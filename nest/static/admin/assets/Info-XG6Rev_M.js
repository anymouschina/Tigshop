import{d as se,v as ie,r as k,a as $,a5 as oe,o as re,J as y,e as S,f as m,g as o,k as n,y as i,h as a,j as v,K as l,t as u,F as z,l as s,i as c,m as de,_ as ne}from"./index-BEWhCL1q.js";import{c as ue,d as pe,o as F,g as ce,a as me,u as ve}from"./order-BQjFJOKB.js";import"./index-DVG44k_-.js";import{O as fe}from"./OrderMoney--IeeVq3Z.js";import{p as N}from"./format-C8RAoEAk.js";import"./Verify.vue_vue_type_style_index_0_lang-B6mvUwPP.js";import"./zh-cn-Crj8NPt5.js";import{T as ye}from"./Tooltip-DKMqsIxV.js";/* empty css                                                                    */import{P as _e}from"./ProductCard-BDl7uMRW.js";import be from"./OperationLog-CJRIz5KK.js";import ge from"./LogisticsTracking-CGMOQ0g_.js";import{M as ke}from"./MobileCard-BFqdI-Pd.js";import{_ as Ie}from"./EditSign.vue_vue_type_style_index_0_lang-DjZPXIu1.js";import xe from"./SignTag-GfUPemyN.js";import{h as Oe,t as Ce}from"./receiptPrint-DbX85EhD.js";import{a as Se}from"./version-C520_GUm.js";import{_ as b}from"./DialogForm.vue_vue_type_script_setup_true_lang-CQB-6Tki.js";import{M}from"./index-BNk7xZkD.js";import{S as he}from"./index-BkEoHS25.js";import"./Pagination-4FaohhlG.js";import"./useResetState-D7o2evJm.js";const we={key:0},Ae={key:0,class:"container-card"},Ne={class:"border-bottom"},Te={key:0},Pe={key:0,style:{"margin-left":"10px"}},De={class:"mt10"},ze={key:1,class:"button-card babyBlue pd20"},Me={class:"container-card"},Be={class:"info-card"},Ve={class:"card-title"},Re={class:"min-title"},Ee={class:"card-li"},Le={class:"li-info"},$e={class:"card-li"},Fe={class:"li-info"},qe={class:"card-li"},We={class:"li-info"},je={key:0,class:"card-li"},Ue={class:"li-info"},Ge={key:1,class:"card-li"},Je={class:"li-info"},Ke={key:2,class:"card-li"},He={class:"li-info"},Qe={class:"card-li"},Xe={class:"li-info"},Ye={class:"card-li"},Ze={class:"li-info"},et={class:"card-title"},tt={class:"min-title"},at={class:"card-li"},lt={class:"li-info"},st={class:"card-li"},it={class:"li-info"},ot={class:"card-li"},rt={class:"li-info"},dt={class:"card-li"},nt={class:"li-info"},ut={class:"card-title"},pt={class:"card-li"},ct={class:"li-info"},mt={class:"card-li"},vt={class:"li-info"},ft={class:"container-card"},yt={class:"title"},_t={class:"product-card-tp"},bt={key:0,class:"gift"},gt={key:1},kt={class:"total"},It={class:"gray",style:{"margin-right":"16px"}},xt={class:"title"},Ot={key:1,class:"container-card"},Ct=se({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},isParent:{type:Boolean,default:!1},isDialog:Boolean},emits:["submitCallback","callback","update:confirmLoading","close"],setup(q,{expose:W,emit:j}){ie();const _=k(localStorage.getItem("adminType")),h=j,x=q,I=k(!0),T=$().currentRoute.value.query,B=k(x.isDialog?x.act:String(T.act)),O=k(x.isDialog?x.id:Number(T.id)),C=k(x.isDialog?x.isParent:!!T.isParent),U=B.value==="add"?"create":"update",G=oe(),e=k({balance:0,couponAmount:0,pointsAmount:0,productAmount:0,totalProductWeight:0,orderId:0,items:[],payType:0,availableActions:{},totalAmount:0,paidAmount:0,updateOrderSn:0,unpaidAmount:0,discountAmount:0}),V=k(!1);re(()=>{I.value=!0,P(),Z()});const P=async()=>{try{const r=await ue(B.value,{id:O.value});Object.assign(e.value,r)}catch(r){y.error(r.message),h("close")}finally{I.value=!1}},J=()=>{M.confirm({title:"确认拆分订单吗？",onOk:async()=>{try{const r=await pe({id:O.value});y.success("操作成功"),f()}catch(r){y.error(r.message)}finally{I.value=!1}}})},K=()=>{M.confirm({title:"确认删除订单吗？",content:"被删除的订单可以通过筛选查找并恢复",onOk:async()=>{try{const r=await F("delOrder",{id:O.value});y.success("操作成功"),f()}catch(r){y.error(r.message)}finally{I.value=!1}}})},H=()=>{M.confirm({title:"确认订单已收货吗？",onOk:async()=>{try{const r=await F("confirmReceipt",{id:O.value});y.success("操作成功"),f()}catch(r){y.error(r.message)}finally{I.value=!1}}})},f=(r={})=>{P(),h("callback",r)},Q=async()=>{await G.value.validate();try{h("update:confirmLoading",!0);const r=await ve(U,{id:O.value,...e.value});h("submitCallback",r),y.success("操作成功")}catch(r){y.error(r.message)}finally{h("update:confirmLoading",!1)}},X=()=>{Q()},Y=$(),R=async(r,t)=>{let w=location.origin+Y.options.history.base+r;try{t==="order"&&await ce({ids:e.value.orderId}),t==="waybill"&&await me({id:e.value.orderId}),window.open(w,"_blank")}catch(p){y.error(p.message)}},Z=async()=>{try{let r=await Oe();V.value=!0}catch(r){console.log(r)}},D=k(!1),ee=async()=>{D.value=!0;try{let r=await Ce({ids:[O.value]});y.success("正在打印中~")}catch(r){console.log(r)}finally{D.value=!1}};return W({onFormSubmit:X}),(r,t)=>{var E,L;const w=S("el-divider"),p=S("el-button"),te=S("el-space"),g=S("el-table-column"),ae=S("el-table"),le=S("a-spin");return o(),m(z,null,[I.value?n("",!0):(o(),m("div",we,[C.value?n("",!0):(o(),m("div",Ae,[a("div",Ne,[l(" 订单编号："+u(e.value.orderSn)+" ",1),i(w,{direction:"vertical"}),l(" 下单时间："+u(e.value.addTime)+" ",1),e.value.storeTitle?(o(),m(z,{key:0},[i(w,{direction:"vertical"}),a("span",null,"下单店铺："+u(e.value.storeTitle),1)],64)):n("",!0)]),i(te,{size:10,class:"button-card"},{default:s(()=>[e.value.isChangeOrderStatus?(o(),m("div",Te,[e.value.availableActions.deliver?(o(),v(c(b),{key:0,params:{id:e.value.orderId,preOrderStatus:e.value.preOrderStatus},isDrawer:"",path:"order/order/src/ChangeStatus",title:"取消订单",width:"600px",onOkCallback:f},{default:s(()=>[i(p,{bg:"",class:"buttonColor",size:"small",text:"",type:"primary"},{default:s(()=>t[4]||(t[4]=[l(" 取消订单 ",-1)])),_:1,__:[4]})]),_:1},8,["params"])):n("",!0),e.value.availableActions.confirmReceipt?(o(),v(c(b),{key:1,params:{id:e.value.orderId,preOrderStatus:e.value.preOrderStatus},isDrawer:"",path:"order/order/src/ChangeStatus",title:"取消发货",width:"600px",onOkCallback:f},{default:s(()=>[i(p,{bg:"",class:"buttonColor",size:"small",text:"",type:"primary"},{default:s(()=>t[5]||(t[5]=[l(" 取消发货 ",-1)])),_:1,__:[5]})]),_:1},8,["params"])):n("",!0)])):n("",!0),e.value.availableActions.setPaid?(o(),v(c(b),{key:1,params:{act:"setPaid",id:e.value.orderId},isDrawer:"",path:"order/order/src/Operation",title:"设置为已支付",width:"600px",onOkCallback:f},{default:s(()=>[i(p,{bg:"",class:"buttonColor",size:"small",text:"",type:"primary"},{default:s(()=>t[6]||(t[6]=[l(" 设置为已支付 ",-1)])),_:1,__:[6]})]),_:1},8,["params"])):n("",!0),e.value.availableActions.cancelOrder?(o(),v(c(b),{key:2,params:{act:"cancelOrder",id:e.value.orderId},isDrawer:"",path:"order/order/src/Operation",title:"取消订单",width:"600px",onOkCallback:f},{default:s(()=>[i(p,{bg:"",class:"buttonColor",size:"small",text:"",type:"primary"},{default:s(()=>t[7]||(t[7]=[l(" 取消订单 ",-1)])),_:1,__:[7]})]),_:1},8,["params"])):n("",!0),e.value.availableActions.delOrder?(o(),v(p,{key:3,bg:"",size:"small",text:"",type:"primary",onClick:K},{default:s(()=>t[8]||(t[8]=[l(" 删除订单 ",-1)])),_:1,__:[8]})):n("",!0),e.value.availableActions.deliver&&_.value=="admin"&&!e.value.vendorId||e.value.availableActions.deliver&&_.value=="vendor"?(o(),v(c(b),{key:4,params:{act:"detail",id:e.value.orderId},title:"订单发货 "+e.value.orderSn,isDrawer:"",path:"order/order/src/ToShip",width:"900px",onOkCallback:f},{default:s(()=>[i(p,{bg:"",size:"small",text:"",type:"danger"},{default:s(()=>t[9]||(t[9]=[l(" 去发货 ",-1)])),_:1,__:[9]})]),_:1},8,["params","title"])):n("",!0),e.value.availableActions.confirmReceipt?(o(),v(p,{key:5,bg:"",size:"small",text:"",type:"primary",onClick:H},{default:s(()=>t[10]||(t[10]=[l(" 确认已收货 ",-1)])),_:1,__:[10]})):n("",!0),e.value.availableActions.splitOrder?(o(),v(p,{key:6,bg:"",size:"small",text:"",type:"danger",onClick:J},{default:s(()=>[t[11]||(t[11]=l(" 拆分店铺订单",-1)),i(c(ye),{ico:"",content:"该订单来自多个店铺且还未拆分，在做任何操作前，您需要先拆分该订单"})]),_:1,__:[11]})):n("",!0),i(p,{bg:"",size:"small",text:"",type:"primary",onClick:t[0]||(t[0]=d=>R(`/print/orderPrint?ids=${e.value.orderId}`,"order"))},{default:s(()=>t[12]||(t[12]=[l(" 打印配送单 ",-1)])),_:1,__:[12]}),e.value.wayBill?(o(),v(p,{key:7,bg:"",size:"small",text:"",type:"primary",onClick:t[1]||(t[1]=d=>R(`/print/waybill?id=${e.value.orderId}`,"waybill"))},{default:s(()=>t[13]||(t[13]=[l(" 打印面单 ",-1)])),_:1,__:[13]})):n("",!0),c(Se)()&&V.value?(o(),v(p,{key:8,bg:"",size:"small",text:"",type:"primary",loading:D.value,onClick:ee},{default:s(()=>t[14]||(t[14]=[l(" 打印小票 ",-1)])),_:1,__:[14]},8,["loading"])):n("",!0)]),_:1}),e.value.mark?(o(),m("div",Pe,[i(Ie,{title:"编辑标记",item:e.value,onCallBack:P},{default:s(()=>[i(p,{link:"",type:"primary",style:{"font-size":"12px"}},{default:s(()=>t[15]||(t[15]=[l("标记订单",-1)])),_:1,__:[15]}),a("div",De,[i(xe,{class:"check-box tag",value:e.value.mark},null,8,["value"]),l(" "+u(e.value.adminNote),1)])]),_:1},8,["item"])])):n("",!0),e.value.stepStatus?(o(),m("div",ze,[i(c(he),{current:e.value.stepStatus.current,size:"small",status:e.value.stepStatus.status,items:e.value.stepStatus.steps},null,8,["current","status","items"])])):n("",!0)])),a("div",Me,[t[35]||(t[35]=a("div",{class:"title"},"订单明细",-1)),a("div",Be,[a("div",Ve,[a("div",Re,[t[17]||(t[17]=l(" 收货人信息 ",-1)),C.value?n("",!0):(o(),v(c(b),{key:0,params:{act:"detail",id:e.value.orderId,form:e.value},isDrawer:"",path:"order/order/src/EditConsignee",title:"编辑收货人信息",width:"550px",onOkCallback:f,disabled:_.value=="admin"&&e.value.vendorId},{default:s(()=>[i(p,{bg:"",class:"ml10",size:"small",text:"",type:"primary",disabled:_.value=="admin"&&e.value.vendorId},{default:s(()=>t[16]||(t[16]=[l(" 编辑 ",-1)])),_:1,__:[16]},8,["disabled"])]),_:1},8,["params","disabled"]))]),a("ul",null,[a("li",Ee,[t[18]||(t[18]=l(" 会员名称：",-1)),a("span",Le,u(((E=e.value.user)==null?void 0:E.nickname)||((L=e.value.user)==null?void 0:L.username)||"--"),1)]),a("li",$e,[t[19]||(t[19]=l("     收货人：",-1)),a("span",Fe,u(e.value.consignee?e.value.consignee:"--"),1)]),a("li",qe,[t[20]||(t[20]=l(" 联系电话：",-1)),a("span",We,[i(ke,{mobile:e.value.mobile},null,8,["mobile"])])]),e.value.telephone?(o(),m("li",je,[t[21]||(t[21]=l(" 手机：",-1)),a("span",Ue,u(e.value.telephone?e.value.telephone:"--"),1)])):n("",!0),e.value.email?(o(),m("li",Ge,[t[22]||(t[22]=l(" 电子邮件：",-1)),a("span",Je,u(e.value.email),1)])):n("",!0),e.value.postcode?(o(),m("li",Ke,[t[23]||(t[23]=l(" 邮政编码：",-1)),a("span",He,u(e.value.postcode),1)])):n("",!0),a("li",Qe,[t[24]||(t[24]=l(" 收货地址： ",-1)),a("span",Xe,u(e.value.userAddress?e.value.userAddress:"--"),1)]),a("li",Ye,[t[25]||(t[25]=l(" 订单备注： ",-1)),a("span",Ze,u(e.value.buyerNote?e.value.buyerNote:"--"),1)])])]),a("div",et,[a("div",tt,[t[27]||(t[27]=l(" 配送信息 ",-1)),C.value?n("",!0):(o(),v(c(b),{key:0,params:{act:"detail",id:e.value.orderId},isDrawer:"",path:"order/order/src/EditShipping",title:"编辑配送方式",width:"600px",disabled:!e.value.availableActions.modifyShippingInfo||_.value=="admin"&&e.value.vendorId,onOkCallback:f},{default:s(()=>[i(p,{disabled:!e.value.availableActions.modifyShippingInfo||_.value=="admin"&&e.value.vendorId,bg:"",class:"buttonColor",size:"small",text:"",type:"primary"},{default:s(()=>t[26]||(t[26]=[l(" 编辑 ",-1)])),_:1,__:[26]},8,["disabled"])]),_:1},8,["params","disabled"]))]),a("ul",null,[a("li",at,[t[28]||(t[28]=l(" 配送方式：",-1)),a("span",lt,u(e.value.shippingTypeName),1)]),a("li",st,[t[29]||(t[29]=l(" 发货时间：",-1)),a("span",it,u(e.value.shippingTime?e.value.shippingTime:"--"),1)]),a("li",ot,[t[30]||(t[30]=l(" 物流名称：",-1)),a("span",rt,u(e.value.logisticsName?e.value.logisticsName:"--"),1)]),a("li",dt,[t[31]||(t[31]=l(" 发货单号：",-1)),a("span",nt,u(e.value.trackingNo?e.value.trackingNo:"--"),1)])])]),a("div",ut,[t[34]||(t[34]=a("div",{class:"min-title"},"付款信息",-1)),a("ul",null,[a("li",pt,[t[32]||(t[32]=l(" 支付方式：",-1)),a("span",ct,u(e.value.payTypeId===1?"在线支付":e.value.payTypeId===2?"货到付款":"线下支付"),1)]),a("li",mt,[t[33]||(t[33]=l(" 付款时间：",-1)),a("span",vt,u(e.value.payTime?e.value.payTime:"--"),1)])])])])]),a("div",ft,[a("div",yt,[t[37]||(t[37]=l(" 商品信息 ",-1)),C.value?n("",!0):(o(),v(c(b),{key:0,params:{act:"detail",id:e.value.orderId},isDrawer:"",path:"order/order/src/EditProduct",title:"编辑商品信息",width:"1050px",disabled:!e.value.availableActions.modifyOrder||_.value=="admin"&&e.value.vendorId,onOkCallback:f},{default:s(()=>[i(p,{disabled:!e.value.availableActions.modifyOrder||_.value=="admin"&&e.value.vendorId,bg:"",class:"buttonColor",size:"small",text:"",type:"primary"},{default:s(()=>t[36]||(t[36]=[l(" 编辑 ",-1)])),_:1,__:[36]},8,["disabled"])]),_:1},8,["params","disabled"]))]),i(ae,{data:e.value.items},{default:s(()=>[i(g,{label:"商品名称",prop:"productId",width:"220"},{default:s(({row:d})=>[a("div",_t,[d.isGift?(o(),m("div",bt,"赠")):n("",!0),i(c(_e),{picThumb:d.picThumb,productId:d.productId,productName:d.productName,productType:d.productType,url:d.url},null,8,["picThumb","productId","productName","productType","url"])])]),_:1}),i(g,{label:"属性",prop:"productAttr"},{default:s(({row:d})=>[l(u(d.skuValue||"无属性"),1)]),_:1}),i(g,{label:"附加规格",prop:"extraSkuData"},{default:s(({row:d})=>[d.extraSkuData&&d.extraSkuData.length>0?(o(!0),m(z,{key:0},de(d.extraSkuData,A=>(o(),m("div",{class:"extraskudata",key:A},u(A.attrName+A.attrValue+c(N)(A.totalAttrPrice)),1))),128)):(o(),m("div",gt,"无附加规格"))]),_:1}),i(g,{label:"商品编号",width:"150"},{default:s(({row:d})=>[l(u(d.productSn),1)]),_:1}),i(g,{label:"价格",prop:"price"},{default:s(({row:d})=>[l(u(c(N)(d.price)),1)]),_:1}),i(g,{label:"数量",prop:"quantity"}),i(g,{label:"库存",prop:"stock"},{default:s(({row:d})=>[l(u(d.stock||"-"),1)]),_:1}),i(g,{label:"小计",prop:"subtotal"},{default:s(({row:d})=>[l(u(c(N)(d.subtotal)),1)]),_:1})]),_:1},8,["data"]),a("div",kt,[a("span",It,"商品总重量："+u(e.value.totalProductWeight)+"kg",1),a("span",null,"合计："+u(c(N)(Number(e.value.productAmount)-Number(e.value.couponAmount)-Number(e.value.discountAmount))),1)]),a("div",xt,[t[39]||(t[39]=l(" 订单金额 ",-1)),C.value?n("",!0):(o(),v(c(b),{key:0,params:{act:"detail",id:e.value.orderId},isDrawer:"",path:"order/order/src/EditMoney",title:"编辑金额",width:"600px",disabled:!e.value.availableActions.modifyOrderMoney||_.value=="admin"&&e.value.vendorId,onOkCallback:f},{default:s(()=>[i(p,{disabled:!e.value.availableActions.modifyOrderMoney||_.value=="admin"&&e.value.vendorId,bg:"",class:"buttonColor",size:"small",text:"",type:"primary"},{default:s(()=>t[38]||(t[38]=[l(" 编辑 ",-1)])),_:1,__:[38]},8,["disabled"])]),_:1},8,["params","disabled"]))]),i(c(fe),{modelValue:e.value,"onUpdate:modelValue":t[2]||(t[2]=d=>e.value=d)},null,8,["modelValue"])]),e.value.orderId&&(e.value.orderStatus===2||e.value.orderStatus===5)?(o(),m("div",Ot,[t[40]||(t[40]=a("div",{class:"title"},"物流追踪",-1)),i(ge,{trackingNo:e.value.trackingNo,logisticsName:e.value.logisticsName,shippingMethod:e.value.shippingMethod,id:e.value.orderId,"onUpdate:id":t[3]||(t[3]=d=>e.value.orderId=d)},null,8,["trackingNo","logisticsName","shippingMethod","id"])])):n("",!0),C.value?n("",!0):(o(),v(be,{key:2,orderId:e.value.orderId},null,8,["orderId"]))])),i(le,{spinning:I.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])],64)}}}),Jt=ne(Ct,[["__scopeId","data-v-58d4a171"]]);export{Jt as default};
