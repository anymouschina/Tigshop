import z from"./BasicInfo-CVI5g7Il.js";import{_ as A}from"./DescInfo.vue_vue_type_script_setup_true_lang-bnXhWzb4.js";import{_ as $}from"./PriceInfo.vue_vue_type_script_setup_true_lang-BtH5u4FZ.js";import{d as G,P as J,r as s,a as K,a5 as M,o as O,J as k,e as g,f as N,g as y,h as o,y as p,l as _,F as H,m as Q,n as T,t as X,j as Y,k as Z,K as h,i as x,q as R,_ as ee}from"./index-BEWhCL1q.js";import{f as te,h as oe}from"./product-Cakm3Kom.js";import"./UploadAvatar.vue_vue_type_style_index_0_scoped_3ec2e0ca_lang-BVJHh8ng.js";import"./index-DVG44k_-.js";import"./index-BNk7xZkD.js";import"./vuedraggable.umd-_qUe1n4L.js";import"./Image.vue_vue_type_script_setup_true_lang-DC1N644b.js";import"./format-C8RAoEAk.js";import"./BusinessImg-CuIKiE1z.js";import"./currencyManagement-BEhPZh48.js";import"./version-C520_GUm.js";import"./DialogForm.vue_vue_type_script_setup_true_lang-CQB-6Tki.js";import"./FormAddGalleryVideo-Cr9BEyUE.js";import"./SelectBrand-DFj6FPJO.js";import"./brand-NPYEvOSK.js";import"./SelectTimeInterval.vue_vue_type_style_index_0_scoped_207fe586_lang-B2T-ARqM.js";import"./time-BMcbgg5F.js";import"./SelectCategory.vue_vue_type_script_setup_true_lang-D5TL5eLW.js";import"./category-Bu2fUBIU.js";import"./category-JkcBf76e.js";/* empty css                                                                    *//* empty css                                                                  *//* empty css                                                                              *//* empty css             */import"./BusinessData-ICvr1eK8.js";import"./ProductDesc-Cq-9rU2D.js";import"./Editor.vue_vue_type_style_index_0_lang-DND4PNav.js";import"./index.esm-yJQQDR41.js";import"./Attr-B75JJvC2.js";import"./PopSelect.vue_vue_type_style_index_0_scoped_5832cf6b_lang-B9ASxJaT.js";import"./PriceInput.vue_vue_type_script_setup_true_lang-2l6MKJVZ.js";const ae={class:"product-container"},re={class:"anchor"},ie={class:"tab-row"},se={id:"part1",class:"form-warp"},ne={id:"part2",class:"form-warp"},le={id:"part3",class:"form-warp"},ce=G({__name:"Info",props:{id:{type:Number,default:0},shopId:{type:Number,default:0},act:{type:String,default:""},examine:{type:Number,default:0},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close","closeConfirm"],setup(n,{expose:P,emit:B}){J();const u=B,d=n,D=[{title:"基本信息",id:"part1"},{title:"价格及库存",id:"part2"},{title:"商品详情",id:"part3"}],b=s(null),m=s(""),q=e=>{e.preventDefault()},E=e=>{m.value=e},l=s(!0),S=K().currentRoute.value.query,c=s(d.isDialog?d.act:String(S.act)),f=s(d.isDialog?d.id:Number(S.id)),F=c.value==="add"?"create":c.value==="copy"?"copy":"update",w=M(),a=s({productType:1,productState:1,skuType:1,productDesc:[],productSnGenerateType:1,video:[],skus:[],skuAttrs:[]});O(async()=>{c.value==="detail"||c.value==="copy"||c.value==="again"?await L():l.value=!1,d.examine!==1&&setTimeout(()=>{u("closeConfirm",!0)},1e4)});const L=async()=>{try{const e=await te("detail",{id:f.value});e.video==null&&(e.video=[]),e.brandId==0&&(e.brandId=""),console.log("详情数据:",e.skus),Object.assign(a.value,e,e)}catch(e){k.error(e.message),u("close")}finally{l.value=!1}};function V(e){for(let t=0;t<e.length;t++){const i=e[t];if(i.skuStock===null||i.skuStock===void 0)return console.error("请填写完整的规格信息"),!1}return!0}const v=s(),U=async()=>{console.log("表单提交:",a.value),a.value.skus.forEach(e=>{console.log(e),(e.skuWeight||e.supplyPrice)&&(e.skuWeight=Number(e.skuWeight),e.supplyPrice=Number(e.supplyPrice))});try{await w.value.validate(),V(a.value.skus)?v.value.skuErrorText="":(k.error("请将商品规格的信息填写完整!"),v.value.skuErrorText="请将商品规格的信息填写完整",await R(),I(".sku-error")),await v.value.attrForm.validateProductSku();try{u("update:confirmLoading",!0);const e=await oe(F,{...a.value});u("submitCallback",e),k.success(e)}catch(e){k.error(e.message)}finally{console.log("提交完成"),u("update:confirmLoading",!1)}}catch(e){await R(),I(),console.error("表单验证失败:",e)}},I=(e=".el-form-item.is-error")=>{const t=document.querySelector(e);if(t){t.scrollIntoView({behavior:"instant",block:"center"});const i=t.querySelector("input, textarea, select");i&&(i==null||i.focus())}};return P({onFormSubmit:()=>{U()}}),(e,t)=>{const i=g("el-anchor-link"),W=g("el-anchor"),j=g("el-form");return y(),N("div",ae,[o("div",re,[p(W,{container:b.value,offset:10,direction:"horizontal",onChange:E,onClick:q},{default:_(()=>[o("div",ie,[(y(),N(H,null,Q(D,(r,C)=>p(i,{key:r.id,class:T({active:m.value===""&&C===0?!0:m.value==="#"+r.id}),href:"#"+r.id},{default:_(()=>[o("div",{class:T([{active:m.value===""&&C===0?!0:m.value==="#"+r.id},"item"])},X(r.title),3)]),_:2},1032,["class","href"])),64))])]),_:1},8,["container"])]),o("div",{ref_key:"containerRef",ref:b,class:"form-container"},[l.value?Z("",!0):(y(),Y(j,{key:0,ref_key:"formRef",ref:w,model:a.value,"label-width":"110px",name:"form_in_modal"},{default:_(()=>[o("div",se,[t[3]||(t[3]=o("div",{class:"title"},[o("p",{class:"xian"}),h(" 基本信息 ")],-1)),p(x(z),{id:f.value,shopId:n.shopId,examine:n.examine,loading:l.value,action:c.value,"form-state":a.value,"onUpdate:formState":t[0]||(t[0]=r=>a.value=r)},null,8,["id","shopId","examine","loading","action","form-state"])]),o("div",ne,[t[4]||(t[4]=o("div",{class:"title"},[o("p",{class:"xian"}),h(" 价格及库存 ")],-1)),p(x($),{ref_key:"priceInfoRef",ref:v,id:f.value,act:n.act,examine:n.examine,loading:l.value,"form-state":a.value,"onUpdate:formState":t[1]||(t[1]=r=>a.value=r)},null,8,["id","act","examine","loading","form-state"])]),o("div",le,[t[5]||(t[5]=o("div",{class:"title"},[o("p",{class:"xian"}),h(" 商品详情 ")],-1)),p(x(A),{id:f.value,examine:n.examine,loading:l.value,formState:a.value,"onUpdate:formState":t[2]||(t[2]=r=>a.value=r)},null,8,["id","examine","loading","formState"])])]),_:1},8,["model"]))],512)])}}}),Je=ee(ce,[["__scopeId","data-v-ca245032"]]);export{Je as default};
