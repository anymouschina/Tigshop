import{d as a,K as e,a3 as t,r as l,W as u,q as c,B as o,E as s,I as n,o as r,c as d,a as i,g as p,i as v,w as m,J as f,O as y,f as b,t as _,h as g,b as h,F as k,G as x,aa as T,ab as $,_ as N,b$ as D,bG as w,X as V,Q as C,n as I,a6 as z,k as j,s as S,ah as U,aE as M,bo as E,bV as W,bk as B,bW as F,a4 as G,ad as O,l as R,c7 as q,Y as J,Z as K}from"./index-BcyAKDDV.js";import{_ as Q}from"./format-price.csRf0ax_.js";import{a as X,_ as Y}from"./tig-layout.DHsvU4xy.js";import{_ as Z}from"./loading-box.BPbOi9GY.js";import{g as A,a as H,b as L,u as P,c as aa,d as ea}from"./account.C1g5Qepq.js";import{_ as ta}from"./tig-fixed-placeholder.BvTFztLB.js";const la=N(a({__name:"detail",props:{activeTab:{},activeTabModifiers:{}},emits:["update:activeTab"],setup(a){const{t:N}=e(),D=t(a,"activeTab"),w=l(0),V=l(!1),C=l(!1),I=u({page:1,size:10,status:1}),z=l([]),j=async()=>{I.page>1?V.value=!0:T({title:N("加载中")});try{const a=await A({...I});w.value=a.total,z.value=[...z.value,...a.records]}catch(a){console.error(a)}finally{$(),V.value=!1,C.value=!0}};return j(),c(()=>{D.value&&"detail"===D.value&&I.page<Math.ceil(w.value/I.size)&&(I.page++,j())}),(a,e)=>{const t=v,l=g,u=h,c=o(s("loading-box"),Z);return r(),n(f,null,[z.value.length>0?(r(),d(t,{key:0,class:"log-main"},{default:m(()=>[(r(!0),n(f,null,y(z.value,(a,e)=>(r(),d(t,{key:e,class:"item"},{default:m(()=>[p(t,{class:"tit"},{default:m(()=>[b(_(a.changeTypeName),1)]),_:2},1024),p(t,{class:"time"},{default:m(()=>[b(_(a.changeTime),1)]),_:2},1024),p(t,{class:"desc"},{default:m(()=>[b(_(a.changeDesc),1)]),_:2},1024),p(t,{class:"real_total"},{default:m(()=>["增加"===a.changeTypeName?(r(),d(l,{key:0},{default:m(()=>[b("+")]),_:1})):(r(),d(l,{key:1},{default:m(()=>[b("-")]),_:1})),p(l,null,{default:m(()=>[b(_(a.balance),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})):i("",!0),0===z.value.length&&!0===C.value?(r(),d(t,{key:1,class:"empty-box"},{default:m(()=>[p(t,{class:"pictrue"},{default:m(()=>[p(u,{src:k(x)("common/data_empty.png")},null,8,["src"])]),_:1}),p(t,{class:"txt"},{default:m(()=>[b(_(a.$t("暂无数据")),1)]),_:1})]),_:1})):i("",!0),p(c,{modelValue:V.value,"onUpdate:modelValue":e[0]||(e[0]=a=>V.value=a),page:I.page,length:z.value.length},null,8,["modelValue","page","length"])],64)}}}),[["__scopeId","data-v-125423cf"]]),ua=N(a({__name:"log",props:{activeTab:{},activeTabModifiers:{}},emits:["update:activeTab"],setup(a){const{t:g}=e(),N=t(a,"activeTab"),D=l(0),w=l(!1),V=l(!1),C=u({page:1,size:10}),I=l([]),z=async()=>{C.page>1?w.value=!0:T({title:g("加载中")});try{const a=await H({...C});D.value=a.total,I.value=[...I.value,...a.records]}catch(a){console.error(a)}finally{$(),w.value=!1,V.value=!0}};return z(),c(()=>{N.value&&"log"===N.value&&C.page<Math.ceil(D.value/C.size)&&(C.page++,z())}),(a,e)=>{const t=v,l=o(s("format-price"),Q),u=h,c=o(s("loading-box"),Z);return r(),n(f,null,[I.value.length>0?(r(),d(t,{key:0,class:"log-main"},{default:m(()=>[(r(!0),n(f,null,y(I.value,(e,u)=>(r(),d(t,{key:u,class:"item"},{default:m(()=>[p(t,{class:"tit"},{default:m(()=>[b(_(e.type),1)]),_:2},1024),p(t,{class:"time"},{default:m(()=>[b(_(e.addTime),1)]),_:2},1024),p(t,{class:"real_total"},{default:m(()=>[p(l,{"show-text":!1,"decimals-style":{fontSize:"25rpx",fontWeight:"bold"},"currency-style":{fontSize:"23rpx",fontWeight:"bold"},"price-data":e.amount},null,8,["price-data"])]),_:2},1024),p(t,{class:"actions"},{default:m(()=>[p(t,{class:"txt"},{default:m(()=>[b(_(a.$t("管理员备注"))+"："+_(e.postscript||a.$t("无")),1)]),_:2},1024),p(t,{class:"status"},{default:m(()=>[b(_(e.statusType),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})):i("",!0),0===I.value.length&&!0===V.value?(r(),d(t,{key:1,class:"empty-box"},{default:m(()=>[p(t,{class:"pictrue"},{default:m(()=>[p(u,{src:k(x)("common/data_empty.png")},null,8,["src"])]),_:1}),p(t,{class:"txt"},{default:m(()=>[b(_(a.$t("暂无数据"))+"！",1)]),_:1})]),_:1})):i("",!0),p(c,{modelValue:w.value,"onUpdate:modelValue":e[0]||(e[0]=a=>w.value=a),page:C.page,length:I.value.length},null,8,["modelValue","page","length"])],64)}}}),[["__scopeId","data-v-6459bed6"]]),ca=N(a({__name:"deposit",emits:["backDetail"],setup(a,{emit:t}){const{t:u}=e(),c=l([]);D(()=>{(async()=>{T({title:u("加载中")});try{const a=await L();c.value=a;let e={rechargeId:0};c.value.push(e),c.value.forEach(a=>{a.selected=!1})}catch(a){console.log(a.message)}finally{$()}})()});const g=l(!1),h=a=>{g.value=5===a,c.value.forEach((e,t)=>{e.selected=t===a})},k=l({id:0,amount:0,money:"",payType:"recharge"}),x=()=>{let a=!1;if(c.value.forEach((e,t)=>{e.selected&&(a=!0,k.value.id=e.rechargeId,0!=e.rechargeId?(k.value.amount=null,k.value.money=e.money):k.value.money=k.value.amount)}),!k.value.money)return C({title:u("请输入充值金额"),icon:"none"});a?N(k.value):C({title:u("请选择充值金额"),icon:"none"})},N=async a=>{try{const e=await P(a);I({url:`/pages/order/pay?orderId=${e.orderId}&type=recharge`})}catch(e){C({title:e.message,icon:"none",duration:1e3})}},z=t,j=()=>{z("backDetail")};return(a,e)=>{const t=o(s("format-price"),Q),l=v,u=o(s("up-input"),w),g=o(s("tig-button"),X),T=o(s("tig-fixed-placeholder"),ta);return r(),n(f,null,[p(l,{class:"recharge-box"},{default:m(()=>[c.value.length>0?(r(),d(l,{key:0,class:"recharge-wrap"},{default:m(()=>[(r(!0),n(f,null,y(c.value,(c,o)=>(r(),n(f,{key:o},[0!=c.rechargeId?(r(),d(l,{key:0,class:V(["recharge-item",{selected:c.selected}]),onClick:a=>h(o)},{default:m(()=>[p(l,{class:"recharge-amount"},{default:m(()=>[p(t,{"show-text":!1,"price-data":c.money,"decimals-style":{fontSize:"25rpx"},"currency-style":{fontSize:"23rpx"}},null,8,["price-data"])]),_:2},1024),Number(c.discountMoney)>0?(r(),d(l,{key:0,class:"recharge-give"},{default:m(()=>[b(_(a.$t("赠送"))+" ",1),p(t,{"show-text":!1,"price-data":c.discountMoney,"is-bottom":!1,"font-style":{fontSize:"11px"}},null,8,["price-data"])]),_:2},1024)):i("",!0)]),_:2},1032,["class","onClick"])):(r(),d(l,{key:1,class:V(["recharge-item",{selected:c.selected}]),onClick:a=>h(o)},{default:m(()=>[p(l,{class:"recharge-amount"},{default:m(()=>[c.selected?(r(),d(u,{key:0,modelValue:k.value.amount,"onUpdate:modelValue":e[0]||(e[0]=a=>k.value.amount=a),type:"digit",color:"var(--color)","input-align":"center",border:"none"},null,8,["modelValue"])):(r(),d(l,{key:1,style:{height:"42rpx"}}))]),_:2},1024),p(l,{class:"recharge-give"},{default:m(()=>[b(_(a.$t("自定义金额")),1)]),_:1})]),_:2},1032,["class","onClick"]))],64))),128))]),_:1})):i("",!0)]),_:1}),p(T,{"background-color":"#fff"},{default:m(()=>[p(l,{class:"btn-box"},{default:m(()=>[p(g,{class:"btn",plain:"",onClick:j},{default:m(()=>[b(_(a.$t("取消充值")),1)]),_:1}),p(g,{class:"btn",onClick:x},{default:m(()=>[b(_(a.$t("提交申请")),1)]),_:1})]),_:1})]),_:1})],64)}}}),[["__scopeId","data-v-eba84b11"]]),oa=N(a({__name:"raplyToCard",props:{balance:{type:[Number,String],default:0}},emits:["backDetail"],setup(a,{emit:t}){const{t:u}=e(),c=[{title:"银行卡",accountType:1},{title:"支付宝",accountType:2},{title:"微信",accountType:3}],g=z(),h=l(1),x=()=>{I.value={id:"",text:u("请选择")},A.value={accountData:{accountNo:"",accountName:"",accountType:h.value,bankName:""},amount:""}},N=l(!1),I=l({id:"",text:u("请选择")}),R=()=>{N.value=!1},q=a=>{N.value=!1,I.value.id=a.value[0].id,I.value.text=a.value[0].text,J(a.value[0].id)},J=a=>{let e=(1===A.value.accountData.accountType?K:2===A.value.accountData.accountType?Q:Y).value[0].find(e=>e.accountId===a);A.value.accountData.accountNo=null==e?void 0:e.accountNo,A.value.accountData.accountName=null==e?void 0:e.accountName,A.value.accountData.bankName=null==e?void 0:e.bankName},K=l([]),Q=l([]),Y=l([]),Z=async a=>{T({title:u("加载中")});try{let e={accountType:a};const t=await aa({...e});let l=[];1==a?(l=t.records.map(a=>({id:a.accountId,text:a.accountNo,...a})),K.value.push(l)):2===a?(l=t.records.map(a=>({id:a.accountId,text:a.accountNo,...a})),Q.value.push(l)):(l=t.records.map(a=>({id:a.accountId,text:a.accountNo,...a})),Y.value.push(l))}catch(e){console.error(e.message)}finally{$()}};D(()=>{Z(h.value)});const A=l({accountData:{accountNo:"",accountName:"",accountType:1,bankName:""},amount:""}),H=j(()=>{switch(A.value.accountData.accountType){case 1:return u("银行卡");case 2:return u("支付宝");case 3:return u("微信");default:return""}}),L=j(()=>{switch(A.value.accountData.accountType){case 1:return K.value;case 2:return Q.value;case 3:return Y.value;default:return[]}}),P={amount:{validator:(a,e,t)=>(0==e&&uni.$u.toast(u("提现金额必须大于0")),e>0),message:u("请输入提现金额"),trigger:["blur"]}};S(()=>{U(()=>{g.value.setRules(P)})});const la=async()=>{0!==I.value.id.length?g.value.validate().then(async a=>{if(a)try{await ea({...A.value});C({title:u("操作成功"),icon:"success",duration:1e3}),setTimeout(()=>{ca()},1500)}catch(e){console.error(e),uni.$u.toast(e.message)}}).catch(()=>{}):C({title:u("请选择需要提现的账号"),icon:"none",duration:1e3})},ua=t,ca=()=>{ua("backDetail")};return(a,e)=>{const t=v,l=o(s("up-picker"),M),u=o(s("up-button"),E),T=o(s("up-form-item"),W),$=G,D=o(s("up-input"),w),C=o(s("up-textarea"),B),z=o(s("up-form"),F),j=o(s("tig-button"),X),S=o(s("tig-fixed-placeholder"),ta);return r(),n(f,null,[p(t,{class:"custom-tabs"},{default:m(()=>[(r(),n(f,null,y(c,(e,l)=>p(t,{key:l,class:V([{"active-tab":h.value===e.accountType},"tab"]),onClick:a=>(async a=>{a!==h.value&&(h.value=a,A.value.accountData.accountType=a,K.value=[],Q.value=[],Y.value=[],x(),Z(a))})(e.accountType)},{default:m(()=>[p(t,null,{default:m(()=>[b(_(a.$t(e.title)),1)]),_:2},1024)]),_:2},1032,["class","onClick"])),64))]),_:1}),p(t,{class:"reply-main"},{default:m(()=>[p(t,{class:"reply-content"},{default:m(()=>[p(z,{ref_key:"formRef",ref:g,model:A.value,"label-width":"170rpx","error-type":"toast"},{default:m(()=>[p(T,{label:a.$t("提现至")},{default:m(()=>[p(l,{show:N.value,columns:L.value,"key-name":"text",onConfirm:q,onCancel:R},null,8,["show","columns"]),p(u,{style:{"justify-content":"flex-start"},onClick:e[0]||(e[0]=a=>N.value=!0)},{default:m(()=>[b(_(I.value.text),1)]),_:1})]),_:1},8,["label"]),p(t,{class:"tips"},{default:m(()=>[b(_(a.$t("当前"))+_(H.value)+_(a.$t("账号已不用"))+"？",1),p($,{url:"/pages/user/account/cardManagement/list",class:"font-color"},{default:m(()=>[b(_(a.$t("点击这里")),1)]),_:1}),b(_(a.$t("去添加新的"))+_(H.value)+_(a.$t("账号"))+"。",1)]),_:1}),p(T,{label:a.$t("提现姓名"),prop:"accountData.accountName"},{default:m(()=>[p(D,{modelValue:A.value.accountData.accountName,"onUpdate:modelValue":e[1]||(e[1]=a=>A.value.accountData.accountName=a),placeholder:k(O)()?a.$t("请选择{0}账号",H.value):`请选择${H.value}账号`,disabled:"","font-size":"12"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),1===A.value.accountData.accountType?(r(),d(T,{key:0,label:a.$t("银行详情"),prop:"accountData.bankName"},{default:m(()=>[p(C,{modelValue:A.value.accountData.bankName,"onUpdate:modelValue":e[2]||(e[2]=a=>A.value.accountData.bankName=a),placeholder:a.$t("请选择银行卡账号"),disabled:"","font-size":"12"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):i("",!0),p(T,{label:a.$t("提现金额"),prop:"amount"},{default:m(()=>[p(D,{modelValue:A.value.amount,"onUpdate:modelValue":e[3]||(e[3]=a=>A.value.amount=a),type:"number",placeholder:a.$t("请输入提现金额"),clearable:"","font-size":"12"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1})]),_:1}),p(S,{"background-color":"#fff"},{default:m(()=>[p(t,{class:"btn-box"},{default:m(()=>[p(j,{class:"btn",plain:"",onClick:ca},{default:m(()=>[b(_(a.$t("返回列表")),1)]),_:1}),p(j,{class:"btn",onClick:la},{default:m(()=>[b(_(a.$t("提交申请")),1)]),_:1})]),_:1})]),_:1})],64)}}}),[["__scopeId","data-v-86790377"]]),sa=N(a({__name:"index",setup(a){const e=l({}),t=[{title:"账户明细",action:"detail"},{title:"申请记录",action:"log"}],u=l("detail"),c=a=>{a!==u.value&&(u.value=a)},g=()=>{u.value="detail"};return R(()=>{(async()=>{try{const a=await q();Object.assign(e.value,a)}catch(a){console.error(a.message)}})()}),(a,l)=>{const h=v,k=o(s("format-price"),Q),x=o(s("tig-layout"),Y);return r(),d(x,{title:"资金管理"},{default:m(()=>[p(h,{class:"top-card"},{default:m(()=>[p(h,{class:"balance-row"},{default:m(()=>[b(_(a.$t("可用余额")),1)]),_:1}),p(h,{class:"amount-row"},{default:m(()=>[p(k,{"show-text":!1,"price-data":e.value.balance,"decimals-style":{fontSize:"40rpx",fontWeight:"bold"},"currency-style":{fontSize:"38rpx",fontWeight:"bold"}},null,8,["price-data"])]),_:1}),p(h,{class:"button-row"},{default:m(()=>[p(h,{class:V(["round-button",{active:"deposit"===u.value}]),onClick:l[0]||(l[0]=a=>c("deposit"))},{default:m(()=>[b(_(a.$t("充值")),1)]),_:1},8,["class"]),p(h,{class:V(["round-button",{active:"raplytocard"===u.value}]),onClick:l[1]||(l[1]=a=>c("raplytocard"))},{default:m(()=>[b(_(a.$t("提现")),1)]),_:1},8,["class"])]),_:1})]),_:1}),"detail"===u.value||"log"===u.value?(r(),d(h,{key:0,class:"custom-tabs"},{default:m(()=>[(r(),n(f,null,y(t,(e,t)=>p(h,{key:t,class:V([{"active-tab":u.value===e.action},"tab"]),onClick:a=>c(e.action)},{default:m(()=>[p(h,null,{default:m(()=>[b(_(a.$t(e.title)),1)]),_:2},1024)]),_:2},1032,["class","onClick"])),64))]),_:1})):i("",!0),J(p(h,null,{default:m(()=>[p(la,{"active-tab":u.value,"onUpdate:activeTab":l[2]||(l[2]=a=>u.value=a)},null,8,["active-tab"])]),_:1},512),[[K,"detail"===u.value]]),J(p(h,null,{default:m(()=>[p(ua,{"active-tab":u.value,"onUpdate:activeTab":l[3]||(l[3]=a=>u.value=a)},null,8,["active-tab"])]),_:1},512),[[K,"log"===u.value]]),"deposit"===u.value?(r(),d(ca,{key:1,onBackDetail:g})):i("",!0),"raplytocard"===u.value?(r(),d(oa,{key:2,balance:e.value.balance,onBackDetail:g},null,8,["balance"])):i("",!0)]),_:1})}}}),[["__scopeId","data-v-e1e77ebb"]]);export{sa as default};
