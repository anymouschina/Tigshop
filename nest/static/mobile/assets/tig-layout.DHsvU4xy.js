import{r as e,C as t,j as a,bn as o,d as s,c as l,w as n,g as c,i as r,aG as i,a as u,H as d,X as p,o as g,f,t as b,_ as h,a9 as y,I as m,O as k,F as v,J as _,a7 as S,Y as x,b as B,ac as C,Z as w,S as I,u as T,B as $,E as z,bo as L,b7 as N,k as A,bp as D,bq as H,br as P,K as V,ay as O,s as j,L as U,h as X,n as q,Q as J,bs as M,bt as R,P as W,W as E,aJ as F,bu as G,aO as Y,ad as Z}from"./index-BcyAKDDV.js";function K(a){const o=e(0);return a&&"function"==typeof a?a(e=>{o.value=e.scrollTop}):t(e=>{o.value=e.scrollTop}),{scrollTop:o}}function Q(){const e=a(),{top:t,bottom:s}=o(e.safeAreaInsets);return{saveTop:t,safeBottom:s}}function ee(t=0){const s=e(t),l=e("100%"),n=e(0),{saveTop:c}=Q();return function(){const e=a(),{left:t,right:s,top:l,height:n}=o(e.menuButtonInfo)}(),n.value=c.value+s.value,{height:n,contentHeight:s,contentWidth:l,statusBarHeight:c}}const te=h(s({__name:"tig-navbar",props:{title:{type:String,default:""},background:{type:String,default:"#fff"},showLeft:{type:Boolean,default:!0},customBack:{type:Boolean,default:!1},borderBottom:{type:Boolean,default:!1},color:{type:String,default:"#000"}},emits:["back"],setup(e,{emit:t}){const a=e,o=t,s=()=>{a.customBack?o("back"):history.back()};return(t,a)=>{const o=r;return g(),l(o,{class:"tig-navbar"},{default:n(()=>[c(o,{class:p(["navbar-box",{"border-bottom":e.borderBottom}]),style:d(`background: ${e.background};`)},{default:n(()=>[c(o,{class:"navbar"},{default:n(()=>[c(o,{class:"navbar-content"},{default:n(()=>[c(o,{class:"left"},{default:n(()=>[e.showLeft?i(t.$slots,"left",{key:0},()=>[c(o,{class:"iconfont icon-houtui",onClick:s})],!0):u("",!0)]),_:3}),c(o,{class:"middle"},{default:n(()=>[i(t.$slots,"title",{},()=>[c(o,{class:"title line1",style:d(`color: ${e.color};`)},{default:n(()=>[f(b(t.$t(e.title)),1)]),_:1},8,["style"])],!0)]),_:3}),c(o,{class:"right"},{default:n(()=>[i(t.$slots,"right",{},void 0,!0)]),_:3})]),_:3})]),_:3})]),_:3},8,["class","style"]),c(o,{class:"placeholder"})]),_:3})}}}),[["__scopeId","data-v-f6e30575"]]),ae=h(s({__name:"tig-tabbar",props:{backgroundColor:{type:String,default:"#fff"},color:{type:String,default:"#000"},activeColor:{type:String,default:"#ea3c2d"}},setup(e){S(e=>({"3b31d980":a.backgroundColor,bba074e4:a.color,c0958430:a.activeColor}));const t=y(),a=e;return(e,a)=>{const o=B,s=r;return g(),l(s,{class:"tabbar-box"},{default:n(()=>[c(s,{class:"tabbar-container"},{default:n(()=>[c(s,{class:"tabbar"},{default:n(()=>[(g(!0),m(_,null,k(v(t).tabbarList,(a,r)=>(g(),l(s,{key:r,class:"tabbar-item",onClick:e=>((e,a)=>{t.currentActiveValue!==a&&e.link&&I({url:T(e.link)})})(a,r)},{default:n(()=>[c(s,{class:"tabbar-icon"},{default:n(()=>[x(c(o,{class:"tabbar-icon-img",src:v(C)(a.activeImage)},null,8,["src"]),[[w,v(t).currentActiveValue===r]]),x(c(o,{class:"tabbar-icon-img",src:v(C)(a.image)},null,8,["src"]),[[w,v(t).currentActiveValue!==r]])]),_:2},1024),c(s,{class:p(["tabbar-text",{active:v(t).currentActiveValue===r}])},{default:n(()=>[f(b(e.$t(a.text)),1)]),_:2},1032,["class"])]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1}),c(s,{class:"placeholder"})]),_:1})}}}),[["__scopeId","data-v-8377a2c8"]]),oe=h(s({__name:"tig-button",props:{shape:{type:String,default:"circle"},type:{type:String,default:"primary"},color:{type:String,default:"var(--main-bg)"},text:{type:String,default:"确定"},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},plain:{type:Boolean,default:!1},loadingText:{type:String,default:""},size:{type:String,default:"normal"},customStyle:{type:Object,default:()=>({})},openType:{type:String,default:""}},emits:["click","getPhoneNumber"],setup(e,{emit:t}){const a=t,o=e=>{a("click",e)},s=e=>{a("getPhoneNumber",e)};return(t,a)=>{const c=$(z("up-button"),L);return g(),l(c,{"custom-style":e.customStyle,type:e.type,size:e.size,plain:e.plain,color:e.color,shape:e.shape,disabled:e.disabled,text:e.text,loading:e.loading,"loading-text":e.loadingText,"open-type":e.openType,onClick:o,onGetphonenumber:s},{default:n(()=>[i(t.$slots,"default",{},void 0,!0)]),_:3},8,["custom-style","type","size","plain","color","shape","disabled","text","loading","loading-text","open-type"])}}}),[["__scopeId","data-v-a9a5879c"]]),se=h(s({__name:"tig-checkbox",props:{checkedText:{type:String,default:""},checkedSize:{type:Number,default:.8},checked:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},shape:{type:String,default:"circle"},size:{type:String,default:"15"}},emits:["update:checked","change"],setup(e,{emit:t}){const a=e,o=N(),s=A(()=>o.themeStyle["--general"]||"#ee0a24"),r=t,i=()=>{a.disabled||(r("update:checked",!a.checked),r("change"))};return(t,a)=>{const o=$(z("up-checkbox"),D),r=H;return g(),l(r,{class:"check",onClick:i},{default:n(()=>[c(o,{shape:e.shape,"used-alone":!0,disabled:e.disabled,"active-color":s.value,checked:e.checked,size:e.size,onChange:i},null,8,["shape","disabled","active-color","checked","size"]),f(" "+b(e.checkedText),1)]),_:1})}}}),[["__scopeId","data-v-faa6bfc6"]]),le=h(s({__name:"tig-popup",props:{show:{type:Boolean,default:!1},showClose:{type:Boolean,default:!0},overlay:{type:Boolean,default:!0},position:{type:String,default:"bottom"},round:{type:[String,Number],default:10},backgroundColor:{type:String,default:"#fff"},customStyle:{type:Object,default:()=>({})},maskClick:{type:Boolean,default:!0},zIndex:{type:Number,default:201},height:{type:String,default:"50vh"}},emits:["update:show","change","handleShade","close"],setup(e,{emit:t}){const a=e,o=t,s=A({get:()=>a.show,set(e){o("update:show",e)}}),c=()=>{o("close"),o("update:show",!1)};return(t,a)=>{const o=$(z("up-popup"),P);return g(),l(o,{show:s.value,"onUpdate:show":a[0]||(a[0]=e=>s.value=e),"close-on-click-overlay":e.maskClick,overlay:e.overlay,mode:e.position,round:e.round,"bg-color":e.backgroundColor,"custom-style":{...e.customStyle},"z-index":e.zIndex,"safe-area-inset-top":!1,"safe-area-inset-bottom":!1,closeable:e.showClose,onClose:c},{default:n(()=>[i(t.$slots,"default",{},void 0,!0)]),_:3},8,["show","close-on-click-overlay","overlay","mode","round","bg-color","custom-style","z-index","closeable"])}}}),[["__scopeId","data-v-780a5652"]]),ne=h(s({__name:"tig-wechart-login",emits:["loginSuccess"],setup(t,{emit:o}){const{t:s}=V(),i=o,d=O(),p=a(),h=A({get:()=>!!d.authType,set(e){d.setAuthType("")}}),y=e(!1),m=e(!1),k=()=>{q({url:"/pages/login/mallAgreement"})},v=()=>{if(!y.value)return J({title:s("请先同意用户协议"),duration:1500,icon:"none"})},_=async()=>{const e=await M({url:location.origin+location.pathname});window.location.href=e.url},S=e=>{d.setAuthType(""),q({url:`/pages/login/index?loginType=${e}`})},x=()=>{d.setAuthType("")};return j(()=>{if("wechat"===p.XClientType&&!U("token")){const e=(e=>{const t={},a=e.split("?")[1];return a&&a.split("&").forEach(e=>{const[a,o]=e.split("=");t[a]=o}),t})(location.href);e.code&&e.code.length>12&&(async e=>{const t=await R({code:e});1==t.type&&(d.setToken(t.token),await d.getUserInfo(),i("loginSuccess"),d.setAuthType("")),2==t.type&&1===p.wechatRegisterBindPhone&&(W("openData",t.openData),q({url:"/pages/user/bindMobilePhone/index"}))})(e.code)}}),(e,t)=>{const a=$(z("tig-button"),oe),o=$(z("tig-checkbox"),se),s=X,i=r,d=$(z("tig-popup"),le);return g(),l(d,{show:h.value,"onUpdate:show":t[4]||(t[4]=e=>h.value=e),"z-index":1e3,onClose:x},{default:n(()=>[h.value?(g(),l(i,{key:0,class:"wechart-login-content"},{default:n(()=>[c(i,{class:"wechart-login-box"},{default:n(()=>[y.value?(g(),l(a,{key:0,"custom-style":{"border-radius":"20rpx",height:"95rpx"},shape:"square",loading:m.value,onClick:_},{default:n(()=>[f(b(e.$t("微信授权")),1)]),_:1},8,["loading"])):(g(),l(a,{key:1,"custom-style":{"border-radius":"20rpx",height:"95rpx"},shape:"square",onClick:v},{default:n(()=>[f(b(e.$t("微信授权")),1)]),_:1})),c(i,{class:"rule-text"},{default:n(()=>[c(o,{checked:y.value,"onUpdate:checked":t[0]||(t[0]=e=>y.value=e)},null,8,["checked"]),c(i,{class:"rule-xieyi"},{default:n(()=>[c(s,{onClick:t[1]||(t[1]=e=>y.value=!y.value)},{default:n(()=>[f(b(e.$t("登录即为同意")),1)]),_:1}),c(s,{class:"special-color",onClick:k},{default:n(()=>[f(b(e.$t("《商城用户服务协议》")),1)]),_:1})]),_:1})]),_:1}),c(i,{class:"other-login"},{default:n(()=>[c(i,{class:"mobile-login",onClick:t[2]||(t[2]=e=>S("mobile"))},{default:n(()=>[f(b(e.$t("手机登录")),1)]),_:1}),c(i,{class:"account-login",onClick:t[3]||(t[3]=e=>S("password"))},{default:n(()=>[f(b(e.$t("账号登录")),1)]),_:1})]),_:1})]),_:1})]),_:1})):u("",!0)]),_:1},8,["show"])}}}),[["__scopeId","data-v-a38e11af"]]),ce=s({__name:"tig-statistic-log",props:{productId:{type:[Number,String],default:""},shopId:{type:[Number,String],default:""},shopCategoryId:{type:[Number,String],default:""},immediateLog:{type:Boolean,default:!0}},setup(e,{expose:t}){const a=e,o=E({}),s=async()=>{a.productId&&(o.productId=a.productId),a.shopId&&(o.shopId=a.shopId),a.shopCategoryId&&(o.shopCategoryId=a.shopCategoryId);try{await G(o)}catch(e){console.error(e)}},l=A(()=>{const e=new Date;return`${e.getFullYear()}-${e.getMonth()+1}-${e.getDate()}`});return(()=>{const e=U("lastDate");!e||((e,t)=>{const a=new Date(e),o=new Date(t);return Math.abs(a.getTime()-o.getTime())>=864e5})(l.value,e)?(o.isNew=1,W("untranslatedCache",JSON.stringify([]))):o.click=1,W("lastDate",l.value)})(),F(()=>{a.immediateLog&&s()}),t({__commonLog:s}),(e,t)=>(g(),m("div"))}}),re=h(s({__name:"tig-layout",props:{needSafeTop:{type:Boolean,default:!1},needSafeBottom:{type:Boolean,default:!0},safeTopBgColor:{type:String,default:"#fff"},productId:{type:[Number,String],default:""},shopId:{type:[Number,String],default:""},shopCategoryId:{type:[Number,String],default:""},immediateLog:{type:Boolean,default:!0},title:{type:String,default:""},customBack:{type:Boolean,default:!1},borderBottom:{type:Boolean,default:!1},background:{type:String,default:"#fff"},color:{type:String,default:"#000"}},emits:["loginSuccess","back"],setup(t,{expose:o,emit:s}){S(e=>({"66d5dfa0":f.safeTopBgColor}));const f=t,b=s,h=y(),m=a(),k=N();Y();const _=A(()=>!0);m.setH5Title();const{safeBottom:B}=Q(),{height:C}=ee(),I=A(()=>({...k.themeStyle,"--tabbar-height":h.tabbarHeight,"--safe-bottom":`${B.value}px`,"--safe-top":`${C.value}px`,"--nav-height":`${m.navHeight}rpx`})),T=e();return o({handleLog:()=>{var e;null==(e=T.value)||e.__commonLog()},isZh:_}),(e,a)=>{const o=r,s=$(z("tig-navbar"),te),f=$(z("tig-tabbar"),ae),y=$(z("tig-wechart-login"),ne),k=$(z("tig-statistic-log"),ce);return g(),l(o,{class:p(["layout",{"not-zh":!_.value&&v(Z)()}]),style:d({...I.value})},{default:n(()=>[t.needSafeTop?(g(),l(o,{key:0,class:"safe-top-box"})):u("",!0),t.title?(g(),l(s,{key:1,title:t.title,"border-bottom":t.borderBottom,background:t.background,color:t.color,"custom-back":t.customBack,onBack:a[0]||(a[0]=e=>b("back"))},null,8,["title","border-bottom","background","color","custom-back"])):u("",!0),i(e.$slots,"default",{},void 0,!0),-1===v(h).currentActiveValue&&t.needSafeBottom?(g(),l(o,{key:2,class:"layout-safe-bottom"})):u("",!0),x(c(o,null,{default:n(()=>[c(f)]),_:1},512),[[w,v(h).currentActiveValue>-1]]),"miniProgram"!==v(m).XClientType&&"wechat"!==v(m).XClientType||1!==v(m).openWechatRegister?u("",!0):(g(),l(y,{key:3,onLoginSuccess:a[1]||(a[1]=t=>e.$emit("loginSuccess"))})),c(k,{ref_key:"statisticLogRef",ref:T,"immediate-log":t.immediateLog,"product-id":t.productId,"shop-id":t.shopId,"shop-category-id":t.shopCategoryId},null,8,["immediate-log","product-id","shop-id","shop-category-id"])]),_:3},8,["class","style"])}}}),[["__scopeId","data-v-5afb389b"]]);export{re as _,oe as a,Q as b,le as c,te as d,se as e,ee as f,K as u};
