import{d as e,K as a,l as t,r as l,s,am as u,m as r,an as f,Q as c,k as n,c as i,w as o,i as d,B as _,E as p,o as m,g as v,I as g,a as b,J as y,f as h,t as $,O as k,ae as I,a1 as x,n as S,_ as j}from"./index-BcyAKDDV.js";import{_ as C}from"./uni-steps.OJZXb1De.js";import{_ as w}from"./uni-icons.CtiPjGAO.js";import{_ as N}from"./tig-image.lWnA30Ud.js";import{_ as B}from"./format-price.csRf0ax_.js";import{a as z,_ as O}from"./tig-layout.DHsvU4xy.js";import{_ as T}from"./tig-fixed-placeholder.BvTFztLB.js";import{b as A,d as E}from"./afterSale.CdY0LO5g.js";const q=j(e({__name:"info",setup(e){const{t:j}=a();t(e=>{e&&e.id&&(q.value=Number(e.id),F())}),s(()=>{u("refreshInfo",e=>{q.value=e,F()})}),r(()=>{f("refreshInfo")});const q=l(),G=l({}),W=l(0),F=async()=>{try{const e=await A(q.value);G.value=e,G.value.aftersalesItems.forEach(e=>{W.value+=e.number})}catch(e){console.error(e),c({title:e.message,icon:"none"})}},J=()=>{I({title:j("提示"),content:j("确认要撤销申请吗？"),success:async e=>{if(e.confirm)try{await E({aftersaleId:G.value.aftersaleId});c({title:j("撤销成功")}),x({url:"/pages/user/afterSale/list"})}catch(a){console.error(a)}}})},K=async()=>{try{1===G.value.aftersalesItems.length?x({url:`/pages/user/afterSale/edit?aftersaleId=${G.value.aftersaleId}&itemId=${G.value.aftersalesItems[0].orderItemId}`}):x({url:`/pages/user/afterSale/edit?aftersaleId=${G.value.aftersaleId}`})}catch(e){console.error(e)}},Q=l(!0),R=n(()=>G.value.returnGoodsTip&&Q.value),D=()=>{S({url:"/pages/user/afterSale/negotiate?id="+G.value.aftersaleId})},H=()=>{S({url:`/pages/user/afterSale/shipments?id=${G.value.aftersaleId}&returnAddress=${G.value.returnAddress}`})};return(e,a)=>{const t=d,l=_(p("uni-steps"),C),s=_(p("uni-icons"),w),u=_(p("tig-image"),N),r=_(p("format-price"),B),f=_(p("tig-button"),z),c=_(p("tig-fixed-placeholder"),T),n=_(p("tig-layout"),O);return m(),i(t,{class:"after-sale-info"},{default:o(()=>[v(n,{"need-safe-top":!0},{default:o(()=>[Object.keys(G.value).length?(m(),g(y,{key:0},[R.value?(m(),i(t,{key:0,class:"returngoodstip-box"},{default:o(()=>[v(t,{class:"returngoodstip-bg"}),v(t,{class:"returngoodstip-content"},{default:o(()=>[v(t,{class:"iconfont-h5 icon-tongzhi"}),v(t,{class:"returngoodstip-text line1"},{default:o(()=>[h($(G.value.returnGoodsTip),1)]),_:1}),v(t,{class:"iconfont-h5 icon-chacha",onClick:a[0]||(a[0]=e=>Q.value=!1)})]),_:1})]),_:1})):b("",!0),v(t,{class:"after-sal-info-steps"},{default:o(()=>[v(l,{"active-color":"var(--general)",options:G.value.stepStatus.steps,active:G.value.stepStatus.current},null,8,["options","active"])]),_:1}),3===G.value.status?(m(),i(t,{key:1,class:"refuse-reply"},{default:o(()=>[v(t,{class:"refuse-reply-title"},{default:o(()=>[h($(e.$t("拒绝原因"))+": ",1)]),_:1}),v(t,{class:"refuse-reply-content line1"},{default:o(()=>[h($(G.value.reply),1)]),_:1})]),_:1})):b("",!0),v(t,{class:"negotiate",onClick:D},{default:o(()=>[v(t,{class:"negotiate-text"},{default:o(()=>[h($(e.$t("查看协商记录")),1)]),_:1}),v(t,{class:"negotiate-icon"},{default:o(()=>[v(s,{type:"right",size:"20",color:"#999"})]),_:1})]),_:1}),4===G.value.status?(m(),i(t,{key:2,class:"negotiate",onClick:H},{default:o(()=>[v(t,{class:"negotiate-text"},{default:o(()=>[h($(e.$t("去发货")),1)]),_:1}),v(t,{class:"negotiate-icon"},{default:o(()=>[v(s,{type:"right",size:"20",color:"#999"})]),_:1})]),_:1})):b("",!0),v(t,{class:"info-content"},{default:o(()=>[v(t,{class:"info-content-title"},{default:o(()=>[h($(e.$t("售后信息")),1)]),_:1}),v(t,{class:"info-content-product"},{default:o(()=>[(m(!0),g(y,null,k(G.value.aftersalesItems,e=>(m(),i(t,{key:e.aftersalesItemId,class:"info-content-product-item",onClick:a=>{return t=e.productId,void S({url:`/pages/product/index?id=${t}`});var t}},{default:o(()=>[v(t,{class:"product-item-left"},{default:o(()=>[v(u,{src:e.picThumb},null,8,["src"])]),_:2},1024),v(t,{class:"product-item-right"},{default:o(()=>[v(t,{class:"product-item-name line2"},{default:o(()=>[h($(e.productName),1)]),_:2},1024),v(t,{class:"right-price"},{default:o(()=>[v(r,{"show-text":!1,"decimals-style":{fontSize:"23rpx",fontWeight:"bold"},"currency-style":{fontSize:"21rpx",fontWeight:"bold"},class:"right-price-pricenum","price-data":e.price},null,8,["price-data"]),v(t,{class:"right-price-quantity"},{default:o(()=>[h("x "+$(e.number),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1}),v(t,{class:"refund-info"},{default:o(()=>[Number(G.value.refundAmount)>0?(m(),i(t,{key:0,class:"refund-info-item"},{default:o(()=>[v(t,{class:"label"},{default:o(()=>[h($(e.$t("退款金额"))+"：",1)]),_:1}),v(t,{class:"value price"},{default:o(()=>[v(r,{"show-text":!1,"is-bottom":!1,"price-data":G.value.refundAmount},null,8,["price-data"])]),_:1})]),_:1})):b("",!0),v(t,{class:"refund-info-item"},{default:o(()=>[v(t,{class:"label"},{default:o(()=>[h($(e.$t("售后方式"))+"：",1)]),_:1}),v(t,{class:"value"},{default:o(()=>[h($(G.value.aftersalesTypeName),1)]),_:1})]),_:1}),v(t,{class:"refund-info-item"},{default:o(()=>[v(t,{class:"label"},{default:o(()=>[h($(e.$t("退款原因"))+"：",1)]),_:1}),v(t,{class:"value"},{default:o(()=>[h($(G.value.aftersaleReason),1)]),_:1})]),_:1})]),_:1}),v(t,{class:"after-sale"},{default:o(()=>[v(t,{class:"after-sale-item"},{default:o(()=>[v(t,{class:"label"},{default:o(()=>[h($(e.$t("售后编号"))+"：",1)]),_:1}),v(t,{class:"value"},{default:o(()=>[h($(G.value.aftersalesSn),1)]),_:1})]),_:1}),v(t,{class:"after-sale-item"},{default:o(()=>[v(t,{class:"label"},{default:o(()=>[h($(e.$t("申请时间"))+"：",1)]),_:1}),v(t,{class:"value"},{default:o(()=>[h($(G.value.addTime),1)]),_:1})]),_:1}),v(t,{class:"after-sale-item"},{default:o(()=>[v(t,{class:"label"},{default:o(()=>[h($(e.$t("退货数量"))+"：",1)]),_:1}),v(t,{class:"value"},{default:o(()=>[h($(W.value),1)]),_:1})]),_:1})]),_:1})]),_:1}),G.value.logisticsName&&G.value.trackingNo?(m(),i(t,{key:3,class:"info-content"},{default:o(()=>[v(t,{class:"info-content-title"},{default:o(()=>[h($(e.$t("退货信息")),1)]),_:1}),v(t,{class:"after-sale"},{default:o(()=>[v(t,{class:"after-sale-item"},{default:o(()=>[v(t,{class:"label"},{default:o(()=>[h($(e.$t("快递公司"))+"：",1)]),_:1}),v(t,{class:"value"},{default:o(()=>[h($(G.value.logisticsName),1)]),_:1})]),_:1}),v(t,{class:"after-sale-item"},{default:o(()=>[v(t,{class:"label"},{default:o(()=>[h($(e.$t("快递单号"))+"：",1)]),_:1}),v(t,{class:"value"},{default:o(()=>[h($(G.value.trackingNo),1)]),_:1})]),_:1})]),_:1})]),_:1})):b("",!0),G.value.refund?(m(),i(t,{key:4,class:"info-content"},{default:o(()=>[v(t,{class:"info-content-title"},{default:o(()=>[h($(e.$t("退款进度")),1)]),_:1}),v(t,{class:"after-sale"},{default:o(()=>[G.value.refund.onlineBalance>0?(m(),i(t,{key:0,class:"after-sale-item"},{default:o(()=>[v(t,{class:"label"},{default:o(()=>[h($(e.$t("线上退款"))+"：",1)]),_:1}),v(t,{class:"value"},{default:o(()=>[v(r,{"show-text":!1,"is-bottom":!1,"price-data":G.value.refund.onlineBalance},null,8,["price-data"])]),_:1}),v(t,{class:"after-sale-status"},{default:o(()=>[h($(2===G.value.refund.isOnline?e.$t("退款成功"):e.$t("退款中")),1)]),_:1})]),_:1})):b("",!0),G.value.refund.offlineBalance>0?(m(),i(t,{key:1,class:"after-sale-item"},{default:o(()=>[v(t,{class:"label"},{default:o(()=>[h($(e.$t("线下退款"))+"：",1)]),_:1}),v(t,{class:"value"},{default:o(()=>[v(r,{"show-text":!1,"is-bottom":!1,"price-data":G.value.refund.offlineBalance},null,8,["price-data"])]),_:1}),v(t,{class:"after-sale-status"},{default:o(()=>[h($(2===G.value.refund.isOnline?e.$t("退款成功"):e.$t("退款中")),1)]),_:1})]),_:1})):b("",!0),G.value.refund.refundBalance>0?(m(),i(t,{key:2,class:"after-sale-item"},{default:o(()=>[v(t,{class:"label"},{default:o(()=>[h($(e.$t("余额退款"))+"：",1)]),_:1}),v(t,{class:"value"},{default:o(()=>[v(r,{"show-text":!1,"is-bottom":!1,"price-data":G.value.refund.refundBalance},null,8,["price-data"])]),_:1}),v(t,{class:"after-sale-status"},{default:o(()=>[h($(2===G.value.refund.isOnline?e.$t("退款成功"):e.$t("退款中")),1)]),_:1})]),_:1})):b("",!0)]),_:1})]),_:1})):b("",!0),G.value.canCancel?(m(),i(c,{key:5,height:"100rpx","background-color":"#fff"},{default:o(()=>[v(t,{class:"after-sale-btn"},{default:o(()=>[v(t,{class:"after-sale-btn-box"},{default:o(()=>[v(f,{class:"btn",plain:!0,onClick:J},{default:o(()=>[h($(e.$t("撤销申请")),1)]),_:1}),v(f,{plain:!0,class:"btn",onClick:K},{default:o(()=>[h($(e.$t("修改申请")),1)]),_:1})]),_:1})]),_:1})]),_:1})):b("",!0)],64)):b("",!0)]),_:1})]),_:1})}}}),[["__scopeId","data-v-d9d8353f"]]);export{q as default};
