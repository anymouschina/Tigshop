import{d as e,K as a,r as l,W as o,s as r,ah as s,l as t,I as n,g as i,w as u,J as d,B as m,E as c,as as p,o as f,i as g,f as b,t as h,Q as v,ar as _,at as V,_ as y}from"./index-BcyAKDDV.js";import{_ as $}from"./uni-easyinput.CZPFNYUF.js";import{_ as j,a as w}from"./uni-forms.B4IbPQ2n.js";import{_ as N,a as U}from"./tig-layout.DHsvU4xy.js";import{_ as q}from"./tig-fixed-placeholder.BvTFztLB.js";import{s as x}from"./selectRegion.BZhvLtv7.js";import{a as I,b as D,u as R}from"./address.DDZ6LhC1.js";import"./uni-icons.CtiPjGAO.js";const k=y(e({__name:"editRegion",setup(e){const{t:y}=a(),k=l("添加地址"),M=l(null),F=o({consignee:"",regionIds:[],address:"",mobile:"",telephone:"",email:"",regionNames:"",isDefault:0}),C=l(!1),T={consignee:{rules:[{required:!0,errorMessage:y("请您填写收货人姓名")}]},regionNames:{rules:[{required:!0,errorMessage:y("请选择所在地区")},{validateFunction:function(e,a,l,o){return F.regionIds.length<1&&o(y("请选择所在地区")),!0}}]},address:{rules:[{required:!0,errorMessage:y("请您填写详细收货地址")}]},mobile:{rules:[{required:!0,errorMessage:y("请您填写收货人手机号码")},{validateFunction:function(e,a,l,o){/^(?:(?:\+|00)86)?1[3-9]\d{9}$/.test(a)||o(y("请输入正确的手机号码"));return!0}}]}};r(()=>{s(()=>{O.value.setRules(T)})}),t(e=>{e&&e.id&&(k.value="编辑地址",M.value=e.id,W())});const W=async()=>{try{const e=await I({id:M.value}),{regionNames:a}=e;Object.assign(F,e),F.regionNames=a.join(" "),C.value=1===F.isDefault}catch(e){console.error(e)}},B=e=>{F.regionNames=e.join(" ")},E=l(!1),J=()=>{E.value=!0},K=l(!1),O=l(),Q=()=>{O.value.validate().then(()=>{F.isDefault=C.value?1:0,M.value?X():S()}).catch(e=>{console.log("表单错误信息：",e)})},S=async()=>{K.value=!0;try{await D(F),v({title:y("添加地址成功"),icon:"none",duration:1e3}),setTimeout(()=>{_({success:function(e){V("refreshData"),K.value=!1}})},1e3)}catch(e){console.error(e),v({title:e.message,icon:"none",duration:1e3}),K.value=!1}},X=async()=>{K.value=!0;try{await R({id:M.value,...F}),v({title:y("编辑地址成功"),icon:"none",duration:1e3}),setTimeout(()=>{_({success:function(e){V("refreshData"),K.value=!1}})},1e3)}catch(e){console.error(e),v({title:e.message,icon:"none",duration:1e3})}};return(e,a)=>{const l=m(c("uni-easyinput"),$),o=m(c("uni-forms-item"),j),r=g,s=m(c("u-switch"),p),t=m(c("uni-forms"),w),v=m(c("tig-button"),U),_=m(c("tig-fixed-placeholder"),q),V=m(c("tig-layout"),N);return f(),n(d,null,[i(V,{title:k.value},{default:u(()=>[i(r,{class:"address-edit-main"},{default:u(()=>[i(r,{class:"address-edit-content"},{default:u(()=>[i(t,{ref_key:"formRef",ref:O,"model-value":F,"label-width":"165rpx"},{default:u(()=>[i(o,{label:e.$t("收货人："),name:"consignee",required:""},{default:u(()=>[i(l,{modelValue:F.consignee,"onUpdate:modelValue":a[0]||(a[0]=e=>F.consignee=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入姓名")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),i(o,{label:e.$t("所在地区："),name:"regionNames",required:""},{default:u(()=>[i(r,{class:"region-input",onClick:J},{default:u(()=>[i(l,{modelValue:F.regionNames,"onUpdate:modelValue":a[1]||(a[1]=e=>F.regionNames=e),"suffix-icon":"right","primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("点击选择所在地区"),readonly:"",class:"no-pointer"},null,8,["modelValue","placeholder"])]),_:1})]),_:1},8,["label"]),i(o,{label:e.$t("详细地址："),name:"address",required:""},{default:u(()=>[i(l,{modelValue:F.address,"onUpdate:modelValue":a[2]||(a[2]=e=>F.address=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请您填写详细收货地址")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),i(o,{label:e.$t("手机号码："),name:"mobile",required:""},{default:u(()=>[i(l,{modelValue:F.mobile,"onUpdate:modelValue":a[3]||(a[3]=e=>F.mobile=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入手机号码")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),i(o,{label:e.$t("固定电话："),name:"telephone"},{default:u(()=>[i(l,{modelValue:F.telephone,"onUpdate:modelValue":a[4]||(a[4]=e=>F.telephone=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入固定电话")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),i(o,{label:e.$t("邮箱地址："),name:"email"},{default:u(()=>[i(l,{modelValue:F.email,"onUpdate:modelValue":a[5]||(a[5]=e=>F.email=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入邮箱地址")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),i(o,{label:e.$t("默认地址"),name:"email"},{default:u(()=>[i(r,{class:"switch"},{default:u(()=>[i(s,{modelValue:C.value,"onUpdate:modelValue":a[6]||(a[6]=e=>C.value=e),"active-color":"var(--general)"},null,8,["modelValue"])]),_:1})]),_:1},8,["label"])]),_:1},8,["model-value"])]),_:1})]),_:1}),i(_,{"background-color":"#fff"},{default:u(()=>[i(r,{class:"btn-box"},{default:u(()=>[i(v,{loading:K.value,onClick:Q},{default:u(()=>[b(h(e.$t("提交")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["title"]),i(x,{show:E.value,"onUpdate:show":a[7]||(a[7]=e=>E.value=e),modelValue:F.regionIds,"onUpdate:modelValue":a[8]||(a[8]=e=>F.regionIds=e),onSendRegionNames:B},null,8,["show","modelValue"])],64)}}}),[["__scopeId","data-v-6d326727"]]);export{k as default};
