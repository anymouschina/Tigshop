import{d as e,r as a,c as l,a as t,i as o,w as s,o as r,b as u,e as d,f as i,t as n,n as c,u as p,_ as v,g as m,h as y,j as g,k as _,l as f,m as k,p as b,q as x,s as j,v as I,x as h,y as w,z as T,A as C,B as U,C as M,D as $,E as L,F as z,G as F,H as E,I as G,J as A}from"./index-BcyAKDDV.js";import{_ as B}from"./tig-back-top.vue_vue_type_script_setup_true_lang.Bi73mTCV.js";import{u as D,_ as H}from"./tig-layout.DHsvU4xy.js";import{g as J,a as S,b as q}from"./home.CJJfsVI7.js";import{u as K,m as R}from"./index.QNyxc9Gs.js";import{m as V}from"./masonry.DMVeXjyb.js";import"./tig-image.lWnA30Ud.js";import"./index.me9OfWvf.js";import"./format-price.csRf0ax_.js";import"./tig-fixed-placeholder.BvTFztLB.js";import"./tig-countdown.vue_vue_type_script_setup_true_lang.BLkMpcmg.js";import"./specification.BVK5lHIl.js";import"./uni-icons.CtiPjGAO.js";import"./uni-number-box.D3RxEDC7.js";import"./product.Dt_JmfR-.js";import"./activityCard.DFNvABJe.js";const W=v(e({__name:"index",props:{adType:{},adUrl:{},duration:{},redirectType:{},redirectUrl:{}},emits:["close"],setup(e,{emit:v}){const m=e,y=a(!0),g=a(!1),_=a(m.duration||3);let f=null;const k=v,b=()=>{y.value=!1,clearInterval(f),k("close")},x=()=>{console.log("123132132"),"1"==m.redirectType&&(c({url:p(m.redirectUrl||"")}),clearInterval(f),k("close"))},j=()=>{g.value=!0,f=setInterval(()=>{_.value--,_.value<=0&&b()},1e3)};return(e,a)=>{const c=u,p=d,v=o;return y.value?(r(),l(v,{key:0,class:"splash-ad"},{default:s(()=>["image"===e.adType?(r(),l(c,{key:0,src:e.adUrl,class:"ad-img",mode:"aspectFill",onLoad:j,onClick:x},null,8,["src"])):"video"===e.adType?(r(),l(p,{key:1,src:e.adUrl,class:"ad-video",autoplay:!0,controls:!1,muted:!0,loop:!0,onEnded:b,onLoadedmetadata:j,onClick:x},null,8,["src"])):t("",!0),g.value?(r(),l(v,{key:2,class:"close-btn",onClick:b},{default:s(()=>[i(n(_.value)+" 跳过",1)]),_:1})):t("",!0)]),_:1})):t("",!0)}}}),[["__scopeId","data-v-1c26dfdf"]]);const N=v({},[["render",function(e,a){const t=y,u=o;return r(),l(u,null,{default:s(()=>[m(u,{class:"preview-box"},{default:s(()=>[m(u,null,{default:s(()=>[i(n(e.$t("预览"))+"：  ",1),m(t,null,{default:s(()=>[i(n(e.$t("移动端")),1)]),_:1})]),_:1})]),_:1}),m(u,{class:"placeholder"})]),_:1})}],["__scopeId","data-v-7a64340e"]]),O=v(e({__name:"index",setup(e){const{scrollTop:d}=D(M),i=g(),n=a("image"),c=a(""),p=a(0),v=a(!1),y=a(""),O=a(""),P=a(0),Q=a(!1),X=a([]),Y=a({}),Z=a(0),ee=a(1),ae=a(!1),le=a(!0),te=a([]),oe=_(()=>{var e,a,l,t;return{"background-color":`${null==(e=i.pageModules)?void 0:e.backgroundColor}`,"background-image":`url("${null==(a=i.pageModules.backgroundImage)?void 0:a.picUrl}")`,"background-size":`${se(null==(l=i.pageModules)?void 0:l.backgroundSize)}`,"background-repeat":`${re(null==(t=null==i?void 0:i.pageModules)?void 0:t.backgroundRepeat)}`}}),se=e=>({1:"100% auto",2:"auto 100%",3:"100% 100%"}[e]),re=e=>({1:"no-repeat",2:"repeat",3:"repeat-x",4:"repeat-y"}[e]),ue=e=>{Z.value=e,0!==Z.value&&(ee.value=1,ae.value=!1,te.value=[],de())},de=async()=>{le.value=!0;try{const e=await J({categoryId:Z.value,page:ee.value});e.records&&e.records.length>0?(te.value=[...te.value,...e.records],ae.value=!1):ae.value=!0}catch(e){console.error(e)}finally{le.value=!1}},ie=async()=>{Q.value=!0;try{const e=await S();X.value=e.moduleList,Y.value=e.pageModule,i.pageModules=e.pageModule,P.value=1,C()}catch(e){console.error(e)}finally{Q.value=!1}},ne=()=>{v.value=!1};f(async e=>{e&&e.previewId&&(i.previewId=e.previewId),ce.reset(),await(async()=>{try{const e=await q();if(!e)return;v.value=1==e.state,n.value=0==e.materialType?"image":"video",c.value=0==e.materialType?e.materialImg:e.materialVideo[0].videoUrl,y.value=String(e.redirectType),O.value=e.redirectUrl,p.value=e.maxWaitTime}catch(e){console.error("获取开屏广告失败:",e)}})(),ie()}),k(()=>{ce.reset()});const ce=K();return b(()=>{Z.value=0,ce.reset(),ie()}),x(()=>{Z.value>0&&!Q.value&&!ae.value&&(ee.value++,de())}),j(()=>{d.value>0&&setTimeout(()=>{I({scrollTop:d.value,duration:0})},20),h()}),w(e=>({title:i.baseInfo.shopTitle})),T(()=>({title:i.baseInfo.shopTitle})),(e,a)=>{const g=u,_=o,f=U(L("up-empty"),$),k=U(L("tig-back-top"),B),b=U(L("tig-layout"),H);return v.value?(r(),l(W,{key:0,"ad-type":n.value,"ad-url":c.value,duration:p.value,"redirect-type":y.value,"redirect-url":O.value,onClose:ne},null,8,["ad-type","ad-url","duration","redirect-type","redirect-url"])):(r(),l(b,{key:1},{default:s(()=>[z(i).previewId>0?(r(),l(N,{key:0})):t("",!0),Q.value?(r(),l(_,{key:1,class:"index_empty"},{default:s(()=>[m(g,{"lazy-load":"",src:z(F)("common/index_empty.png"),mode:"widthFix"},null,8,["src"])]),_:1})):(r(),l(_,{key:2,class:"index"},{default:s(()=>[m(_,{class:"decorate-page-window",style:E({...oe.value})},{default:s(()=>[m(R,{modules:X.value,"page-modles":Y.value,"scroll-top":z(d),onLoadGoodsList:ue},null,8,["modules","page-modles","scroll-top"]),Z.value>0&&te.value.length>0?(r(),G(A,{key:0},[m(V,{"commodity-list":te.value},null,8,["commodity-list"]),le.value||0!==te.value.length?t("",!0):(r(),l(_,{key:0,class:"empty-box"},{default:s(()=>[m(f,{icon:z(F)("salesman/no_order.png"),text:e.$t("暂无数据")},null,8,["icon","text"])]),_:1}))],64)):t("",!0)]),_:1},8,["style"])]),_:1})),m(k,{"scroll-top":z(d)},null,8,["scroll-top"])]),_:1}))}}}),[["__scopeId","data-v-6fef471b"]]);export{O as default};
