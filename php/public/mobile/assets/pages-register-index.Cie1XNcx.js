import{a2 as e,d as a,j as l,r as o,K as t,k as s,a6 as i,s as r,L as d,ag as u,ah as n,c as p,w as c,B as m,E as b,o as f,g as h,i as v,f as g,t as y,a as _,F as k,I as x,J as C,ai as V,aj as $,h as w,N as U,Q as j,a1 as z,n as T,_ as M}from"./index-BcyAKDDV.js";import{_ as q}from"./uni-easyinput.CZPFNYUF.js";import{_ as A,a as I}from"./uni-forms.B4IbPQ2n.js";import{_ as R}from"./tig-mobile-areacode.CTYLrvaX.js";import{_ as S,e as E,a as F}from"./tig-layout.DHsvU4xy.js";import{V as D}from"./index.Bk5EsjlE.js";import{u as O}from"./useResetState.IfkyeeAd.js";import"./uni-icons.CtiPjGAO.js";const Z=M(a({__name:"index",setup(a){const M=l(),Z=o("86"),[W,B]=O({mobile:"",mobileCode:"",password:"",registType:"",email:"",emailCode:""}),{t:J}=t(),K=o(!1),L=o(""),N=o(!1),Q=s(()=>"email"===W.value.registType?!(W.value.email&&W.value.emailCode&&W.value.password&&L.value):!(W.value.mobile&&W.value.mobileCode&&W.value.password&&L.value)),X={mobile:{rules:[{required:!0,errorMessage:J("请输入手机号")},{validateFunction:(e,a,l,o)=>a?/^(?=.*\D).+$/.test(a)?o(J("格式错误，请输入正确的手机号码")):void o():o(J("手机号不能为空"))}]},mobileCode:{rules:[{required:!0,errorMessage:J("请输入验证码")},{validateFunction:(e,a,l,o)=>a?6!=a.length?o(J("请输入6位验证码")):void o():o(J("验证码不能为空"))}]},password:{rules:[{required:!0,errorMessage:J("请输入密码")},{validateFunction:(e,a,l,o)=>a?a.length>20||a.length<6?o(J("密码应为6-20位字符")):/\s/.test(a)?o(J("密码中不允许有空格")):/^\d+$/.test(a)?o(J("密码不能全为数字")):/^(?=.*[\d\W]).+$/.test(a)?/^(?=.*[a-zA-Z0-9]).+$/.test(a)?/^(?!([a-zA-Z0-9])\1*$).+$/.test(a)?void o():o(J("密码不能全为相同字符或数字")):o(J("密码不能全为符号")):o(J("密码不能全为字母")):o(J("密码不能为空"))}]}},Y=i(),G=async()=>{Y.value.validate().then(async()=>{try{N.value=!0;const a=d("bindSalesmanId"),l={...W.value};a&&(l.salesmanId=a),W.value.mobile&&(l.mobile=M.isOpenMobileAreaCode?Z.value+W.value.mobile:W.value.mobile),await(a=>e({url:"user/regist/registAct",method:"post",data:a}))(l),j({title:J("注册成功"),duration:1500,icon:"none"}),setTimeout(()=>{z({url:"/pages/login/index"})},1e3)}catch(a){W.value.emailCode="",W.value.mobileCode="",j({title:a.message,duration:1500,icon:"none"})}finally{N.value=!1}}).catch(e=>{console.error("表单错误信息：",e)})};r(()=>{d("token")&&u({url:"/pages/index/index"}),n(()=>{Y.value.setRules(X)})});const H=e=>{j({title:e,duration:1500,icon:"none"})},P=e=>{T({url:e})};return(e,a)=>{const l=v,o=m(b("uni-easyinput"),q),t=m(b("uni-forms-item"),A),s=m(b("tig-mobile-areacode"),R),i=m(b("tig-checkbox"),E),r=w,d=m(b("uni-forms"),I),u=m(b("tig-button"),F),n=m(b("tig-layout"),S);return f(),p(n,{title:"注册"},{default:c(()=>[h(l,{class:"register-container"},{default:c(()=>[h(l,{class:"register-warp"},{default:c(()=>[h(l,{class:"h1_tit"},{default:c(()=>[g(y(e.$t("会员注册")),1)]),_:1})]),_:1}),h(l,{class:"profile-edit-content"},{default:c(()=>[h(d,{ref_key:"formRef",ref:Y,"model-value":k(W),rules:X,"label-align":"right"},{default:c(()=>["email"===k(W).registType?(f(),x(C,{key:0},[h(t,{label:"",name:"email"},{default:c(()=>[h(l,{class:"input mobileareacode-box"},{default:c(()=>[h(o,{modelValue:k(W).email,"onUpdate:modelValue":a[0]||(a[0]=e=>k(W).email=e),"input-border":!1,focus:"",class:"uni-input item-input","placeholder-style":"font-size: 28rpx;","placeholder-class":"placeholder",placeholder:e.$t("请输入邮箱"),"primary-color":"rgb(192, 196, 204)"},null,8,["modelValue","placeholder"])]),_:1})]),_:1}),h(t,{label:"",name:"emailCode"},{default:c(()=>[h(l,{class:"item-one"},{default:c(()=>[h(o,{modelValue:k(W).emailCode,"onUpdate:modelValue":a[1]||(a[1]=e=>k(W).emailCode=e),"input-border":!1,class:"uni-input item-input input","placeholder-style":"font-size: 28rpx;","placeholder-class":"placeholder",placeholder:e.$t("邮箱验证码"),"primary-color":"rgb(192, 196, 204)",style:{width:"400rpx"}},null,8,["modelValue","placeholder"]),h(D,{"is-checked":K.value,"onUpdate:isChecked":a[2]||(a[2]=e=>K.value=e),"verify-token-data":L.value,"onUpdate:verifyTokenData":a[3]||(a[3]=e=>L.value=e),style:{height:"65rpx"},email:k(W).email,"request-api":k(V),onMobileErrorCallback:H},null,8,["is-checked","verify-token-data","email","request-api"])]),_:1})]),_:1})],64)):(f(),x(C,{key:1},[h(t,{label:"",name:"mobile"},{default:c(()=>[h(l,{class:"input mobileareacode-box"},{default:c(()=>[k(M).isOpenMobileAreaCode?(f(),p(s,{key:0,modelValue:Z.value,"onUpdate:modelValue":a[4]||(a[4]=e=>Z.value=e),"label-style":{fontSize:"28rpx"},"name-style":{fontSize:"24rpx",padding:"0 2rpx 0 10rpx"},"box-style":{paddingRight:"0"},"icon-style":{fontSize:"22rpx"}},null,8,["modelValue"])):_("",!0),h(o,{modelValue:k(W).mobile,"onUpdate:modelValue":a[5]||(a[5]=e=>k(W).mobile=e),"input-border":!1,class:"uni-input item-input",focus:"","placeholder-style":"font-size: 28rpx;","placeholder-class":"placeholder",placeholder:e.$t("请输入手机号"),"primary-color":"rgb(192, 196, 204)"},null,8,["modelValue","placeholder"])]),_:1})]),_:1}),h(t,{label:"",name:"mobileCode"},{default:c(()=>[h(l,{class:"item-one"},{default:c(()=>[h(o,{modelValue:k(W).mobileCode,"onUpdate:modelValue":a[6]||(a[6]=e=>k(W).mobileCode=e),"input-border":!1,class:"uni-input item-input input","placeholder-style":"font-size: 28rpx;","placeholder-class":"placeholder",placeholder:e.$t("手机验证码"),"primary-color":"rgb(192, 196, 204)",style:{width:"400rpx"}},null,8,["modelValue","placeholder"]),h(D,{"is-checked":K.value,"onUpdate:isChecked":a[7]||(a[7]=e=>K.value=e),"verify-token-data":L.value,"onUpdate:verifyTokenData":a[8]||(a[8]=e=>L.value=e),style:{height:"65rpx"},mobile:k(M).isOpenMobileAreaCode?Z.value+k(W).mobile:k(W).mobile,"request-api":k($),onMobileErrorCallback:H},null,8,["is-checked","verify-token-data","mobile","request-api"])]),_:1})]),_:1})],64)),h(t,{label:"",name:"password"},{default:c(()=>[h(l,{class:"input"},{default:c(()=>[h(o,{modelValue:k(W).password,"onUpdate:modelValue":a[9]||(a[9]=e=>k(W).password=e),clearable:!1,"input-border":!1,trim:!0,type:"password",class:"uni-input item-input","placeholder-style":"font-size: 28rpx;","placeholder-class":"placeholder",placeholder:e.$t("请输入密码"),"primary-color":"rgb(192, 196, 204)"},null,8,["modelValue","placeholder"])]),_:1})]),_:1}),h(t,{label:"",name:""},{default:c(()=>[h(l,{class:"btn"},{default:c(()=>[h(l,{class:"agreement-btn"},{default:c(()=>[h(i,{checked:K.value,"onUpdate:checked":a[10]||(a[10]=e=>K.value=e)},null,8,["checked"]),h(r,{class:"agreement-text special-color",onClick:a[11]||(a[11]=U(e=>P("/pages/register/agreement"),["stop"]))},{default:c(()=>[g(y(e.$t("《注册协议》")),1)]),_:1})]),_:1}),h(l,{class:"lf-input",onClick:a[12]||(a[12]=U(e=>P("/pages/login/index"),["stop"]))},{default:c(()=>[h(l,null,{default:c(()=>[g(y(e.$t("已有账号？")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"]),h(l,{class:"form-con"},{default:c(()=>[h(u,{disabled:Q.value,loading:N.value,class:"btn2-css3",onClick:G},{default:c(()=>[g(y(e.$t("注 册")),1)]),_:1},8,["disabled","loading"])]),_:1}),1===k(M).openEmailRegister?(f(),p(l,{key:0,class:"change-btn",onClick:a[13]||(a[13]=e=>{return a="email"===k(W).registType?"mobile":"email",B(),void(W.value.registType=a);var a})},{default:c(()=>[g(y("email"===k(W).registType?e.$t("切换为手机号注册"):e.$t("切换为邮箱注册")),1)]),_:1})):_("",!0)]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-742fee16"]]);export{Z as default};
