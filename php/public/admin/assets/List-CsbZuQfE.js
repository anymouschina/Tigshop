/* empty css             */import"./index-DVG44k_-.js";import{_ as B}from"./Switch.vue_vue_type_script_setup_true_lang-4ZoJqbbn.js";import{D as M}from"./DeleteRecord-C4_57oHW.js";/* empty css                                                                    */import{P as le}from"./Pagination-4FaohhlG.js";import{i as de}from"./format-C8RAoEAk.js";import{d as ie,a as pe,v as ce,r as _,ak as $,Q as ue,o as _e,J as O,e as d,f as v,g as c,h as n,y as a,l as o,j as S,k as f,K as y,i as r,t as I,F as me}from"./index-BEWhCL1q.js";import{P as V}from"./PopSelect.vue_vue_type_style_index_0_scoped_5832cf6b_lang-B9ASxJaT.js";import{g as z,u as b,d as E,b as ge}from"./category-Bu2fUBIU.js";import{u as fe}from"./category-JkcBf76e.js";import{b as ye}from"./version-C520_GUm.js";import{_ as U}from"./DialogForm.vue_vue_type_script_setup_true_lang-CQB-6Tki.js";import"./index-BNk7xZkD.js";const ve=["href"],he={class:"container"},ke={class:"content_wrapper"},Ie={class:"lyecs-table-list-warp"},be={class:"list-table-tool lyecs-search-warp"},Ce={class:"list-table-tool-row"},xe={class:"list-table-tool-col"},qe={key:2},Ae={class:"table-container"},Se={style:{position:"relative"}},ze=["onClick"],Ue={key:1},De={key:0},Ne={class:"empty-warp"},we={key:0,class:"empty-bg"},Oe={key:0,class:"pagination-con"},Ge=ie({__name:"List",setup(Ve){const H=fe(),{currentRoute:L}=pe(),F=ce(),j=_(F.icoDefinedCss),P=_([]),C=_(!0),x=_(0),h=_([]),J=_([]),i=$({page:1,size:F.get("pageSize"),sortField:"",sortOrder:"",keyword:"",isShow:-1,parentId:0}),q=_([0]);_();const K=ue(),k=$({});_e(()=>{const s=L.value.query;s.id>0&&(i.parentId=s.id),K.meta.title="",u()});const u=async()=>{C.value=!0;try{const s=await z({...i});P.value=s.records,x.value=s.total}catch(s){O.error(s.message)}finally{C.value=!1}},Q=async(s,e,l)=>{k[s.categoryId]={},k[s.categoryId].resolve=l,k[s.categoryId].expandCount=0;const m=await z({page:1,parentId:s.categoryId,size:1e3});l(m.records),s.children=m.records},G=async(s,e)=>{const l=k[s.categoryId];if(l.expandCount++,e&&l.expandCount>1&&!l.prevStatus){const m=await z({page:1,parentId:s.categoryId,size:1e3});l.resolve(m.records)}l.prevStatus=e},A=_(),D=async(s,e)=>{const l=k[e.parentId];if(l){const m=await z({page:1,parentId:e.parentId,size:1e3});A.value.store.states.lazyTreeNodeMap.value[e.parentId].length>1?A.value.store.states.lazyTreeNodeMap[e.parentId]=[]:A.value.store.states.lazyTreeNodeMap.value[e.parentId]=[],l.resolve(m.records)}else u()},N=()=>{H.clearCategory()},W=s=>{q.value.push(s),i.parentId=s,u()},X=()=>{q.value.pop(),i.parentId=q.value[q.value.length-1],u()},Y=async s=>{try{const e=await ge(s,{ids:h.value});O.success("操作成功"),u()}catch(e){O.error(e.message)}},Z=s=>{h.value=s.map(e=>e.categoryId)};return(s,e)=>{const l=d("el-button"),m=d("router-link"),ee=d("el-popconfirm"),w=d("el-space"),te=d("el-form"),g=d("el-table-column"),ae=d("el-image"),R=d("el-divider"),T=d("el-dropdown-item"),oe=d("el-dropdown-menu"),se=d("el-dropdown"),re=d("el-table"),ne=d("a-spin");return c(),v(me,null,[n("link",{href:j.value,rel:"stylesheet"},null,8,ve),n("div",he,[n("div",ke,[n("div",Ie,[n("div",be,[a(te,{model:i,name:"form"},{default:o(()=>[n("div",Ce,[n("div",xe,[a(w,null,{default:o(()=>[i.parentId>0?(c(),S(l,{key:0,onClick:X},{default:o(()=>e[3]||(e[3]=[n("i",{class:"iconfont icon-fanhui",style:{"font-size":"14px","padding-right":"5px"}},null,-1),y(" 返回上一级 ",-1)])),_:1,__:[3]})):f("",!0),a(r(U),{params:{act:"add",parentId:i.parentId},isDrawer:"",path:"product/category/Info",title:"添加分类",width:"600px",onOkCallback:u},{default:o(()=>[a(l,{type:"primary"},{default:o(()=>e[4]||(e[4]=[y("添加分类",-1)])),_:1,__:[4]})]),_:1},8,["params"]),r(ye)()?(c(),S(m,{key:1,to:{path:"/setting/translationContent/list",query:{type:"category"}}},{default:o(()=>[a(l,null,{default:o(()=>e[5]||(e[5]=[y("批量翻译分类名称",-1)])),_:1,__:[5]})]),_:1})):f("",!0),a(ee,{title:"您确认要批量删除所选数据吗？",onConfirm:e[0]||(e[0]=t=>Y("del"))},{reference:o(()=>[a(l,{disabled:h.value.length===0},{default:o(()=>e[6]||(e[6]=[y("批量删除",-1)])),_:1,__:[6]},8,["disabled"])]),_:1}),h.value.length>0?(c(),v("span",qe,[e[7]||(e[7]=y(" 已选择：",-1)),n("b",null,I(h.value.length),1),e[8]||(e[8]=y(" 项 ",-1))])):f("",!0)]),_:1})])])]),_:1},8,["model"])]),n("div",Ae,[a(ne,{spinning:C.value},{default:o(()=>[a(re,{data:P.value,"expand-row-keys":J.value,indent:30,load:Q,total:x.value,"tree-props":{children:"children",hasChildren:"hasChildren"},lazy:"","row-key":"categoryId",onSelectionChange:Z,onExpandChange:G,ref_key:"tableRef",ref:A},{empty:o(()=>[n("div",Ne,[C.value?f("",!0):(c(),v("div",we,"暂无数据"))])]),default:o(()=>[a(g,{type:"selection",width:"32"}),a(g,{width:200,label:"分类名称"},{default:o(({row:t})=>[a(w,{style:{height:"30px"}},{default:o(()=>[n("div",Se,[a(r(V),{"org-value":t.categoryName,"onUpdate:orgValue":p=>t.categoryName=p,params:{id:t.categoryId,field:"categoryName"},requestApi:r(b),label:"分类名称",type:"textarea",onCallback:N},{default:o(()=>[t.hasChildren?(c(),v("a",{key:0,onClick:p=>W(t.categoryId)},I(t.categoryName),9,ze)):(c(),v("span",Ue,I(t.categoryName),1))]),_:2},1032,["org-value","onUpdate:orgValue","params","requestApi"])])]),_:2},1024)]),_:1}),a(g,{width:120,label:"分类图片"},{default:o(({row:t})=>[t.categoryPic?(c(),v("div",De,[a(ae,{src:r(de)(t.categoryPic),fit:"contain",style:{height:"30px",width:"30px"}},null,8,["src"])])):f("",!0)]),_:1}),a(g,{label:"单位"},{default:o(({row:t})=>[a(r(V),{"org-value":t.measureUnit,"onUpdate:orgValue":p=>t.measureUnit=p,params:{id:t.categoryId,field:"measureUnit"},requestApi:r(b),label:"单位",type:"input",onCallback:N},{default:o(()=>[n("div",null,I(t.measureUnit||"-"),1)]),_:2},1032,["org-value","onUpdate:orgValue","params","requestApi"])]),_:1}),a(g,{label:"是否热门"},{default:o(({row:t})=>[a(r(B),{checked:t.isHot,"onUpdate:checked":p=>t.isHot=p,params:{id:t.categoryId,field:"isHot"},requestApi:r(b)},null,8,["checked","onUpdate:checked","params","requestApi"])]),_:1}),a(g,{key:"isShow",sorter:!0,label:"是否显示"},{default:o(({row:t})=>[a(r(B),{checked:t.isShow,"onUpdate:checked":p=>t.isShow=p,params:{id:t.categoryId,field:"isShow"},requestApi:r(b)},null,8,["checked","onUpdate:checked","params","requestApi"])]),_:1}),a(g,{key:"sortOrder",sorter:!0,label:"排序"},{default:o(({row:t})=>[a(r(V),{"org-value":t.sortOrder,"onUpdate:orgValue":p=>t.sortOrder=p,params:{id:t.categoryId,field:"sortOrder"},requestApi:r(b),label:"排序",type:"integer",onCallback:N},{default:o(()=>[n("div",null,I(t.sortOrder),1)]),_:2},1032,["org-value","onUpdate:orgValue","params","requestApi"])]),_:1}),a(g,{width:180,fixed:"right",label:"操作"},{default:o(({row:t})=>[a(w,{size:0},{default:o(()=>[a(r(U),{params:{act:"detail",id:t.categoryId},data:{parentId:t.parentId},isDrawer:"",path:"product/category/Info",title:"编辑分类",width:"600px",onOkCallback:D},{default:o(()=>e[9]||(e[9]=[n("a",{class:"btn-link"},"编辑",-1)])),_:2,__:[9]},1032,["params","data"]),a(R,{direction:"vertical"}),a(r(U),{params:{act:"add",parentId:t.categoryId},data:{parentId:t.parentId||t.categoryId},isDrawer:"",path:"product/category/Info",title:"添加子分类",width:"600px",onOkCallback:D},{default:o(()=>e[10]||(e[10]=[n("a",{class:"btn-link"},"添加子分类",-1)])),_:2,__:[10]},1032,["params","data"]),a(R,{direction:"vertical"}),a(se,{trigger:"hover","hide-on-click":!1},{dropdown:o(()=>[a(oe,null,{default:o(()=>[a(T,null,{default:o(()=>[a(r(U),{params:{id:t.categoryId},isDrawer:"",path:"product/category/Move",title:"商品转移",width:"600px",onOkCallback:u},{default:o(()=>e[11]||(e[11]=[n("a",{class:"btn-link"},"商品转移",-1)])),_:2,__:[11]},1032,["params"])]),_:2},1024),a(T,null,{default:o(()=>[t.parentId?(c(),S(r(M),{key:0,params:{id:t.categoryId},requestApi:r(E),onAfterDelete:p=>D({},{parentId:t.parentId})},{default:o(()=>e[12]||(e[12]=[y("删除 ",-1)])),_:2,__:[12]},1032,["params","requestApi","onAfterDelete"])):f("",!0),t.parentId?f("",!0):(c(),S(r(M),{key:1,params:{id:t.categoryId},requestApi:r(E),onAfterDelete:u},{default:o(()=>e[13]||(e[13]=[y("删除",-1)])),_:2,__:[13]},1032,["params","requestApi"]))]),_:2},1024)]),_:2},1024)]),default:o(()=>[e[14]||(e[14]=n("span",{class:"iconfont-admin icon-gengduo1 btn-link"},null,-1))]),_:2,__:[14]},1024)]),_:2},1024)]),_:1})]),_:1},8,["data","expand-row-keys","total"])]),_:1},8,["spinning"]),x.value>0?(c(),v("div",Oe,[a(r(le),{page:i.page,"onUpdate:page":e[1]||(e[1]=t=>i.page=t),size:i.size,"onUpdate:size":e[2]||(e[2]=t=>i.size=t),total:x.value,onCallback:u},null,8,["page","size","total"])])):f("",!0)])])])])],64)}}});export{Ge as default};
