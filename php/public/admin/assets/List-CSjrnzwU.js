import{a0 as Y,d as X,v as Z,r as _,ak as ss,Q as ts,a as es,o as os,e as v,f as a,g as l,h as s,k as i,y as r,l as u,a2 as ls,F as L,m as z,j as D,i as p,K as b,t as n,dt as A,n as as,J as U,_ as rs}from"./index-BEWhCL1q.js";/* empty css             *//* empty css                                                                    */import{S as M}from"./SortButton-Bsisc0vM.js";import{P as ns}from"./Pagination-4FaohhlG.js";import{P as ds}from"./ProductCard-BDl7uMRW.js";import{r as is}from"./export-CPfNg7CD.js";import"./index-DVG44k_-.js";import{p as R}from"./format-C8RAoEAk.js";import"./Verify.vue_vue_type_style_index_0_lang-B6mvUwPP.js";import"./zh-cn-Crj8NPt5.js";import{T as q}from"./Tag-Bhu-jNjT.js";import"./SelectTimeInterval.vue_vue_type_style_index_0_scoped_207fe586_lang-B2T-ARqM.js";/* empty css                                                                  *//* empty css                                                                              */import{S as us}from"./SelectTimeInterval-CHncG0ge.js";import{M as ps}from"./MobileCard-BFqdI-Pd.js";import{s as cs}from"./promoter-CIm3q0L5.js";import{_ as ms}from"./DialogForm.vue_vue_type_script_setup_true_lang-CQB-6Tki.js";import"./index-BNk7xZkD.js";import"./time-BMcbgg5F.js";const _s=h=>Y({url:"salesman/customerTransaction/list",method:"get",params:h}),vs=h=>Y({url:"salesman/customerTransaction/list",method:"get",responseType:"arraybuffer",params:h}),fs={class:"container"},ys={class:"content_wrapper"},gs={class:"lyecs-table-list-warp"},bs={class:"list-table-tool lyecs-search-warp"},hs={class:"advanced-search-warp list-table-tool-row"},ks={class:"simple-form-warp"},ws={class:"simple-form-field"},Ts={class:"form-group"},Ss={class:"control-container"},xs={class:"simple-form-field"},Cs={class:"form-group"},Is={class:"control-container"},Fs={class:"simple-form-field"},Ns={class:"form-group"},Os={class:"simple-form-warp"},Ls={class:"simple-form-field"},zs={class:"control-container"},Ds={class:"list-table-tool-row"},Us={class:"list-table-tool-col"},Vs={class:"table-container"},Es={class:"custom-table"},Bs={class:"custom-table"},Ps={class:"data-tr"},As={colspan:"6"},Ms={class:"check-box"},Rs={class:"check-box"},qs={class:"displayRow flex flex-align-center flex-justify-between"},Ys={class:"displayColumn textR whiteSN widthAuto"},Ks=["rowspan"],$s={class:"displayColumn textL"},js=["rowspan"],Js={class:"displayColumn textL"},Qs=["rowspan"],Gs={class:"displayColumn fz12 textL"},Hs={class:"gray"},Ws={class:"black"},Xs={class:"gray"},Zs={class:"black"},st={class:"gray flex user-address"},tt={class:"black line1 value"},et=["rowspan"],ot={class:"displayColumn textL"},lt=["rowspan"],at={class:"displayColumn textL"},rt={key:0},nt={class:"gray"},dt=["rowspan"],it=["rowspan"],ut={class:"displayColumn fz14"},pt={class:"gray"},ct={key:0,class:"empty-warp"},mt={key:0,class:"empty-bg"},_t={key:0,class:"pagination-con"},vt=X({__name:"List",props:{id:{type:Number,default:0},act:{type:String,default:""},isDialog:Boolean},setup(h){const V=Z(),F=_([]),w=_(!0),T=_(0),K=_([]),o=ss({page:1,size:V.get("pageSize"),sortField:"addTime",sortOrder:"desc",endTime:"",startTime:"",keyword:"",salesmanId:""}),$=()=>{o.page=1,o.size=V.get("pageSize"),o.sortField="addTime",o.sortOrder="desc",o.keyword="",o.endTime="",o.startTime="",o.salesmanId="",k()},k=async()=>{w.value=!0,K.value=[];try{const d=await _s({...o});if(d.records!==null){const t=d.records.map(c=>({...c}));F.value=t}else F.value=[];T.value=d.total}catch(d){U.error(d.message)}finally{w.value=!1}},S=h;ts();const E=es().currentRoute.value.query;_(S.isDialog?S.act:String(E.act)),_(S.isDialog?S.id:Number(E.id)),os(()=>{k()});const f=()=>{k()},N=_([]),O=_(!1),j=async d=>{try{if(d){O.value=!0;const c=await cs({nickname:d});c.records.forEach(m=>{var C,I;m.value=m.salesmanId,m.key=m.salesmanId,m.label=((C=m.user)==null?void 0:C.nickname)||((I=m.user)==null?void 0:I.username)||"--"}),N.value=c.records}else N.value=[]}catch(t){U.error(t.message)}finally{O.value=!1}},x=_(!1),J=async()=>{x.value=!0;try{const d=await vs({...o,isExport:"1"});x.value=!1,is(d,"客户成交订单导出")}catch(d){U.error(d.message)}finally{x.value=!1}};return(d,t)=>{const c=v("el-button"),m=v("TigInput"),C=v("el-option"),I=v("el-select"),Q=v("el-space"),G=v("el-divider"),H=v("el-tooltip"),W=v("a-spin");return l(),a("div",fs,[s("div",ys,[s("div",gs,[s("div",bs,[s("div",hs,[s("div",ks,[s("div",ws,[s("div",Ts,[t[13]||(t[13]=s("label",{class:"control-label"},[s("span",null,"订单信息：")],-1)),s("div",Ss,[r(m,{modelValue:o.keyword,"onUpdate:modelValue":t[0]||(t[0]=e=>o.keyword=e),name:"keyword",placeholder:"订单号/会员名称",onKeyup:ls(f,["enter"]),clearable:"",onClear:f},{append:u(()=>[r(c,{onClick:f},{default:u(()=>t[12]||(t[12]=[s("span",{class:"iconfont icon-chakan1"},null,-1)])),_:1,__:[12]})]),_:1},8,["modelValue"])])])]),s("div",xs,[s("div",Cs,[t[14]||(t[14]=s("label",{class:"control-label"},[s("span",null,"分销员：")],-1)),s("div",Is,[r(I,{modelValue:o.salesmanId,"onUpdate:modelValue":t[1]||(t[1]=e=>o.salesmanId=e),filterable:"",remote:"","reserve-keyword":"",placeholder:"输入分销员昵称查询订单","remote-method":j,onChange:f,loading:O.value},{default:u(()=>[(l(!0),a(L,null,z(N.value,e=>(l(),D(C,{key:e.key,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])])])]),s("div",Fs,[s("div",Ns,[t[15]||(t[15]=s("label",{class:"control-label"},[s("span",null,"下单时间：")],-1)),r(p(us),{"end-date":o.endTime,"onUpdate:endDate":t[2]||(t[2]=e=>o.endTime=e),"start-date":o.startTime,"onUpdate:startDate":t[3]||(t[3]=e=>o.startTime=e),clearable:!1,type:"date","value-format":"YYYY-MM-DD"},null,8,["end-date","start-date"])])]),s("div",Os,[s("div",Ls,[t[18]||(t[18]=s("label",{class:"control-label"},null,-1)),s("div",zs,[r(c,{type:"primary",plain:"",onClick:f},{default:u(()=>t[16]||(t[16]=[b("搜索",-1)])),_:1,__:[16]}),r(c,{plain:"",onClick:$},{default:u(()=>t[17]||(t[17]=[b("重置",-1)])),_:1,__:[17]})])])])])])]),s("div",Ds,[s("div",Us,[r(Q,null,{default:u(()=>[r(c,{onClick:J,loading:x.value},{default:u(()=>t[19]||(t[19]=[b(" 导出 ",-1)])),_:1,__:[19]},8,["loading"])]),_:1})])]),s("div",Vs,[r(W,{spinning:w.value},{default:u(()=>[s("table",Es,[s("thead",null,[s("tr",null,[s("th",null,[r(M,{sortField:o.sortField,"onUpdate:sortField":t[4]||(t[4]=e=>o.sortField=e),sortOrder:o.sortOrder,"onUpdate:sortOrder":t[5]||(t[5]=e=>o.sortOrder=e),sortName:"salesmanId",text:"订单信息(下单时间排序)",onLoadData:t[6]||(t[6]=e=>f())},null,8,["sortField","sortOrder"])]),t[20]||(t[20]=s("th",null,"所属分销员",-1)),t[21]||(t[21]=s("th",null,"客户名称",-1)),t[22]||(t[22]=s("th",null,"收货人信息",-1)),t[23]||(t[23]=s("th",{style:{"text-align":"start"}},"收货时间",-1)),t[24]||(t[24]=s("th",{style:{"text-align":"start"}},"物流/支付信息",-1)),t[25]||(t[25]=s("th",{style:{"text-align":"start"}},"订单状态",-1)),s("th",null,[r(M,{sortField:o.sortField,"onUpdate:sortField":t[7]||(t[7]=e=>o.sortField=e),sortOrder:o.sortOrder,"onUpdate:sortOrder":t[8]||(t[8]=e=>o.sortOrder=e),sortName:"totalAmount",text:"订单金额",onLoadData:t[9]||(t[9]=e=>f())},null,8,["sortField","sortOrder"])])])])]),(l(!0),a(L,null,z(F.value,e=>(l(),a("table",Bs,[s("thead",null,[s("tr",Ps,[s("th",As,[s("span",Ms,"订单编号："+n(e.orderSn),1),r(G,{direction:"vertical"}),s("span",Rs,"下单时间："+n(e.addTime),1),e.orderSource?(l(),D(H,{key:0,content:"订单来自"+e.orderSource+"下单",effect:"light",placement:"top"},{default:u(()=>[r(p(q),{text:e.orderSource,transparent:!0,style:{"text-transform":"uppercase"}},null,8,["text"])]),_:2},1032,["content"])):i("",!0),e.isExchangeOrder?(l(),D(p(q),{key:1,transparent:!0,color:"red",text:"积分兑换"})):i("",!0)])])]),s("tbody",null,[(l(!0),a(L,null,z(e.items,(y,g)=>(l(),a("tr",null,[s("td",null,[s("div",qs,[r(p(ds),{picThumb:y.picThumb,productId:y.productId,productName:y.productName,productType:y.productType,url:y.url},null,8,["picThumb","productId","productName","productType","url"]),s("div",Ys,[s("div",null,n(p(R)(y.price)),1),s("div",null,"× "+n(y.quantity),1)])])]),g==0?(l(),a("td",{key:0,rowspan:e.items.length},[s("div",$s,[s("div",null,n(e.salesmanName||"--"),1)])],8,Ks)):i("",!0),g==0?(l(),a("td",{key:1,rowspan:e.items.length},[s("div",Js,[s("div",null,[r(p(ms),{params:{act:"detail",id:e.user.userId},isDrawer:"",path:"user/user/Detail",title:"用户信息",width:"800px",onOkCallback:k,showOnOk:!1},{default:u(()=>{var B,P;return[s("a",null,n(((B=e.user)==null?void 0:B.nickname)||((P=e.user)==null?void 0:P.username)||"--"),1)]}),_:2},1032,["params"])])])],8,js)):i("",!0),g==0?(l(),a("td",{key:2,rowspan:e.items.length},[s("div",Gs,[s("div",Hs,[t[26]||(t[26]=b(" 收货人： ",-1)),s("span",Ws,n(p(A)(e.consignee,1,1)),1)]),s("div",Xs,[t[27]||(t[27]=b(" 手机号： ",-1)),s("span",Zs,[s("span",null,[r(ps,{mobile:e.mobile},null,8,["mobile"])])])]),s("div",st,[t[28]||(t[28]=s("span",{class:"label"}," 收货地址： ",-1)),s("span",tt,n(p(A)(e.userAddress,16,0)),1)])])],8,Qs)):i("",!0),g==0?(l(),a("td",{key:3,rowspan:e.items.length},[s("div",ot,[s("div",null,[s("span",null,n(e.receivedTime||"--"),1)])])],8,et)):i("",!0),g==0?(l(),a("td",{key:4,rowspan:e.items.length},[s("div",at,[s("div",null,[s("span",null,n(e.payTypeId===1?"在线支付":e.payTypeId===2?"货到付款":"线下支付"),1)]),e.logisticsName?(l(),a("div",rt,[b(n(e.shippingTypeName)+" ",1),s("span",nt,n(""+e.logisticsName),1)])):i("",!0)])],8,lt)):i("",!0),g==0?(l(),a("td",{key:5,rowspan:e.items.length},[s("span",{class:as({orange:e.orderStatus===0,black:e.orderStatus===1||e.orderStatus===2||e.orderStatus===4,gray:e.orderStatus===3,green:e.orderStatus===5})},n(e.orderStatusName),3)],8,dt)):i("",!0),g==0?(l(),a("td",{key:6,rowspan:e.items.length},[s("div",ut,[s("div",null,n(p(R)(e.totalAmount)),1),s("div",pt,"(含运费："+n(e.shippingFee)+")",1)])],8,it)):i("",!0)]))),256))])]))),256)),T.value==0?(l(),a("div",ct,[w.value?i("",!0):(l(),a("div",mt,"暂无数据"))])):i("",!0)]),_:1},8,["spinning"])]),T.value>0?(l(),a("div",_t,[r(p(ns),{page:o.page,"onUpdate:page":t[10]||(t[10]=e=>o.page=e),size:o.size,"onUpdate:size":t[11]||(t[11]=e=>o.size=e),total:T.value,onCallback:k},null,8,["page","size","total"])])):i("",!0)])])])}}}),Bt=rs(vt,[["__scopeId","data-v-a34fb4d8"]]);export{Bt as default};
