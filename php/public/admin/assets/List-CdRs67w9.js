/* empty css             */import{a0 as x,d as F,r as v,a5 as I,o as N,e as u,f as O,g as B,h as l,y as a,l as i,i as r,dn as k,dm as f,K as d,t as w,a9 as R,J as p,_ as j}from"./index-BEWhCL1q.js";import{d as q}from"./format-C8RAoEAk.js";import{u as z}from"./theme-YtIM2XHr.js";const E=()=>x({url:"setting/appVersion/detail",method:"get"}),M=V=>x({url:"setting/appVersion/update",method:"post",data:V}),D={class:"container"},J={class:"content_wrapper"},K={class:"lyecs-form-table"},$={class:"link-wrapper"},G={class:"link-wrapper"},H={class:"selected-action"},Q=F({__name:"List",emits:["submitCallback","update:confirmLoading","close"],setup(V,{expose:h,emit:S}){const{themeInfo:C}=z(),c=S,T=v(!1),s=v({}),g=v(!0),y=I(),U=async()=>{g.value=!0;try{const e=await E();Object.assign(s.value,q(e))}catch(e){p.error(e.message)}finally{g.value=!1}},b=(e,t)=>{if(e.file.status=="uploading",e.file.status,e.file.status==="done")if(e.file.response.code!==0)e.file.status="error",p.error(e.file.response.data.message);else{console.log(e.file.response);for(let n in e.fileList)e.file.uid==e.fileList[n].uid&&(e.fileList[n]=Object.assign(e.fileList[n],e.fileList[n].response.data));t==="android"&&(s.value.androidLink=e.file.response.data),t==="ios"&&(s.value.iosLink=e.file.response.data),p.success("文件上传成功！")}else e.file.status==="error"&&p.error(`${e.file.name} 文件上传失败！`)};N(()=>{U()});const L=async()=>{await y.value.validate();try{c("update:confirmLoading",!0);const e=await M({...s.value});c("submitCallback",e),p.success("操作成功")}catch(e){p.error(e.message)}finally{c("update:confirmLoading",!1)}};return h({onFormSubmit:()=>{L()}}),(e,t)=>{const n=u("TigInput"),m=u("el-form-item"),_=u("el-button"),A=u("el-form"),P=u("a-spin");return B(),O("div",D,[l("div",J,[l("div",K,[a(P,{spinning:g.value,style:{width:"100%","margin-top":"100px"}},{default:i(()=>[a(A,{ref_key:"formRef",ref:y,model:s.value,"label-width":"auto",style:{display:"flex",gap:"12px","flex-direction":"column"}},{default:i(()=>[t[8]||(t[8]=l("div",{class:"title"},"APP版本",-1)),a(m,{label:"Android版本号",prop:"androidVersion"},{default:i(()=>[a(n,{classType:"tig-form-input",modelValue:s.value.androidVersion,"onUpdate:modelValue":t[0]||(t[0]=o=>s.value.androidVersion=o),type:"text"},null,8,["modelValue"])]),_:1}),a(m,{label:"Android下载链接",prop:"androidLink"},{default:i(()=>[l("div",null,[l("div",$,[a(n,{classType:"tig-form-input",modelValue:s.value.androidLink,"onUpdate:modelValue":t[1]||(t[1]=o=>s.value.androidLink=o),disabled:"",type:"text"},null,8,["modelValue"]),a(r(k),{name:"file",action:r(f).prefix+"/setting/appVersion/uploadFile",headers:r(f).headers(),onChange:t[2]||(t[2]=o=>b(o,"android")),showUploadList:!1,multiple:!1,accept:".apk,.wgt"},{default:i(()=>[a(_,null,{default:i(()=>[d(w(s.value.androidLink?"重新上传":"点击上传"),1)]),_:1})]),_:1},8,["action","headers"])]),t[6]||(t[6]=l("div",{class:"extra"},[d(" 版本升级需制作热更新文件，制作时版本号需要高一个版本号。具体制作请参考"),l("a",{href:"https://www.tigshop.com/course/tigshop/187506502217291111",target:"_blank"}," 《APP版本管理》 "),d("教程。 ")],-1))])]),_:1}),a(m,{label:"iOS版本号",prop:"iosVersion"},{default:i(()=>[a(n,{classType:"tig-form-input",modelValue:s.value.iosVersion,"onUpdate:modelValue":t[3]||(t[3]=o=>s.value.iosVersion=o),type:"text"},null,8,["modelValue"])]),_:1}),a(m,{label:"iOS下载链接",prop:"iosLink"},{default:i(()=>[l("div",null,[l("div",G,[a(n,{classType:"tig-form-input",modelValue:s.value.iosLink,"onUpdate:modelValue":t[4]||(t[4]=o=>s.value.iosLink=o),disabled:"",type:"text"},null,8,["modelValue"]),a(r(k),{name:"file",action:r(f).prefix+"/setting/appVersion/uploadFile",headers:r(f).headers(),onChange:t[5]||(t[5]=o=>b(o,"ios")),showUploadList:!1,multiple:!1,accept:".wgt"},{default:i(()=>[a(_,null,{default:i(()=>[d(w(s.value.iosLink?"重新上传":"点击上传"),1)]),_:1})]),_:1},8,["action","headers"])]),t[7]||(t[7]=l("div",{class:"extra"},[d(" 版本升级需制作热更新文件，制作时版本号需要高一个版本号。具体制作请参考"),l("a",{href:"https://www.tigshop.com/course/tigshop/187506502217291111",target:"_blank"}," 《APP版本管理》 "),d("教程。 ")],-1))])]),_:1})]),_:1,__:[8]},8,["model"]),l("div",{class:"selected-action-warp selected-warp-left",style:R({left:r(C).layout!=="topMenu"?"369px":"270px"})},[l("div",H,[a(_,{loading:T.value,class:"form-submit-btn",size:"large",type:"primary",onClick:L},{default:i(()=>t[9]||(t[9]=[d("提 交",-1)])),_:1,__:[9]},8,["loading"])])],4)]),_:1},8,["spinning"])])])])}}}),te=j(Q,[["__scopeId","data-v-26aeb829"]]);export{te as default};
