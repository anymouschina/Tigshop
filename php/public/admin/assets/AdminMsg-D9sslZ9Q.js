import{i as $}from"./version-C520_GUm.js";import{d as E,s as D,v as J,r as i,ak as K,o as O,A as q,e as I,f as a,g as s,y as C,l as x,h as o,F as S,m as z,k as d,i as N,n as A,t as m,j as G,K as H,J as Q,_ as W}from"./index-BEWhCL1q.js";/* empty css                                                                    */import{P as X}from"./Pagination-4FaohhlG.js";import Y from"./Collapse-aA1YZ33Y.js";import{a as Z,b as ee,c as te}from"./adminMsg-BCkN2foR.js";import"./Image.vue_vue_type_script_setup_true_lang-DC1N644b.js";import"./format-C8RAoEAk.js";import"./order-BQjFJOKB.js";import"./DetailBtn.vue_vue_type_script_setup_true_lang-DQF1JO7C.js";import"./index-DVG44k_-.js";import"./index-BNk7xZkD.js";import"./DialogForm.vue_vue_type_script_setup_true_lang-CQB-6Tki.js";import"./aftersales-C2D9m--S.js";const se="/admin/assets/empty-bg-CEmUzxL0.png",ae={class:"message_center"},ne={class:"tab_box tab_box1"},oe=["onClick"],le={key:0,class:"num"},ie=["onClick"],ue={key:0,class:"num"},ce={class:"tab_box tab_box2"},re=["onClick"],de={key:0,class:"num"},pe={class:"list_box"},me={style:{"min-height":"200px"}},ge={key:0,class:"item"},ve={key:1,class:"table-empty"},_e={key:0,class:"pagination-con"},ye={class:"btn"},he=E({__name:"AdminMsg",emits:["callback","update:confirmLoading","close"],setup(Ce,{emit:w}){const B=D(),f=w,R=J(),p=i([]),k=i([]),u=i(0),v=i(0),_=i(!0),y=i(!0),l=K({page:1,size:R.get("pageSize"),msgType:11}),c=i([]),b=i(0),g=async()=>{f("callback"),y.value=!0;try{const t=await Z({...l}),n=await ee();c.value=t.records,p.value=n,k.value=T(p.value[u.value].child),b.value=t.total,_.value=!1}catch(t){Q.error(t.message)}finally{y.value=!1}},U=()=>{f("close")};O(()=>{localStorage.setItem("lastOpenTime",String(q().unix())),g()});const V=async()=>{await te(),f("callback",!1),g()},L=t=>{u.value=t,v.value=0,c.value.length=0,l.msgType=T(p.value[u.value].child)[0].msgType,g()},j=t=>{l.page=1,v.value=t,c.value.length=0,l.msgType=T(p.value[u.value].child)[t].msgType,g()},F=()=>{p.value[u.value].unreadCount-=1,k.value[v.value].unreadCount-=1,B.messageCount-=1},T=t=>{if(typeof t=="object"){var n=[];for(let h in t)n.push(t[h]);return n}else return t};return(t,n)=>{const h=I("a-spin"),P=I("el-button");return s(),a("div",null,[C(h,{spinning:_.value},{default:x(()=>[o("div",ae,[o("div",ne,[(s(!0),a(S,null,z(p.value,(e,r)=>(s(),a("div",null,[e.catId==4&&N($)()?(s(),a("div",{key:0,class:A(["tab",u.value==r?"current":""]),onClick:M=>L(r)},[o("p",null,m(e.catName),1),e.unreadCount>0?(s(),a("p",le,m(e.unreadCount),1)):d("",!0)],10,oe)):e.catId!=4?(s(),a("div",{key:1,class:A(["tab",u.value==r?"current":""]),onClick:M=>L(r)},[o("p",null,m(e.catName),1),e.unreadCount>0?(s(),a("p",ue,m(e.unreadCount),1)):d("",!0)],10,ie)):d("",!0)]))),256))]),o("div",ce,[(s(!0),a(S,null,z(k.value,(e,r)=>(s(),a("div",{class:A(["tab",v.value==r?"current":""]),onClick:M=>j(r)},[o("p",null,m(e.name),1),e.unreadCount>0?(s(),a("p",de,m(e.unreadCount),1)):d("",!0)],10,re))),256))]),o("div",pe,[C(h,{spinning:y.value&&!_.value,style:{width:"100%"}},{default:x(()=>[o("div",me,[c.value.length>0?(s(),a("div",ge,[(s(!0),a(S,null,z(c.value,e=>(s(),G(Y,{item:e,msgType:e.msgType,key:e.msgType,onSetReadedCallback:F,onClose:U},null,8,["item","msgType"]))),128))])):d("",!0),c.value.length===0&&!y.value&&!_.value?(s(),a("div",ve,n[2]||(n[2]=[o("img",{src:se,alt:""},null,-1),o("p",null,"当前暂无消息哟",-1)]))):d("",!0)])]),_:1},8,["spinning"]),c.value.length>0&&b.value>0?(s(),a("div",_e,[C(N(X),{page:l.page,"onUpdate:page":n[0]||(n[0]=e=>l.page=e),size:l.size,"onUpdate:size":n[1]||(n[1]=e=>l.size=e),background:!1,total:b.value,onCallback:g},null,8,["page","size","total"])])):d("",!0)]),o("div",ye,[C(P,{onClick:V},{default:x(()=>n[3]||(n[3]=[H("全部已读",-1)])),_:1,__:[3]})])])]),_:1},8,["spinning"])])}}}),Re=W(he,[["__scopeId","data-v-3a60cb71"]]);export{Re as default};
