import{_ as H}from"./AdvancedInfo.vue_vue_type_script_setup_true_lang-k1i1KqUp.js";import Q from"./BasicInfo-2D8Yy_1B.js";import{_ as W}from"./DescInfo.vue_vue_type_script_setup_true_lang-B_k6E1FQ.js";import X from"./LogisticsInfo-BVXVA3cw.js";import{_ as Y}from"./PriceInfo.vue_vue_type_script_setup_true_lang-CHF1aPYC.js";import{_ as Z}from"./VendorPriceInfo.vue_vue_type_script_setup_true_lang-a5OSfGn7.js";import{d as ee,P as te,r as l,a as ae,a5 as ie,R as oe,o as re,J as g,e as R,f as q,g as y,h as r,y as L,l as N,F as se,m as le,n as F,t as ne,j as b,k as w,K as x,i as I,q as P,_ as de}from"./index-BEWhCL1q.js";import{e as ue,f as pe,h as ce,i as me}from"./product-IfnnwfpZ.js";/* empty css                                                                  */import"./Checkbox.vue_vue_type_script_setup_true_lang-D8m8tZt5.js";import"./SelectTimeInterval.vue_vue_type_style_index_0_scoped_207fe586_lang-B2T-ARqM.js";import"./time-BMcbgg5F.js";import"./index-DVG44k_-.js";import"./index-BNk7xZkD.js";import"./SelectProduct-CS10v706.js";import"./format-C8RAoEAk.js";/* empty css                                                                    */import"./Pagination-4FaohhlG.js";import"./SelectSku-CKVpMAXG.js";/* empty css                                                                  */import"./DialogForm.vue_vue_type_script_setup_true_lang-CQB-6Tki.js";import"./article-vtwOCIi8.js";/* empty css                                                                              *//* empty css             */import"./UploadAvatar.vue_vue_type_style_index_0_scoped_3ec2e0ca_lang-BVJHh8ng.js";import"./vuedraggable.umd-_qUe1n4L.js";import"./Image.vue_vue_type_script_setup_true_lang-DC1N644b.js";import"./BusinessImg-CuIKiE1z.js";import"./currencyManagement-BEhPZh48.js";import"./version-C520_GUm.js";import"./FormAddGalleryVideo-Cr9BEyUE.js";import"./RadioType-C4-J2Zv8.js";import"./SelectBrand-DFj6FPJO.js";import"./brand-NPYEvOSK.js";import"./SelectCategory.vue_vue_type_script_setup_true_lang-D5TL5eLW.js";import"./category-Bu2fUBIU.js";import"./category-JkcBf76e.js";import"./SelectShopProductCategory.vue_vue_type_script_setup_true_lang-BByYTMhQ.js";import"./shopProductCategory-BYkWAEdg.js";import"./BusinessData-ICvr1eK8.js";import"./ProductDesc-CsofV_qO.js";import"./Editor.vue_vue_type_style_index_0_lang-DND4PNav.js";import"./index.esm-yJQQDR41.js";import"./PriceInput.vue_vue_type_script_setup_true_lang-2l6MKJVZ.js";import"./Attr-AU5fuNcZ.js";import"./PopSelect.vue_vue_type_style_index_0_scoped_5832cf6b_lang-B9ASxJaT.js";import"./VendorAttr-D-J3ZSob.js";import"./product-Cakm3Kom.js";const ve={class:"product-container"},fe={class:"anchor"},ge={class:"tab-row"},ye={id:"part1",class:"form-warp"},Ie={id:"part2",class:"form-warp"},he={id:"part3",class:"form-warp"},ke={id:"part4",class:"form-warp"},Le={id:"part5",class:"form-warp"},xe=ee({__name:"Info",props:{id:{type:Number,default:0},shopId:{type:Number,default:0},act:{type:String,default:""},type:{type:String,default:""},examine:{type:Number,default:0},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close","closeConfirm"],setup(s,{expose:A,emit:E}){te();const m=E,p=s,_=[{title:"基本信息",id:"part1"},{title:"价格及库存",id:"part2"},{title:"物流及配送",id:"part3"},{title:"商品详情",id:"part4"},{title:"高级信息",id:"part5"}],d=l(p.type),V=l(null),h=l(""),$=a=>{a.preventDefault()},j=a=>{h.value=a},n=l(!0),U=ae().currentRoute.value.query,v=l(p.isDialog?p.act:String(U.act)),u=l(p.isDialog?p.id:Number(U.id)),z=v.value==="add"?"create":v.value==="copy"?"copy":"update",B=ie(),c=l(!1),t=l({snType:1,productType:1,freeShipping:0,shopCategoryId:0,productStatus:1,giveIntegral:-1,rankIntegral:-1,integral:0,isSupportCod:0,productVideoInfo:[],productDescArr:[],productRelated:[],serviceList:[],eCardList:[],productList:[],limitNumber:"",virtualSample:"",paidContent:[],noShipping:0,fixedShippingType:1,attrList:{normal:[],spe:[],extra:[]},vendorProductId:0});oe(t.value,a=>{a.productType!=1&&(t.value.noShipping=1)});const M=l([]);re(async()=>{await K(!1),M.value=[{key:1,title:"普通商品",desc:"物流配送"},{key:3,title:"卡密商品",tips:"可以在菜单中【营销>电子卡券组】创建卡券组，然后在【查看卡列表】添加单个卡密或通过下载【批量导入模板文件】填好卡密后在通过批量导入电子卡券按钮上传该文件批量导入。",desc:"无需物流"},{key:2,title:"虚拟商品",tips:"网盘链接、视频链接，在添加商品添加虚拟商品。用户购买后将在订单详情直接展示。",desc:"无需物流"},{key:4,title:"付费内容",tips:"软件授权、在线课程等。通过简单的操作，即可将这些商品添加到您的商店中，为客户提供更丰富的选择。立即体验，享受便捷的付费内容管理服务。",desc:"无需物流"}],v.value==="detail"||v.value==="copy"||v.value==="again"?await J():n.value=!1,setTimeout(()=>{m("closeConfirm",!0)},1e4)});const T=l([]),J=async()=>{try{const a=await ue("detail",{id:u.value});a.productRelated==null&&(a.productRelated=[]),a.brandId==0&&(a.brandId=""),a.shippingTplId==0&&(a.shippingTplId=""),a.limitNumber===0?(a.limitNumber="",c.value=!1):c.value=!0,a.vendorId&&(d.value="vendor"),t.value.serviceList=t.value.serviceList.map(e=>{var i;return{...e,check:(i=a.productServiceIds)!=null&&i.includes(e.productServiceId)?1:0}}),Object.assign(t.value,a,a)}catch(a){g.error(a.message),m("close")}finally{n.value=!1}},K=async(a=!0)=>{var e;try{const i=await pe({shopId:p.shopId});T.value=i.attrTplList,t.value.serviceList=i.serviceList,t.value.serviceList=(e=i.serviceList)==null?void 0:e.map(f=>{var S;return{...f,check:(S=i.item.productServiceIds)!=null&&S.includes(f.productServiceId)?1:0}}),t.value.suppliersList=i.suppliersList,t.value.shippingTplList=i.shippingTplList,t.value.eCardList=i.eCardList}catch(i){g.error(i.message),m("close")}finally{n.value=!1}};function O(a){for(let e=0;e<a.length;e++){const i=a[e];if(!i.attrValues||i.attrValues.length===0||i.attrValues.some(f=>f==="")||i.skuStock===null||i.skuStock===void 0)return console.error("请填写完整的规格信息"),!1}return!0}const k=l(),G=async()=>{try{if(await B.value.validate(),t.value.productType==4&&t.value.paidContent.length==0){g.error("付费内容信息不能为空!"),await P(),C(".goods-info-edit-row");return}t.value.productType!==3&&(!O(t.value.productList)&&d.value!=="vendor"?(g.error("请将商品规格的信息填写完整!"),k.value.skuErrorText="请将商品规格的信息填写完整",await P(),C(".sku-error")):k.value.skuErrorText="",await k.value.attrForm.validateProductSku()),t.value.attrList.spe.length>0&&(t.value.productStock=0);try{m("update:confirmLoading",!0),t.value.productServiceIds=t.value.serviceList.filter(e=>e.check===1).map(e=>e.productServiceId),t.value.limitNumber=c.value?t.value.limitNumber:0;const a=await ce(z,{...t.value});p.act==="again"&&await me({id:u.value}),m("submitCallback",a),g.success(a)}catch(a){g.error(a.message)}finally{console.log("提交完成"),m("update:confirmLoading",!1)}}catch(a){await P(),C(),console.error("表单验证失败:",a)}},C=(a=".el-form-item.is-error")=>{const e=document.querySelector(a);if(e){e.scrollIntoView({behavior:"instant",block:"center"});const i=e.querySelector("input, textarea, select");i&&(i==null||i.focus())}};return A({onFormSubmit:()=>{G()}}),(a,e)=>{const i=R("el-anchor-link"),f=R("el-anchor"),S=R("el-form");return y(),q("div",ve,[r("div",fe,[L(f,{container:V.value,offset:10,direction:"horizontal",onChange:j,onClick:$},{default:N(()=>[r("div",ge,[(y(),q(se,null,le(_,(o,D)=>L(i,{key:o.id,class:F({active:h.value===""&&D===0?!0:h.value==="#"+o.id}),href:"#"+o.id},{default:N(()=>[r("div",{class:F([{active:h.value===""&&D===0?!0:h.value==="#"+o.id},"item"])},ne(o.title),3)]),_:2},1032,["class","href"])),64))])]),_:1},8,["container"])]),r("div",{ref_key:"containerRef",ref:V,class:"form-container"},[n.value?w("",!0):(y(),b(S,{key:0,ref_key:"formRef",ref:B,model:t.value,"label-width":"110px",name:"form_in_modal"},{default:N(()=>[r("div",ye,[e[8]||(e[8]=r("div",{class:"title"},[r("p",{class:"xian"}),x(" 基本信息 ")],-1)),L(I(Q),{type:d.value,id:u.value,shopId:s.shopId,examine:s.examine,loading:n.value,action:v.value,"form-state":t.value,"onUpdate:formState":e[0]||(e[0]=o=>t.value=o)},null,8,["type","id","shopId","examine","loading","action","form-state"])]),r("div",Ie,[e[9]||(e[9]=r("div",{class:"title"},[r("p",{class:"xian"}),x(" 价格及库存 ")],-1)),d.value!=="vendor"?(y(),b(I(Y),{key:0,ref_key:"priceInfoRef",ref:k,id:u.value,shopId:s.shopId,act:s.act,examine:s.examine,attrTplList:T.value,isLimit:c.value,"onUpdate:isLimit":e[1]||(e[1]=o=>c.value=o),loading:n.value,"form-state":t.value,"onUpdate:formState":e[2]||(e[2]=o=>t.value=o)},null,8,["id","shopId","act","examine","attrTplList","isLimit","loading","form-state"])):w("",!0),d.value=="vendor"?(y(),b(I(Z),{key:1,ref_key:"priceInfoRef",ref:k,id:u.value,shopId:s.shopId,act:s.act,examine:s.examine,attrTplList:T.value,isLimit:c.value,"onUpdate:isLimit":e[3]||(e[3]=o=>c.value=o),loading:n.value,"form-state":t.value,"onUpdate:formState":e[4]||(e[4]=o=>t.value=o)},null,8,["id","shopId","act","examine","attrTplList","isLimit","loading","form-state"])):w("",!0)]),r("div",he,[e[10]||(e[10]=r("div",{class:"title"},[r("p",{class:"xian"}),x(" 物流及配送 ")],-1)),d.value!=="vendor"||d.value=="vendor"&&t.value.vendorProductId>0?(y(),b(I(X),{key:0,id:u.value,shopId:s.shopId,examine:s.examine,loading:n.value,"form-state":t.value,"onUpdate:formState":e[5]||(e[5]=o=>t.value=o)},null,8,["id","shopId","examine","loading","form-state"])):w("",!0)]),r("div",ke,[e[11]||(e[11]=r("div",{class:"title"},[r("p",{class:"xian"}),x(" 商品详情 ")],-1)),L(I(W),{type:d.value,id:u.value,shopId:s.shopId,examine:s.examine,loading:n.value,"form-state":t.value,"onUpdate:formState":e[6]||(e[6]=o=>t.value=o)},null,8,["type","id","shopId","examine","loading","form-state"])]),r("div",Le,[e[12]||(e[12]=r("div",{class:"title"},[r("p",{class:"xian"}),x(" 高级信息 ")],-1)),L(I(H),{id:u.value,shopId:s.shopId,examine:s.examine,loading:n.value,"form-state":t.value,"onUpdate:formState":e[7]||(e[7]=o=>t.value=o)},null,8,["id","shopId","examine","loading","form-state"])])]),_:1},8,["model"]))],512)])}}}),It=de(xe,[["__scopeId","data-v-768f5e24"]]);export{It as default};
