import{d as j,v as E,r as J,o as M,e as n,f as b,g as c,h as t,y as l,l as s,i as e,a2 as H,F as Q,m as W,j as X,K as m,aR as Y,k,t as C,J as Z}from"./index-BEWhCL1q.js";/* empty css             */import"./index-DVG44k_-.js";import{P as ee}from"./PopSelect.vue_vue_type_style_index_0_scoped_5832cf6b_lang-B9ASxJaT.js";import{_ as oe}from"./Switch.vue_vue_type_script_setup_true_lang-4ZoJqbbn.js";import{D as te}from"./DeleteRecord-C4_57oHW.js";/* empty css                                                                    */import{P as le}from"./Pagination-4FaohhlG.js";import{u as A,d as ae,b as se,g as ne,a as ie}from"./productActivity--3tpTIGZ.js";import{u as re}from"./useListRequest-Bpxbydyo.js";import{_ as de}from"./DialogForm.vue_vue_type_script_setup_true_lang-CQB-6Tki.js";const pe={class:"container"},ce={class:"lyecs-table-list-warp"},me={class:"list-table-tool lyecs-search-warp"},ue={class:"advanced-search-warp list-table-tool-row"},_e={class:"simple-form-warp"},fe={class:"simple-form-field"},be={class:"form-group"},ge={class:"control-container"},ve={class:"simple-form-field"},ye={class:"form-group"},ke={class:"control-container"},Ce={class:"simple-form-warp"},he={class:"simple-form-field"},Ae={class:"control-container"},Se={class:"list-table-tool-row"},we={class:"list-table-tool-col"},Pe={key:0},Te={class:"table-container"},Ve={style:{position:"relative"}},Ie={class:"empty-warp"},De={key:0,class:"empty-bg"},Ne={key:0,class:"pagination-con"},Re=j({__name:"activityTable",props:{promotionType:{type:Number,default:1}},setup(S,{expose:w}){const P=E(),T=S,{listData:V,loading:u,total:v,selectedIds:y,filterParams:i,loadData:_,onSearchSubmit:p,onSortChange:I,onSelectChange:D,onBatchAction:N,resetParams:O}=re({apiFunction:ie,idKey:"promotionId",defaultParams:{page:1,size:P.get("pageSize"),sortField:"",sortOrder:"",keyword:"",isGoing:"",promotionType:T.promotionType==3?"3":"1,2"}}),U=async d=>{await N(d,se)};_();const h=J([]),q=async()=>{u.value=!0;try{const d=await ne();h.value=d.promotionStatus}catch(d){Z.error(d.message)}finally{u.value=!1}};return M(()=>{q()}),w({loadFilter:_}),(d,o)=>{const g=n("el-button"),x=n("TigInput"),z=n("el-option"),F=n("el-select"),B=n("el-popconfirm"),K=n("el-space"),$=n("el-form"),r=n("el-table-column"),G=n("el-divider"),L=n("el-table"),R=n("a-spin");return c(),b("div",pe,[t("div",ce,[t("div",me,[l($,{model:e(i)},{default:s(()=>[t("div",ue,[t("div",_e,[t("div",fe,[t("div",be,[o[6]||(o[6]=t("label",{class:"control-label"},[t("span",null,"活动名称：")],-1)),t("div",ge,[l(x,{modelValue:e(i).keyword,"onUpdate:modelValue":o[0]||(o[0]=a=>e(i).keyword=a),name:"keyword",placeholder:"输入活动名称",onKeyup:H(e(p),["enter"]),clearable:"",onClear:e(p)},{append:s(()=>[l(g,{onClick:e(p)},{default:s(()=>o[5]||(o[5]=[t("span",{class:"iconfont icon-chakan1"},null,-1)])),_:1,__:[5]},8,["onClick"])]),_:1},8,["modelValue","onKeyup","onClear"])])])]),t("div",ve,[t("div",ye,[o[7]||(o[7]=t("label",{class:"control-label"},[t("span",null,"活动状态：")],-1)),t("div",ke,[l(F,{modelValue:e(i).isGoing,"onUpdate:modelValue":o[1]||(o[1]=a=>e(i).isGoing=a),clearable:"",onClear:e(p),onChange:e(p)},{default:s(()=>[(c(!0),b(Q,null,W(h.value,(a,f)=>(c(),X(z,{value:f,label:a},null,8,["value","label"]))),256))]),_:1},8,["modelValue","onClear","onChange"])])])]),t("div",Ce,[t("div",he,[o[10]||(o[10]=t("label",{class:"control-label"},null,-1)),t("div",Ae,[l(g,{type:"primary",plain:"",onClick:e(p)},{default:s(()=>o[8]||(o[8]=[m("搜索",-1)])),_:1,__:[8]},8,["onClick"]),l(g,{plain:"",onClick:e(O)},{default:s(()=>o[9]||(o[9]=[m("重置",-1)])),_:1,__:[9]},8,["onClick"])])])])])]),t("div",Se,[t("div",we,[l(K,null,{default:s(()=>[Y(d.$slots,"default"),l(B,{title:"您确认要批量删除所选数据吗？",onConfirm:o[2]||(o[2]=a=>U("del"))},{reference:s(()=>[l(g,{disabled:e(y).length===0},{default:s(()=>o[11]||(o[11]=[m("批量删除",-1)])),_:1,__:[11]},8,["disabled"])]),_:1}),e(y).length>0?(c(),b("span",Pe,[o[12]||(o[12]=m(" 已选择：",-1)),t("b",null,C(e(y).length),1),o[13]||(o[13]=m(" 项 ",-1))])):k("",!0)]),_:3})])])]),_:3},8,["model"])]),t("div",Te,[l(R,{spinning:e(u)},{default:s(()=>[l(L,{data:e(V),"row-key":"promotionId",onSelectionChange:e(D),total:e(v),onSortChange:e(I),loading:e(u)},{empty:s(()=>[t("div",Ie,[e(u)?k("",!0):(c(),b("div",De,"暂无数据"))])]),default:s(()=>[l(r,{type:"selection",width:"32"}),l(r,{label:"活动名称",prop:"promotionName",width:150},{default:s(({row:a})=>[t("div",Ve,[t("div",null,C(a.promotionName||"--"),1)])]),_:1}),l(r,{label:"活动类型",prop:"promotionTypeName",width:"100"}),l(r,{label:"起始日期",prop:"startTime",width:"150",sortable:"custom"}),l(r,{label:"截止日期",prop:"endTime",width:"150",sortable:"custom"}),l(r,{label:"排序",prop:"sortOrder",sortable:"custom"},{default:s(({row:a})=>[l(e(ee),{label:"排序",type:"integer",requestApi:e(A),"org-value":a.sortOrder,"onUpdate:orgValue":f=>a.sortOrder=f,params:{id:a.promotionId,field:"sortOrder"},extra:"默认值为50，数值越小，排序越靠前"},{default:s(()=>[t("div",null,C(a.sortOrder),1)]),_:2},1032,["requestApi","org-value","onUpdate:orgValue","params"])]),_:1}),l(r,{label:"状态",prop:"productStatus"}),l(r,{label:"是否启用",prop:"isAvailable",sortable:"custom"},{default:s(({row:a})=>[l(e(oe),{checked:a.isAvailable,"onUpdate:checked":f=>a.isAvailable=f,requestApi:e(A),params:{id:a.promotionId,field:"isAvailable"}},null,8,["checked","onUpdate:checked","requestApi","params"])]),_:1}),l(r,{label:"操作",fixed:"right"},{default:s(({row:a})=>[l(e(de),{isDrawer:"",onOkCallback:e(_),title:"编辑优惠活动",width:"800px",path:"promotion/productActivity/Info",params:{act:"detail",id:a.promotionId,promotionType:a.promotionType}},{default:s(()=>o[14]||(o[14]=[t("a",{class:"btn-link"},"编辑",-1)])),_:2,__:[14]},1032,["onOkCallback","params"]),l(G,{direction:"vertical"}),l(e(te),{onAfterDelete:e(_),requestApi:e(ae),params:{id:a.promotionId}},{default:s(()=>o[15]||(o[15]=[m("删除",-1)])),_:2,__:[15]},1032,["onAfterDelete","requestApi","params"])]),_:1})]),_:1},8,["data","onSelectionChange","total","onSortChange","loading"])]),_:1},8,["spinning"]),e(v)>0?(c(),b("div",Ne,[l(e(le),{page:e(i).page,"onUpdate:page":o[3]||(o[3]=a=>e(i).page=a),size:e(i).size,"onUpdate:size":o[4]||(o[4]=a=>e(i).size=a),total:e(v),onCallback:e(_)},null,8,["page","size","total","onCallback"])])):k("",!0)])])])}}});export{Re as _};
