import{d as j,v as $,r as s,a as J,a5 as K,c as V,o as M,e as c,j as g,k as T,g as i,l,E as P,y as u,h as C,f as X,F as z,m as G,K as H,t as S,i as Q,I as W,J as v}from"./index-BEWhCL1q.js";import{a as Y,b as Z,u as ee}from"./account-DrTT_IM1.js";const ae={class:"extra"},ue=j({__name:"Info",props:{act:{type:String,default:""},id:{type:Number,default:0},type:{type:Number,default:1},page:{type:Number,default:1},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(N,{expose:B,emit:E}){const q=$().get("withdrawSettingVO"),y=E,d=N,p=s(!0),h=J().currentRoute.value.query,b=s(d.isDialog?d.act:String(h.act)),k=s(d.isDialog?d.id:Number(h.id)),D=b.value==="add"?"create":"update",m=K(),e=s({accountType:1}),_=V(()=>{switch(e.value.accountType){case 1:return"银行卡";case 2:return"支付宝";case 3:return"微信";default:return""}}),R=async()=>{await m.value.resetFields()};V(()=>[{required:!0,message:"请输入身份证号",trigger:"blur"},{validator:(a,t,r)=>{/^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}([0-9]|X)$/.test(t)?r():r(new Error("请输入正确的身份证号码"))},trigger:"blur"}]);const F=V(()=>[{required:!0,message:"请输入"+_.value+"号!",trigger:"blur"},{validator:(a,t,r)=>{!/^\d{6,}$/.test(t)&&e.value.accountType===1?r(new Error("请输入正确的银行卡号")):r()},trigger:"blur"}]),I=async()=>{await m.value.validate();try{y("update:confirmLoading",!0);const a=await ee(D,{id:k.value,...e.value});await m.value.resetFields(),v.success("操作成功"),e.value.accountType=1,y("submitCallback",a)}catch(a){v.error(a.message)}finally{y("update:confirmLoading",!1)}},L=()=>{I()},U=async()=>{try{p.value=!0;const a=await Y(b.value,{id:k.value});Object.assign(e.value,a)}catch(a){v.error(a.message)}finally{p.value=!1}},x=s([]),A=async()=>{try{const a=await Z();x.value=a}catch(a){v.error(a.message)}};return M(()=>{b.value==="detail"?U():p.value=!1,A()}),B({onFormSubmit:L}),(a,t)=>{const r=c("el-radio-button"),w=c("el-radio-group"),n=c("el-form-item"),f=c("TigInput"),O=c("el-form");return p.value?T("",!0):(i(),g(O,{key:0,ref_key:"formRef",ref:m,model:e.value,class:"form-body","label-suffix":"：","label-width":"auto"},{default:l(()=>[P(u(n,{rules:[{required:!0,message:"请选择收款方式!"}],label:"收款方式"},{default:l(()=>[C("div",null,[u(w,{modelValue:e.value.accountType,"onUpdate:modelValue":t[0]||(t[0]=o=>e.value.accountType=o),onChange:R},{default:l(()=>[(i(!0),X(z,null,G(x.value,o=>(i(),g(r,{value:o.accountType},{default:l(()=>[H(S(o.accountTypeText),1)]),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"]),C("div",ae,S(Q(q).withdrawalDescription),1)])]),_:1},512),[[W,N.page]]),u(n,{rules:[{required:!0,message:"请输入真实姓名!"}],label:"真实姓名",prop:"accountName"},{default:l(()=>[u(f,{classType:"tig-form-input",modelValue:e.value.accountName,"onUpdate:modelValue":t[1]||(t[1]=o=>e.value.accountName=o),placeholder:"请输入真实姓名"},null,8,["modelValue"])]),_:1}),u(n,{label:_.value+"号",rules:F.value,prop:"accountNo"},{default:l(()=>[u(f,{classType:"tig-form-input",modelValue:e.value.accountNo,"onUpdate:modelValue":t[2]||(t[2]=o=>e.value.accountNo=o),placeholder:"请输入"+_.value},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),e.value.accountType===1?(i(),g(n,{key:0,label:"分行名称",prop:"bankBranch"},{default:l(()=>[u(f,{classType:"tig-form-input",modelValue:e.value.bankBranch,"onUpdate:modelValue":t[3]||(t[3]=o=>e.value.bankBranch=o),placeholder:"请输入分行名称"},null,8,["modelValue"])]),_:1})):T("",!0),e.value.accountType===1?(i(),g(n,{key:1,label:"银行卡详情",prop:"bankName"},{default:l(()=>[u(f,{classType:"tig-form-input",modelValue:e.value.bankName,"onUpdate:modelValue":t[4]||(t[4]=o=>e.value.bankName=o),rows:4,placeholder:"请选择银行卡账号",type:"textarea"},null,8,["modelValue"])]),_:1})):T("",!0)]),_:1},8,["model"]))}}});export{ue as default};
