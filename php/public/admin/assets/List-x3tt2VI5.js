/* empty css             */import"./index-DVG44k_-.js";import{P as G}from"./PopSelect.vue_vue_type_style_index_0_scoped_5832cf6b_lang-B9ASxJaT.js";import{d as j,v as E,r as b,ak as J,o as K,e as r,f as g,g as m,h as t,y as o,K as a,l,i as d,k as h,F as M,m as R,j as H,t as u,J as A}from"./index-BEWhCL1q.js";import{_ as Q}from"./Switch.vue_vue_type_script_setup_true_lang-4ZoJqbbn.js";import{D as W}from"./DeleteRecord-C4_57oHW.js";/* empty css                                                                    */import{P as X}from"./Pagination-4FaohhlG.js";import{u as S,d as Y,a as Z,g as tt,b as et}from"./productActivity--3tpTIGZ.js";import{_ as w}from"./DialogForm.vue_vue_type_script_setup_true_lang-CQB-6Tki.js";import"./index-BNk7xZkD.js";const ot={class:"container"},st={class:"content_wrapper"},lt={class:"bonus-wrap"},at={class:"card-wrap"},it={class:"card-wrap__container"},nt={class:"item-bg coupon-cards-item"},rt={class:"item-bg coupon-cards-item"},dt={class:"item-bg coupon-cards-item item-bg2"},pt={class:"lyecs-table-list-warp"},ct={class:"list-table-tool lyecs-search-warp"},mt={class:"advanced-search-warp list-table-tool-row"},ut={class:"simple-form-warp"},_t={class:"simple-form-field"},vt={class:"form-group"},ft={class:"control-container"},bt={class:"simple-form-field"},gt={class:"form-group"},yt={class:"control-container"},kt={class:"simple-form-field"},wt={class:"table-container"},ht={style:{position:"relative"}},At={class:"order-tips-p"},Ct={class:"green"},Ot={class:"empty-warp"},St={key:0,class:"empty-bg"},It={key:0,class:"pagination-con"},xt={key:0,class:"selected-action-warp selected-warp-left"},Vt={class:"selected-action"},jt=j({__name:"List",setup(Tt){const I=E(),C=b(),_=b(!0),y=b(0),k=b([]),i=J({page:1,size:I.get("pageSize"),sortField:"",sortOrder:"",keyword:""}),O=b([]),p=async()=>{_.value=!0;try{const n=await Z({...i});C.value=n.records,y.value=n.total;const e=await tt();O.value=e.promotionStatus}catch(n){A.error(n.message)}finally{_.value=!1}};K(()=>{p()});const x=()=>{p()},V=({prop:n,order:e})=>{i.sortField=n,i.sortOrder=e=="ascending"?"asc":e=="descending"?"desc":"",p()},T=async n=>{try{const e=await et(n,{ids:k.value});A.success("操作成功"),p()}catch(e){A.error(e.message)}},P=n=>{k.value=n.map(e=>e.promotionId)};return(n,e)=>{const v=r("el-button"),D=r("TigInput"),U=r("el-option"),z=r("el-select"),F=r("el-form"),c=r("el-table-column"),q=r("el-divider"),N=r("el-table"),B=r("a-spin"),L=r("el-popconfirm"),$=r("el-space");return m(),g("div",ot,[t("div",st,[t("div",lt,[e[11]||(e[11]=t("p",{class:"subtitle"},"按优惠方式快速创建",-1)),t("div",at,[t("div",it,[t("div",nt,[e[6]||(e[6]=t("div",null,[t("div",{class:"title"},"满减"),t("div",{class:"desc"},[t("p",null,[a("例：100元减20元"),t("br"),a("便于合理控制活动成本")])])],-1)),o(d(w),{isDrawer:"",onOkCallback:p,title:"添加减免优惠活动",width:"800px",path:"promotion/productActivity/Info",params:{act:"add",promotionType:1}},{default:l(()=>[o(v,{type:"primary"},{default:l(()=>e[5]||(e[5]=[a("立即新建",-1)])),_:1,__:[5]})]),_:1})]),t("div",rt,[e[8]||(e[8]=t("div",null,[t("div",{class:"title"},"折扣"),t("div",{class:"desc"},[t("p",null,[a("例：100元打9折"),t("br"),a("提高店铺销量和客单价")])])],-1)),o(d(w),{isDrawer:"",onOkCallback:p,title:"添加折扣优惠活动",width:"800px",path:"promotion/productActivity/Info",params:{act:"add",promotionType:2}},{default:l(()=>[o(v,{type:"primary"},{default:l(()=>e[7]||(e[7]=[a("立即新建",-1)])),_:1,__:[7]})]),_:1})]),t("div",dt,[e[10]||(e[10]=t("div",null,[t("div",{class:"title"},"赠品"),t("div",{class:"desc"},[t("p",null,[a("据会员等级可领的赠品，丰富会"),t("br"),a("员权益，凸显会员身份价值")])])],-1)),o(d(w),{isDrawer:"",onOkCallback:p,title:"添加赠品优惠活动",width:"800px",path:"promotion/productActivity/Info",params:{act:"add",promotionType:0}},{default:l(()=>[o(v,{type:"primary"},{default:l(()=>e[9]||(e[9]=[a("立即新建",-1)])),_:1,__:[9]})]),_:1})])])])]),t("div",pt,[t("div",ct,[o(F,{model:i},{default:l(()=>[t("div",mt,[t("div",ut,[t("div",_t,[t("div",vt,[e[12]||(e[12]=t("label",{class:"control-label"},[t("span",null,"活动名称：")],-1)),t("div",ft,[o(D,{name:"keyword",modelValue:i.keyword,"onUpdate:modelValue":e[0]||(e[0]=s=>i.keyword=s),placeholder:"输入活动名称"},null,8,["modelValue"])])])]),t("div",bt,[t("div",gt,[e[13]||(e[13]=t("label",{class:"control-label"},[t("span",null,"是否显示：")],-1)),t("div",yt,[o(z,{modelValue:i.isGoing,"onUpdate:modelValue":e[1]||(e[1]=s=>i.isGoing=s),clearable:""},{default:l(()=>[(m(!0),g(M,null,R(O.value,(s,f)=>(m(),H(U,{value:f+1,label:s},null,8,["value","label"]))),256))]),_:1},8,["modelValue"])])])]),t("div",kt,[o(v,{type:"primary",onClick:x},{default:l(()=>e[14]||(e[14]=[a("搜索",-1)])),_:1,__:[14]})])])])]),_:1},8,["model"])]),t("div",wt,[o(B,{spinning:_.value},{default:l(()=>[o(N,{data:C.value,"row-key":"promotionId",onSelectionChange:P,total:y.value,onSortChange:V,loading:_.value},{empty:l(()=>[t("div",Ot,[_.value?h("",!0):(m(),g("div",St,"暂无数据"))])]),default:l(()=>[o(c,{type:"selection",width:"32"}),o(c,{label:"活动名称",prop:"promotionName",width:150},{default:l(({row:s})=>[t("div",ht,[t("div",null,u(s.promotionName||"--"),1)]),t("p",At,[t("span",Ct,u(s.promotionType==1?"减免":s.promotionType==2?"折扣":"赠品"),1)])]),_:1}),o(c,{label:"起始日期",prop:"startTime",width:"150",sortable:"custom"}),o(c,{label:"截止日期",prop:"endTime",width:"150",sortable:"custom"}),o(c,{label:"金额下限",prop:"minOrderAmount",sortable:"custom"},{default:l(({row:s})=>[t("div",null,u(s.minOrderAmount),1)]),_:1}),o(c,{label:"金额上限",prop:"maxOrderAmount",sortable:"custom"},{default:l(({row:s})=>[t("div",null,u(s.maxOrderAmount),1)]),_:1}),o(c,{label:"排序",prop:"sortOrder",sortable:"custom"},{default:l(({row:s})=>[o(d(G),{label:"排序",type:"input",requestApi:d(S),"org-value":s.sortOrder,"onUpdate:orgValue":f=>s.sortOrder=f,params:{id:s.promotionId,field:"sortOrder"},extra:"默认值为50，数值越小，排序越靠前"},{default:l(()=>[t("div",null,u(s.sortOrder),1)]),_:2},1032,["requestApi","org-value","onUpdate:orgValue","params"])]),_:1}),o(c,{label:"状态",prop:"productStatus"}),o(c,{label:"是否启用",prop:"isShow",sortable:"custom"},{default:l(({row:s})=>[o(d(Q),{checked:s.isAvailable,"onUpdate:checked":f=>s.isAvailable=f,requestApi:d(S),params:{id:s.promotionId,field:"isAvailable"}},null,8,["checked","onUpdate:checked","requestApi","params"])]),_:1}),o(c,{label:"操作",fixed:"right"},{default:l(({row:s})=>[o(d(w),{isDrawer:"",onOkCallback:p,title:"编辑优惠活动",width:"800px",path:"promotion/productActivity/Info",params:{act:"detail",id:s.promotionId}},{default:l(()=>e[15]||(e[15]=[t("a",{class:"btn-link"},"编辑",-1)])),_:2,__:[15]},1032,["params"]),o(q,{direction:"vertical"}),o(d(W),{onAfterDelete:p,requestApi:d(Y),params:{id:s.promotionId}},{default:l(()=>e[16]||(e[16]=[a("删除",-1)])),_:2,__:[16]},1032,["requestApi","params"])]),_:1})]),_:1},8,["data","total","loading"])]),_:1},8,["spinning"]),y.value>0?(m(),g("div",It,[o(d(X),{page:i.page,"onUpdate:page":e[2]||(e[2]=s=>i.page=s),size:i.size,"onUpdate:size":e[3]||(e[3]=s=>i.size=s),total:y.value,onCallback:p},null,8,["page","size","total"])])):h("",!0)]),k.value.length>0?(m(),g("div",xt,[t("div",Vt,[o($,null,{default:l(()=>[t("span",null,[e[17]||(e[17]=a("已选择：",-1)),t("b",null,u(k.value.length),1),e[18]||(e[18]=a(" 项",-1))]),o(L,{title:"您确认要批量删除所选数据吗？",onConfirm:e[4]||(e[4]=s=>T("del"))},{reference:l(()=>[o(v,null,{default:l(()=>e[19]||(e[19]=[a("批量删除",-1)])),_:1,__:[19]})]),_:1})]),_:1})])])):h("",!0)])])])}}});export{jt as default};
