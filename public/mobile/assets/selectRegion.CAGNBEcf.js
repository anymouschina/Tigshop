import{Y as e,e as a,E as l,R as s,r as t,O as o,c as u,w as n,q as i,y as d,o as r,a as c,i as g,b as m,t as p,D as h,J as v,F as f,T as y,z as _,S as w,H as V,_ as k}from"./index-BKzbZvRR.js";import{b as I}from"./tig-layout.BpNdXByQ.js";const b=k(a({__name:"selectRegion",props:{show:{type:Boolean,default:!1,required:!0},height:{type:String,default:"60vh"},modelValue:{type:Array,default:()=>[]}},emits:["update:show","update:modelValue","sendRegionNames"],setup(a,{emit:k}){const{t:b}=l(),R=a,j=k,C=s({get:()=>R.show,set:()=>{j("update:show",!1)}}),N=t([]),E=t(0),q=async()=>{try{let a="";R.modelValue.length>0&&(a=R.modelValue.join(","));const l=await(a=>e({url:"sys/region/getRegion",method:"get",params:{regionIds:a}}))(a);Object.assign(N.value,l),N.value.length>1?N.value[N.value.length-1].length>0?E.value=N.value.length-1:E.value=N.value.length-2:E.value=0}catch(a){}};o((()=>R.modelValue),((e,a)=>{e&&q()}),{immediate:!0,deep:!0});const x=e=>R.modelValue.includes(e),O=s((()=>{let e=[];return N.value.forEach(((a,l)=>{if(a.length>0){let s=!1;a.forEach((a=>{x(a.regionId)&&(e[l]=a.regionName,s=!0)})),0==s&&(e[l]=b("请选择地区"))}})),e}));return(e,a)=>{const l=g,s=w,t=i(d("tig-popup"),I);return r(),u(t,{show:C.value,"onUpdate:show":a[0]||(a[0]=e=>C.value=e),position:"bottom"},{default:n((()=>[c(l,{class:"select-region-main"},{default:n((()=>[c(l,{class:"popup-title"},{default:n((()=>[m(p(e.$t("选择地区")),1)])),_:1}),c(l,{class:"content"},{default:n((()=>[c(l,{class:"region-menu"},{default:n((()=>[(r(!0),h(f,null,v(O.value,((a,s)=>(r(),u(l,{class:y(["region-menu-item",{active:E.value===s}]),onClick:e=>E.value=s,key:s},{default:n((()=>[m(p(a||e.$t("请选择")),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),(r(!0),h(f,null,v(N.value,((e,a)=>(r(),h(f,{key:a},[E.value===a?(r(),u(s,{key:0,"scroll-y":"true",class:"region-list"},{default:n((()=>[(r(!0),h(f,null,v(e,(e=>(r(),u(l,{class:y(["region-list-item",{active:x(e.regionId)}]),key:e.regionId,onClick:V((l=>(async(e,a)=>{e>=0&&e<=R.modelValue.length&&(R.modelValue[e]=a,R.modelValue.splice(e+1)),await q(),N.value.length==e+1||0==N.value[e+1].length?(j("update:modelValue",R.modelValue),j("update:show",!1),j("sendRegionNames",O.value)):E.value=e+1})(a,e.regionId)),["stop"])},{default:n((()=>[m(p(e.regionName),1)])),_:2},1032,["class","onClick"])))),128))])),_:2},1024)):_("",!0)],64)))),128))])),_:1})])),_:1})])),_:1},8,["show"])}}}),[["__scopeId","data-v-0d65b78a"]]);export{b as s};
