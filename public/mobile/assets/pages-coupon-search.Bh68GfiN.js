import{am as e,an as a,ao as t,aq as o,ap as l,ba as s,k as c,l as r,m as n,n as i,w as u,q as h,T as d,aB as p,t as y,v as f,x as m,V as _,I as g,B as b,C as k,N as S,d as C,r as v,o as w,H as x,y as I,J as B,F as $,K as A,ak as j,ar as T,O as V}from"./index-Do_Cb7fn.js";import{_ as H}from"./u-icon.CBDMG2rO.js";import{_ as z}from"./_plugin-vue_export-helper.BCo6x5W8.js";const F=z({name:"u-search",mixins:[a,t,{props:{shape:{type:String,default:()=>e.search.shape},bgColor:{type:String,default:()=>e.search.bgColor},placeholder:{type:String,default:()=>e.search.placeholder},clearabled:{type:Boolean,default:()=>e.search.clearabled},focus:{type:Boolean,default:()=>e.search.focus},showAction:{type:Boolean,default:()=>e.search.showAction},actionStyle:{type:Object,default:()=>e.search.actionStyle},actionText:{type:String,default:()=>e.search.actionText},inputAlign:{type:String,default:()=>e.search.inputAlign},inputStyle:{type:Object,default:()=>e.search.inputStyle},disabled:{type:Boolean,default:()=>e.search.disabled},borderColor:{type:String,default:()=>e.search.borderColor},searchIconColor:{type:String,default:()=>e.search.searchIconColor},color:{type:String,default:()=>e.search.color},placeholderColor:{type:String,default:()=>e.search.placeholderColor},searchIcon:{type:String,default:()=>e.search.searchIcon},searchIconSize:{type:[Number,String],default:()=>e.search.searchIconSize},margin:{type:String,default:()=>e.search.margin},animation:{type:Boolean,default:()=>e.search.animation},modelValue:{type:String,default:()=>e.search.value},value:{type:String,default:()=>e.search.value},maxlength:{type:[String,Number],default:()=>e.search.maxlength},height:{type:[String,Number],default:()=>e.search.height},label:{type:[String,Number,null],default:()=>e.search.label},adjustPosition:{type:Boolean,default:()=>!0},autoBlur:{type:Boolean,default:()=>!1}}}],data(){return{keyword:"",showClear:!1,show:!1,focused:this.focus}},watch:{keyword(e){this.$emit("update:modelValue",e),this.$emit("change",e)},modelValue:{immediate:!0,handler(e){this.keyword=e}}},computed:{showActionBtn(){return!this.animation&&this.showAction}},emits:["clear","search","custom","focus","blur","click","clickIcon","update:modelValue","change"],methods:{addStyle:o,addUnit:l,inputChange(e){this.keyword=e.detail.value},clear(){this.keyword="",this.$nextTick((()=>{this.$emit("clear")}))},search(e){this.$emit("search",e.detail.value);try{s()}catch(a){}},custom(){this.$emit("custom",this.keyword);try{s()}catch(e){}},getFocus(){this.focused=!0,this.animation&&this.showAction&&(this.show=!0),this.$emit("focus",this.keyword)},blur(){setTimeout((()=>{this.focused=!1}),100),this.show=!1,this.$emit("blur",this.keyword)},clickHandler(){this.disabled&&this.$emit("click")},clickIcon(e){this.$emit("clickIcon",this.keyword);try{s()}catch(a){}}}},[["render",function(e,a,t,o,l,s){const C=b,v=c(r("u-icon"),H),w=k,x=S;return n(),i(w,{class:"u-search",onClick:s.clickHandler,style:d([{margin:e.margin},s.addStyle(e.customStyle)])},{default:u((()=>[h(w,{class:"u-search__content",style:d({backgroundColor:e.bgColor,borderRadius:"round"==e.shape?"100px":"4px",borderColor:e.borderColor})},{default:u((()=>[e.$slots.label||null!==e.label?p(e.$slots,"label",{key:0},(()=>[h(C,{class:"u-search__content__label"},{default:u((()=>[y(f(e.label),1)])),_:1})]),!0):m("",!0),h(w,{class:"u-search__content__icon"},{default:u((()=>[h(v,{onClick:s.clickIcon,size:e.searchIconSize,name:e.searchIcon,color:e.searchIconColor?e.searchIconColor:e.color},null,8,["onClick","size","name","color"])])),_:1}),h(x,{"confirm-type":"search",onBlur:s.blur,value:l.keyword,onConfirm:s.search,onInput:s.inputChange,disabled:e.disabled,onFocus:s.getFocus,focus:e.focus,maxlength:e.maxlength,"adjust-position":e.adjustPosition,"auto-blur":e.autoBlur,"placeholder-class":"u-search__content__input--placeholder",placeholder:e.placeholder,"placeholder-style":`color: ${e.placeholderColor}`,class:"u-search__content__input",type:"text",style:d([{textAlign:e.inputAlign,color:e.color,backgroundColor:e.bgColor,height:s.addUnit(e.height)},e.inputStyle])},null,8,["onBlur","value","onConfirm","onInput","disabled","onFocus","focus","maxlength","adjust-position","auto-blur","placeholder","placeholder-style","style"]),l.keyword&&e.clearabled&&l.focused?(n(),i(w,{key:1,class:"u-search__content__icon u-search__content__close",onClick:s.clear},{default:u((()=>[h(v,{name:"close",size:"11",color:"#ffffff",customStyle:"line-height: 12px"})])),_:1},8,["onClick"])):m("",!0)])),_:3},8,["style"]),h(C,{style:d([e.actionStyle]),class:_(["u-search__action",[(s.showActionBtn||l.show)&&"u-search__action--active"]]),onClick:g(s.custom,["stop","prevent"])},{default:u((()=>[y(f(e.actionText),1)])),_:1},8,["style","class","onClick"])])),_:3},8,["onClick","style"])}],["__scopeId","data-v-54aceb98"]]),N=z(C({__name:"search",setup(e){const a=v(""),t=()=>{a.value?(o.value.unshift(a.value),o.value=[...new Set(o.value)],o.value.length>10&&o.value.splice(10,o.value.length-10),A("couponSearchHistory",o.value),j({success:()=>{T("coupon-search-return",a.value)}})):j({success:()=>{T("coupon-search-return","")}})},o=v([]);w((e=>{x("couponSearchHistory")&&(o.value=x("couponSearchHistory"))}));const l=()=>{o.value=[],V("couponSearchHistory")};return(e,s)=>{const d=c(r("up-search"),F),p=b,_=k;return n(),i(_,{class:"coupon-search"},{default:u((()=>[h(d,{onSearch:t,shape:"square",modelValue:a.value,"onUpdate:modelValue":s[0]||(s[0]=e=>a.value=e),actionText:e.$t("取消"),onCustom:t},null,8,["modelValue","actionText"]),o.value.length?(n(),i(_,{key:0,class:"search_init_box"},{default:u((()=>[h(_,{class:"search_history_box"},{default:u((()=>[h(_,{class:"title"},{default:u((()=>[y(f(e.$t("搜索历史"))+" ",1),h(_,{class:"clear_history",onClick:g(l,["stop"])},{default:u((()=>[h(p,{class:"iconfont-h5 icon-shanchu"})])),_:1})])),_:1}),h(_,{class:"list acea-row"},{default:u((()=>[(n(!0),I($,null,B(o.value,((e,a)=>(n(),i(_,{key:a,class:"item",onClick:a=>(e=>{j({success:()=>{T("coupon-search-return",e)}})})(e)},{default:u((()=>[y(f(e),1)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})])),_:1})):m("",!0)])),_:1})}}}),[["__scopeId","data-v-49960363"]]);export{N as default};
