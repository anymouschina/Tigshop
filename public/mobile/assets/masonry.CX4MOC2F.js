import{d as e,r as t,P as a,k as s,l as i,m as l,n as o,w as c,q as n,y as u,J as p,F as r,V as d,C as _,aB as f,t as y,v as m,x as h,s as k,E as g,I as x,Y as v,L as S,B as b,D as C}from"./index-Do_Cb7fn.js";import{_ as z}from"./tig-image.D5KdQk-t.js";import{_ as L}from"./format-price.D2lH_-yv.js";import{_ as j}from"./u-loading-icon.rQrrZF_r.js";import{s as $}from"./specification.C7sO8fab.js";import{a as D}from"./activityCard._4qx8gud.js";import{_ as w}from"./_plugin-vue_export-helper.BCo6x5W8.js";const I=w(e({__name:"masonry",props:{commodityList:{type:Array,default:""},promotionList:{type:Object,default:{}},type:{type:String,default:""}},emits:["callback"],setup(e,{emit:w}){const I=e,O=w,U=()=>{O("callback")},A=t([]),V=t([]),B=t([]),E=async()=>{if(!A.value.length)return;let e=A.value[0];if(!e)return;let t=V.value.length,a=B.value.length;t<a?V.value.push(e):t>a?B.value.push(e):V.value.push(e),A.value.splice(0,1),A.value.length&&setTimeout((()=>{E()}),25)};a((()=>I.commodityList),((e,t)=>{let a=Array.isArray(t)&&t.length>0?t.length:0;var s;e&&(A.value=[...A.value,...(s=e.slice(a),JSON.parse(JSON.stringify(s)))],A.value.forEach((e=>{e.is_check=!1})),E())}),{immediate:!0});const F=e=>{let t,a,s;if(t=I.promotionList[e.product_id],t&&t.activity_info&&t.activity_info[0].sku_ids&&(a=t.activity_info[0].sku_ids[0]),"exchange"===I.type)s=`id=${e.id}&type=exchange`;else s=`id=${e.product_id}`;s=a?`${s}&sku_id=${a}`:s,S({url:"/pages/productDetail/index?"+s})},J=e=>{S({url:`/pages/shop/index?shop_id=${e}`})},N=t(0),P=t(),q=t({}),G=e=>{if(!e.is_check){if("exchange"===I.type)N.value=e.id;else N.value=e.product_id;e.is_check=!0,q.value=e}},K=()=>{P.value.handleShowPopup(),q.value.is_check=!1},R=()=>{N.value=0};return(t,a)=>{const S=s(i("tig-image"),z),w=_,I=s(i("format-price"),L),O=b,A=C,E=s(i("up-loading-icon"),j);return l(),o(w,null,{default:c((()=>[n(w,{class:d(["masonry",{show:V.value.length>0}])},{default:c((()=>[n(w,{id:"left-item",class:"masonry-item"},{default:c((()=>[(l(!0),u(r,null,p(V.value,(a=>f(t.$slots,"left",{key:a.id,item:a},(()=>[n(w,{class:"item-li",onClick:e=>F(a)},{default:c((()=>[n(w,{class:"photo"},{default:c((()=>[n(S,{src:a.pic_thumb,"onUpdate:src":e=>a.pic_thumb=e,mode:"widthFix"},null,8,["src","onUpdate:src"]),n(w,{class:"product-status-box"},{default:c((()=>[a.product_sku&&0===a.product_sku.length&&0==a.product_stock?(l(),o(w,{key:0,class:"outsale"},{default:c((()=>[y(m(t.$t("已售罄")),1)])),_:1})):h("",!0)])),_:2},1024)])),_:2},1024),n(w,{class:"info"},{default:c((()=>[n(w,{class:"detail"},{default:c((()=>[y(m(a.product_name),1)])),_:2},1024),Object.keys(e.promotionList).length>0?(l(),o(w,{key:0,class:"flex activity-box"},{default:c((()=>[e.promotionList[a.product_id]&&e.promotionList[a.product_id].activity_info?(l(!0),u(r,{key:0},p(e.promotionList[a.product_id].activity_info,(e=>(l(),o(D,{key:e.promotion_id,activityInfo:e},null,8,["activityInfo"])))),128)):h("",!0)])),_:2},1024)):h("",!0),n(w,{class:"action"},{default:c((()=>[n(w,{class:"pricenum"},{default:c((()=>["exchange"===e.type?(l(),o(w,{key:0,class:"exchange-box"},{default:c((()=>[n(I,{fontStyle:{fontSize:"32rpx"},currencyStyle:{fontSize:"22rpx"},decimalsStyle:{fontSize:"25rpx"},priceData:a.discounts_price},null,8,["priceData"]),n(O,{class:"exchange-icon"},{default:c((()=>[y("+")])),_:1}),n(A,{class:"exchange-img",src:k(g)("exchange/exchange.png")},null,8,["src"]),n(O,{class:"exchange-text"},{default:c((()=>[y(m(a.exchange_integral),1)])),_:2},1024)])),_:2},1024)):(l(),o(I,{key:1,fontStyle:{fontSize:"32rpx"},currencyStyle:{fontSize:"22rpx"},decimalsStyle:{fontSize:"25rpx"},priceData:a.product_price},null,8,["priceData"]))])),_:2},1024),n(w,{class:"buy_btn",onClick:x((e=>G(a)),["stop"])},{default:c((()=>[a.is_check?(l(),o(E,{key:0,size:"22",mode:"circle"})):(l(),u(r,{key:1},["exchange"===e.type?(l(),u(r,{key:0},[],64)):(l(),o(O,{key:1,class:"iconfont-h5 icon-gouwuche3 buy_btn_icon"}))],64))])),_:2},1032,["onClick"])])),_:2},1024),a.shopSimple&&k(v)()?(l(),o(w,{key:1,class:"shop",onClick:x((e=>J(a.shopSimple.shop_id)),["stop"])},{default:c((()=>[n(w,{class:"shop-name"},{default:c((()=>[y(m(a.shopSimple.shop_title),1)])),_:2},1024),n(w,{class:"shop-btn"},{default:c((()=>[y(m(t.$t("进店"))+" ",1),n(O,{class:"iconfont-h5 icon-youjiantou"})])),_:1})])),_:2},1032,["onClick"])):h("",!0)])),_:2},1024)])),_:2},1032,["onClick"])]),!0))),128))])),_:3}),n(w,{id:"right-item",class:"masonry-item"},{default:c((()=>[(l(!0),u(r,null,p(B.value,(a=>f(t.$slots,"right",{key:a.id,item:a},(()=>[n(w,{class:"item-li",onClick:e=>F(a)},{default:c((()=>[n(w,{class:"photo"},{default:c((()=>[n(S,{src:a.pic_thumb,"onUpdate:src":e=>a.pic_thumb=e,mode:"widthFix"},null,8,["src","onUpdate:src"]),n(w,{class:"product-status-box"},{default:c((()=>[a.product_sku&&0===a.product_sku.length&&0==a.product_stock?(l(),o(w,{key:0,class:"outsale"},{default:c((()=>[y(m(t.$t("已售罄")),1)])),_:1})):h("",!0)])),_:2},1024)])),_:2},1024),n(w,{class:"info"},{default:c((()=>[n(w,{class:"detail"},{default:c((()=>[y(m(a.product_name),1)])),_:2},1024),Object.keys(e.promotionList).length>0?(l(),o(w,{key:0,class:"flex activity-box"},{default:c((()=>[e.promotionList[a.product_id]&&e.promotionList[a.product_id].activity_info?(l(!0),u(r,{key:0},p(e.promotionList[a.product_id].activity_info,(e=>(l(),o(D,{key:e.promotion_id,activityInfo:e},null,8,["activityInfo"])))),128)):h("",!0)])),_:2},1024)):h("",!0),n(w,{class:"action"},{default:c((()=>[n(w,{class:"pricenum"},{default:c((()=>["exchange"===e.type?(l(),o(w,{key:0,class:"exchange-box"},{default:c((()=>[n(I,{fontStyle:{fontSize:"32rpx"},currencyStyle:{fontSize:"22rpx"},decimalsStyle:{fontSize:"25rpx"},priceData:a.discounts_price},null,8,["priceData"]),n(O,{class:"exchange-icon"},{default:c((()=>[y("+")])),_:1}),n(A,{class:"exchange-img",src:k(g)("exchange/exchange.png")},null,8,["src"]),n(O,{class:"exchange-text"},{default:c((()=>[y(m(a.exchange_integral),1)])),_:2},1024)])),_:2},1024)):(l(),o(I,{key:1,fontStyle:{fontSize:"32rpx"},currencyStyle:{fontSize:"22rpx"},decimalsStyle:{fontSize:"25rpx"},priceData:a.product_price},null,8,["priceData"]))])),_:2},1024),n(w,{class:"buy_btn",onClick:x((e=>G(a)),["stop"])},{default:c((()=>[a.is_check?(l(),o(E,{key:0,size:"22",mode:"circle"})):(l(),u(r,{key:1},["exchange"===e.type?(l(),u(r,{key:0},[],64)):(l(),o(O,{key:1,class:"iconfont-h5 icon-gouwuche3 buy_btn_icon"}))],64))])),_:2},1032,["onClick"])])),_:2},1024),a.shopSimple&&k(v)()?(l(),o(w,{key:1,class:"shop",onClick:x((e=>J(a.shopSimple.shop_id)),["stop"])},{default:c((()=>[n(w,{class:"shop-name"},{default:c((()=>[y(m(a.shopSimple.shop_title),1)])),_:2},1024),n(w,{class:"shop-btn"},{default:c((()=>[y(m(t.$t("进店"))+" ",1),n(O,{class:"iconfont-h5 icon-youjiantou"})])),_:1})])),_:2},1032,["onClick"])):h("",!0)])),_:2},1024)])),_:2},1032,["onClick"])]),!0))),128))])),_:3})])),_:3},8,["class"]),n($,{ref_key:"specificationRef",ref:P,modelValue:N.value,"onUpdate:modelValue":a[0]||(a[0]=e=>N.value=e),type:e.type,onAddCardSucceed:U,onLoadEnd:K,onClose:R},null,8,["modelValue","type"])])),_:3})}}}),[["__scopeId","data-v-2a989c7a"]]);export{I as m};
