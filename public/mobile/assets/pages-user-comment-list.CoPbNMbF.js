import{e,G as a,Q as t,r as l,g as s,k as c,h as u,b0 as o,c as n,w as r,N as i,a9 as d,aa as m,v as p,z as _,o as f,a as v,i as g,A as y,E as b,F as h,K as x,T as k,d as w,b as $,t as j,$ as z,B as C,a7 as U,C as D,D as S,aV as T,a3 as V,M as F,_ as M}from"./index-BKXBH4vI.js";import{_ as q}from"./uni-badge.BNHThzBW.js";import{_ as A}from"./tig-image.BbZoJ9nS.js";import{_ as E}from"./format-price.0qAAshfo.js";import{_ as I,a as K}from"./tig-layout.DMoUsUKf.js";import{_ as N}from"./uni-rate.CVLwPHjC.js";import{_ as B}from"./loading-box.BnnJRdlH.js";import{n as G}from"./index.xrDesKlL.js";import{b as H}from"./order.BjcCWkE9.js";import{g as Q,a as J,b as L}from"./comment.Duzh5iFl.js";import"./uni-icons.C94_g2wt.js";const O=M(e({__name:"list",setup(e){const{t:M}=a(),O={navbar:"1",return:"1",title:"订单评价",showHome:!0,color:!1},P=t([{type:0,value:M("待评价"),num:0},{type:1,value:M("待晒单"),num:0},{type:2,value:M("已评价"),num:0}]),R=l(0),W=t({page:1,size:10}),X=l(!1),Y=l([]),Z=l(0),ee=async()=>{W.page>1?X.value=!0:d({title:M("加载中")});try{let e=[];0==R.value&&(e=await H({...W,comment_status:0})),1==R.value&&(e=await J({...W})),2==R.value&&(e=await L({...W})),Y.value=[...Y.value,...e.filter_result],Z.value=e.total}catch(e){i({title:e.message,icon:"none",duration:1e3})}finally{m(),X.value=!1}};return s((e=>{e&&e.currentType&&(R.value=Number(e.currentType)),(async()=>{try{const e=await Q();P[0].size=e.item.await_comment,P[1].size=e.item.show_pics,P[2].size=e.item.commented}catch(e){i({title:e.message,icon:"none",duration:1e3})}})(),ee()})),c((()=>{W.page<Math.ceil(Z.value/W.size)&&(W.page++,ee())})),u((()=>{o()})),(e,a)=>{const t=w,l=p(_("uni-badge"),q),s=g,c=p(_("tig-image"),A),u=p(_("format-price"),E),o=z,i=p(_("tig-button"),K),d=p(_("uni-rate"),N),m=D,M=p(_("loading-box"),B),H=p(_("tig-layout"),I);return f(),n(H,null,{default:r((()=>[v(s,{class:"order"},{default:r((()=>[v(G,{parameter:O}),v(s,{class:"order-menu"},{default:r((()=>[(f(!0),b(h,null,x(P,(e=>(f(),n(s,{key:e.type,class:k(["order-menu-item",{active:R.value===e.type}]),onClick:a=>{return t=e.type,R.value=t,Y.value=[],W.page=1,void ee();var t}},{default:r((()=>[e.num>0?(f(),n(l,{key:0,class:"badgecolor",text:e.num,absolute:"rightTop",size:"small"},{default:r((()=>[v(t,{class:"order-menu-item-text"},{default:r((()=>[$(j(e.value),1)])),_:2},1024)])),_:2},1032,["text"])):(f(),n(t,{key:1,class:"order-menu-item-text"},{default:r((()=>[$(j(e.value),1)])),_:2},1024))])),_:2},1032,["class","onClick"])))),128))])),_:1}),v(s,{class:"placeholder"}),R.value<2?(f(),n(s,{key:0,class:"order-list"},{default:r((()=>[(f(!0),b(h,null,x(Y.value,(a=>(f(),n(s,{key:a.order_id,class:"order-list-item"},{default:r((()=>[v(s,{class:"order-list-item-header"},{default:r((()=>[v(t,{class:"special-text"},{default:r((()=>[$(j(e.$t("订单编号"))+"：",1),v(t,{class:"special-color"},{default:r((()=>[$(j(a.order_sn),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),v(s,{class:"order-list-item-content"},{default:r((()=>[v(s,{class:"item-content-product"},{default:r((()=>[(f(!0),b(h,null,x(a.items,(e=>(f(),n(o,{key:e.product_id,url:"/pages/productDetail/index?id="+e.product_id,"hover-class":"navigator-hover"},{default:r((()=>[v(s,{class:"item-content-product-item"},{default:r((()=>[v(s,{class:"item-content-product-img"},{default:r((()=>[v(c,{src:e.pic_thumb,"onUpdate:src":a=>e.pic_thumb=a},null,8,["src","onUpdate:src"])])),_:2},1024),v(s,{class:"item-content-product-info"},{default:r((()=>[v(s,{class:"product-item-title"},{default:r((()=>[$(j(e.product_name),1)])),_:2},1024),v(s,{class:"product-item-price"},{default:r((()=>[v(u,{showText:!1,decimalsStyle:{fontSize:"25rpx"},currencyStyle:{fontSize:"23rpx"},class:"product-item-pricenum",priceData:e.price},null,8,["priceData"]),v(s,{class:"product-item-quantity"},{default:r((()=>[$("x "+j(e.quantity),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["url"])))),128))])),_:2},1024)])),_:2},1024),v(s,{class:"order-list-item-btn"},{default:r((()=>[v(s,{class:"item-btn-box"},{default:r((()=>[v(i,{plain:!0,customStyle:{height:"55rpx"},plainMainColor:!0,onClick:e=>{return t=a.order_id,void F({url:`/pages/user/comment/info?id=${t}`});var t}},{default:r((()=>[$(j(0==R.value?e.$t("去评价"):e.$t("待晒单")),1)])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})):(f(),n(s,{key:1,class:"comment-list"},{default:r((()=>[(f(!0),b(h,null,x(Y.value,(a=>(f(),n(s,{class:"comment-item flex",key:a.order_id},{default:r((()=>[v(s,{class:"comment-header"},{default:r((()=>[a.pic_thumb?(f(),n(c,{key:0,class:"head",src:a.pic_thumb,"onUpdate:src":e=>a.pic_thumb=e,mode:"aspectFill"},null,8,["src","onUpdate:src"])):y("",!0)])),_:2},1024),v(s,{class:"comment-info"},{default:r((()=>[v(s,{class:"comment-label flex align-center"},{default:r((()=>[v(s,{class:"name"},{default:r((()=>[$(j(e.$t("评价"))+":",1)])),_:1}),v(s,{class:"content flex align-center justify-between"},{default:r((()=>[v(d,{value:a.comment_rank,color:"#bfbfbf",readonly:!0,"active-color":"#ffa800",size:"18"},null,8,["value"]),v(s,{class:"time"},{default:r((()=>[$(j(a.add_time),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),v(s,{class:"comment-label flex",onClick:e=>{return t=a.product_id,void V({url:`/pages/productDetail/index?id=${t}`});var t}},{default:r((()=>[v(s,{class:"name"},{default:r((()=>[$(j(e.$t("商品名称"))+":",1)])),_:1}),v(s,{class:"content"},{default:r((()=>[v(s,{class:"product-name line1"},{default:r((()=>[$(j(a.product_name||"--"),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"]),v(s,{class:"comment-label flex"},{default:r((()=>[v(s,{class:"name"},{default:r((()=>[$(j(e.$t("评价标签"))+":",1)])),_:1}),v(s,{class:"content flex-wrap"},{default:r((()=>[(f(!0),b(h,null,x(a.comment_tag,(e=>(f(),n(s,{class:"product-tag"},{default:r((()=>[$(j(e),1)])),_:2},1024)))),256))])),_:2},1024)])),_:2},1024),v(s,{class:"comment-label flex"},{default:r((()=>[v(s,{class:"name"},{default:r((()=>[$(j(e.$t("评价内容"))+":",1)])),_:1}),v(s,{class:"content"},{default:r((()=>[v(s,{class:"cont"},{default:r((()=>[$(j(a.content),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),a.reply?(f(),n(s,{key:0,class:"comment-label flex"},{default:r((()=>[v(s,{class:"name"},{default:r((()=>[$(j(e.$t("客服答复"))+":",1)])),_:1}),v(s,{class:"content"},{default:r((()=>[v(t,{class:"cont"},{default:r((()=>{var e;return[$(j(null==(e=a.reply)?void 0:e.content),1)]})),_:2},1024)])),_:2},1024)])),_:2},1024)):y("",!0),v(s,{class:"comment-label flex"},{default:r((()=>[v(s,{class:"name"},{default:r((()=>[$(j(e.$t("晒单"))+":",1)])),_:1}),a.show_pics.length>0?(f(),n(s,{key:0,class:"content flex-wrap"},{default:r((()=>[(f(!0),b(h,null,x(a.show_pics,(e=>(f(),n(s,{class:"product-pic"},{default:r((()=>[v(c,{src:e.pic_thumb,"onUpdate:src":a=>e.pic_thumb=a,mode:"aspectFill",onClick:a=>{return t=C(U)(e.pic_url),void T({urls:[t]});var t}},null,8,["src","onUpdate:src","onClick"])])),_:2},1024)))),256))])),_:2},1024)):y("",!0)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})),0==Y.value.length?(f(),n(s,{key:2,class:"empty-box"},{default:r((()=>[v(s,{class:"pictrue"},{default:r((()=>[v(m,{src:C(S)("common/data_empty.png")},null,8,["src"])])),_:1}),v(s,{class:"txt"},{default:r((()=>[$(j(e.$t("暂无评价")),1)])),_:1})])),_:1})):y("",!0),v(M,{modelValue:X.value,"onUpdate:modelValue":a[0]||(a[0]=e=>X.value=e),page:W.page,length:Y.value.length},null,8,["modelValue","page","length"])])),_:1})])),_:1})}}}),[["__scopeId","data-v-897ee407"]]);export{O as default};
