import{e as a,r as e,c as t,o as l,i as s,w as o,a as c,A as u,T as i,ay as r,_ as n,a2 as d,R as p,G as m,D as f,v as _,z as v,S as h,E as g,K as y,J as b,F as w,b as k,t as x,a7 as C,ac as V,aV as $,B as j,H as I,aB as P,af as D,ak as U,al as S,C as z,aZ as F,aX as q,aD as B,aF as L,aY as T,N as H,f as M,Q as N,g as O,h as R,b0 as A,at as E,d as G,ah as J,M as K,a_ as Q}from"./index-BKXBH4vI.js";import{_ as W}from"./tig-image.BbZoJ9nS.js";import{_ as X}from"./tig-qrcode.CpruMLXZ.js";import{b as Y,g as Z,e as aa,_ as ea}from"./tig-layout.DMoUsUKf.js";import{m as ta,f as la,g as sa}from"./salesman.CxOPGtEY.js";import{s as oa}from"./searchInput.CP9DQ8PZ.js";import{_ as ca}from"./tig-fixed-placeholder.BHdfEiP8.js";import{_ as ua}from"./uni-icons.C94_g2wt.js";import{_ as ia}from"./uni-transition.B095q5__.js";import{e as ra}from"./empty.CM0AaKdC.js";import{u as na}from"./useList.D_gHwM0_.js";import"./empty.vue_vue_type_style_index_0_scoped_b2f6c60f_lang.BgK1t0Rd.js";import"./product.BhwveQst.js";const da=n(a({__name:"materialPopover",setup(a){const n=e(!1),d=()=>{n.value=!n.value};return(a,e)=>{const p=s;return l(),t(p,{class:"material-popover"},{default:o((()=>[c(p,{class:i(["popover-masking",{show:n.value}]),onClick:d},null,8,["class"]),n.value?(l(),t(p,{key:0,class:i(["popover-content-box",{show:n.value}])},{default:o((()=>[c(p,{class:i(["popover-content",{enter:n.value,leave:!n.value}]),onClick:d},{default:o((()=>[c(p,{class:"triangle"}),r(a.$slots,"content",{show:n.value},void 0,!0)])),_:3},8,["class"])])),_:3},8,["class"])):u("",!0),c(p,{onClick:e[0]||(e[0]=a=>n.value=!n.value)},{default:o((()=>[r(a.$slots,"default",{},void 0,!0)])),_:3})])),_:3})}}}),[["__scopeId","data-v-78148723"]]),pa=n(a({__name:"materialSaveCard",props:{modelValue:{type:Boolean,default:!1},currentPics:{type:Object,default:()=>{}}},emits:["update:modelValue"],setup(a,{emit:e}){d((a=>({"5360c200":j.value})));const{t:u}=m(),i=a,r=e,n=p({get:()=>i.modelValue,set(a){r("update:modelValue",a)}}),j=p((()=>`url(${f("salesman/materialPopup.png")})`));return(e,i)=>{const r=_(v("tig-image"),W),d=s,p=h,m=_(v("tig-fixed-placeholder"),ca),f=_(v("tig-popup"),Y);return l(),t(f,{show:n.value,"onUpdate:show":i[1]||(i[1]=a=>n.value=a),zIndex:999,showClose:!1,backgroundColor:"#fff"},{default:o((()=>[c(d,{class:"share-popup"},{default:o((()=>[c(d,{class:"share-cube"},{default:o((()=>[c(p,{class:"list-box","scroll-x":"true"},{default:o((()=>[c(d,{class:"list-content"},{default:o((()=>[(l(!0),g(w,null,y(a.currentPics,(a=>(l(),t(d,{key:a.pic_id,class:"list-item",onLongpress:b((e=>(a=>{let e=C(a);V({title:u("提示"),content:u("确定要保存图片吗？"),success:async a=>{a.confirm&&$({urls:[e]})}})})(a.pic_url)),["stop"])},{default:o((()=>[c(r,{src:a.pic_url,"onUpdate:src":e=>a.pic_url=e},null,8,["src","onUpdate:src"])])),_:2},1032,["onLongpress"])))),128))])),_:1})])),_:1})])),_:1}),c(m,{height:"100rpx",backgroundColor:"#fff"},{default:o((()=>[c(d,{class:"share-cube-btn",onClick:i[0]||(i[0]=a=>e.$emit("update:modelValue",!1))},{default:o((()=>[k(x(e.$t("我知道了")),1)])),_:1})])),_:1})])),_:1})])),_:1},8,["show"])}}}),[["__scopeId","data-v-897a8bfe"]]),ma=300,fa=n(a({__name:"materialChoosePoster",props:{modelValue:{type:Boolean,default:!1},currentData:{type:Object,default:()=>{}},qrcodePath:{type:String,default:""}},emits:["update:modelValue"],setup(a,{emit:i}){d((a=>({"648c3680":j(M)+20+"rpx","2c7b1ff0":A.value+"px"})));const{t:r}=m(),n=B(),p=I("userInfo"),{safeBottom:M}=Z(),N=a,O=e(0),R=e(0),A=e(0),E=e([]),G=(a,e,t)=>({width:t=t||ma,height:e*t/a}),J=async()=>{await(async a=>{try{const e=await L(C(a));R.value=G(e.width,e.height).height,A.value=R.value+90}catch(e){}})(N.currentData.pics[O.value].pic_url);let a=q("myCanvas",n);if(E.value[O.value])return;const e=p.avatar?C(p.avatar):f("user/defaultAvatar.jpg");a.draw(),a.setFillStyle("#ffffff"),a.fillRect(0,0,ma,A.value);try{a.draw(!1,(async()=>{const t=await L(e);a.save(),a.beginPath(),a.arc(30,R.value+35,22,0,2*Math.PI),a.clip(),a.drawImage(t.path,8,R.value+12,45,45),a.restore(),setTimeout((()=>{a.draw(!0,(async()=>{const e=await L(C(N.currentData.pics[O.value].pic_url));a.drawImage(e.path,0,0,G(e.width,e.height).width,G(e.width,e.height).height),a.draw(!0,(async()=>{const e=await L(N.qrcodePath);a.drawImage(e.path,220,A.value-80,70,70),a.setFontSize(13),a.setFillStyle("#000000"),a.fillText(p.mobile,58,R.value+33),a.setFontSize(11),a.setFillStyle("#999999"),a.fillText(`${r("这个真不错，推荐你也来看看")}`,58,R.value+48),setTimeout((()=>{a.draw(!0,(()=>{K()}))}),50)}))}))}),50)}))}catch(t){}},K=()=>{T({fileType:"jpg",canvasId:"myCanvas",quality:1,destWidth:600,destHeight:2*A.value,success:function(a){E.value[O.value]=a.tempFilePath},fail:a=>{H({title:JSON.stringify(a),icon:"none",duration:3e3})}},null==n?void 0:n.proxy)};return P((()=>{D((()=>{J()}))})),(e,i)=>{const n=s,d=_(v("uni-icons"),ua),p=_(v("up-radio"),U),m=_(v("tig-image"),W),f=h,C=_(v("up-radio-group"),S),j=_(v("uni-transition"),ia),I=z,P=F;return l(),t(n,null,{default:o((()=>[c(n,{class:"overlay"},{default:o((()=>[a.currentData.pics&&a.currentData.pics.length>1?(l(),t(n,{key:0,class:"bottom-choose-box"},{default:o((()=>[c(j,{styles:{width:"100%",height:"inherit",backgroundColor:"#fff","border-radius":"30rpx 30rpx 0 0"},"mode-class":["fade","slide-bottom"],show:a.modelValue},{default:o((()=>[c(n,{class:"bottom-choose"},{default:o((()=>[c(n,{class:"bottom-choose-title"},{default:o((()=>[k(x(e.$t("选择图片，生成对应海报")),1)])),_:1}),c(n,{class:"chose-ico"},{default:o((()=>[c(d,{type:"closeempty",size:"24",color:"#c8c9cc",onClick:i[0]||(i[0]=a=>e.$emit("update:modelValue",!1))})])),_:1}),c(n,{class:"choose-img"},{default:o((()=>[c(C,{modelValue:O.value,"onUpdate:modelValue":i[2]||(i[2]=a=>O.value=a),placement:"column"},{default:o((()=>[c(f,{class:"list-box","scroll-x":"true"},{default:o((()=>[c(n,{class:"list-content"},{default:o((()=>[(l(!0),g(w,null,y(a.currentData.pics,((a,e)=>(l(),t(n,{key:a.pic_id,class:"list-item",onClick:a=>(a=>{O.value=a,J()})(e)},{default:o((()=>[c(p,{customStyle:{marginBottom:"8px",position:"absolute",top:0,right:"14rpx",zIndex:9},label:"",activeColor:"#2da641",name:e,onChange:i[1]||(i[1]=()=>{})},null,8,["name"]),c(m,{src:a.pic_url,"onUpdate:src":e=>a.pic_url=e},null,8,["src","onUpdate:src"])])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["show"])])),_:1})):u("",!0),c(n,{class:"poster-box"},{default:o((()=>[c(n,{class:"preview-wrap"},{default:o((()=>[c(n,{class:"poster-wrap"},{default:o((()=>[c(n,{class:"poster-img"},{default:o((()=>[c(I,{style:{height:"100%"},src:E.value[O.value]},null,8,["src"])])),_:1})])),_:1}),a.currentData.pics&&1===a.currentData.pics.length?(l(),t(n,{key:0,class:"preview-icon"},{default:o((()=>[c(d,{type:"close",size:"36",color:"#fff",onClick:i[3]||(i[3]=a=>e.$emit("update:modelValue",!1))})])),_:1})):u("",!0),c(n,{class:"preview-text",onLongpress:i[4]||(i[4]=b((a=>{return e=E.value[O.value],void V({title:r("提示"),content:r("确定要保存分享海报吗？"),success:function(a){a.confirm&&$({urls:[e]})}});var e}),["stop"]))},{default:o((()=>[k(x(e.$t("长按图片保存至相册")),1)])),_:1})])),_:1})])),_:1}),c(P,{class:"canvas-content",id:"myCanvas","canvas-id":"myCanvas"})])),_:1})])),_:1})}}}),[["__scopeId","data-v-f7b368ff"]]),_a=n(a({__name:"material",setup(a){d((a=>({"571f5f46":j(r)+"px","2ecb62f6":j(P)+"px","76aae866":j(n)+"px","8796b9e6":j(h),"4a0229a4":wa.value,"70bbedda":ka.value,db6b4770:xa.value})));const{t:i}=m(),{height:r,contentHeight:n,contentWidth:h,statusBarHeight:P}=aa(60),U=M(),S=I("userInfo"),z=N({keyword:"",page:1,size:10,category_id:null}),F=e([{category_id:null,category_name:i("全部")}]),{data:q,isLoading:B,total:L,getList:T}=na(ta,{params:z,path:{dataKey:"filter_result"}}),H=e(),Y=e(""),Z=a=>{z.category_id=a.category_id,q.value=[],T()},ca=()=>{q.value=[],T()},ua=()=>{q.value=[],T()},ia=e(!1),ma=e(!1),_a=e([]),va=e({}),ha=(a,e)=>{switch((async a=>{try{await sa(a)}catch(e){}})(e.id),a){case"poster":va.value=e,ba(e);break;case"friend":Q(e.content,(()=>{ia.value=!0,_a.value=e.pics}))}},ga=a=>{Y.value=a,ma.value=!0},ya=e(""),ba=a=>{var e;ya.value=a.product_id?`${U.baseInfo.h5_domain}/pages/productDetail/index?id=${a.product_id}&salesman_id=${null==(e=null==S?void 0:S.salesman)?void 0:e.salesman_id}`:U.baseInfo.h5_domain,D((()=>{var a;null==(a=H.value)||a.drawQrcode()}))},wa=p((()=>`url(${C(U.baseInfo.ico_img)})`)),ka=p((()=>`url(${f("salesman/materialFriends.png")})`)),xa=p((()=>`url(${f("salesman/materialPic.png")})`));return O((async()=>{await(async()=>{try{const a=await la();F.value=[...F.value,...a.item]}catch(a){}})(),T()})),R((()=>{A()})),(a,e)=>{const r=s,n=_(v("up-tabs"),E),d=G,p=J,m=_(v("tig-image"),W),f=_(v("tig-qrcode"),X),h=_(v("tig-layout"),ea);return l(),t(r,null,{default:o((()=>[c(h,null,{default:o((()=>[c(r,{class:"sticky"},{default:o((()=>[c(r,{class:"material-menu"},{default:o((()=>[c(r,{class:"search-box"},{default:o((()=>[c(r,{class:"status-bar"}),c(r,{class:"search-input-box"},{default:o((()=>[c(r,{class:"input"},{default:o((()=>[c(oa,{style:{width:"100%"},modelValue:z.keyword,"onUpdate:modelValue":e[0]||(e[0]=a=>z.keyword=a),onConfirm:ca,onClear:ua},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),c(r,{class:"material-content"},{default:o((()=>[c(n,{lineColor:"#5d53b7",inactiveStyle:{color:"#969799"},keyName:"category_name",scrollable:F.value.length>5,list:F.value,onClick:Z},null,8,["scrollable","list"])])),_:1})])),_:1})])),_:1}),c(r,{class:"material-content"},{default:o((()=>[c(r,{class:"material-list"},{default:o((()=>[(l(!0),g(w,null,y(j(q),(e=>(l(),t(r,{key:e.id,class:"material-item"},{default:o((()=>[c(r,{class:"material-item-content"},{default:o((()=>[c(r,{class:"material-item-left"},{default:o((()=>[c(r,{class:"item-logo"},{default:o((()=>[c(d,{class:"item-logo-bg"})])),_:1})])),_:1}),c(r,{class:"material-item-right"},{default:o((()=>[c(r,{class:"item-name"},{default:o((()=>[k(x(a.$t("分销小助手")),1)])),_:1}),c(r,{class:"item-content"},{default:o((()=>[e.content?(l(),t(p,{key:0,nodes:e.content},null,8,["nodes"])):u("",!0)])),_:2},1024),e.pics?(l(),t(r,{key:0,class:"item-images"},{default:o((()=>[(l(!0),g(w,null,y(e.pics,((a,s)=>(l(),t(r,{key:a.pic_id,class:"image-box",onClick:a=>((a,e)=>{const t=e.map((a=>C(a.pic_url||"")));$({current:t[a],urls:t})})(s,e.pics)},{default:o((()=>[c(m,{onLongpress:b((e=>(a=>{let e=C(a);V({title:i("提示"),content:i("确定要保存图片吗？"),success:async a=>{a.confirm&&$({urls:[e]})}})})(a.pic_url)),["stop"]),src:a.pic_url,"onUpdate:src":e=>a.pic_url=e},null,8,["onLongpress","src","onUpdate:src"])])),_:2},1032,["onClick"])))),128))])),_:2},1024)):u("",!0),c(r,{class:"item-tip"},{default:o((()=>[k(x(a.$t("长按图片保存到相册")),1)])),_:1}),e.product?(l(),t(r,{key:1,class:"item-product"},{default:o((()=>[c(r,{class:"item-product-text"},{default:o((()=>[k(x(a.$t("商品：")),1)])),_:1}),c(r,{class:"item-product-img",onClick:a=>{return t=`/pages/productDetail/index?id=${e.product_id}`,void K({url:t});var t}},{default:o((()=>[c(m,{src:e.product.pic_thumb,"onUpdate:src":a=>e.product.pic_thumb=a},null,8,["src","onUpdate:src"])])),_:2},1032,["onClick"])])),_:2},1024)):u("",!0),c(r,{class:"item-btn"},{default:o((()=>[c(r,{class:"item-sharenum"},{default:o((()=>[k(x(a.$t("分享"))+x(e.share_num),1)])),_:2},1024),c(da,null,{content:o((()=>[c(r,{class:"popover-btns"},{default:o((()=>[c(r,{class:"popover-btns-item",onClick:a=>ha("friend",e)},{default:o((()=>[c(d,{class:"popover-btns-item-icon icon-1"}),k(" "+x(a.$t("发朋友圈")),1)])),_:2},1032,["onClick"]),c(r,{class:"common-line"}),c(r,{class:"popover-btns-item",onClick:a=>ha("poster",e)},{default:o((()=>[c(d,{class:"popover-btns-item-icon icon-2"}),k(" "+x(a.$t("生成海报")),1)])),_:2},1032,["onClick"])])),_:2},1024)])),default:o((()=>[c(r,{class:"item-btn-content"},{default:o((()=>[c(d,{class:"round"}),c(d,{class:"round"})])),_:1})])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1}),j(B)||0!==j(L)?u("",!0):(l(),t(ra,{key:0,styles:{width:"320rpx",height:"320rpx"}})),c(f,{ref_key:"qrcodeRef",ref:H,immediatelyCreate:!0,value:ya.value,size:400,margin:10,show:!1,onSuccess:ga},null,8,["value"]),c(pa,{modelValue:ia.value,"onUpdate:modelValue":e[1]||(e[1]=a=>ia.value=a),currentPics:_a.value},null,8,["modelValue","currentPics"]),ma.value?(l(),t(fa,{key:1,modelValue:ma.value,"onUpdate:modelValue":e[2]||(e[2]=a=>ma.value=a),qrcodePath:Y.value,currentData:va.value},null,8,["modelValue","qrcodePath","currentData"])):u("",!0)])),_:1})])),_:1})}}}),[["__scopeId","data-v-487cf56a"]]);export{_a as default};
