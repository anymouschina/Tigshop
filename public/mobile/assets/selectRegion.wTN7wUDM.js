import{Z as e,d as a,G as l,R as s,r as t,P as o,k as i,l as n,m as u,n as r,w as d,q as g,t as c,v as m,y as p,J as _,F as h,C as v,V as f,I as y,x as w}from"./index-Ce4FtYLL.js";import{c as V}from"./tig-layout.nM03J4I_.js";import{_ as k}from"./_plugin-vue_export-helper.BCo6x5W8.js";const j=k(a({__name:"selectRegion",props:{show:{type:Boolean,default:!1,required:!0},height:{type:String,default:"60vh"},modelValue:{type:Array,default:()=>[]}},emits:["update:show","update:modelValue","sendRegionNames"],setup(a,{emit:k}){const{t:j}=l(),C=a,x=k,R=s({get:()=>C.show,set:()=>{x("update:show",!1)}}),b=t([]),q=t(0),E=async()=>{try{let a="";C.modelValue.length>0&&(a=C.modelValue.join(","));const l=await(a=>e({url:"sys/region/get_region",method:"get",params:{region_ids:a}}))(a);Object.assign(b.value,l.region_list),q.value=l.region_list&&l.region_list.length>1?l.region_list.length-1:0}catch(a){}};o((()=>C.modelValue),((e,a)=>{e&&E()}),{immediate:!0,deep:!0});const I=e=>C.modelValue.includes(e),N=s((()=>{let e=[];return b.value.forEach(((a,l)=>{if(a.length>0){let s=!1;a.forEach((a=>{I(a.region_id)&&(e[l]=a.region_name,s=!0)})),0==s&&(e[l]=j("请选择地区"))}})),e}));return(e,a)=>{const l=v,s=i(n("tig-popup"),V);return u(),r(s,{show:R.value,"onUpdate:show":a[0]||(a[0]=e=>R.value=e),position:"bottom"},{default:d((()=>[g(l,{class:"select-region-main"},{default:d((()=>[g(l,{class:"popup-title"},{default:d((()=>[c(m(e.$t("选择地区")),1)])),_:1}),g(l,{class:"content"},{default:d((()=>[g(l,{class:"region-menu"},{default:d((()=>[(u(!0),p(h,null,_(N.value,((a,s)=>(u(),r(l,{class:f(["region-menu-item",{active:q.value===s}]),onClick:e=>q.value=s,key:s},{default:d((()=>[c(m(a||e.$t("请选择")),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),(u(!0),p(h,null,_(b.value,((e,a)=>(u(),p(h,{key:a},[q.value===a?(u(),r(l,{key:0,class:"region-list"},{default:d((()=>[(u(!0),p(h,null,_(e,(e=>(u(),r(l,{class:f(["region-list-item",{active:I(e.region_id)}]),key:e.region_id,onClick:y((l=>(async(e,a)=>{e>=0&&e<=C.modelValue.length&&(C.modelValue[e]=a,C.modelValue.splice(e+1)),await E(),b.value.length==e+1?(x("update:modelValue",C.modelValue),x("update:show",!1),x("sendRegionNames",N.value)):q.value=e+1})(a,e.region_id)),["stop"])},{default:d((()=>[c(m(e.region_name),1)])),_:2},1032,["class","onClick"])))),128))])),_:2},1024)):w("",!0)],64)))),128))])),_:1})])),_:1})])),_:1},8,["show"])}}}),[["__scopeId","data-v-8b39957c"]]);export{j as s};
