import{r as e,v as t,u as a,bc as o,e as s,c as l,w as n,a as r,i as u,aE as i,z as c,a9 as d,o as p,b as g,t as h,_ as f,a4 as y,D as b,J as m,A as v,F as _,a2 as k,B as S,a7 as C,T as I,N as x,aG as w,q as T,y as $,bd as B,aZ as L,R as z,be as A,bf as N,bg as D,Y as U,E as O,ar as P,k as V,G as W,d as H,P as M,L as j,K as R,Q as q,ax as E,bh as G,aC as X,U as F,V as Y,a8 as Z}from"./index-BKzbZvRR.js";function J(a){const o=e(0);return a&&"function"==typeof a?a((e=>{o.value=e.scrollTop})):t((e=>{o.value=e.scrollTop})),{scrollTop:o}}function K(){const e=a(),{top:t,bottom:s}=o(e.safeAreaInsets);return{saveTop:t,safeBottom:s}}function Q(t=0){const s=e(t),l=e("100%"),n=e(0),{saveTop:r}=K();return function(){const e=a(),{left:t,right:s,top:l,height:n}=o(e.menuButtonInfo)}(),n.value=r.value+s.value,{height:n,contentHeight:s,contentWidth:l,statusBarHeight:r}}const ee=f(s({__name:"tig-navbar",props:{title:{type:String,default:""},background:{type:String,default:"#fff"},showLeft:{type:Boolean,default:!0}},setup(e){const t=()=>{history.back()};return(a,o)=>{const s=u;return p(),l(s,{class:"tig-navbar"},{default:n((()=>[r(s,{class:"navbar-box",style:d(`background: ${e.background};`)},{default:n((()=>[r(s,{class:"navbar"},{default:n((()=>[r(s,{class:"navbar-content"},{default:n((()=>[r(s,{class:"left"},{default:n((()=>[e.showLeft?i(a.$slots,"left",{key:0},(()=>[r(s,{onClick:t,class:"iconfont icon-houtui"})]),!0):c("",!0)])),_:3}),r(s,{class:"middle"},{default:n((()=>[i(a.$slots,"title",{},(()=>[r(s,{class:"title line1"},{default:n((()=>[g(h(a.$t(e.title)),1)])),_:1})]),!0)])),_:3}),r(s,{class:"right"},{default:n((()=>[i(a.$slots,"right",{},void 0,!0)])),_:3})])),_:3})])),_:3})])),_:3},8,["style"]),r(s,{class:"placeholder"})])),_:3})}}}),[["__scopeId","data-v-8f29a248"]]),te=f(s({__name:"tig-tabbar",props:{backgroundColor:{type:String,default:"#fff"},color:{type:String,default:"#000"},activeColor:{type:String,default:"#ea3c2d"}},setup(e){k((e=>({"37da30dc":a.backgroundColor,"8e910f40":a.color,"21e7e98c":a.activeColor})));const t=y(),a=e;return(e,a)=>{const o=S,s=u;return p(),l(s,{class:"tabbar-box"},{default:n((()=>[r(s,{class:"tabbar-container"},{default:n((()=>[r(s,{class:"tabbar"},{default:n((()=>[(p(!0),b(_,null,m(v(t).tabbarList,((a,u)=>(p(),l(s,{class:"tabbar-item",key:u,onClick:e=>((e,a)=>{t.currentActiveValue!==a&&e.link&&x({url:w(e.link)})})(a,u)},{default:n((()=>[r(s,{class:"tabbar-icon"},{default:n((()=>[r(o,{class:"tabbar-icon-img",src:v(t).currentActiveValue===u?v(C)(a.activeImage):v(C)(a.image)},null,8,["src"])])),_:2},1024),r(s,{class:I(["tabbar-text",{active:v(t).currentActiveValue===u}])},{default:n((()=>[g(h(e.$t(a.text)),1)])),_:2},1032,["class"])])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1}),r(s,{class:"placeholder"})])),_:1})}}}),[["__scopeId","data-v-a957a259"]]),ae=f(s({__name:"tig-button",props:{shape:{type:String,default:"circle"},type:{type:String,default:"primary"},color:{type:String,default:"var(--main-bg)"},text:{type:String,default:"确定"},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},plain:{type:Boolean,default:!1},loadingText:{type:String,default:""},size:{type:String,default:"normal"},customStyle:{type:Object,default:()=>({})},openType:{type:String,default:""}},emits:["click","getPhoneNumber"],setup(e,{emit:t}){const a=t,o=e=>{a("click",e)},s=e=>{a("getPhoneNumber",e)};return(t,a)=>{const r=T($("up-button"),B);return p(),l(r,{customStyle:e.customStyle,type:e.type,size:e.size,plain:e.plain,color:e.color,shape:e.shape,disabled:e.disabled,text:e.text,loading:e.loading,loadingText:e.loadingText,"open-type":e.openType,onClick:o,onGetphonenumber:s},{default:n((()=>[i(t.$slots,"default",{},void 0,!0)])),_:3},8,["customStyle","type","size","plain","color","shape","disabled","text","loading","loadingText","open-type"])}}}),[["__scopeId","data-v-307c4a8f"]]),oe=f(s({__name:"tig-checkbox",props:{checkedText:{type:String,default:""},checkedSize:{type:Number,default:.8},checked:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},shape:{type:String,default:"circle"},size:{type:String,default:"15"}},emits:["update:checked","change"],setup(e,{emit:t}){const a=e,o=L(),s=z((()=>o.themeStyle["--general"]||"#ee0a24")),u=t,i=()=>{a.disabled||(u("update:checked",!a.checked),u("change"))};return(t,a)=>{const o=T($("up-checkbox"),A),u=N;return p(),l(u,{class:"check",onClick:i},{default:n((()=>[r(o,{onChange:i,shape:e.shape,usedAlone:!0,disabled:e.disabled,activeColor:s.value,checked:e.checked,size:e.size},null,8,["shape","disabled","activeColor","checked","size"]),g(" "+h(e.checkedText),1)])),_:1})}}}),[["__scopeId","data-v-c77e2edb"]]),se=f(s({__name:"tig-popup",props:{show:{type:Boolean,default:!1},showClose:{type:Boolean,default:!0},overlay:{type:Boolean,default:!0},position:{type:String,default:"bottom"},round:{type:[String,Number],default:10},backgroundColor:{type:String,default:"#fff"},customStyle:{type:Object,default:()=>({})},maskClick:{type:Boolean,default:!0},zIndex:{type:Number,default:100},height:{type:String,default:"50vh"}},emits:["update:show","change","handleShade","close"],setup(e,{emit:t}){const a=e,o=t,s=z({get:()=>a.show,set(e){o("update:show",e)}}),r=()=>{o("close"),o("update:show",!1)};return(t,a)=>{const o=T($("up-popup"),D);return p(),l(o,{show:s.value,"onUpdate:show":a[0]||(a[0]=e=>s.value=e),closeOnClickOverlay:e.maskClick,onClose:r,overlay:e.overlay,mode:e.position,round:e.round,bgColor:e.backgroundColor,customStyle:{...e.customStyle},zIndex:e.zIndex,safeAreaInsetTop:!1,safeAreaInsetBottom:!1,closeable:e.showClose},{default:n((()=>[i(t.$slots,"default",{},void 0,!0)])),_:3},8,["show","closeOnClickOverlay","overlay","mode","round","bgColor","customStyle","zIndex","closeable"])}}}),[["__scopeId","data-v-9b397be0"]]),le=e=>U({url:"user/login/signin",method:"post",data:e}),ne=e=>U({url:"user/login/sendMobileCode",method:"post",data:e}),re=e=>U({url:"user/login/getWxLoginUrl",method:"get",data:e}),ue=e=>U({url:"user/login/bindWechat",method:"post",data:e}),ie=()=>U({url:"user/login/unbindWechat",method:"get"}),ce=e=>U({url:"user/login/checkMobile",method:"post",data:e}),de=(e,t)=>U({url:`user/oauth/render/${e}?redirectUri=${t}`,method:"get"}),pe=(e,t,a)=>U({url:`user/oauth/callback/${e}?redirectUri=${t}`,method:"post",data:a}),ge=f(s({__name:"tig-wechart-login",emits:["loginSuccess"],setup(t,{emit:o}){const{t:s}=O(),i=o,d=P(),f=a(),y=z({get:()=>!!d.authType,set(e){d.setAuthType("")}}),b=e(!1),m=e(!1),v=()=>{M({url:"/pages/login/mallAgreement"})},_=()=>{if(!b.value)return j({title:s("请先同意用户协议"),duration:1500,icon:"none"})},k=async()=>{const e=await re({url:location.origin+location.pathname});window.location.href=e.url},S=async e=>{const t=await(a={code:e},U({url:"user/login/getWxLoginInfoByCode",method:"get",data:a}));var a;1==t.type&&(d.setToken(t.token),d.getUserInfo(),i("loginSuccess"),d.setAuthType("")),2==t.type&&1===f.wechatRegisterBindPhone&&(R("openData",t.openData),M({url:"/pages/user/bindMobilePhone/index"}))},C=e=>{d.setAuthType(""),M({url:`/pages/login/index?loginType=${e}`})},I=()=>{d.setAuthType("")};return V((()=>{if("wechat"===f.XClientType&&!W("token")){const e=(e=>{const t={},a=e.split("?")[1];return a&&a.split("&").forEach((e=>{const[a,o]=e.split("=");t[a]=o})),t})(location.href);e.code&&e.code.length>12&&S(e.code)}})),(e,t)=>{const a=T($("tig-button"),ae),o=T($("tig-checkbox"),oe),s=H,i=u,d=T($("tig-popup"),se);return p(),l(d,{zIndex:1e3,show:y.value,"onUpdate:show":t[4]||(t[4]=e=>y.value=e),onClose:I},{default:n((()=>[y.value?(p(),l(i,{key:0,class:"wechart-login-content"},{default:n((()=>[r(i,{class:"wechart-login-box"},{default:n((()=>[b.value?(p(),l(a,{key:0,customStyle:{"border-radius":"20rpx",height:"95rpx"},shape:"square",loading:m.value,onClick:k},{default:n((()=>[g(h(e.$t("微信授权")),1)])),_:1},8,["loading"])):(p(),l(a,{key:1,customStyle:{"border-radius":"20rpx",height:"95rpx"},shape:"square",onClick:_},{default:n((()=>[g(h(e.$t("微信授权")),1)])),_:1})),r(i,{class:"rule-text"},{default:n((()=>[r(o,{checked:b.value,"onUpdate:checked":t[0]||(t[0]=e=>b.value=e)},null,8,["checked"]),r(i,{class:"rule-xieyi"},{default:n((()=>[r(s,{onClick:t[1]||(t[1]=e=>b.value=!b.value)},{default:n((()=>[g(h(e.$t("登录即为同意")),1)])),_:1}),r(s,{class:"special-color",onClick:v},{default:n((()=>[g(h(e.$t("《商城用户服务协议》")),1)])),_:1})])),_:1})])),_:1}),r(i,{class:"other-login"},{default:n((()=>[r(i,{class:"mobile-login",onClick:t[2]||(t[2]=e=>C("mobile"))},{default:n((()=>[g(h(e.$t("手机登录")),1)])),_:1}),r(i,{class:"account-login",onClick:t[3]||(t[3]=e=>C("password"))},{default:n((()=>[g(h(e.$t("账号登录")),1)])),_:1})])),_:1})])),_:1})])),_:1})):c("",!0)])),_:1},8,["show"])}}}),[["__scopeId","data-v-0214dea0"]]),he=s({__name:"tig-statistic-log",props:{productId:{type:[Number,String],default:""},shopId:{type:[Number,String],default:""},shopCategoryId:{type:[Number,String],default:""},immediateLog:{type:Boolean,default:!0}},setup(e,{expose:t}){const a=e,o=q({}),s=async()=>{a.productId&&(o.productId=a.productId),a.shopId&&(o.shopId=a.shopId),a.shopCategoryId&&(o.shopCategoryId=a.shopCategoryId);try{await G(o)}catch(e){console.error(e)}},n=z((()=>{const e=new Date;return`${e.getFullYear()}-${e.getMonth()+1}-${e.getDate()}`}));return(()=>{const e=W("lastDate");!e||((e,t)=>{const a=new Date(e),o=new Date(t);return Math.abs(a.getTime()-o.getTime())>=864e5})(n.value,e)?o.isNew=1:o.click=1,R("lastDate",n.value)})(),E((()=>{a.immediateLog&&s()})),t({__commonLog:s}),(e,t)=>{const a=u;return p(),l(a)}}}),fe=f(s({__name:"tig-layout",props:{needSafeTop:{type:Boolean,default:!1},needSafeBottom:{type:Boolean,default:!0},safeTopBgColor:{type:String,default:"#fff"},productId:{type:[Number,String],default:""},shopId:{type:[Number,String],default:""},shopCategoryId:{type:[Number,String],default:""},immediateLog:{type:Boolean,default:!0},title:{type:String,default:""}},emits:["loginSuccess"],setup(t,{expose:o,emit:s}){k((e=>({"1a04db78":g.safeTopBgColor})));const g=t,h=y(),f=a(),b=L();X();const m=z((()=>!0));f.setH5Title();const{safeBottom:_}=K(),{height:S}=Q(),C=z((()=>({...b.themeStyle,"--tabbar-height":h.tabbarHeight,"--safe-bottom":`${_.value}px`,"--safe-top":`${S.value}px`,"--nav-height":`${f.navHeight}rpx`}))),x=e();return o({handleLog:()=>{var e;null==(e=x.value)||e.__commonLog()},isZh:m}),(e,a)=>{const o=u,s=T($("tig-navbar"),ee),g=T($("tig-tabbar"),te),y=T($("tig-wechart-login"),ge),b=T($("tig-statistic-log"),he);return p(),l(o,{class:I(["layout",{"not-zh":!m.value&&v(Z)()}]),style:d({...C.value})},{default:n((()=>[t.needSafeTop?(p(),l(o,{key:0,class:"safe-top-box"})):c("",!0),t.title?(p(),l(s,{key:1,title:t.title},null,8,["title"])):c("",!0),i(e.$slots,"default",{},void 0,!0),-1===v(h).currentActiveValue&&t.needSafeBottom?(p(),l(o,{key:2,class:"layout-safe-bottom"})):c("",!0),F(r(o,null,{default:n((()=>[r(g)])),_:1},512),[[Y,v(h).currentActiveValue>-1]]),"miniProgram"!==v(f).XClientType&&"wechat"!==v(f).XClientType||1!==v(f).openWechatRegister?c("",!0):(p(),l(y,{key:3,onLoginSuccess:a[0]||(a[0]=t=>e.$emit("loginSuccess"))})),r(b,{ref_key:"statisticLogRef",ref:x,immediateLog:t.immediateLog,productId:t.productId,shopId:t.shopId,shopCategoryId:t.shopCategoryId},null,8,["immediateLog","productId","shopId","shopCategoryId"])])),_:3},8,["class","style"])}}}),[["__scopeId","data-v-456a7f98"]]);export{fe as _,ae as a,se as b,ee as c,oe as d,ce as e,le as f,de as g,pe as h,Q as i,K as j,ue as k,ie as l,re as m,ne as s,J as u};
