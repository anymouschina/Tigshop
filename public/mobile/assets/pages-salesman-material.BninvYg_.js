import{d as a,r as e,m as t,n as s,w as l,q as o,V as c,aB as u,x as r,C as i,a3 as n,G as d,R as p,k as m,l as f,y as _,J as v,F as h,t as g,v as y,E as b,S as w,I as k,a5 as x,a9 as C,aZ as $,H as j,aG as V,ae as I,s as P,D,b1 as U,a$ as S,aJ as q,b0 as z,M as L,aI as F,a as B,Q as H,o as T,b as J,b4 as O,L as Q,b2 as R,B as G,ag as M}from"./index-Ce4FtYLL.js";import{_ as N}from"./u-tabs.DUI4fA-S.js";import{_ as W}from"./tig-image.bUT1hZK2.js";import{_ as A}from"./tig-qrcode.D3zUv8Qk.js";import{c as E,b as K,g as Z,_ as X}from"./tig-layout.nM03J4I_.js";import{m as Y,f as aa,g as ea}from"./salesman.Ct1j_gaE.js";import{s as ta}from"./searchInput.Cj-E80eO.js";import{_ as sa}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{_ as la}from"./save-bottom-box.C22fRRFe.js";import{_ as oa}from"./uni-icons.yuSuVTUg.js";import{_ as ca,a as ua}from"./u-radio-group.BHbsLwTM.js";import{_ as ra}from"./uni-transition.D6PXbR48.js";import{e as ia}from"./empty.D542JKKH.js";import{u as na}from"./useList.D1YctHiI.js";import"./u-loading-icon.CaEeBur7.js";import"./u-icon.BDQrrWMI.js";import"./u-input.2cv__j3I.js";import"./empty.vue_vue_type_style_index_0_scoped_b2f6c60f_lang.DiLAYZG5.js";import"./product.rX84B_3L.js";const da=sa(a({__name:"materialPopover",setup(a){const n=e(!1),d=()=>{n.value=!n.value};return(a,e)=>{const p=i;return t(),s(p,{class:"material-popover"},{default:l((()=>[o(p,{class:c(["popover-masking",{show:n.value}]),onClick:d},null,8,["class"]),n.value?(t(),s(p,{key:0,class:c(["popover-content-box",{show:n.value}])},{default:l((()=>[o(p,{class:c(["popover-content",{enter:n.value,leave:!n.value}]),onClick:d},{default:l((()=>[o(p,{class:"triangle"}),u(a.$slots,"content",{show:n.value},void 0,!0)])),_:3},8,["class"])])),_:3},8,["class"])):r("",!0),o(p,{onClick:e[0]||(e[0]=a=>n.value=!n.value)},{default:l((()=>[u(a.$slots,"default",{},void 0,!0)])),_:3})])),_:3})}}}),[["__scopeId","data-v-219abb52"]]),pa=sa(a({__name:"materialSaveCard",props:{modelValue:{type:Boolean,default:!1},currentPics:{type:Object,default:()=>{}}},emits:["update:modelValue"],setup(a,{emit:e}){n((a=>({fcf3b436:V.value})));const{t:c}=d(),u=a,r=e,j=p({get:()=>u.modelValue,set(a){r("update:modelValue",a)}}),V=p((()=>`url(${b("salesman/materialPopup.png")})`));return(e,u)=>{const r=m(f("tig-image"),W),n=i,d=w,p=m(f("save-bottom-box"),la),b=m(f("tig-popup"),E);return t(),s(b,{show:j.value,"onUpdate:show":u[1]||(u[1]=a=>j.value=a),zIndex:999,showClose:!1,backgroundColor:"#fff"},{default:l((()=>[o(n,{class:"share-popup"},{default:l((()=>[o(n,{class:"share-cube"},{default:l((()=>[o(d,{class:"list-box","scroll-x":"true"},{default:l((()=>[o(n,{class:"list-content"},{default:l((()=>[(t(!0),_(h,null,v(a.currentPics,(a=>(t(),s(n,{key:a.pic_id,class:"list-item",onLongpress:k((e=>(a=>{let e=x(a);C({title:c("提示"),content:c("确定要保存图片吗？"),success:async a=>{a.confirm&&$({urls:[e]})}})})(a.pic_url)),["stop"])},{default:l((()=>[o(r,{src:a.pic_url,"onUpdate:src":e=>a.pic_url=e},null,8,["src","onUpdate:src"])])),_:2},1032,["onLongpress"])))),128))])),_:1})])),_:1})])),_:1})])),_:1}),o(p,{height:50,backgroundColor:"#fff"},{default:l((()=>[o(n,{class:"share-cube-btn",onClick:u[0]||(u[0]=a=>e.$emit("update:modelValue",!1))},{default:l((()=>[g(y(e.$t("我知道了")),1)])),_:1})])),_:1})])),_:1},8,["show"])}}}),[["__scopeId","data-v-98a23f9e"]]),ma=300,fa=sa(a({__name:"materialChoosePoster",props:{modelValue:{type:Boolean,default:!1},currentData:{type:Object,default:()=>{}},qrcodePath:{type:String,default:""}},emits:["update:modelValue"],setup(a,{emit:c}){n((a=>({"757b821a":P(H)+20+"rpx","4be5336b":Q.value+"px"})));const{t:u}=d(),p=F(),B=j("userInfo"),{saveBottom:H}=K(),T=a,J=e(0),O=e(0),Q=e(0),R=e([]),G=(a,e,t)=>({width:t=t||ma,height:e*t/a}),M=async()=>{await(async a=>{try{const e=await q(x(a));O.value=G(e.width,e.height).height,Q.value=O.value+90}catch(e){console.error(e)}})(T.currentData.pics[J.value].pic_url);let a=S("myCanvas",p);if(R.value[J.value])return;const e=B.avatar?x(B.avatar):b("user/defaultAvatar.jpg");a.draw(),a.setFillStyle("#ffffff"),a.fillRect(0,0,ma,Q.value);try{a.draw(!1,(async()=>{const t=await q(e);a.save(),a.beginPath(),a.arc(30,O.value+35,22,0,2*Math.PI),a.clip(),a.drawImage(t.path,8,O.value+12,45,45),a.restore(),setTimeout((()=>{a.draw(!0,(async()=>{const e=await q(x(T.currentData.pics[J.value].pic_url));a.drawImage(e.path,0,0,G(e.width,e.height).width,G(e.width,e.height).height),a.draw(!0,(async()=>{const e=await q(T.qrcodePath);a.drawImage(e.path,220,Q.value-80,70,70),a.setFontSize(13),a.setFillStyle("#000000"),a.fillText(B.mobile,58,O.value+33),a.setFontSize(11),a.setFillStyle("#999999"),a.fillText(`${u("这个真不错，推荐你也来看看")}`,58,O.value+48),setTimeout((()=>{a.draw(!0,(()=>{N()}))}),50)}))}))}),50)}))}catch(t){console.error(t)}},N=()=>{z({fileType:"jpg",canvasId:"myCanvas",quality:1,destWidth:600,destHeight:2*Q.value,success:function(a){R.value[J.value]=a.tempFilePath},fail:a=>{L({title:JSON.stringify(a),icon:"none",duration:3e3}),console.log(a)}},null==p?void 0:p.proxy)};return V((()=>{I((()=>{M()}))})),(e,c)=>{const n=i,d=m(f("uni-icons"),oa),p=m(f("up-radio"),ca),b=m(f("tig-image"),W),x=w,j=m(f("up-radio-group"),ua),V=m(f("uni-transition"),ra),I=D,P=U;return t(),s(n,null,{default:l((()=>[o(n,{class:"overlay"},{default:l((()=>[a.currentData.pics&&a.currentData.pics.length>1?(t(),s(n,{key:0,class:"bottom-choose-box"},{default:l((()=>[o(V,{styles:{width:"100%",height:"inherit",backgroundColor:"#fff","border-radius":"30rpx 30rpx 0 0"},"mode-class":["fade","slide-bottom"],show:a.modelValue},{default:l((()=>[o(n,{class:"bottom-choose"},{default:l((()=>[o(n,{class:"bottom-choose-title"},{default:l((()=>[g(y(e.$t("选择图片，生成对应海报")),1)])),_:1}),o(n,{class:"chose-ico"},{default:l((()=>[o(d,{type:"closeempty",size:"24",color:"#c8c9cc",onClick:c[0]||(c[0]=a=>e.$emit("update:modelValue",!1))})])),_:1}),o(n,{class:"choose-img"},{default:l((()=>[o(j,{modelValue:J.value,"onUpdate:modelValue":c[2]||(c[2]=a=>J.value=a),placement:"column"},{default:l((()=>[o(x,{class:"list-box","scroll-x":"true"},{default:l((()=>[o(n,{class:"list-content"},{default:l((()=>[(t(!0),_(h,null,v(a.currentData.pics,((a,e)=>(t(),s(n,{key:a.pic_id,class:"list-item",onClick:a=>(a=>{J.value=a,M()})(e)},{default:l((()=>[o(p,{customStyle:{marginBottom:"8px",position:"absolute",top:0,right:"14rpx",zIndex:9},label:"",activeColor:"#2da641",name:e,onChange:c[1]||(c[1]=()=>{})},null,8,["name"]),o(b,{src:a.pic_url,"onUpdate:src":e=>a.pic_url=e},null,8,["src","onUpdate:src"])])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["show"])])),_:1})):r("",!0),o(n,{class:"poster-box"},{default:l((()=>[o(n,{class:"preview-wrap"},{default:l((()=>[o(n,{class:"poster-wrap"},{default:l((()=>[o(n,{class:"poster-img"},{default:l((()=>[o(I,{style:{height:"100%"},src:R.value[J.value]},null,8,["src"])])),_:1})])),_:1}),a.currentData.pics&&1===a.currentData.pics.length?(t(),s(n,{key:0,class:"preview-icon"},{default:l((()=>[o(d,{type:"close",size:"36",color:"#fff",onClick:c[3]||(c[3]=a=>e.$emit("update:modelValue",!1))})])),_:1})):r("",!0),o(n,{class:"preview-text",onLongpress:c[4]||(c[4]=k((a=>{return e=R.value[J.value],void C({title:u("提示"),content:u("确定要保存分享海报吗？"),success:function(a){a.confirm&&$({urls:[e]})}});var e}),["stop"]))},{default:l((()=>[g(y(e.$t("长按图片保存至相册")),1)])),_:1})])),_:1})])),_:1}),o(P,{class:"canvas-content",id:"myCanvas","canvas-id":"myCanvas"})])),_:1})])),_:1})}}}),[["__scopeId","data-v-a786765c"]]),_a=sa(a({__name:"material",setup(a){n((a=>({"571f5f46":P(u)+"px","2ecb62f6":P(D)+"px","76aae866":P(w)+"px","8796b9e6":P(V),"4a0229a4":wa.value,"70bbedda":ka.value,db6b4770:xa.value})));const{t:c}=d(),{height:u,contentHeight:w,contentWidth:V,statusBarHeight:D}=Z(60),U=B(),S=j("userInfo"),q=H({keyword:"",page:1,size:10,category_id:null}),z=e([{category_id:null,category_name:c("全部")}]),{data:L,isLoading:F,total:E,getList:K}=na(Y,{params:q,path:{dataKey:"filter_result"}}),sa=e(),la=e(""),oa=a=>{q.category_id=a.category_id,L.value=[],K()},ca=()=>{L.value=[],K()},ua=()=>{L.value=[],K()},ra=e(!1),ma=e(!1),_a=e([]),va=e({}),ha=(a,e)=>{switch((async a=>{try{await ea(a)}catch(e){console.error(e)}})(e.id),a){case"poster":va.value=e,ba(e);break;case"friend":R(e.content,(()=>{ra.value=!0,_a.value=e.pics}))}},ga=a=>{la.value=a,ma.value=!0},ya=e(""),ba=a=>{var e;ya.value=a.product_id?`${U.baseInfo.h5_domain}/pages/productDetail/index?id=${a.product_id}&salesman_id=${null==(e=null==S?void 0:S.salesman)?void 0:e.salesman_id}`:U.baseInfo.h5_domain,I((()=>{var a;null==(a=sa.value)||a.drawQrcode()}))},wa=p((()=>`url(${x(U.baseInfo.ico_img)})`)),ka=p((()=>`url(${b("salesman/materialFriends.png")})`)),xa=p((()=>`url(${b("salesman/materialPic.png")})`));return T((async()=>{await(async()=>{try{const a=await aa();z.value=[...z.value,...a.item]}catch(a){console.error(a)}})(),K()})),J((()=>{O()})),(a,e)=>{const u=i,n=m(f("up-tabs"),N),d=G,p=M,b=m(f("tig-image"),W),w=m(f("tig-qrcode"),A),j=m(f("tig-layout"),X);return t(),s(u,null,{default:l((()=>[o(j,null,{default:l((()=>[o(u,{class:"sticky"},{default:l((()=>[o(u,{class:"material-menu"},{default:l((()=>[o(u,{class:"search-box"},{default:l((()=>[o(u,{class:"status-bar"}),o(u,{class:"search-input-box"},{default:l((()=>[o(u,{class:"input"},{default:l((()=>[o(ta,{style:{width:"100%"},modelValue:q.keyword,"onUpdate:modelValue":e[0]||(e[0]=a=>q.keyword=a),onConfirm:ca,onClear:ua},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),o(u,{class:"material-content"},{default:l((()=>[o(n,{lineColor:"#5d53b7",inactiveStyle:{color:"#969799"},keyName:"category_name",scrollable:z.value.length>5,list:z.value,onClick:oa},null,8,["scrollable","list"])])),_:1})])),_:1})])),_:1}),o(u,{class:"material-content"},{default:l((()=>[o(u,{class:"material-list"},{default:l((()=>[(t(!0),_(h,null,v(P(L),(e=>(t(),s(u,{key:e.id,class:"material-item"},{default:l((()=>[o(u,{class:"material-item-content"},{default:l((()=>[o(u,{class:"material-item-left"},{default:l((()=>[o(u,{class:"item-logo"},{default:l((()=>[o(d,{class:"item-logo-bg"})])),_:1})])),_:1}),o(u,{class:"material-item-right"},{default:l((()=>[o(u,{class:"item-name"},{default:l((()=>[g(y(a.$t("分销小助手")),1)])),_:1}),o(u,{class:"item-content"},{default:l((()=>[e.content?(t(),s(p,{key:0,nodes:e.content},null,8,["nodes"])):r("",!0)])),_:2},1024),e.pics?(t(),s(u,{key:0,class:"item-images"},{default:l((()=>[(t(!0),_(h,null,v(e.pics,((a,r)=>(t(),s(u,{key:a.pic_id,class:"image-box",onClick:a=>((a,e)=>{const t=e.map((a=>x(a.pic_url||"")));$({current:t[a],urls:t})})(r,e.pics)},{default:l((()=>[o(b,{onLongpress:k((e=>(a=>{let e=x(a);C({title:c("提示"),content:c("确定要保存图片吗？"),success:async a=>{a.confirm&&$({urls:[e]})}})})(a.pic_url)),["stop"]),src:a.pic_url,"onUpdate:src":e=>a.pic_url=e},null,8,["onLongpress","src","onUpdate:src"])])),_:2},1032,["onClick"])))),128))])),_:2},1024)):r("",!0),o(u,{class:"item-tip"},{default:l((()=>[g(y(a.$t("长按图片保存到相册")),1)])),_:1}),e.product?(t(),s(u,{key:1,class:"item-product"},{default:l((()=>[o(u,{class:"item-product-text"},{default:l((()=>[g(y(a.$t("商品：")),1)])),_:1}),o(u,{class:"item-product-img",onClick:a=>{return t=`/pages/productDetail/index?id=${e.product_id}`,void Q({url:t});var t}},{default:l((()=>[o(b,{src:e.product.pic_thumb,"onUpdate:src":a=>e.product.pic_thumb=a},null,8,["src","onUpdate:src"])])),_:2},1032,["onClick"])])),_:2},1024)):r("",!0),o(u,{class:"item-btn"},{default:l((()=>[o(u,{class:"item-sharenum"},{default:l((()=>[g(y(a.$t("分享"))+y(e.share_num),1)])),_:2},1024),o(da,null,{content:l((()=>[o(u,{class:"popover-btns"},{default:l((()=>[o(u,{class:"popover-btns-item",onClick:a=>ha("friend",e)},{default:l((()=>[o(d,{class:"popover-btns-item-icon icon-1"}),g(" "+y(a.$t("发朋友圈")),1)])),_:2},1032,["onClick"]),o(u,{class:"common-line"}),o(u,{class:"popover-btns-item",onClick:a=>ha("poster",e)},{default:l((()=>[o(d,{class:"popover-btns-item-icon icon-2"}),g(" "+y(a.$t("生成海报")),1)])),_:2},1032,["onClick"])])),_:2},1024)])),default:l((()=>[o(u,{class:"item-btn-content"},{default:l((()=>[o(d,{class:"round"}),o(d,{class:"round"})])),_:1})])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1}),P(F)||0!==P(E)?r("",!0):(t(),s(ia,{key:0,styles:{width:"320rpx",height:"320rpx"}})),o(w,{ref_key:"qrcodeRef",ref:sa,immediatelyCreate:!0,value:ya.value,size:400,margin:10,show:!1,onSuccess:ga},null,8,["value"]),o(pa,{modelValue:ra.value,"onUpdate:modelValue":e[1]||(e[1]=a=>ra.value=a),currentPics:_a.value},null,8,["modelValue","currentPics"]),ma.value?(t(),s(fa,{key:1,modelValue:ma.value,"onUpdate:modelValue":e[2]||(e[2]=a=>ma.value=a),qrcodePath:la.value,currentData:va.value},null,8,["modelValue","qrcodePath","currentData"])):r("",!0)])),_:1})])),_:1})}}}),[["__scopeId","data-v-487cf56a"]]);export{_a as default};
