import{Y as e,e as a,u as l,r as t,E as o,R as s,a1 as i,k as r,G as d,ac as n,ad as u,c,w as p,q as m,y as f,o as b,a as g,i as v,b as h,t as _,A as y,z as x,d as k,H as C,L as V,ae as S,P as $,_ as w}from"./index-BKzbZvRR.js";import{_ as z}from"./tig-mobile-areacode.CYb80BY7.js";import{_ as A}from"./uni-easyinput.DUnQnQgu.js";import{_ as j,a as U}from"./uni-forms.B4Kaqmtk.js";import{_ as M,d as q,a as R,s as B}from"./tig-layout.BpNdXByQ.js";import{V as E}from"./index.B_Pq2Y6R.js";import{u as F}from"./useResetState.Cp1dvD_I.js";import"./uni-icons.DELFdrY8.js";const I=w(a({__name:"index",setup(a){const w=l(),I=t("86"),[O,T]=F({mobile:"",mobileCode:"",password:""}),{t:D}=o(),W=t(!1),Z=t(""),G=t(!1),H=s((()=>!(O.value.mobile&&O.value.mobileCode&&O.value.password&&Z.value))),L={mobile:{rules:[{required:!0,errorMessage:D("请输入手机号")},{validateFunction:(e,a,l,t)=>a?/^(?=.*\D).+$/.test(a)?t(D("格式错误，请输入正确的手机号码")):void t():t(D("手机号不能为空"))}]},mobileCode:{rules:[{required:!0,errorMessage:D("请输入验证码")},{validateFunction:(e,a,l,t)=>a?6!=a.length?t(D("请输入6位验证码")):void t():t(D("验证码不能为空"))}]},password:{rules:[{required:!0,errorMessage:D("请输入密码")},{validateFunction:(e,a,l,t)=>a?a.length>20||a.length<6?t(D("密码应为6-20位字符")):/\s/.test(a)?t(D("密码中不允许有空格")):/^\d+$/.test(a)?t(D("密码不能全为数字")):/^(?=.*[\d\W]).+$/.test(a)?/^(?=.*[a-zA-Z0-9]).+$/.test(a)?/^(?!([a-zA-Z0-9])\1*$).+$/.test(a)?void t():t(D("密码不能全为相同字符或数字")):t(D("密码不能全为符号")):t(D("密码不能全为字母")):t(D("密码不能为空"))}]}},P=i(),Y=async()=>{P.value.validate().then((async()=>{const a=d("bindSalesmanId");try{G.value=!0,O.value.mobile=w.isOpenMobileAreaCode?I.value+O.value.mobile:O.value.mobile,await(l={...O.value,salesmanId:a},e({url:"user/regist/registAct",method:"post",data:l})),V({title:D("注册成功"),duration:1500,icon:"none"}),setTimeout((()=>{S({url:"/pages/login/index"})}),1e3)}catch(t){T(),V({title:t.message,duration:1500,icon:"none"})}finally{G.value=!1}var l})).catch((e=>{console.error("表单错误信息：",e)}))};r((()=>{d("token")&&n({url:"/pages/index/index"}),u((()=>{P.value.setRules(L)}))}));const J=e=>{V({title:e,duration:1500,icon:"none"})},K=e=>{$({url:e})};return(e,a)=>{const l=v,t=m(f("tig-mobile-areacode"),z),o=m(f("uni-easyinput"),A),s=m(f("uni-forms-item"),j),i=m(f("tig-checkbox"),q),r=k,d=m(f("uni-forms"),U),n=m(f("tig-button"),R),u=m(f("tig-layout"),M);return b(),c(u,{title:"注册"},{default:p((()=>[g(l,{class:"register-container"},{default:p((()=>[g(l,{class:"register-warp"},{default:p((()=>[g(l,{class:"h1_tit"},{default:p((()=>[h(_(e.$t("会员注册")),1)])),_:1})])),_:1}),g(l,{class:"profile-edit-content"},{default:p((()=>[g(d,{ref_key:"formRef",ref:P,modelValue:y(O),rules:L,"label-align":"right"},{default:p((()=>[g(s,{label:"",name:"mobile"},{default:p((()=>[g(l,{class:"input mobileareacode-box"},{default:p((()=>[y(w).isOpenMobileAreaCode?(b(),c(t,{key:0,labelStyle:{fontSize:"28rpx"},nameStyle:{fontSize:"24rpx",padding:"0 2rpx 0 10rpx"},boxStyle:{paddingRight:"0"},iconStyle:{fontSize:"22rpx"},modelValue:I.value,"onUpdate:modelValue":a[0]||(a[0]=e=>I.value=e)},null,8,["modelValue"])):x("",!0),g(o,{inputBorder:!1,modelValue:y(O).mobile,"onUpdate:modelValue":a[1]||(a[1]=e=>y(O).mobile=e),class:"uni-input item-input",placeholderStyle:"font-size: 28rpx;","placeholder-class":"placeholder",placeholder:e.$t("请输入手机号"),primaryColor:"rgb(192, 196, 204)"},null,8,["modelValue","placeholder"])])),_:1})])),_:1}),g(s,{label:"",name:"mobile_code"},{default:p((()=>[g(l,{class:"item-one"},{default:p((()=>[g(o,{inputBorder:!1,modelValue:y(O).mobileCode,"onUpdate:modelValue":a[2]||(a[2]=e=>y(O).mobileCode=e),class:"uni-input item-input input",focus:"",placeholderStyle:"font-size: 28rpx;","placeholder-class":"placeholder",placeholder:e.$t("手机短信验证码"),primaryColor:"rgb(192, 196, 204)",style:{width:"400rpx"}},null,8,["modelValue","placeholder"]),g(E,{style:{height:"65rpx"},isChecked:W.value,"onUpdate:isChecked":a[3]||(a[3]=e=>W.value=e),mobile:y(w).isOpenMobileAreaCode?I.value+y(O).mobile:y(O).mobile,"verify-token-data":Z.value,"onUpdate:verifyTokenData":a[4]||(a[4]=e=>Z.value=e),requestApi:y(B),onMobileErrorCallback:J},null,8,["isChecked","mobile","verify-token-data","requestApi"])])),_:1})])),_:1}),g(s,{label:"",name:"password"},{default:p((()=>[g(l,{class:"input"},{default:p((()=>[g(o,{clearable:!1,inputBorder:!1,trim:!0,type:"password",modelValue:y(O).password,"onUpdate:modelValue":a[5]||(a[5]=e=>y(O).password=e),class:"uni-input item-input",placeholderStyle:"font-size: 28rpx;","placeholder-class":"placeholder",placeholder:e.$t("请输入密码"),primaryColor:"rgb(192, 196, 204)"},null,8,["modelValue","placeholder"])])),_:1})])),_:1}),g(s,{label:"",name:""},{default:p((()=>[g(l,{class:"btn"},{default:p((()=>[g(l,{class:"agreement-btn"},{default:p((()=>[g(i,{checked:W.value,"onUpdate:checked":a[6]||(a[6]=e=>W.value=e)},null,8,["checked"]),g(r,{class:"agreement-text special-color",onClick:a[7]||(a[7]=C((e=>K("/pages/register/agreement")),["stop"]))},{default:p((()=>[h(_(e.$t("《注册协议》")),1)])),_:1})])),_:1}),g(l,{class:"lf-input",onClick:a[8]||(a[8]=C((e=>K("/pages/login/index")),["stop"]))},{default:p((()=>[g(l,null,{default:p((()=>[h(_(e.$t("已有账号？")),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"]),g(l,{class:"form-con"},{default:p((()=>[g(n,{disabled:H.value,loading:G.value,class:"btn2-css3",onClick:Y},{default:p((()=>[h(_(e.$t("注 册")),1)])),_:1},8,["disabled","loading"])])),_:1})])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-4891c977"]]);export{I as default};
