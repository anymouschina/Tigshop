import{d as e,$ as a,u as l,G as t,r as o,R as s,k as i,l as u,m as n,y as d,q as r,w as p,s as c,n as v,x as m,t as _,v as f,F as y,M as b,L as h,N as g,C as x,Z as w,V as k}from"./index-Do_Cb7fn.js";import{h as $,a as K,s as C,i as j,_ as U}from"./tig-layout.BV0ZvCt0.js";import{_ as I}from"./tig-mobile-areacode.Dq2bqdok.js";import{V as T}from"./verificationCode.Cl5MBpD9.js";import{_ as M}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./u-loading-icon.rQrrZF_r.js";import"./u-icon.CBDMG2rO.js";import"./u-picker.C0Ehso0s.js";const V=M(e({__name:"stepOne",props:{mobileKey:{},mobileKeyModifiers:{},step:{},stepModifiers:{}},emits:["update:mobileKey","update:step"],setup(e){const w=a(e,"mobileKey"),k=a(e,"step"),j=l(),{t:U}=t(),M=o("86"),V=o(!0),A=o(""),q=o(""),Z=e=>{q.value=e.detail.value},z=o(""),E=e=>{z.value=e.detail.value},D=e=>{b({title:e,duration:1500,icon:"none"})},F=o(!1),G=s((()=>!q.value||!z.value||F.value)),L=async()=>{if(!q.value)return b({title:U("请输入手机号"),duration:1500,icon:"none"});if(!z.value)return b({title:U("请输入手机验证码"),duration:1500,icon:"none"});F.value=!0;try{const e=await $({mobile:j.is_open_mobile_area_code?M.value+q.value:q.value,code:z.value});w.value=e.item,k.value=2}catch(e){console.error(e),b({title:e.message,duration:1500,icon:"none"})}finally{F.value=!1}},N=()=>{h({url:"/pages/login/index"})};return(e,a)=>{const l=i(u("tig-mobile-areacode"),I),t=g,o=x,s=i(u("tig-button"),K);return n(),d(y,null,[r(o,{class:"item"},{default:p((()=>[r(o,{class:"text mobileareacode-box"},{default:p((()=>[c(j).is_open_mobile_area_code?(n(),v(l,{key:0,modelValue:M.value,"onUpdate:modelValue":a[0]||(a[0]=e=>M.value=e)},null,8,["modelValue"])):m("",!0),r(t,{type:"text",onInput:Z,value:q.value,placeholder:e.$t("请输入手机号"),"placeholder-class":"placeholder",class:"mobile-text"},null,8,["value","placeholder"])])),_:1})])),_:1}),r(o,{class:"item mobile_code_text"},{default:p((()=>[r(o,{style:{flex:"1","margin-right":"10rpx"}},{default:p((()=>[r(t,{onInput:E,type:"text",placeholder:e.$t("手机短信验证码"),"placeholder-class":"placeholder",value:z.value,name:"mobile_code",class:"text"},null,8,["placeholder","value"])])),_:1}),r(T,{style:{height:"65rpx"},mobile:c(j).is_open_mobile_area_code?M.value+q.value:q.value,isChecked:V.value,"onUpdate:isChecked":a[1]||(a[1]=e=>V.value=e),"verify-token-data":A.value,"onUpdate:verifyTokenData":a[2]||(a[2]=e=>A.value=e),event:"forget_password",requestApi:c(C),onMobileErrorCallback:D},null,8,["mobile","isChecked","verify-token-data","requestApi"])])),_:1}),r(o,{class:"btn2-css3"},{default:p((()=>[r(s,{loadingText:e.$t("下 一 步"),loading:F.value,onClick:L,disabled:G.value},{default:p((()=>[_(f(e.$t("下 一 步")),1)])),_:1},8,["loadingText","loading","disabled"])])),_:1}),r(o,{class:"login-text",onClick:N},{default:p((()=>[_(f(e.$t("立即登录")),1)])),_:1})],64)}}}),[["__scopeId","data-v-0a04aa50"]]),A=M(e({__name:"stepTow.",props:{mobileKey:{},mobileKeyModifiers:{},step:{},stepModifiers:{}},emits:["update:mobileKey","update:step"],setup(e){const{t:l}=t(),c=a(e,"mobileKey"),v=a(e,"step"),m=o(["password","password"]),$=e=>{m.value[e]="password"==m.value[e]?"text":"password"},C=o(""),j=e=>{C.value=e.detail.value},U=o(""),I=e=>{U.value=e.detail.value},T=o(!1),M=s((()=>!C.value||!U.value||T.value)),V=e=>e?e.length>20||e.length<6?l("密码应为6-20位字符"):/\s/.test(e)?l("密码中不允许有空格"):/^\d+$/.test(e)?l("密码不能全为数字"):/^(?=.*[\d\W]).+$/.test(e)?/^(?=.*[a-zA-Z0-9]).+$/.test(e)?/^(?!([a-zA-Z0-9])\1*$).+$/.test(e)?void 0:l("密码不能全为相同字符或数字"):l("密码不能全为符号"):l("密码不能全为字母"):l("密码不能为空"),A=async()=>{if(V(C.value))return b({title:V(C.value),duration:1500,icon:"none"});if(C.value!=U.value)return b({title:l("两次密码输入不一致"),duration:1500,icon:"none"});try{T.value=!0;await(e={mobile_key:c.value,password:C.value},w({url:"user/login/forget_password",method:"post",data:e}));b({title:l("重置密码成功"),duration:1500,icon:"none"}),setTimeout((()=>{h({url:"/pages/login/index?type=password"})}),1500)}catch(a){console.error(a),b({title:a.message,duration:1500,icon:"none"}),v.value=1,c.value="",C.value="",U.value=""}finally{T.value=!1}var e},q=()=>{h({url:"/pages/login/index"})};return(e,a)=>{const l=g,t=x,o=i(u("tig-button"),K);return n(),d(y,null,[r(t,{class:"item"},{default:p((()=>[r(l,{type:m.value[0],onInput:j,placeholder:e.$t("请输入新密码"),"placeholder-class":"placeholder",class:"text password-text",value:C.value},null,8,["type","placeholder","value"]),r(t,{onClick:a[0]||(a[0]=e=>$(0)),class:k("password_show_hide iconfont "+("text"==m.value[0]?"icon-xianshi":"icon-yincang"))},null,8,["class"])])),_:1}),r(t,{class:"item"},{default:p((()=>[r(l,{type:m.value[1],onInput:I,placeholder:e.$t("请再次确认新密码"),"placeholder-class":"placeholder",class:"text password-text",value:U.value},null,8,["type","placeholder","value"]),r(t,{onClick:a[1]||(a[1]=e=>$(1)),class:k("password_show_hide iconfont "+("text"==m.value[1]?"icon-xianshi":"icon-yincang"))},null,8,["class"])])),_:1}),r(t,{class:"btn2-css3"},{default:p((()=>[r(o,{loadingText:e.$t("确 认"),loading:T.value,onClick:A,disabled:M.value},{default:p((()=>[_(f(e.$t("确 认")),1)])),_:1},8,["loadingText","loading","disabled"])])),_:1}),r(t,{class:"login-text",onClick:q},{default:p((()=>[_(f(e.$t("立即登录")),1)])),_:1})],64)}}}),[["__scopeId","data-v-8cafc69b"]]),q=M(e({__name:"index",setup(e){const a=o(1),l=o("");return(e,t)=>{const o=x,s=i(u("up-transition"),j),d=i(u("tig-layout"),U);return n(),v(o,null,{default:p((()=>[r(d,null,{default:p((()=>[r(o,{class:"plr-40"},{default:p((()=>[r(o,{class:"h1_tit"},{default:p((()=>[_(f(e.$t("找回密码")),1)])),_:1}),1===a.value?(n(),v(V,{key:0,step:a.value,"onUpdate:step":t[0]||(t[0]=e=>a.value=e),mobileKey:l.value,"onUpdate:mobileKey":t[1]||(t[1]=e=>l.value=e)},null,8,["step","mobileKey"])):m("",!0),r(s,{show:2===a.value,mode:"fade-left"},{default:p((()=>[r(A,{step:a.value,"onUpdate:step":t[2]||(t[2]=e=>a.value=e),mobileKey:l.value,"onUpdate:mobileKey":t[3]||(t[3]=e=>l.value=e)},null,8,["step","mobileKey"])])),_:1},8,["show"])])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-fde8ee2d"]]);export{q as default};
