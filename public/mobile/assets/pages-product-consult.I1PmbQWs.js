import{e as a,E as e,r as l,f as t,j as s,c as u,w as c,L as o,a5 as i,a6 as n,q as r,y as d,o as f,a as m,z as p,i as _,B as v,A as y,a7 as g,b as k,t as b,D as h,F as j,J as x,d as w,C as z,_ as A}from"./index-BKzbZvRR.js";import{_ as D}from"./format-price.kSnuguuz.js";import{_ as I}from"./tig-layout.BpNdXByQ.js";import{h as P,c as B}from"./product.BqL6tr7k.js";const L=A(a({__name:"consult",setup(a){const{t:A}=e(),L=l({productId:0,productStock:0}),N=l(!1),T=l(1),q=l(10),C=l(0),E=l(!1),F=l([]),G=l(0),J=async()=>{T.value>1&&(E.value=!0),i({title:A("加载中")});try{const a=await B({productId:M.value,page:T.value,size:q.value});F.value=[...F.value,...a.records],G.value=a.total}catch(a){o({title:a.message,icon:"none"})}finally{E.value=!1,n()}},M=l("");return t((a=>{if(a){const{id:e}=a;e&&(M.value=e,(async a=>{try{let e=await P(a);L.value=e.item}catch(e){o({title:e.message,icon:"none"})}})(e),J())}})),s((()=>{T.value<Math.ceil(C.value/q.value)&&(T.value++,J())})),(a,e)=>{const l=v,t=_,s=r(d("format-price"),D),o=w,i=r(d("tig-layout"),I);return f(),u(i,{title:"商品咨询"},{default:c((()=>[m(t,{class:"product-info flex"},{default:c((()=>[m(t,{class:"product-info-img"},{default:c((()=>[m(l,{"lazy-load":"",class:"product-img",src:y(g)(L.value.picThumb||"")},null,8,["src"])])),_:1}),m(t,null,{default:c((()=>[m(t,{class:"product-info-title line2"},{default:c((()=>[k(b(L.value.productName),1)])),_:1}),L.value.marketPrice&&Number(L.value.marketPrice)>0?(f(),u(t,{key:0,class:"product-info-price"},{default:c((()=>[m(s,{isBottom:!1,priceData:L.value.marketPrice},null,8,["priceData"])])),_:1})):p("",!0)])),_:1})])),_:1}),m(t,{class:"product-consult-card"},{default:c((()=>[(f(!0),h(j,null,x(F.value,((a,e)=>(f(),u(t,{class:"consult-item",key:e},{default:c((()=>[m(t,{class:"consult-item-tit flex justify-between"},{default:c((()=>[m(t,{class:"time"},{default:c((()=>[k(b(a.addTime),1)])),_:2},1024),m(t,{class:"name"},{default:c((()=>[k(b(a.username),1)])),_:2},1024)])),_:2},1024),m(t,{class:"consult-con line1"},{default:c((()=>[m(o,null,{default:c((()=>[k("Q")])),_:1}),k(" "+b(a.content),1)])),_:2},1024),a.reply?(f(),u(t,{key:0,class:"consult-con line1 reply"},{default:c((()=>[m(o,null,{default:c((()=>[k("A")])),_:1}),k(" "+b(a.reply.content),1)])),_:2},1024)):p("",!0)])),_:2},1024)))),128))])),_:1}),T.value>1?(f(),u(t,{key:0,class:"loading-box"},{default:c((()=>[N.value?(f(),u(t,{key:0,class:"bottomLoading"},{default:c((()=>[m(l,{"lazy-load":"",class:"loading",src:y(z)("common/loading.gif")},null,8,["src"])])),_:1})):p("",!0)])),_:1})):p("",!0),m(t,{class:"loading-box"},{default:c((()=>[F.value.length<1?(f(),u(t,{key:0},{default:c((()=>[k(b(a.$t("暂无咨询")),1)])),_:1})):p("",!0)])),_:1})])),_:1})}}}),[["__scopeId","data-v-f64e6333"]]);export{L as default};
