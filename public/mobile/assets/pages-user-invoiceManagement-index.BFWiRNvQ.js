import{e,G as a,r as l,Q as t,aB as s,v as u,z as o,c as n,o as c,i as r,w as i,a as d,E as p,K as m,d as _,b as f,t as v,F as y,$ as b,a9 as g,aa as h,M as $,_ as k,R as x,A as V,T as C,N as j,g as M,k as w}from"./index-BKXBH4vI.js";import{a as U,c as B,_ as q}from"./tig-layout.DMoUsUKf.js";import{n as S}from"./index.xrDesKlL.js";import{_ as I}from"./tig-image.BbZoJ9nS.js";import{_ as O}from"./format-price.0qAAshfo.js";import{_ as z}from"./loading-box.BnnJRdlH.js";import{b as D}from"./order.BjcCWkE9.js";import{_ as R}from"./uni-easyinput.D0KhEVqd.js";import{_ as L,a as P}from"./uni-forms.lNaSstdl.js";import{_ as T}from"./tig-fixed-placeholder.BHdfEiP8.js";import{g as A,u as E}from"./invoiceManagemen.DkScM0Jj.js";import"./uni-icons.C94_g2wt.js";const K=k(e({__name:"invoiceList",setup(e,{expose:k}){const{t:x}=a(),V=l([]),C=t({page:1,size:10,order_status:5}),j=l(!1),M=l(0),w=async()=>{C.page>1?j.value=!0:g({title:x("加载中")});try{const e=await D(C);V.value=[...V.value,...e.filter_result],M.value=e.total}catch(e){}finally{h(),j.value=!1}},B=e=>{switch(e){case 0:return x("待审核");case 1:return x("通过");default:return x("失败/作废")}},q=()=>{$({url:"/pages/user/invoiceManagement/applyInvoice"})};return s((()=>{w()})),k({__getOrderList:w,filterParams:C,total:M}),(e,a)=>{const l=_,t=r,s=u(o("tig-image"),I),g=u(o("format-price"),O),h=b,k=u(o("tig-button"),U),x=u(o("loading-box"),z);return c(),n(t,{class:""},{default:i((()=>[d(t,{class:"invoice-list"},{default:i((()=>[(c(!0),p(y,null,m(V.value,(a=>(c(),n(t,{key:a.order_id,class:"invoice-list-item"},{default:i((()=>[d(t,{class:"invoice-list-item-header"},{default:i((()=>[d(l,{class:"special-text"},{default:i((()=>[f(v(e.$t("订单编号"))+"：",1),d(l,{class:"special-color"},{default:i((()=>[f(v(a.order_sn),1)])),_:2},1024)])),_:2},1024),a.invoice_data?(c(),n(l,{key:0},{default:i((()=>[f(v(B(a.invoice_data.status)),1)])),_:2},1024)):(c(),n(l,{key:1},{default:i((()=>[f(v(e.$t("可申请")),1)])),_:1}))])),_:2},1024),d(t,{class:"invoice-list-item-content"},{default:i((()=>[d(t,{class:"item-content-product"},{default:i((()=>[(c(!0),p(y,null,m(a.items,(e=>(c(),n(h,{key:e.item_id,url:"/pages/productDetail/index?id="+e.product_id,"hover-class":"navigator-hover"},{default:i((()=>[d(t,{class:"item-content-product-item"},{default:i((()=>[d(t,{class:"item-content-product-img"},{default:i((()=>[d(s,{src:e.pic_thumb,"onUpdate:src":a=>e.pic_thumb=a},null,8,["src","onUpdate:src"])])),_:2},1024),d(t,{class:"item-content-product-info"},{default:i((()=>[d(t,{class:"product-item-title"},{default:i((()=>[f(v(e.product_name),1)])),_:2},1024),d(t,{class:"product-item-price"},{default:i((()=>[d(g,{showText:!1,decimalsStyle:{fontSize:"25rpx"},currencyStyle:{fontSize:"23rpx"},class:"product-item-pricenum",priceData:e.price},null,8,["priceData"]),d(t,{class:"product-item-quantity"},{default:i((()=>[f("x "+v(e.quantity),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["url"])))),128))])),_:2},1024),d(t,{class:"item-content-pay"},{default:i((()=>[d(t,{class:"item-content-pay-box"},{default:i((()=>[d(t,{class:"pay-item total-money"},{default:i((()=>[f(v(e.$t("总额"))+"：",1),d(g,{showText:!1,isBottom:!1,priceData:a.total_amount},null,8,["priceData"])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024),d(t,{class:"invoice-list-item-btn"},{default:i((()=>[d(t,{class:"item-btn-box"},{default:i((()=>[a.invoice_data?(c(),n(k,{key:0,customStyle:{width:"150rpx",height:"60rpx"},plain:!0,plainMainColor:!0,onClick:e=>((e,a)=>{e.order_sn=a;const l=encodeURIComponent(JSON.stringify(e));$({url:"/pages/user/invoiceManagement/invoiceInfo?invoice_data="+l})})(a.invoice_data,a.order_sn)},{default:i((()=>[f(v(e.$t("查看")),1)])),_:2},1032,["onClick"])):(c(),n(k,{key:1,plain:!0,customStyle:{width:"150rpx",height:"60rpx"},plainMainColor:!0,onClick:q},{default:i((()=>[f(v(e.$t("申请")),1)])),_:1}))])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128)),d(x,{modelValue:j.value,"onUpdate:modelValue":a[0]||(a[0]=e=>j.value=e),page:C.page,length:V.value.length},null,8,["modelValue","page","length"])])),_:1})])),_:1})}}}),[["__scopeId","data-v-719c1ae3"]]),N=k(e({__name:"certification",setup(e){const{t:t}=a(),m=l({}),b={company_name:{rules:[{required:!0,errorMessage:t("单位名称不能为空!")}]},company_code:{rules:[{required:!0,errorMessage:t("纳税人识别码不能为空!")}]},company_address:{rules:[{required:!0,errorMessage:t("注册地址不能为空!")}]},company_phone:{rules:[{required:!0,errorMessage:t("注册电话不能为空!")}]},company_bank:{rules:[{required:!0,errorMessage:t("开户银行不能为空!")}]},company_account:{rules:[{required:!0,errorMessage:t("银行账户不能为空!")}]}},g=l(!1),h=l(!1),$=async()=>{try{const e=await A();Object.assign(m.value,e.item)}catch(e){}};s((()=>{$()}));const k=()=>{h.value=!0},M=x((()=>{switch(m.value.status){case 0:return t("未申请专用发票");case 1:return t("审核通过");case 2:return t("已申请，待审核");case 3:return t("审核未通过");default:return""}})),w=l(),q=()=>{w.value.validate().then((e=>{if(!g.value)return j({title:t("需要确认勾选才能继续"),icon:"none"});S()})).catch((e=>{}))},S=async()=>{try{m.value.is_confirm=g.value?1:0,m.value.title_type=2,m.value.invoice_type=1,m.value.is_add=0==m.value.status?1:0,await E({id:m.value.invoice_id,...m.value}),j({title:t("提交成功"),icon:"none"}),$(),h.value=!1}catch(e){}},I=()=>{};return(e,a)=>{const l=r,t=_,s=u(o("uni-easyinput"),R),$=u(o("uni-forms-item"),L),x=u(o("uni-forms"),P),j=u(o("tig-checkbox"),B),S=u(o("tig-button"),U),O=u(o("tig-fixed-placeholder"),T);return Object.keys(m.value).length>0?(c(),n(l,{key:0,class:"certification safe-padding"},{default:i((()=>[d(l,{class:"tip-box"},{default:i((()=>[d(l,{class:"tig-title"},{default:i((()=>[f(v(e.$t("温馨提示")),1)])),_:1}),d(l,null,{default:i((()=>[f(v(e.$t("首次开具增值税专用发票"))+"，"+v(e.$t("请添加资质后并提交"))+"。",1)])),_:1}),d(l,null,{default:i((()=>[f(v(e.$t("我们会在一个工作日内完成审核工作"))+"。",1)])),_:1}),d(l,null,{default:i((()=>[f(" 1."+v(e.$t("补发流程"))+"： ",1),d(t,{class:"specaial-text"},{default:i((()=>[f(v(e.$t("资质未审核通过"))+"-"+v(e.$t("登录会员中心"))+"->"+v(e.$t("增票资质"))+"->"+v(e.$t("填写资质信息"))+"->"+v(e.$t("提交"))+"。",1)])),_:1})])),_:1}),d(l,null,{default:i((()=>[f(" 2. "+v(e.$t("资质审核结果查询时间"))+"：",1),d(t,{class:"specaial-text"},{default:i((()=>[f(v(e.$t("资质上传一到两个工作日后即可查询"))+"。",1)])),_:1})])),_:1}),d(l,null,{default:i((()=>[f(" 3. "+v(e.$t("注意有效增值税专用发票开票资质仅为一个"))+"。",1)])),_:1})])),_:1}),d(l,{class:"status-box"},{default:i((()=>[d(l,{class:"status-text"},{default:i((()=>[d(l,null,{default:i((()=>[f(v(e.$t("您的增票资质状态"))+"：",1)])),_:1}),d(l,{class:"specaial-text"},{default:i((()=>[f(v(M.value),1)])),_:1})])),_:1})])),_:1}),d(l,{class:"certification-content"},{default:i((()=>[h.value?(c(),n(l,{key:0,class:"content-title"},{default:i((()=>[f(v(e.$t("填写增票资质信息")),1),d(t,{class:"specaial-text"},{default:i((()=>[f("（"+v(e.$t("所有信息均为必填"))+"）",1)])),_:1})])),_:1})):!h.value&&Object.keys(m.value).length>0?(c(),n(l,{key:1,class:"content-title"},{default:i((()=>[f(v(e.$t("增票资质信息")),1)])),_:1})):V("",!0),d(l,null,{default:i((()=>[h.value?(c(),p(y,{key:0},[d(x,{ref_key:"formRef",ref:w,modelValue:m.value,rules:b,"label-width":"180rpx"},{default:i((()=>[d($,{label:e.$t("单位名称"),name:"company_name"},{default:i((()=>[d(s,{primaryColor:"rgb(192, 196, 204)",inputBorder:!1,placeholder:e.$t("请输入单位名称"),modelValue:m.value.company_name,"onUpdate:modelValue":a[0]||(a[0]=e=>m.value.company_name=e)},null,8,["placeholder","modelValue"])])),_:1},8,["label"]),d($,{label:e.$t("纳税人识别码"),name:"company_code"},{default:i((()=>[d(s,{primaryColor:"rgb(192, 196, 204)",inputBorder:!1,placeholder:e.$t("请输入纳税人识别码"),modelValue:m.value.company_code,"onUpdate:modelValue":a[1]||(a[1]=e=>m.value.company_code=e)},null,8,["placeholder","modelValue"])])),_:1},8,["label"]),d($,{label:e.$t("注册地址"),name:"company_address"},{default:i((()=>[d(s,{primaryColor:"rgb(192, 196, 204)",inputBorder:!1,placeholder:e.$t("请输入注册地址"),modelValue:m.value.company_address,"onUpdate:modelValue":a[2]||(a[2]=e=>m.value.company_address=e)},null,8,["placeholder","modelValue"])])),_:1},8,["label"]),d($,{label:e.$t("注册电话"),name:"company_phone"},{default:i((()=>[d(s,{primaryColor:"rgb(192, 196, 204)",inputBorder:!1,placeholder:e.$t("请输入注册电话"),modelValue:m.value.company_phone,"onUpdate:modelValue":a[3]||(a[3]=e=>m.value.company_phone=e)},null,8,["placeholder","modelValue"])])),_:1},8,["label"]),d($,{label:"开户银行",name:"company_bank"},{default:i((()=>[d(s,{primaryColor:"rgb(192, 196, 204)",inputBorder:!1,placeholder:e.$t("请输入开户银行"),modelValue:m.value.company_bank,"onUpdate:modelValue":a[4]||(a[4]=e=>m.value.company_bank=e)},null,8,["placeholder","modelValue"])])),_:1}),d($,{label:e.$t("开户银行"),name:"company_account"},{default:i((()=>[d(s,{primaryColor:"rgb(192, 196, 204)",inputBorder:!1,placeholder:e.$t("请输入银行账户"),modelValue:m.value.company_account,"onUpdate:modelValue":a[5]||(a[5]=e=>m.value.company_account=e)},null,8,["placeholder","modelValue"])])),_:1},8,["label"])])),_:1},8,["modelValue"]),d(l,{class:"agreement-box"},{default:i((()=>[d(j,{checked:g.value,"onUpdate:checked":a[6]||(a[6]=e=>g.value=e),checkedSize:.7},null,8,["checked"]),f(" "+v(e.$t("我已阅读并同意")),1),d(t,{class:"specaial-text",onClick:I},{default:i((()=>[f("《"+v(e.$t("增票资质确认书"))+"》",1)])),_:1})])),_:1})],64)):V("",!0),0!==m.value.status||h.value?!h.value&&Object.keys(m.value).length>0?(c(),n(x,{key:2,ref_key:"formRef",ref:w,class:C({readonly:!h.value}),modelValue:m.value,rules:b,"label-width":"180rpx"},{default:i((()=>[d($,{label:e.$t("单位名称")},{default:i((()=>[d(l,{class:"disabled-text"},{default:i((()=>[f(v(m.value.company_name),1)])),_:1})])),_:1},8,["label"]),d($,{label:e.$t("纳税人识别码")},{default:i((()=>[d(l,{class:"disabled-text"},{default:i((()=>[f(v(m.value.company_code),1)])),_:1})])),_:1},8,["label"]),d($,{label:e.$t("注册地址")},{default:i((()=>[d(l,{class:"disabled-text"},{default:i((()=>[f(v(m.value.company_address),1)])),_:1})])),_:1},8,["label"]),d($,{label:e.$t("注册电话")},{default:i((()=>[d(l,{class:"disabled-text"},{default:i((()=>[f(v(m.value.company_phone),1)])),_:1})])),_:1},8,["label"]),d($,{label:e.$t("开户银行")},{default:i((()=>[d(l,{class:"disabled-text"},{default:i((()=>[f(v(m.value.company_bank),1)])),_:1})])),_:1},8,["label"]),d($,{label:e.$t("银行账户")},{default:i((()=>[d(l,{class:"disabled-text"},{default:i((()=>[f(v(m.value.company_account),1)])),_:1})])),_:1},8,["label"])])),_:1},8,["class","modelValue"])):V("",!0):(c(),n(l,{key:1,class:"empty-text"},{default:i((()=>[f(v(e.$t("暂无增票资质信息"))+"!",1)])),_:1}))])),_:1})])),_:1}),h.value?(c(),n(O,{key:0,backgroundColor:"#fff"},{default:i((()=>[d(l,{class:"btn-box"},{default:i((()=>[d(S,{class:"btn",plain:"",onClick:a[7]||(a[7]=e=>h.value=!1)},{default:i((()=>[f(v(e.$t("取消")),1)])),_:1}),d(S,{class:"btn",onClick:q},{default:i((()=>[f(v(e.$t("提交")),1)])),_:1})])),_:1})])),_:1})):(c(),n(O,{key:1,backgroundColor:"#fff"},{default:i((()=>[d(l,{class:"btn-box"},{default:i((()=>[d(S,{onClick:k},{default:i((()=>[f(v(0===m.value.status?e.$t("添加增票资质"):e.$t("修改并重新审核")),1)])),_:1})])),_:1})])),_:1}))])),_:1})):V("",!0)}}}),[["__scopeId","data-v-44ab9152"]]),F=k(e({__name:"index",setup(e){const a=t([{type:"list",value:"已完成订单"},{type:"invoice",value:"增票资质"}]),s=l(),b=l("list"),g={navbar:"1",return:"1",title:"发票管理"};return M((e=>{e&&e.type&&(b.value=e.type)})),w((()=>{"list"===b.value&&s.value.filterParams.page<Math.ceil(s.value.total/s.value.filterParams.size)&&(s.value.filterParams.page++,s.value.__getOrderList())})),(e,l)=>{const t=_,h=r,$=u(o("tig-layout"),q);return c(),n($,null,{default:i((()=>[d(h,{class:"invoice-management"},{default:i((()=>[d(S,{parameter:g}),d(h,{class:"invoice-menu"},{default:i((()=>[(c(!0),p(y,null,m(a,(a=>(c(),n(h,{key:a.type,class:C(["invoice-menu-item",{active:b.value===a.type}]),onClick:e=>{return l=a.type,void(b.value=l);var l}},{default:i((()=>[d(t,{class:"invoice-menu-item-text"},{default:i((()=>[f(v(e.$t(a.value)),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1}),d(h,{class:"placeholder"}),d(h,{class:"invoice-content"},{default:i((()=>["list"===b.value?(c(),n(K,{key:0,ref_key:"invoiceListRef",ref:s},null,512)):V("",!0),"invoice"===b.value?(c(),n(N,{key:1})):V("",!0)])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-9d5c6e1a"]]);export{F as default};
