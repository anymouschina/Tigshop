import{e as a,G as t,Q as e,r as l,g as s,c as i,w as r,v as o,z as n,at as c,o as u,a as d,i as _,A as p,E as m,F as y,K as f,B as g,d as v,b as k,t as x,$ as b,T as h,X as w,ac as $,N as C,a3 as S,M as j,ag as D,_ as V}from"./index-BKXBH4vI.js";import{_ as T}from"./tig-image.BbZoJ9nS.js";import{_ as U}from"./format-price.0qAAshfo.js";import{_ as z,a as L}from"./tig-layout.DMoUsUKf.js";import{_ as M}from"./loading-box.BnnJRdlH.js";import{_ as q}from"./tig-loadingpage.vue_vue_type_script_setup_true_lang.Dhxkn5Gn.js";import{n as B}from"./index.xrDesKlL.js";import{_ as I}from"./empty-box.vue_vue_type_script_setup_true_lang.BoUZcl39.js";import{b as K,c as N,d as A,o as G,e as E}from"./order.BjcCWkE9.js";import{u as F}from"./useList.D_gHwM0_.js";import"./product.BhwveQst.js";const J=V(a({__name:"list",setup(a){const{t:V}=t(),J={navbar:"1",return:"1",title:"我的订单"},Q=e([{type:"all",value:V("全部订单"),badge:{value:0}},{type:"await_pay",value:V("待支付"),badge:{value:0}},{type:"await_shipping",value:V("待发货"),badge:{value:0}},{type:"await_received",value:V("待收货"),badge:{value:0}},{type:"await_comment",value:V("待评价"),badge:{value:0}}]),X=l("all"),Y=e({page:1,size:10,order_status:-1,comment_status:-1}),H=l(0),O=a=>{X.value!==a.type&&(X.value=a.type,Y.page=1,R.value=[],"await_comment"===a.type?(Y.comment_status=0,Y.order_status=-1):(Y.order_status=ta(a.type),Y.comment_status=-1),P())},{getList:P,data:R,isLoadMore:W,isLoading:Z,total:aa}=F(K,{params:Y,path:{dataKey:"filter_result"}}),ta=a=>{switch(a){case"all":default:return-1;case"await_pay":return 0;case"await_shipping":return 1;case"await_received":return 2}};return s((a=>{a&&a.type&&(H.value=Q.findIndex((t=>t.type===a.type)),"await_comment"===a.type?Y.comment_status=0:Y.order_status=ta(a.type),X.value=a.type),P()})),(a,t)=>{const e=o(n("up-tabs"),c),l=_,s=v,K=o(n("tig-image"),T),F=o(n("format-price"),U),X=b,ta=o(n("tig-button"),L),ea=o(n("loading-box"),M),la=o(n("tig-loadingpage"),q),sa=o(n("tig-layout"),z);return u(),i(sa,null,{default:r((()=>[d(l,{class:"order"},{default:r((()=>[d(B,{parameter:J}),d(l,{class:"order-menu badgecolor"},{default:r((()=>[d(e,{lineColor:"var(--general)",list:Q,activeStyle:{padding:"0 10rpx"},inactiveStyle:{padding:"0 10rpx"},scrollable:!0,onChange:O,keyName:"value",current:H.value,"onUpdate:current":t[0]||(t[0]=a=>H.value=a)},null,8,["list","current"])])),_:1}),d(l,{class:"placeholder"}),d(l,{class:"order-list"},{default:r((()=>[(u(!0),m(y,null,f(g(R),(t=>(u(),i(l,{key:t.order_id,class:"order-list-item"},{default:r((()=>[d(l,{class:"order-list-item-header"},{default:r((()=>[d(s,{class:"special-text"},{default:r((()=>[k(x(a.$t("订单编号"))+"：",1),d(s,{class:"special-color"},{default:r((()=>[k(x(t.order_sn),1)])),_:2},1024)])),_:2},1024),d(s,null,{default:r((()=>[k(x(t.order_status_name),1)])),_:2},1024)])),_:2},1024),d(l,{class:"order-list-item-content"},{default:r((()=>[d(l,{class:"item-content-text"},{default:r((()=>[d(l,null,{default:r((()=>[k(x(a.$t("收件人"))+"："+x(t.consignee),1)])),_:2},1024),d(l,{class:"special-color"},{default:r((()=>[k(x(t.add_time),1)])),_:2},1024)])),_:2},1024),d(l,{class:"item-content-product"},{default:r((()=>[(u(!0),m(y,null,f(t.items,(t=>(u(),i(X,{key:t.item_id,url:"/pages/user/order/info?id="+t.order_id,"hover-class":"navigator-hover"},{default:r((()=>[d(l,{class:"item-content-product-item"},{default:r((()=>[d(l,{class:"item-content-product-img"},{default:r((()=>[d(K,{src:t.pic_thumb,"onUpdate:src":a=>t.pic_thumb=a},null,8,["src","onUpdate:src"]),1===t.is_gift?(u(),i(l,{key:0,class:"gift-text"},{default:r((()=>[k(x(a.$t("赠品")),1)])),_:1})):p("",!0)])),_:2},1024),d(l,{class:"item-content-product-info"},{default:r((()=>[d(l,{class:"product-item-title"},{default:r((()=>[k(x(t.product_name),1)])),_:2},1024),d(l,{class:h(["sku-card",{nodata:0===t.sku_data.length}])},{default:r((()=>[t.sku_data.length>0?(u(!0),m(y,{key:0},f(t.sku_data,((a,t)=>(u(),i(l,{key:t,class:"sku-item line1"},{default:r((()=>[k(x(a.value),1)])),_:2},1024)))),128)):p("",!0)])),_:2},1032,["class"]),t.extra_sku_data&&t.extra_sku_data.length?(u(),i(l,{key:0,class:"extraskudata-box"},{default:r((()=>[d(l,{class:"extraskudata"},{default:r((()=>[(u(!0),m(y,null,f(t.extra_sku_data,(a=>(u(),i(l,{key:a,class:"extraskudata-item"},{default:r((()=>[d(l,{class:"title"},{default:r((()=>[k(x(a.attr_name),1)])),_:2},1024),d(l,{class:"line-box"},{default:r((()=>[d(l,{class:"line"})])),_:1}),d(l,{class:"content"},{default:r((()=>[d(s,{class:"line1 content-text"},{default:r((()=>[k(x(a.attr_value),1)])),_:2},1024),d(F,{showText:!1,class:"price",priceData:a.attr_price},null,8,["priceData"]),d(l,{class:"num"},{default:r((()=>[k("x"+x(t.quantity),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:2},1024)])),_:2},1024)):p("",!0),d(l,{class:"product-item-price"},{default:r((()=>[d(F,{showText:!1,class:"product-item-pricenum",decimalsStyle:{fontSize:"25rpx"},currencyStyle:{fontSize:"23rpx"},priceData:t.price},null,8,["priceData"]),d(l,{class:"product-item-quantity"},{default:r((()=>[k("x "+x(t.quantity),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["url"])))),128))])),_:2},1024),d(l,{class:"item-content-pay"},{default:r((()=>[d(l,{class:"item-content-pay-box"},{default:r((()=>[d(l,{class:"pay-item pay-type"},{default:r((()=>[k(x(1===t.pay_type_id?a.$t("在线支付"):2===t.pay_type_id?a.$t("货到付款"):g(V)("线下支付")),1)])),_:2},1024),d(l,{class:"pay-item total-money"},{default:r((()=>[k(x(a.$t("总额"))+"：",1),d(F,{showText:!1,isBottom:!1,priceData:t.total_amount},null,8,["priceData"])])),_:2},1024),0===t.order_status&&Number(t.unpaid_amount)>0?(u(),i(l,{key:0,class:"pay-item"},{default:r((()=>[k(x(a.$t("应付"))+"：",1),d(F,{showText:!1,isBottom:!1,priceData:t.unpaid_amount},null,8,["priceData"])])),_:2},1024)):p("",!0)])),_:2},1024)])),_:2},1024)])),_:2},1024),d(l,{class:"order-list-item-btn"},{default:r((()=>[d(l,{class:"item-btn-box"},{default:r((()=>[d(ta,{class:"btn-margin",customStyle:{height:"55rpx"},plain:!0,plainMainColor:!0,onClick:a=>{return e=t.order_id,void j({url:`/pages/user/order/info?id=${e}`});var e}},{default:r((()=>[k(x(a.$t("订单详情")),1)])),_:2},1032,["onClick"]),t.available_actions.to_pay?(u(),i(ta,{key:0,class:"btn-margin",color:"#333",customStyle:{height:"55rpx"},plain:!0,onClick:a=>{return e=t.order_id,void j({url:`/pages/order/pay?order_id=${e}`});var e}},{default:r((()=>[k(x(a.$t("去付款")),1)])),_:2},1032,["onClick"])):p("",!0),t.available_actions.cancel_order?(u(),i(ta,{key:1,color:"#333",class:"btn-margin",customStyle:{height:"55rpx"},plain:!0,onClick:a=>(async a=>{$({title:V("提示"),content:V("确认要取消该订单吗？"),success:async t=>{if(t.confirm)try{await N({id:a}),Y.page=1,R.value=[],P()}catch(e){C({title:e.message,icon:"none"})}}})})(t.order_id)},{default:r((()=>[k(x(a.$t("取消订单")),1)])),_:2},1032,["onClick"])):p("",!0),t.available_actions.del_order?(u(),i(ta,{key:2,color:"#333",class:"btn-margin",customStyle:{height:"55rpx"},plain:!0,onClick:a=>(async a=>{$({title:V("提示"),content:V("确认要删除该订单吗？"),success:async t=>{if(t.confirm)try{await A({id:a}),Y.page=1,R.value=[],P()}catch(e){C({title:e.message,icon:"none"})}}})})(t.order_id)},{default:r((()=>[k(x(a.$t("删除订单")),1)])),_:2},1032,["onClick"])):p("",!0),t.available_actions.rebuy?(u(),i(ta,{key:3,color:"#333",class:"btn-margin",customStyle:{height:"55rpx"},plain:!0,onClick:a=>(async a=>{try{await G({id:a}),S({url:"/pages/cart/index"})}catch(t){C({title:t.message,icon:"none"})}})(t.order_id)},{default:r((()=>[k(x(a.$t("再次购买")),1)])),_:2},1032,["onClick"])):p("",!0),t.available_actions.to_comment?(u(),i(ta,{key:4,color:"#333",class:"btn-margin",customStyle:{height:"55rpx"},plain:!0,onClick:a=>{return e=t.order_id,void j({url:`/pages/user/comment/info?id=${e}`});var e}},{default:r((()=>[k(x(a.$t("去评价")),1)])),_:2},1032,["onClick"])):p("",!0),t.available_actions.confirm_receipt?(u(),i(ta,{key:5,color:"#333",class:"btn-margin",customStyle:{height:"55rpx"},plain:!0,onClick:a=>{return e=t.order_id,void $({title:V("提示"),content:V("确认收货吗？"),success:async a=>{if(a.confirm)try{await E({id:e}),D({url:"/pages/user/order/list?type=await_comment"})}catch(t){C({title:t.message,icon:"none"})}}});var e}},{default:r((()=>[k(x(a.$t("确认收货")),1)])),_:2},1032,["onClick"])):p("",!0)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1}),d(ea,{modelValue:g(W),"onUpdate:modelValue":t[1]||(t[1]=a=>w(W)?W.value=a:null),page:Y.page,length:g(R).length},null,8,["modelValue","page","length"]),g(Z)||0!==g(aa)?p("",!0):(u(),i(I,{key:0,mode:"list",background:"#f5f5f5",text:a.$t("暂无订单")},null,8,["text"]))])),_:1}),d(la,{modelValue:g(Z),"onUpdate:modelValue":t[2]||(t[2]=a=>w(Z)?Z.value=a:null)},null,8,["modelValue"])])),_:1})}}}),[["__scopeId","data-v-adab8ce8"]]);export{J as default};
