import{Y as e,e as a,G as l,R as s,r as t,P as o,v as i,z as n,c as u,o as d,w as r,a as c,i as g,b as m,t as p,E as _,K as h,T as v,F as f,A as y,S as w,J as V,_ as k}from"./index-BKXBH4vI.js";import{b}from"./tig-layout.DMoUsUKf.js";const j=k(a({__name:"selectRegion",props:{show:{type:Boolean,default:!1,required:!0},height:{type:String,default:"60vh"},modelValue:{type:Array,default:()=>[]}},emits:["update:show","update:modelValue","sendRegionNames"],setup(a,{emit:k}){const{t:j}=l(),C=a,R=k,E=s({get:()=>C.show,set:()=>{R("update:show",!1)}}),x=t([]),A=t(0),N=async()=>{try{let a="";C.modelValue.length>0&&(a=C.modelValue.join(","));const l=await(a=>e({url:"sys/region/get_region",method:"get",params:{region_ids:a}}))(a);Object.assign(x.value,l.region_list),A.value=l.region_list&&l.region_list.length>1?l.region_list.length-1:0}catch(a){}};o((()=>C.modelValue),((e,a)=>{e&&N()}),{immediate:!0,deep:!0});const S=e=>C.modelValue.includes(e),$=s((()=>{let e=[];return x.value.forEach(((a,l)=>{if(a.length>0){let s=!1;a.forEach((a=>{S(a.region_id)&&(e[l]=a.region_name,s=!0)})),0==s&&(e[l]=j("请选择地区"))}})),e}));return(e,a)=>{const l=g,s=w,t=i(n("tig-popup"),b);return d(),u(t,{show:E.value,"onUpdate:show":a[0]||(a[0]=e=>E.value=e),position:"bottom"},{default:r((()=>[c(l,{class:"select-region-main"},{default:r((()=>[c(l,{class:"popup-title"},{default:r((()=>[m(p(e.$t("选择地区")),1)])),_:1}),c(l,{class:"content"},{default:r((()=>[c(l,{class:"region-menu"},{default:r((()=>[(d(!0),_(f,null,h($.value,((a,s)=>(d(),u(l,{class:v(["region-menu-item",{active:A.value===s}]),onClick:e=>A.value=s,key:s},{default:r((()=>[m(p(a||e.$t("请选择")),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),(d(!0),_(f,null,h(x.value,((e,a)=>(d(),_(f,{key:a},[A.value===a?(d(),u(s,{key:0,"scroll-y":"true",class:"region-list"},{default:r((()=>[(d(!0),_(f,null,h(e,(e=>(d(),u(l,{class:v(["region-list-item",{active:S(e.region_id)}]),key:e.region_id,onClick:V((l=>(async(e,a)=>{e>=0&&e<=C.modelValue.length&&(C.modelValue[e]=a,C.modelValue.splice(e+1)),await N(),x.value.length==e+1||0==x.value[e+1].length?(R("update:modelValue",C.modelValue),R("update:show",!1),R("sendRegionNames",$.value)):A.value=e+1})(a,e.region_id)),["stop"])},{default:r((()=>[m(p(e.region_name),1)])),_:2},1032,["class","onClick"])))),128))])),_:2},1024)):y("",!0)],64)))),128))])),_:1})])),_:1})])),_:1},8,["show"])}}}),[["__scopeId","data-v-8f05c14f"]]);export{j as s};
