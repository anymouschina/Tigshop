import{d as e,G as a,Q as l,r as o,o as t,f as n,k as r,l as m,m as i,n as d,w as c,q as p,t as u,v as s,V as _,y,F as b,af as f,B as v,C as h}from"./index-Do_Cb7fn.js";import{_ as g,a as $}from"./u-radio-group.BgbJeO8e.js";import{_ as V,a as k}from"./uni-forms.7UC4mlQa.js";import{_ as x}from"./uni-easyinput.DgTgv_xO.js";import{a as C,_ as j}from"./tig-layout.BV0ZvCt0.js";import{_ as B}from"./save-bottom-box.BM5fwIJO.js";import{a as M,g as U}from"./invoice.9xgOpt71.js";import{o as q,a as w}from"./invoiceManagemen.Db_DG8CQ.js";import{n as I}from"./index.Y6J4G1_A.js";import{_ as P}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./u-icon.CBDMG2rO.js";import"./uni-icons.DK0ZiICA.js";import"./u-loading-icon.rQrrZF_r.js";const R=P(e({__name:"applyInvoice",setup(e){const{t:P}=a(),R=l({navbar:"1",return:"1",title:"发票申请"}),S=l({title_type:1,invoice_type:1,company_name:"",mobile:"",email:"",company_code:"",company_address:"",company_phone:"",company_bank:"",company_account:""}),z={company_code:{rules:[{required:!0,errorMessage:P("纳税人识号不能为空!")}]},company_address:{rules:[{required:!0,errorMessage:P("单位地址不能为空!")}]},company_phone:{rules:[{required:!0,errorMessage:P("单位电话不能为空!")}]},company_bank:{rules:[{required:!0,errorMessage:P("开户银行不能为空!")}]},company_account:{rules:[{required:!0,errorMessage:P("银行账户不能为空!")}]},mobile:{rules:[{required:!0,errorMessage:P("手机不能为空!")}]}},D=o(0),F=o(!1),G=async()=>{try{const e=await U({invoice_type:S.invoice_type,title_type:S.title_type});e.item&&(1===S.invoice_type&&1===S.title_type?(S.company_name=e.item.company_name,S.mobile=e.item.mobile,S.email=e.item.email):(S.company_code=e.item.company_code,S.company_name=e.item.company_name,S.company_address=e.item.company_address,S.company_phone=e.item.company_phone,S.company_bank=e.item.company_bank,S.company_account=e.item.company_account),S.mobile=e.item.mobile,S.email=e.item.email)}catch(e){console.error(e)}},H=e=>{S.invoice_type=e,S.title_type=2===e?2:1,S.company_name="",S.mobile="",S.email="",S.company_code="",S.company_address="",S.company_phone="",S.company_bank="",S.company_account="",G()},L=o(),N=o("insert"),Q=()=>{L.value.validate().then((e=>{"insert"===N.value?(async()=>{try{D.value,await q(S),f({url:"/pages/user/invoiceManagement/index?type=list"})}catch(e){console.error(e)}})():(async()=>{try{const e={...S,id:D.value};await w(e),f({url:"/pages/user/invoiceManagement/index?type=list"})}catch(e){console.error(e)}})()})).catch((e=>{console.log("表单错误信息：",e)}))};t((e=>{e&&e.type&&(N.value=e.type,D.value=e.order_id)})),n((()=>{(async()=>{try{(await M()).item?F.value=!0:F.value=!1}catch(e){console.error(e)}})(),G()}));const W=()=>{f({url:"/pages/user/invoiceManagement/index?type=invoice"})};return(e,a)=>{const l=v,o=h,t=r(m("up-radio"),g),n=r(m("up-radio-group"),$),f=r(m("uni-forms-item"),V),M=r(m("uni-easyinput"),x),U=r(m("uni-forms"),k),q=r(m("tig-button"),C),w=r(m("save-bottom-box"),B),P=r(m("tig-layout"),j);return i(),d(o,null,{default:c((()=>[p(P,{specialNum:65},{default:c((()=>[p(I,{parameter:R},null,8,["parameter"]),p(o,{class:"invoice-popup-content"},{default:c((()=>[p(o,{class:"invoice-typemenu"},{default:c((()=>[p(o,{class:"invoice-explain"},{default:c((()=>[u(s(e.$t("我公司依法开具发票，请您按照税法规定使用发票。根据现行税收政策，部分公司提供数电票"))+", "+s(e.$t("数电（专用发票）法律效力与现有增值税专用发票相同;如商品由第三方卖家销售，发票类型和内容将由该卖家决定，发票由卖家开具并提供。如您为企业采购，需要多单合并开具或批量提交发票可注册企业用户"))+"；",1),p(l,{class:"main-color"},{default:c((()=>[u(s(e.$t("使用礼品卡支付部分的金额，不支持开发票")),1)])),_:1})])),_:1}),p(o,{class:_(["invoice-typemenu-item",{active:1===S.invoice_type}]),onClick:a[0]||(a[0]=e=>H(1))},{default:c((()=>[u(s(e.$t("普通发票")),1)])),_:1},8,["class"]),p(o,{class:_(["invoice-typemenu-item",{active:2===S.invoice_type}]),onClick:a[1]||(a[1]=e=>H(2))},{default:c((()=>[u(s(e.$t("增值税专用发票")),1)])),_:1},8,["class"])])),_:1}),p(o,{class:"invoice-formState"},{default:c((()=>[p(U,{ref_key:"formRef",ref:L,modelValue:S,rules:z,"label-width":"170rpx"},{default:c((()=>[1===S.invoice_type?(i(),y(b,{key:0},[p(f,{label:e.$t("发票抬头"),name:"name"},{default:c((()=>[p(o,{class:"item-layout"},{default:c((()=>[p(n,{modelValue:S.title_type,"onUpdate:modelValue":a[2]||(a[2]=e=>S.title_type=e),placement:"row"},{default:c((()=>[p(t,{customStyle:{marginRight:"22rpx"},name:1,activeColor:"var(--general)",label:e.$t("个人")},null,8,["label"]),p(t,{name:2,activeColor:"var(--general)",label:e.$t("企业")},null,8,["label"])])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["label"]),1==S.title_type?(i(),d(f,{key:0,label:e.$t("个人名称"),name:"company_name",rules:[{required:!0,errorMessage:e.$t("个人名称不能为空")}]},{default:c((()=>[p(M,{primaryColor:"rgb(192, 196, 204)",inputBorder:!1,modelValue:S.company_name,"onUpdate:modelValue":a[3]||(a[3]=e=>S.company_name=e),placeholder:e.$t("请输入个人名称")},null,8,["modelValue","placeholder"])])),_:1},8,["label","rules"])):(i(),y(b,{key:1},[p(f,{label:e.$t("企业名称"),name:"company_name",rules:[{required:!0,errorMessage:"企业名称不能为空"}]},{default:c((()=>[p(M,{primaryColor:"rgb(192, 196, 204)",inputBorder:!1,modelValue:S.company_name,"onUpdate:modelValue":a[4]||(a[4]=e=>S.company_name=e),placeholder:e.$t("请输入企业名称")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),p(f,{label:e.$t("纳税人识号"),name:"company_code"},{default:c((()=>[p(M,{primaryColor:"rgb(192, 196, 204)",inputBorder:!1,modelValue:S.company_code,"onUpdate:modelValue":a[5]||(a[5]=e=>S.company_code=e),placeholder:e.$t("请输入纳税人识号")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),p(f,{label:e.$t("单位地址"),name:"company_address"},{default:c((()=>[p(M,{primaryColor:"rgb(192, 196, 204)",inputBorder:!1,modelValue:S.company_address,"onUpdate:modelValue":a[6]||(a[6]=e=>S.company_address=e),placeholder:e.$t("请输入单位地址")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),p(f,{label:e.$t("单位电话"),name:"company_phone"},{default:c((()=>[p(M,{primaryColor:"rgb(192, 196, 204)",inputBorder:!1,modelValue:S.company_phone,"onUpdate:modelValue":a[7]||(a[7]=e=>S.company_phone=e),placeholder:e.$t("请输入单位电话")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),p(f,{label:e.$t("开户银行"),name:"company_bank"},{default:c((()=>[p(M,{primaryColor:"rgb(192, 196, 204)",inputBorder:!1,modelValue:S.company_bank,"onUpdate:modelValue":a[8]||(a[8]=e=>S.company_bank=e),placeholder:e.$t("请输入开户银行")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),p(f,{label:e.$t("银行账户"),name:"company_account"},{default:c((()=>[p(M,{primaryColor:"rgb(192, 196, 204)",inputBorder:!1,modelValue:S.company_account,"onUpdate:modelValue":a[9]||(a[9]=e=>S.company_account=e),placeholder:e.$t("请输入银行账户")},null,8,["modelValue","placeholder"])])),_:1},8,["label"])],64)),p(f,{label:e.$t("收票人手机"),name:"mobile"},{default:c((()=>[p(M,{primaryColor:"rgb(192, 196, 204)",inputBorder:!1,modelValue:S.mobile,"onUpdate:modelValue":a[10]||(a[10]=e=>S.mobile=e),placeholder:e.$t("请输入收票人手机")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),p(f,{label:e.$t("收票人邮箱"),name:"email"},{default:c((()=>[p(M,{primaryColor:"rgb(192, 196, 204)",inputBorder:!1,modelValue:S.email,"onUpdate:modelValue":a[11]||(a[11]=e=>S.email=e),placeholder:e.$t("请输入收票人邮箱")},null,8,["modelValue","placeholder"])])),_:1},8,["label"])],64)):2===S.invoice_type&&F.value?(i(),y(b,{key:1},[p(f,{label:e.$t("单位名称")},{default:c((()=>[p(o,{class:"disabled-text"},{default:c((()=>[u(s(S.company_name),1)])),_:1})])),_:1},8,["label"]),p(f,{label:e.$t("纳税人识别码")},{default:c((()=>[p(o,{class:"disabled-text"},{default:c((()=>[u(s(S.company_code),1)])),_:1})])),_:1},8,["label"]),p(f,{label:e.$t("注册地址")},{default:c((()=>[p(o,{class:"disabled-text"},{default:c((()=>[u(s(S.company_address),1)])),_:1})])),_:1},8,["label"]),p(f,{label:e.$t("注册电话")},{default:c((()=>[p(o,{class:"disabled-text"},{default:c((()=>[u(s(S.company_phone),1)])),_:1})])),_:1},8,["label"]),p(f,{label:e.$t("开户银行")},{default:c((()=>[p(o,{class:"disabled-text"},{default:c((()=>[u(s(S.company_bank),1)])),_:1})])),_:1},8,["label"]),p(f,{label:e.$t("银行账户")},{default:c((()=>[p(o,{class:"disabled-text"},{default:c((()=>[u(s(S.company_account),1)])),_:1})])),_:1},8,["label"]),p(f,{label:e.$t("收票人手机"),name:"mobile"},{default:c((()=>[p(M,{primaryColor:"rgb(192, 196, 204)",inputBorder:!1,modelValue:S.mobile,"onUpdate:modelValue":a[12]||(a[12]=e=>S.mobile=e),placeholder:e.$t("请输入收票人手机")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),p(f,{label:e.$t("收票人邮箱"),name:"email"},{default:c((()=>[p(M,{primaryColor:"rgb(192, 196, 204)",inputBorder:!1,modelValue:S.email,"onUpdate:modelValue":a[13]||(a[13]=e=>S.email=e),placeholder:e.$t("请输入收票人邮箱")},null,8,["modelValue","placeholder"])])),_:1},8,["label"])],64)):(i(),d(o,{key:2,class:"notPass"},{default:c((()=>[p(o,null,{default:c((()=>[u(s(e.$t("您还未通过增票资质申请，暂时无法开具增值税专用发票"))+" ",1),p(l,{class:"notPassBtn",onClick:W},{default:c((()=>[u(s(e.$t("去申请")),1)])),_:1})])),_:1})])),_:1}))])),_:1},8,["modelValue"])])),_:1}),p(w,{height:"65",backgroundColor:"#fff"},{default:c((()=>[p(o,{class:"btn-box"},{default:c((()=>[p(q,{style:{width:"100%",height:"70rpx"},disabled:2===S.invoice_type&&!F.value,onClick:Q},{default:c((()=>[u(s(e.$t("提交")),1)])),_:1},8,["disabled"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-37637315"]]);export{R as default};
