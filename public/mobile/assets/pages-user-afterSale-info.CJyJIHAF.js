import{e,E as a,f as t,r as l,k as s,ag as u,g as r,ah as f,L as c,R as n,c as i,w as o,i as d,q as _,y as p,o as v,a as m,D as g,z as y,F as h,b as $,t as b,J as k,aa as I,ae as x,P as S,_ as B}from"./index-BKzbZvRR.js";import{_ as D}from"./uni-steps.B0H3NFeo.js";import{_ as T}from"./uni-icons.DELFdrY8.js";import{_ as j}from"./tig-image.DrOwWlV9.js";import{_ as C}from"./format-price.kSnuguuz.js";import{a as w,_ as N}from"./tig-layout.BpNdXByQ.js";import{_ as z}from"./tig-fixed-placeholder.s9cnCRBL.js";import{b as A,d as O}from"./afterSale.CaZTaIe1.js";const E=B(e({__name:"info",setup(e){const{t:B}=a();t((e=>{e&&e.id&&(E.value=Number(e.id),R())})),s((()=>{u("refreshInfo",(e=>{E.value=e,R()}))})),r((()=>{f("refreshInfo")}));const E=l(),q=l({}),G=l(0),R=async()=>{try{const e=await A(E.value);q.value=e,q.value.aftersalesItems.forEach((e=>{G.value+=e.number}))}catch(e){console.error(e),c({title:e.message,icon:"none"})}},W=()=>{I({title:B("提示"),content:B("确认要撤销申请吗？"),success:async e=>{if(e.confirm)try{await O({aftersaleId:q.value.aftersaleId});c({title:B("撤销成功")}),x({url:"/pages/user/afterSale/list"})}catch(a){console.error(a)}}})},F=async()=>{try{1===q.value.aftersalesItems.length?x({url:`/pages/user/afterSale/edit?aftersaleId=${q.value.aftersaleId}&itemId=${q.value.aftersalesItems[0].orderItemId}`}):x({url:`/pages/user/afterSale/edit?aftersaleId=${q.value.aftersaleId}`})}catch(e){console.error(e)}},J=l(!0),L=n((()=>q.value.returnGoodsTip&&J.value)),P=()=>{S({url:"/pages/user/afterSale/negotiate?id="+q.value.aftersaleId})},H=()=>{S({url:`/pages/user/afterSale/shipments?id=${q.value.aftersaleId}&returnAddress=${q.value.returnAddress}`})};return(e,a)=>{const t=d,l=_(p("uni-steps"),D),s=_(p("uni-icons"),T),u=_(p("tig-image"),j),r=_(p("format-price"),C),f=_(p("tig-button"),w),c=_(p("tig-fixed-placeholder"),z),n=_(p("tig-layout"),N);return v(),i(t,{class:"after-sale-info"},{default:o((()=>[m(n,{needSafeTop:!0},{default:o((()=>[Object.keys(q.value).length?(v(),g(h,{key:0},[L.value?(v(),i(t,{key:0,class:"returngoodstip-box"},{default:o((()=>[m(t,{class:"returngoodstip-bg"}),m(t,{class:"returngoodstip-content"},{default:o((()=>[m(t,{class:"iconfont-h5 icon-tongzhi"}),m(t,{class:"returngoodstip-text line1"},{default:o((()=>[$(b(q.value.returnGoodsTip),1)])),_:1}),m(t,{class:"iconfont-h5 icon-chacha",onClick:a[0]||(a[0]=e=>J.value=!1)})])),_:1})])),_:1})):y("",!0),m(t,{class:"after-sal-info-steps"},{default:o((()=>[m(l,{"active-color":"var(--general)",options:q.value.stepStatus.steps,active:q.value.stepStatus.current},null,8,["options","active"])])),_:1}),3===q.value.status?(v(),i(t,{key:1,class:"refuse-reply"},{default:o((()=>[m(t,{class:"refuse-reply-title"},{default:o((()=>[$(b(e.$t("拒绝原因"))+": ",1)])),_:1}),m(t,{class:"refuse-reply-content line1"},{default:o((()=>[$(b(q.value.reply),1)])),_:1})])),_:1})):y("",!0),m(t,{class:"negotiate",onClick:P},{default:o((()=>[m(t,{class:"negotiate-text"},{default:o((()=>[$(b(e.$t("查看协商记录")),1)])),_:1}),m(t,{class:"negotiate-icon"},{default:o((()=>[m(s,{type:"right",size:"20",color:"#999"})])),_:1})])),_:1}),4===q.value.status?(v(),i(t,{key:2,class:"negotiate",onClick:H},{default:o((()=>[m(t,{class:"negotiate-text"},{default:o((()=>[$(b(e.$t("去发货")),1)])),_:1}),m(t,{class:"negotiate-icon"},{default:o((()=>[m(s,{type:"right",size:"20",color:"#999"})])),_:1})])),_:1})):y("",!0),m(t,{class:"info-content"},{default:o((()=>[m(t,{class:"info-content-title"},{default:o((()=>[$(b(e.$t("售后信息")),1)])),_:1}),m(t,{class:"info-content-product"},{default:o((()=>[(v(!0),g(h,null,k(q.value.aftersalesItems,(e=>(v(),i(t,{class:"info-content-product-item",onClick:a=>{return t=e.productId,void S({url:`/pages/product/index?id=${t}`});var t},key:e.aftersalesItemId},{default:o((()=>[m(t,{class:"product-item-left"},{default:o((()=>[m(u,{src:e.picThumb},null,8,["src"])])),_:2},1024),m(t,{class:"product-item-right"},{default:o((()=>[m(t,{class:"product-item-name line2"},{default:o((()=>[$(b(e.productName),1)])),_:2},1024),m(t,{class:"right-price"},{default:o((()=>[m(r,{showText:!1,decimalsStyle:{fontSize:"23rpx",fontWeight:"bold"},currencyStyle:{fontSize:"21rpx",fontWeight:"bold"},class:"right-price-pricenum",priceData:e.price},null,8,["priceData"]),m(t,{class:"right-price-quantity"},{default:o((()=>[$("x "+b(e.number),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1}),m(t,{class:"refund-info"},{default:o((()=>[Number(q.value.refundAmount)>0?(v(),i(t,{key:0,class:"refund-info-item"},{default:o((()=>[m(t,{class:"label"},{default:o((()=>[$(b(e.$t("退款金额"))+"：",1)])),_:1}),m(t,{class:"value price"},{default:o((()=>[m(r,{showText:!1,isBottom:!1,priceData:q.value.refundAmount},null,8,["priceData"])])),_:1})])),_:1})):y("",!0),m(t,{class:"refund-info-item"},{default:o((()=>[m(t,{class:"label"},{default:o((()=>[$(b(e.$t("售后方式"))+"：",1)])),_:1}),m(t,{class:"value"},{default:o((()=>[$(b(q.value.aftersalesTypeName),1)])),_:1})])),_:1}),m(t,{class:"refund-info-item"},{default:o((()=>[m(t,{class:"label"},{default:o((()=>[$(b(e.$t("退款原因"))+"：",1)])),_:1}),m(t,{class:"value"},{default:o((()=>[$(b(q.value.aftersaleReason),1)])),_:1})])),_:1})])),_:1}),m(t,{class:"after-sale"},{default:o((()=>[m(t,{class:"after-sale-item"},{default:o((()=>[m(t,{class:"label"},{default:o((()=>[$(b(e.$t("售后编号"))+"：",1)])),_:1}),m(t,{class:"value"},{default:o((()=>[$(b(q.value.aftersalesSn),1)])),_:1})])),_:1}),m(t,{class:"after-sale-item"},{default:o((()=>[m(t,{class:"label"},{default:o((()=>[$(b(e.$t("申请时间"))+"：",1)])),_:1}),m(t,{class:"value"},{default:o((()=>[$(b(q.value.addTime),1)])),_:1})])),_:1}),m(t,{class:"after-sale-item"},{default:o((()=>[m(t,{class:"label"},{default:o((()=>[$(b(e.$t("退货数量"))+"：",1)])),_:1}),m(t,{class:"value"},{default:o((()=>[$(b(G.value),1)])),_:1})])),_:1})])),_:1})])),_:1}),q.value.logisticsName&&q.value.trackingNo?(v(),i(t,{key:3,class:"info-content"},{default:o((()=>[m(t,{class:"info-content-title"},{default:o((()=>[$(b(e.$t("退货信息")),1)])),_:1}),m(t,{class:"after-sale"},{default:o((()=>[m(t,{class:"after-sale-item"},{default:o((()=>[m(t,{class:"label"},{default:o((()=>[$(b(e.$t("快递公司"))+"：",1)])),_:1}),m(t,{class:"value"},{default:o((()=>[$(b(q.value.logisticsName),1)])),_:1})])),_:1}),m(t,{class:"after-sale-item"},{default:o((()=>[m(t,{class:"label"},{default:o((()=>[$(b(e.$t("快递单号"))+"：",1)])),_:1}),m(t,{class:"value"},{default:o((()=>[$(b(q.value.trackingNo),1)])),_:1})])),_:1})])),_:1})])),_:1})):y("",!0),q.value.refund?(v(),i(t,{key:4,class:"info-content"},{default:o((()=>[m(t,{class:"info-content-title"},{default:o((()=>[$(b(e.$t("退款进度")),1)])),_:1}),m(t,{class:"after-sale"},{default:o((()=>[q.value.refund.onlineBalance>0?(v(),i(t,{key:0,class:"after-sale-item"},{default:o((()=>[m(t,{class:"label"},{default:o((()=>[$(b(e.$t("线上退款"))+"：",1)])),_:1}),m(t,{class:"value"},{default:o((()=>[m(r,{showText:!1,isBottom:!1,priceData:q.value.refund.onlineBalance},null,8,["priceData"])])),_:1}),m(t,{class:"after-sale-status"},{default:o((()=>[$(b(2===q.value.refund.isOnline?e.$t("退款成功"):e.$t("退款中")),1)])),_:1})])),_:1})):y("",!0),q.value.refund.offlineBalance>0?(v(),i(t,{key:1,class:"after-sale-item"},{default:o((()=>[m(t,{class:"label"},{default:o((()=>[$(b(e.$t("线下退款"))+"：",1)])),_:1}),m(t,{class:"value"},{default:o((()=>[m(r,{showText:!1,isBottom:!1,priceData:q.value.refund.offlineBalance},null,8,["priceData"])])),_:1}),m(t,{class:"after-sale-status"},{default:o((()=>[$(b(2===q.value.refund.isOnline?e.$t("退款成功"):e.$t("退款中")),1)])),_:1})])),_:1})):y("",!0),q.value.refund.refundBalance>0?(v(),i(t,{key:2,class:"after-sale-item"},{default:o((()=>[m(t,{class:"label"},{default:o((()=>[$(b(e.$t("余额退款"))+"：",1)])),_:1}),m(t,{class:"value"},{default:o((()=>[m(r,{showText:!1,isBottom:!1,priceData:q.value.refund.refundBalance},null,8,["priceData"])])),_:1}),m(t,{class:"after-sale-status"},{default:o((()=>[$(b(2===q.value.refund.isOnline?e.$t("退款成功"):e.$t("退款中")),1)])),_:1})])),_:1})):y("",!0)])),_:1})])),_:1})):y("",!0),q.value.canCancel?(v(),i(c,{key:5,height:"100rpx",backgroundColor:"#fff"},{default:o((()=>[m(t,{class:"after-sale-btn"},{default:o((()=>[m(t,{class:"after-sale-btn-box"},{default:o((()=>[m(f,{class:"btn",plain:!0,onClick:W},{default:o((()=>[$(b(e.$t("撤销申请")),1)])),_:1}),m(f,{plain:!0,class:"btn",onClick:F},{default:o((()=>[$(b(e.$t("修改申请")),1)])),_:1})])),_:1})])),_:1})])),_:1})):y("",!0)],64)):y("",!0)])),_:1})])),_:1})}}}),[["__scopeId","data-v-48f6f36d"]]);export{E as default};
