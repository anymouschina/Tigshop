import{e as a,G as e,r as t,Q as l,bJ as u,k as c,v as n,z as o,E as s,o as d,c as r,A as i,a as _,i as p,w as m,F as f,K as v,b as y,t as g,d as b,C as h,B as k,D as x,a9 as $,aa as w,_ as C,b9 as S,T as V,N as D,M as z,a1 as j,R as T,l as I,af as U,ax as B,bd as E,bD as M,bQ as N,bE as R,$ as W,ab as A,g as K,bR as Q}from"./index-BKXBH4vI.js";import{_ as F}from"./format-price.0qAAshfo.js";import{a as G,_ as J}from"./tig-layout.DMoUsUKf.js";import{n as O}from"./index.xrDesKlL.js";import{_ as q}from"./loading-box.BnnJRdlH.js";import{g as H,a as L,b as P,u as X,c as Y,d as Z}from"./account.CplyG8VS.js";import{_ as aa}from"./tig-fixed-placeholder.BHdfEiP8.js";const ea=C(a({__name:"detail",setup(a){const{t:C}=e(),S=t(0),V=t(!1),D=t(!1),z=l({page:1,size:10,status:1}),j=t([]),T=async()=>{z.page>1?V.value=!0:$({title:C("加载中")});try{const a=await H({...z});S.value=a.total,j.value=[...j.value,...a.filter_result]}catch(a){}finally{w(),V.value=!1,D.value=!0}};return u((()=>{T()})),c((()=>{z.page<Math.ceil(S.value/z.size)&&(z.page++,T())})),(a,e)=>{const t=p,l=b,u=h,c=n(o("loading-box"),q);return d(),s(f,null,[j.value.length>0?(d(),r(t,{key:0,class:"log-main"},{default:m((()=>[(d(!0),s(f,null,v(j.value,((a,e)=>(d(),r(t,{key:e,class:"item"},{default:m((()=>[_(t,{class:"tit"},{default:m((()=>[y(g(a.change_type_name),1)])),_:2},1024),_(t,{class:"time"},{default:m((()=>[y(g(a.change_time),1)])),_:2},1024),_(t,{class:"desc"},{default:m((()=>[y(g(a.change_desc),1)])),_:2},1024),_(t,{class:"real_total"},{default:m((()=>["增加"===a.change_type_name?(d(),r(l,{key:0},{default:m((()=>[y("+")])),_:1})):(d(),r(l,{key:1},{default:m((()=>[y("-")])),_:1})),_(l,null,{default:m((()=>[y(g(a.balance),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})):i("",!0),0===j.value.length&&!0===D.value?(d(),r(t,{key:1,class:"empty-box"},{default:m((()=>[_(t,{class:"pictrue"},{default:m((()=>[_(u,{src:k(x)("common/data_empty.png")},null,8,["src"])])),_:1}),_(t,{class:"txt"},{default:m((()=>[y(g(a.$t("暂无数据")),1)])),_:1})])),_:1})):i("",!0),_(c,{modelValue:V.value,"onUpdate:modelValue":e[0]||(e[0]=a=>V.value=a),page:z.page,length:j.value.length},null,8,["modelValue","page","length"])],64)}}}),[["__scopeId","data-v-ded5339f"]]),ta=C(a({__name:"log",setup(a){const{t:b}=e(),C=t(0),S=t(!1),V=t(!1),D=l({page:1,size:10}),z=t([]),j=async()=>{D.page>1?S.value=!0:$({title:b("加载中")});try{const a=await L({...D});C.value=a.total,z.value=[...z.value,...a.filter_result]}catch(a){}finally{w(),S.value=!1,V.value=!0}};return u((()=>{j()})),c((()=>{D.page<Math.ceil(C.value/D.size)&&(D.page++,j())})),(a,e)=>{const t=p,l=n(o("format-price"),F),u=h,c=n(o("loading-box"),q);return d(),s(f,null,[z.value.length>0?(d(),r(t,{key:0,class:"log-main"},{default:m((()=>[(d(!0),s(f,null,v(z.value,((e,u)=>(d(),r(t,{key:u,class:"item"},{default:m((()=>[_(t,{class:"tit"},{default:m((()=>[y(g(e.type),1)])),_:2},1024),_(t,{class:"time"},{default:m((()=>[y(g(e.add_time),1)])),_:2},1024),_(t,{class:"real_total"},{default:m((()=>[_(l,{showText:!1,decimalsStyle:{fontSize:"25rpx",fontWeight:"bold"},currencyStyle:{fontSize:"23rpx",fontWeight:"bold"},priceData:e.amount},null,8,["priceData"])])),_:2},1024),_(t,{class:"actions"},{default:m((()=>[_(t,{class:"txt"},{default:m((()=>[y(g(a.$t("管理员备注"))+"："+g(e.postscript||a.$t("无")),1)])),_:2},1024),_(t,{class:"status"},{default:m((()=>[y(g(e.status_type),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})):i("",!0),0===z.value.length&&!0===V.value?(d(),r(t,{key:1,class:"empty-box"},{default:m((()=>[_(t,{class:"pictrue"},{default:m((()=>[_(u,{src:k(x)("common/data_empty.png")},null,8,["src"])])),_:1}),_(t,{class:"txt"},{default:m((()=>[y(g(a.$t("暂无数据"))+"！",1)])),_:1})])),_:1})):i("",!0),_(c,{modelValue:S.value,"onUpdate:modelValue":e[0]||(e[0]=a=>S.value=a),page:D.page,length:z.value.length},null,8,["modelValue","page","length"])],64)}}}),[["__scopeId","data-v-3d37f8f8"]]),la=C(a({__name:"deposit",emits:["backDetail"],setup(a,{emit:l}){const{t:c}=e(),b=t([]);u((()=>{(async()=>{$({title:c("加载中")});try{const a=await P();b.value=a.filter_result;let e={recharge_id:0};b.value.push(e),b.value.forEach((a=>{a.selected=!1}))}catch(a){}finally{w()}})()}));const h=t(!1),k=a=>{h.value=5===a,b.value.forEach(((e,t)=>{e.selected=t===a}))},x=t({id:0,amount:0,money:"",payType:"recharge"}),C=()=>{let a=!1;if(b.value.forEach(((e,t)=>{e.selected&&(a=!0,x.value.id=e.recharge_id,0!=e.recharge_id?(x.value.amount=null,x.value.money=e.money):x.value.money=x.value.amount)})),!x.value.money)return D({title:c("请输入充值金额"),icon:"none"});a?j(x.value):D({title:c("请选择充值金额"),icon:"none"})},j=async a=>{try{const e=await X(a);z({url:`/pages/order/pay?order_id=${e.order_id}&type=recharge`})}catch(e){D({title:e.message,icon:"none",duration:1e3})}},T=l,I=()=>{T("backDetail")};return(a,e)=>{const t=n(o("format-price"),F),l=p,u=n(o("up-input"),S),c=n(o("tig-button"),G),h=n(o("tig-fixed-placeholder"),aa);return d(),s(f,null,[_(l,{class:"recharge-box"},{default:m((()=>[b.value.length>0?(d(),r(l,{key:0,class:"recharge-wrap"},{default:m((()=>[(d(!0),s(f,null,v(b.value,((c,n)=>(d(),s(f,{key:n},[0!=c.recharge_id?(d(),r(l,{key:0,class:V(["recharge-item",{selected:c.selected}]),onClick:a=>k(n)},{default:m((()=>[_(l,{class:"recharge-amount"},{default:m((()=>[_(t,{showText:!1,priceData:c.money,decimalsStyle:{fontSize:"25rpx"},currencyStyle:{fontSize:"23rpx"}},null,8,["priceData"])])),_:2},1024),Number(c.discount_money)>0?(d(),r(l,{key:0,class:"recharge-give"},{default:m((()=>[y(g(a.$t("赠送"))+" ",1),_(t,{showText:!1,priceData:c.discount_money,isBottom:!1,fontStyle:{fontSize:"11px"}},null,8,["priceData"])])),_:2},1024)):i("",!0)])),_:2},1032,["class","onClick"])):(d(),r(l,{key:1,class:V(["recharge-item",{selected:c.selected}]),onClick:a=>k(n)},{default:m((()=>[_(l,{class:"recharge-amount"},{default:m((()=>[c.selected?(d(),r(u,{key:0,modelValue:x.value.amount,"onUpdate:modelValue":e[0]||(e[0]=a=>x.value.amount=a),type:"digit",color:"var(--color)",inputAlign:"center",border:"none"},null,8,["modelValue"])):(d(),r(l,{key:1,style:{height:"42rpx"}}))])),_:2},1024),_(l,{class:"recharge-give"},{default:m((()=>[y(g(a.$t("自定义金额")),1)])),_:1})])),_:2},1032,["class","onClick"]))],64)))),128))])),_:1})):i("",!0)])),_:1}),_(h,{backgroundColor:"#fff"},{default:m((()=>[_(l,{class:"btn-box"},{default:m((()=>[_(c,{class:"btn",plain:"",onClick:I},{default:m((()=>[y(g(a.$t("取消充值")),1)])),_:1}),_(c,{class:"btn",onClick:C},{default:m((()=>[y(g(a.$t("提交申请")),1)])),_:1})])),_:1})])),_:1})],64)}}}),[["__scopeId","data-v-5570bf79"]]),ua=C(a({__name:"raplyToCard",props:{balance:{type:[Number,String],default:0}},emits:["backDetail"],setup(a,{emit:l}){const{t:c}=e(),b=[{title:"银行卡",account_type:1},{title:"支付宝",account_type:2},{title:"微信",account_type:3}],h=j(),x=t(1),C=()=>{K.value={id:"",text:c("请选择")},P.value={account_data:{account_no:"",account_name:"",account_type:x.value,bank_name:""},amount:""}},z=t(!1),K=t({id:"",text:c("请选择")}),Q=()=>{z.value=!1},F=a=>{z.value=!1,K.value.id=a.value[0].id,K.value.text=a.value[0].text,J(a.value[0].id)},J=a=>{let e=(1===P.value.account_data.account_type?O:2===P.value.account_data.account_type?q:H).value[0].find((e=>e.account_id===a));P.value.account_data.account_no=null==e?void 0:e.account_no,P.value.account_data.account_name=null==e?void 0:e.account_name,P.value.account_data.bank_name=null==e?void 0:e.bank_name},O=t([]),q=t([]),H=t([]),L=async a=>{$({title:c("加载中")});try{let e={account_type:a};const t=await Y({...e});let l=[];1==a?(l=t.filter_result.map((a=>({id:a.account_id,text:a.account_no,...a}))),O.value.push(l)):2===a?(l=t.filter_result.map((a=>({id:a.account_id,text:a.account_no,...a}))),q.value.push(l)):(l=t.filter_result.map((a=>({id:a.account_id,text:a.account_no,...a}))),H.value.push(l))}catch(e){}finally{w()}};u((()=>{L(x.value)}));const P=t({account_data:{account_no:"",account_name:"",account_type:1,bank_name:""},amount:""}),X=T((()=>{switch(P.value.account_data.account_type){case 1:return c("银行卡");case 2:return c("支付宝");case 3:return c("微信");default:return""}})),ea=T((()=>{switch(P.value.account_data.account_type){case 1:return O.value;case 2:return q.value;case 3:return H.value;default:return""}})),ta={amount:{validator:(a,e,t)=>(0==e&&uni.$u.toast(c("提现金额必须大于0")),e>0),message:c("请输入提现金额"),trigger:["blur"]}};I((()=>{U((()=>{h.value.setRules(ta)}))}));const la=async()=>{0!==K.value.id.length?h.value.validate().then((async a=>{if(a)try{const a=await Z({...P.value});D({title:a.message,icon:"success",duration:1e3}),setTimeout((()=>{ca()}),1500)}catch(e){uni.$u.toast(e.message)}})).catch((()=>{})):D({title:c("请选择需要提现的账号"),icon:"none",duration:1e3})},ua=l,ca=()=>{ua("backDetail")};return(a,e)=>{const t=p,l=n(o("up-picker"),B),u=n(o("up-button"),E),c=n(o("up-form-item"),M),$=W,w=n(o("up-input"),S),D=n(o("up-textarea"),N),j=n(o("up-form"),R),T=n(o("tig-button"),G),I=n(o("tig-fixed-placeholder"),aa);return d(),s(f,null,[_(t,{class:"custom-tabs"},{default:m((()=>[(d(),s(f,null,v(b,((e,l)=>_(t,{key:l,class:V([{"active-tab":x.value===e.account_type},"tab"]),onClick:a=>(async a=>{a!==x.value&&(x.value=a,P.value.account_data.account_type=a,O.value=[],q.value=[],H.value=[],C(),L(a))})(e.account_type)},{default:m((()=>[_(t,null,{default:m((()=>[y(g(a.$t(e.title)),1)])),_:2},1024)])),_:2},1032,["class","onClick"]))),64))])),_:1}),_(t,{class:"reply-main"},{default:m((()=>[_(t,{class:"reply-content"},{default:m((()=>[_(j,{ref_key:"formRef",ref:h,model:P.value,"label-width":"170rpx",errorType:"toast"},{default:m((()=>[_(c,{label:a.$t("提现至")},{default:m((()=>[_(l,{show:z.value,columns:ea.value,keyName:"text",onConfirm:F,onCancel:Q},null,8,["show","columns"]),_(u,{onClick:e[0]||(e[0]=a=>z.value=!0),style:{"justify-content":"flex-start"}},{default:m((()=>[y(g(K.value.text),1)])),_:1})])),_:1},8,["label"]),_(t,{class:"tips"},{default:m((()=>[y(g(a.$t("当前"))+g(X.value)+g(a.$t("账号已不用"))+"？",1),_($,{url:"/pages/user/account/cardManagement/list",class:"font-color"},{default:m((()=>[y(g(a.$t("点击这里")),1)])),_:1}),y(g(a.$t("去添加新的"))+g(X.value)+g(a.$t("账号"))+"。",1)])),_:1}),_(c,{label:a.$t("提现姓名"),prop:"account_data.account_name"},{default:m((()=>[_(w,{modelValue:P.value.account_data.account_name,"onUpdate:modelValue":e[1]||(e[1]=a=>P.value.account_data.account_name=a),placeholder:k(A)()?a.$t("请选择{0}账号",X.value):`请选择${X.value}账号`,disabled:"",fontSize:"12"},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),1===P.value.account_data.account_type?(d(),r(c,{key:0,label:a.$t("银行详情"),prop:"account_data.bank_name"},{default:m((()=>[_(D,{modelValue:P.value.account_data.bank_name,"onUpdate:modelValue":e[2]||(e[2]=a=>P.value.account_data.bank_name=a),placeholder:a.$t("请选择银行卡账号"),disabled:"",fontSize:"12"},null,8,["modelValue","placeholder"])])),_:1},8,["label"])):i("",!0),_(c,{label:a.$t("提现金额"),prop:"amount"},{default:m((()=>[_(w,{type:"number",modelValue:P.value.amount,"onUpdate:modelValue":e[3]||(e[3]=a=>P.value.amount=a),placeholder:a.$t("请输入提现金额"),clearable:"",fontSize:"12"},null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1},8,["model"])])),_:1})])),_:1}),_(I,{backgroundColor:"#fff"},{default:m((()=>[_(t,{class:"btn-box"},{default:m((()=>[_(T,{class:"btn",plain:"",onClick:ca},{default:m((()=>[y(g(a.$t("返回列表")),1)])),_:1}),_(T,{class:"btn",onClick:la},{default:m((()=>[y(g(a.$t("提交申请")),1)])),_:1})])),_:1})])),_:1})],64)}}}),[["__scopeId","data-v-76354f85"]]),ca=C(a({__name:"index",setup(a){const e=t({}),u=l({navbar:"1",return:"1",title:"资金管理"}),c=[{title:"账户明细",action:"detail"},{title:"申请记录",action:"log"}],b=t("detail"),h=a=>{a!==b.value&&(b.value=a)},k=()=>{b.value="detail"};return K((()=>{(async()=>{try{const a=await Q();Object.assign(e.value,a.item)}catch(a){}})()})),(a,t)=>{const l=p,x=n(o("format-price"),F),$=n(o("tig-layout"),J);return d(),r($,null,{default:m((()=>[_(O,{parameter:u},null,8,["parameter"]),_(l,{class:"top-card"},{default:m((()=>[_(l,{class:"balance-row"},{default:m((()=>[y(g(a.$t("可用余额")),1)])),_:1}),_(l,{class:"amount-row"},{default:m((()=>[_(x,{showText:!1,priceData:e.value.balance,decimalsStyle:{fontSize:"40rpx",fontWeight:"bold"},currencyStyle:{fontSize:"38rpx",fontWeight:"bold"}},null,8,["priceData"])])),_:1}),_(l,{class:"button-row"},{default:m((()=>[_(l,{class:V(["round-button",{active:"deposit"===b.value}]),onClick:t[0]||(t[0]=a=>h("deposit"))},{default:m((()=>[y(g(a.$t("充值")),1)])),_:1},8,["class"]),_(l,{class:V(["round-button",{active:"raplytocard"===b.value}]),onClick:t[1]||(t[1]=a=>h("raplytocard"))},{default:m((()=>[y(g(a.$t("提现")),1)])),_:1},8,["class"])])),_:1})])),_:1}),"detail"===b.value||"log"===b.value?(d(),r(l,{key:0,class:"custom-tabs"},{default:m((()=>[(d(),s(f,null,v(c,((e,t)=>_(l,{key:t,class:V([{"active-tab":b.value===e.action},"tab"]),onClick:a=>h(e.action)},{default:m((()=>[_(l,null,{default:m((()=>[y(g(a.$t(e.title)),1)])),_:2},1024)])),_:2},1032,["class","onClick"]))),64))])),_:1})):i("",!0),"detail"===b.value?(d(),r(ea,{key:1})):i("",!0),"log"===b.value?(d(),r(ta,{key:2})):i("",!0),"deposit"===b.value?(d(),r(la,{key:3,onBackDetail:k})):i("",!0),"raplytocard"===b.value?(d(),r(ua,{key:4,balance:e.value.balance,onBackDetail:k},null,8,["balance"])):i("",!0)])),_:1})}}}),[["__scopeId","data-v-4c590b14"]]);export{ca as default};
