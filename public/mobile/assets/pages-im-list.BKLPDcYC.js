import{e as a,f as s,Q as e,r as t,l,k as i,c as n,w as o,i as r,v as c,z as u,o as p,a as _,E as d,A as f,F as m,K as h,ar as g,a6 as v,B as y,a7 as b,b as k,t as w,M,_ as x}from"./index-BKXBH4vI.js";import{_ as I}from"./tig-layout.DMoUsUKf.js";import{b as j}from"./im.CLfEp95e.js";import{n as $}from"./index.xrDesKlL.js";const z=x(a({__name:"list",setup(a){const x=s(),z={navbar:"1",return:"1",title:"消息列表"},C=e({page:1,size:15}),H=t(0),L=t(!1),T=t([]),A=async()=>{try{const a=await j(C);T.value=a.filter_result,H.value=a.total}catch(a){}finally{L.value=!0}};return l((()=>{A()})),i((()=>{C.page<Math.ceil(H.value/C.size)&&(C.page++,A())})),(a,s)=>{const e=r,t=c(u("tig-layout"),I);return p(),n(e,{class:"page-content"},{default:o((()=>[_(t,null,{default:o((()=>[_(e,{class:"thanos-layout conversation-list-layout"},{default:o((()=>[_($,{parameter:z}),_(e,{class:"thanos-layout-main-content"},{default:o((()=>[_(e,{class:"thanos-waterfall conversation-list-wrap"},{default:o((()=>[T.value.length>0?(p(!0),d(m,{key:0},h(T.value,((a,s)=>(p(),n(e,{class:"main-list",key:s},{default:o((()=>[_(e,{onClick:s=>{return e=`/pages/im/index?shop_id=${a.shop_id}&conversation_id=${a.conversation_id}`,void M({url:e});var e},class:"wapim-conversation-item"},{default:o((()=>[g("figure",{class:"bg-pic circle-bg-pic thanos-figure thanos-hairline--surround conversation-figure"},[_(e,{class:"bg-pic-content",style:v({backgroundImage:`url(${a.shop?y(b)(a.shop.shop_logo):y(b)(y(x).baseInfo.ico_img)})`})},null,8,["style"])]),_(e,{class:"wapim-conversation-item-content thanos-hairline--bottom"},{default:o((()=>[_(e,{class:"shop-name thanos-ellipsis"},{default:o((()=>[k(w(a.shop?a.shop.shop_title:y(x).baseInfo.shop_title),1)])),_:2},1024),"text"==a.lastMessage[0].message_type?(p(),n(e,{key:0,class:"last-message thanos-ellipsis"},{default:o((()=>[_(e,{class:"ellipsis",innerHTML:a.lastMessage[0].content.content},null,8,["innerHTML"])])),_:2},1024)):(p(),n(e,{key:1,class:"last-message thanos-ellipsis"},{default:o((()=>[k("["+w(a.lastMessage[0].message_type_text)+"]",1)])),_:2},1024))])),_:2},1024),_(e,{class:"wapim-conversation-item-right"},{default:o((()=>[g("span",{class:"last-time"},w(a.last_update_time),1)])),_:2},1024)])),_:2},1032,["onClick"])])),_:2},1024)))),128)):f("",!0),0===T.value.length&&L.value?(p(),n(e,{key:1,class:"thanos-waterfall-finish-desc"},{default:o((()=>[k(w(a.$t("已经没有更多消息了")),1)])),_:1})):f("",!0)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-8f855dd8"]]);export{z as default};
