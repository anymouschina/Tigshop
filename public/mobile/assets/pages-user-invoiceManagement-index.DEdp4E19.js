import{d as e,G as a,r as l,Q as t,aG as s,k as o,l as u,m as n,n as i,w as r,q as c,y as d,J as p,F as m,a6 as _,a7 as f,C as v,t as y,v as b,L as h,B as g,a0 as x,R as $,c6 as k,x as V,V as C,M as j,o as w,e as M}from"./index-Do_Cb7fn.js";import{a as U,e as q,_ as B}from"./tig-layout.BV0ZvCt0.js";import{n as S}from"./index.Y6J4G1_A.js";import{_ as z}from"./tig-image.D5KdQk-t.js";import{_ as O}from"./format-price.D2lH_-yv.js";import{_ as D}from"./loading-box.Cez_qIZa.js";import{b as I}from"./order.ChpFLtyJ.js";import{_ as L}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{_ as R}from"./uni-easyinput.DgTgv_xO.js";import{_ as P,a as G}from"./uni-forms.7UC4mlQa.js";import{_ as J}from"./save-bottom-box.BM5fwIJO.js";import{g as N,u as T}from"./invoiceManagemen.Db_DG8CQ.js";import"./u-loading-icon.rQrrZF_r.js";import"./u-icon.CBDMG2rO.js";import"./uni-icons.DK0ZiICA.js";const F=L(e({__name:"invoiceList",setup(e,{expose:$}){const{t:k}=a(),V=l([]),C=t({page:1,size:10,order_status:5}),j=l(!1),w=l(0),M=async()=>{C.page>1?j.value=!0:_({title:k("加载中")});try{const e=await I(C);V.value=[...V.value,...e.filter_result],w.value=e.total}catch(e){console.error(e)}finally{f(),j.value=!1}},q=e=>{switch(e){case 0:return k("待审核");case 1:return k("通过");default:return k("失败/作废")}},B=()=>{h({url:"/pages/user/invoiceManagement/applyInvoice"})};return s((()=>{M()})),$({__getOrderList:M,filterParams:C,total:w}),(e,a)=>{const l=g,t=v,s=o(u("tig-image"),z),_=o(u("format-price"),O),f=x,$=o(u("tig-button"),U),k=o(u("loading-box"),D);return n(),i(t,{class:""},{default:r((()=>[c(t,{class:"invoice-list"},{default:r((()=>[(n(!0),d(m,null,p(V.value,(a=>(n(),i(t,{key:a.order_id,class:"invoice-list-item"},{default:r((()=>[c(t,{class:"invoice-list-item-header"},{default:r((()=>[c(l,{class:"special-text"},{default:r((()=>[y(b(e.$t("订单编号"))+"：",1),c(l,{class:"special-color"},{default:r((()=>[y(b(a.order_sn),1)])),_:2},1024)])),_:2},1024),a.invoice_data?(n(),i(l,{key:0},{default:r((()=>[y(b(q(a.invoice_data.status)),1)])),_:2},1024)):(n(),i(l,{key:1},{default:r((()=>[y(b(e.$t("可申请")),1)])),_:1}))])),_:2},1024),c(t,{class:"invoice-list-item-content"},{default:r((()=>[c(t,{class:"item-content-product"},{default:r((()=>[(n(!0),d(m,null,p(a.items,(e=>(n(),i(f,{key:e.item_id,url:"/pages/productDetail/index?id="+e.product_id,"hover-class":"navigator-hover"},{default:r((()=>[c(t,{class:"item-content-product-item"},{default:r((()=>[c(t,{class:"item-content-product-img"},{default:r((()=>[c(s,{src:e.pic_thumb,"onUpdate:src":a=>e.pic_thumb=a},null,8,["src","onUpdate:src"])])),_:2},1024),c(t,{class:"item-content-product-info"},{default:r((()=>[c(t,{class:"product-item-title"},{default:r((()=>[y(b(e.product_name),1)])),_:2},1024),c(t,{class:"product-item-price"},{default:r((()=>[c(_,{showText:!1,decimalsStyle:{fontSize:"25rpx"},currencyStyle:{fontSize:"23rpx"},class:"product-item-pricenum",priceData:e.price},null,8,["priceData"]),c(t,{class:"product-item-quantity"},{default:r((()=>[y("x "+b(e.quantity),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["url"])))),128))])),_:2},1024),c(t,{class:"item-content-pay"},{default:r((()=>[c(t,{class:"item-content-pay-box"},{default:r((()=>[c(t,{class:"pay-item total-money"},{default:r((()=>[y(b(e.$t("总额"))+"：",1),c(_,{showText:!1,isBottom:!1,priceData:a.total_amount},null,8,["priceData"])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024),c(t,{class:"invoice-list-item-btn"},{default:r((()=>[c(t,{class:"item-btn-box"},{default:r((()=>[a.invoice_data?(n(),i($,{key:0,customStyle:{width:"150rpx",height:"60rpx"},plain:!0,plainMainColor:!0,onClick:e=>((e,a)=>{e.order_sn=a;const l=encodeURIComponent(JSON.stringify(e));h({url:"/pages/user/invoiceManagement/invoiceInfo?invoice_data="+l})})(a.invoice_data,a.order_sn)},{default:r((()=>[y(b(e.$t("查看")),1)])),_:2},1032,["onClick"])):(n(),i($,{key:1,plain:!0,customStyle:{width:"150rpx",height:"60rpx"},plainMainColor:!0,onClick:B},{default:r((()=>[y(b(e.$t("申请")),1)])),_:1}))])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128)),c(k,{modelValue:j.value,"onUpdate:modelValue":a[0]||(a[0]=e=>j.value=e),page:C.page,length:V.value.length},null,8,["modelValue","page","length"])])),_:1})])),_:1})}}}),[["__scopeId","data-v-be306420"]]),H=L(e({__name:"certification",setup(e){const{t:t}=a(),p=l({}),_={company_name:{rules:[{required:!0,errorMessage:t("单位名称不能为空!")}]},company_code:{rules:[{required:!0,errorMessage:t("纳税人识别码不能为空!")}]},company_address:{rules:[{required:!0,errorMessage:t("注册地址不能为空!")}]},company_phone:{rules:[{required:!0,errorMessage:t("注册电话不能为空!")}]},company_bank:{rules:[{required:!0,errorMessage:t("开户银行不能为空!")}]},company_account:{rules:[{required:!0,errorMessage:t("银行账户不能为空!")}]}},f=l(!1),h=l(!1),x=async()=>{try{const e=await N();Object.assign(p.value,e.item)}catch(e){}};s((()=>{x()}));const w=()=>{h.value=!0},M=$((()=>{switch(p.value.status){case 0:return t("未申请专用发票");case 1:return t("审核通过");case 2:return t("已申请，待审核");case 3:return t("审核未通过");default:return""}})),B=l(),S=()=>{B.value.validate().then((e=>{if(!f.value)return j({title:t("需要确认勾选才能继续"),icon:"none"});z()})).catch((e=>{console.log("表单错误信息：",e)}))},z=async()=>{try{p.value.is_confirm=f.value?1:0,p.value.title_type=2,p.value.invoice_type=1,p.value.is_add=0==p.value.status?1:0;await T({id:p.value.invoice_id,...p.value});j({title:t("提交成功"),icon:"none"}),x(),h.value=!1}catch(e){}},O=()=>{};return(e,a)=>{const l=v,t=g,s=o(u("uni-easyinput"),R),x=o(u("uni-forms-item"),P),$=o(u("uni-forms"),G),j=o(u("tig-checkbox"),q),z=k("biock"),D=o(u("tig-button"),U),I=o(u("save-bottom-box"),J);return Object.keys(p.value).length>0?(n(),i(l,{key:0,class:"certification safe-padding"},{default:r((()=>[c(l,{class:"tip-box"},{default:r((()=>[c(l,{class:"tig-title"},{default:r((()=>[y(b(e.$t("温馨提示")),1)])),_:1}),c(l,null,{default:r((()=>[y(b(e.$t("首次开具增值税专用发票"))+"，"+b(e.$t("请添加资质后并提交"))+"。",1)])),_:1}),c(l,null,{default:r((()=>[y(b(e.$t("我们会在一个工作日内完成审核工作"))+"。",1)])),_:1}),c(l,null,{default:r((()=>[y(" 1."+b(e.$t("补发流程"))+"： ",1),c(t,{class:"specaial-text"},{default:r((()=>[y(b(e.$t("资质未审核通过"))+"-"+b(e.$t("登录会员中心"))+"->"+b(e.$t("增票资质"))+"->"+b(e.$t("填写资质信息"))+"->"+b(e.$t("提交"))+"。",1)])),_:1})])),_:1}),c(l,null,{default:r((()=>[y(" 2. "+b(e.$t("资质审核结果查询时间"))+"：",1),c(t,{class:"specaial-text"},{default:r((()=>[y(b(e.$t("资质上传一到两个工作日后即可查询"))+"。",1)])),_:1})])),_:1}),c(l,null,{default:r((()=>[y(" 3. "+b(e.$t("注意有效增值税专用发票开票资质仅为一个"))+"。",1)])),_:1})])),_:1}),c(l,{class:"status-box"},{default:r((()=>[c(l,{class:"status-text"},{default:r((()=>[c(l,null,{default:r((()=>[y(b(e.$t("您的增票资质状态"))+"：",1)])),_:1}),c(l,{class:"specaial-text"},{default:r((()=>[y(b(M.value),1)])),_:1})])),_:1})])),_:1}),c(l,{class:"certification-content"},{default:r((()=>[h.value?(n(),i(l,{key:0,class:"content-title"},{default:r((()=>[y(b(e.$t("填写增票资质信息")),1),c(t,{class:"specaial-text"},{default:r((()=>[y("（"+b(e.$t("所有信息均为必填"))+"）",1)])),_:1})])),_:1})):!h.value&&Object.keys(p.value).length>0?(n(),i(l,{key:1,class:"content-title"},{default:r((()=>[y(b(e.$t("增票资质信息")),1)])),_:1})):V("",!0),c(l,null,{default:r((()=>[h.value?(n(),d(m,{key:0},[c($,{ref_key:"formRef",ref:B,modelValue:p.value,rules:_,"label-width":"180rpx"},{default:r((()=>[c(x,{label:e.$t("单位名称"),name:"company_name"},{default:r((()=>[c(s,{primaryColor:"rgb(192, 196, 204)",inputBorder:!1,placeholder:e.$t("请输入单位名称"),modelValue:p.value.company_name,"onUpdate:modelValue":a[0]||(a[0]=e=>p.value.company_name=e)},null,8,["placeholder","modelValue"])])),_:1},8,["label"]),c(x,{label:e.$t("纳税人识别码"),name:"company_code"},{default:r((()=>[c(s,{primaryColor:"rgb(192, 196, 204)",inputBorder:!1,placeholder:e.$t("请输入纳税人识别码"),modelValue:p.value.company_code,"onUpdate:modelValue":a[1]||(a[1]=e=>p.value.company_code=e)},null,8,["placeholder","modelValue"])])),_:1},8,["label"]),c(x,{label:e.$t("注册地址"),name:"company_address"},{default:r((()=>[c(s,{primaryColor:"rgb(192, 196, 204)",inputBorder:!1,placeholder:e.$t("请输入注册地址"),modelValue:p.value.company_address,"onUpdate:modelValue":a[2]||(a[2]=e=>p.value.company_address=e)},null,8,["placeholder","modelValue"])])),_:1},8,["label"]),c(x,{label:e.$t("注册电话"),name:"company_phone"},{default:r((()=>[c(s,{primaryColor:"rgb(192, 196, 204)",inputBorder:!1,placeholder:e.$t("请输入注册电话"),modelValue:p.value.company_phone,"onUpdate:modelValue":a[3]||(a[3]=e=>p.value.company_phone=e)},null,8,["placeholder","modelValue"])])),_:1},8,["label"]),c(x,{label:"开户银行",name:"company_bank"},{default:r((()=>[c(s,{primaryColor:"rgb(192, 196, 204)",inputBorder:!1,placeholder:e.$t("请输入开户银行"),modelValue:p.value.company_bank,"onUpdate:modelValue":a[4]||(a[4]=e=>p.value.company_bank=e)},null,8,["placeholder","modelValue"])])),_:1}),c(x,{label:e.$t("开户银行"),name:"company_account"},{default:r((()=>[c(s,{primaryColor:"rgb(192, 196, 204)",inputBorder:!1,placeholder:e.$t("请输入银行账户"),modelValue:p.value.company_account,"onUpdate:modelValue":a[5]||(a[5]=e=>p.value.company_account=e)},null,8,["placeholder","modelValue"])])),_:1},8,["label"])])),_:1},8,["modelValue"]),c(l,{class:"agreement-box"},{default:r((()=>[c(j,{checked:f.value,"onUpdate:checked":a[6]||(a[6]=e=>f.value=e),checkedSize:.7},null,8,["checked"]),y(" "+b(e.$t("我已阅读并同意")),1),c(t,{class:"specaial-text",onClick:O},{default:r((()=>[y("《"+b(e.$t("增票资质确认书"))+"》",1)])),_:1})])),_:1})],64)):V("",!0),0!==p.value.status||h.value?!h.value&&Object.keys(p.value).length>0?(n(),i($,{key:2,ref_key:"formRef",ref:B,class:C({readonly:!h.value}),modelValue:p.value,rules:_,"label-width":"180rpx"},{default:r((()=>[c(x,{label:e.$t("单位名称")},{default:r((()=>[c(l,{class:"disabled-text"},{default:r((()=>[y(b(p.value.company_name),1)])),_:1})])),_:1},8,["label"]),c(x,{label:e.$t("纳税人识别码")},{default:r((()=>[c(l,{class:"disabled-text"},{default:r((()=>[y(b(p.value.company_code),1)])),_:1})])),_:1},8,["label"]),c(x,{label:e.$t("注册地址")},{default:r((()=>[c(l,{class:"disabled-text"},{default:r((()=>[y(b(p.value.company_address),1)])),_:1})])),_:1},8,["label"]),c(x,{label:e.$t("注册电话")},{default:r((()=>[c(l,{class:"disabled-text"},{default:r((()=>[y(b(p.value.company_phone),1)])),_:1})])),_:1},8,["label"]),c(x,{label:e.$t("开户银行")},{default:r((()=>[c(l,{class:"disabled-text"},{default:r((()=>[y(b(p.value.company_bank),1)])),_:1})])),_:1},8,["label"]),c(x,{label:e.$t("银行账户")},{default:r((()=>[c(l,{class:"disabled-text"},{default:r((()=>[y(b(p.value.company_account),1)])),_:1})])),_:1},8,["label"])])),_:1},8,["class","modelValue"])):V("",!0):(n(),i(z,{key:1},{default:r((()=>[c(l,{class:"empty-text"},{default:r((()=>[y(b(e.$t("暂无增票资质信息"))+"!",1)])),_:1})])),_:1}))])),_:1})])),_:1}),h.value?(n(),i(I,{key:0,height:"65",backgroundColor:"#fff"},{default:r((()=>[c(l,{class:"btn-box"},{default:r((()=>[c(D,{plain:"",style:{width:"100%",height:"70rpx"},onClick:a[7]||(a[7]=e=>h.value=!1)},{default:r((()=>[y(b(e.$t("取消")),1)])),_:1}),c(D,{style:{width:"100%",height:"70rpx"},onClick:S},{default:r((()=>[y(b(e.$t("提交")),1)])),_:1})])),_:1})])),_:1})):V("",!0),h.value?V("",!0):(n(),i(I,{key:1,height:"65",backgroundColor:"#fff"},{default:r((()=>[c(l,{class:"btn-box"},{default:r((()=>[c(D,{style:{width:"100%",height:"70rpx"},onClick:w},{default:r((()=>[y(b(0===p.value.status?e.$t("添加增票资质"):e.$t("修改并重新审核")),1)])),_:1})])),_:1})])),_:1}))])),_:1})):V("",!0)}}}),[["__scopeId","data-v-37600116"]]),Q=L(e({__name:"index",setup(e){const a=t([{type:"list",value:"已完成订单"},{type:"invoice",value:"增票资质"}]),s=l(),_=l("list"),f={navbar:"1",return:"1",title:"发票管理"};return w((e=>{e&&e.type&&(_.value=e.type)})),M((()=>{"list"===_.value&&s.value.filterParams.page<Math.ceil(s.value.total/s.value.filterParams.size)&&(s.value.filterParams.page++,s.value.__getOrderList())})),(e,l)=>{const t=g,h=v,x=o(u("tig-layout"),B);return n(),i(x,null,{default:r((()=>[c(h,{class:"invoice-management"},{default:r((()=>[c(S,{parameter:f}),c(h,{class:"invoice-menu"},{default:r((()=>[(n(!0),d(m,null,p(a,(a=>(n(),i(h,{key:a.type,class:C(["invoice-menu-item",{active:_.value===a.type}]),onClick:e=>{return l=a.type,void(_.value=l);var l}},{default:r((()=>[c(t,{class:"invoice-menu-item-text"},{default:r((()=>[y(b(e.$t(a.value)),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1}),c(h,{class:"placeholder"}),c(h,{class:"invoice-content"},{default:r((()=>["list"===_.value?(n(),i(F,{key:0,ref_key:"invoiceListRef",ref:s},null,512)):V("",!0),"invoice"===_.value?(n(),i(H,{key:1})):V("",!0)])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-9d5c6e1a"]]);export{Q as default};
