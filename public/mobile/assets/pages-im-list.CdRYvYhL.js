import{e as a,u as s,Q as e,r as t,k as l,j as o,c as n,w as i,i as c,q as r,y as u,o as p,a as d,D as h,z as f,F as g,J as m,aw as v,a9 as _,A as y,a7 as b,b as k,t as w,P as I,_ as T}from"./index-BKzbZvRR.js";import{_ as M}from"./tig-layout.BpNdXByQ.js";import{b as x}from"./im.B7-H1VeE.js";const j=T(a({__name:"list",setup(a){const T=s(),j=e({page:1,size:15}),$=t(0),z=t(!1),L=t([]),C=async()=>{try{const a=await x(j);L.value=a.records,$.value=a.total}catch(a){}finally{z.value=!0}};return l((()=>{C()})),o((()=>{j.page<Math.ceil($.value/j.size)&&(j.page++,C())})),(a,s)=>{const e=c,t=r(u("tig-layout"),M);return p(),n(e,{class:"page-content"},{default:i((()=>[d(t,{title:"消息列表"},{default:i((()=>[d(e,{class:"thanos-layout conversation-list-layout"},{default:i((()=>[d(e,{class:"thanos-layout-main-content"},{default:i((()=>[d(e,{class:"thanos-waterfall conversation-list-wrap"},{default:i((()=>[L.value.length>0?(p(!0),h(g,{key:0},m(L.value,((a,s)=>(p(),n(e,{class:"main-list",key:s},{default:i((()=>[d(e,{onClick:s=>{return e=`/pages/im/index?shopId=${a.shopId}&conversationId=${a.conversationId}`,void I({url:e});var e},class:"wapim-conversation-item"},{default:i((()=>[v("figure",{class:"bg-pic circle-bg-pic thanos-figure thanos-hairline--surround conversation-figure"},[d(e,{class:"bg-pic-content",style:_({backgroundImage:`url(${a.shop?y(b)(a.shop.shopLogo):y(b)(y(T).baseInfo.icoImg)})`})},null,8,["style"])]),d(e,{class:"wapim-conversation-item-content thanos-hairline--bottom"},{default:i((()=>[d(e,{class:"shop-name thanos-ellipsis"},{default:i((()=>[k(w(a.shop?a.shop.shopTitle:y(T).baseInfo.shopTitle),1)])),_:2},1024),"text"==a.lastMessage[0].messageType?(p(),n(e,{key:0,class:"last-message thanos-ellipsis"},{default:i((()=>[d(e,{class:"ellipsis",innerHTML:a.lastMessage[0].content.content},null,8,["innerHTML"])])),_:2},1024)):(p(),n(e,{key:1,class:"last-message thanos-ellipsis"},{default:i((()=>[k("["+w(a.lastMessage[0].messageTypeText)+"]",1)])),_:2},1024))])),_:2},1024),d(e,{class:"wapim-conversation-item-right"},{default:i((()=>[v("span",{class:"last-time"},w(a.lastUpdateTime),1)])),_:2},1024)])),_:2},1032,["onClick"])])),_:2},1024)))),128)):f("",!0),0===L.value.length&&z.value?(p(),n(e,{key:1,class:"thanos-waterfall-finish-desc"},{default:i((()=>[k(w(a.$t("已经没有更多消息了")),1)])),_:1})):f("",!0)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-4184b9af"]]);export{j as default};
