import{e as a,E as e,Z as t,r as l,Q as u,j as c,q as o,y as s,D as n,o as r,c as d,z as i,a as p,i as v,w as m,F as f,J as y,b as _,t as b,d as g,B as h,A as k,C as x,a5 as T,a6 as D,_ as $,bO as N,bt as w,T as C,L as V,P as S,a1 as I,R as z,k as j,ad as U,at as M,bd as B,bI as W,bV as E,bJ as A,$ as J,a8 as R,f as O,bW as q,U as F,V as L}from"./index-BKzbZvRR.js";import{_ as P}from"./format-price.kSnuguuz.js";import{a as Q,_ as Z}from"./tig-layout.BpNdXByQ.js";import{_ as G}from"./loading-box.C4egri0r.js";import{g as H,a as K,b as X,u as Y,c as aa,d as ea}from"./account.CZcvX3n8.js";import{_ as ta}from"./tig-fixed-placeholder.s9cnCRBL.js";const la=$(a({__name:"detail",props:{activeTab:{},activeTabModifiers:{}},emits:["update:activeTab"],setup(a){const{t:$}=e(),N=t(a,"activeTab"),w=l(0),C=l(!1),V=l(!1),S=u({page:1,size:10,status:1}),I=l([]),z=async()=>{S.page>1?C.value=!0:T({title:$("加载中")});try{const a=await H({...S});w.value=a.total,I.value=[...I.value,...a.records]}catch(a){console.error(a)}finally{D(),C.value=!1,V.value=!0}};return z(),c((()=>{N.value&&"detail"===N.value&&S.page<Math.ceil(w.value/S.size)&&(S.page++,z())})),(a,e)=>{const t=v,l=g,u=h,c=o(s("loading-box"),G);return r(),n(f,null,[I.value.length>0?(r(),d(t,{key:0,class:"log-main"},{default:m((()=>[(r(!0),n(f,null,y(I.value,((a,e)=>(r(),d(t,{key:e,class:"item"},{default:m((()=>[p(t,{class:"tit"},{default:m((()=>[_(b(a.changeTypeName),1)])),_:2},1024),p(t,{class:"time"},{default:m((()=>[_(b(a.changeTime),1)])),_:2},1024),p(t,{class:"desc"},{default:m((()=>[_(b(a.changeDesc),1)])),_:2},1024),p(t,{class:"real_total"},{default:m((()=>["增加"===a.changeTypeName?(r(),d(l,{key:0},{default:m((()=>[_("+")])),_:1})):(r(),d(l,{key:1},{default:m((()=>[_("-")])),_:1})),p(l,null,{default:m((()=>[_(b(a.balance),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})):i("",!0),0===I.value.length&&!0===V.value?(r(),d(t,{key:1,class:"empty-box"},{default:m((()=>[p(t,{class:"pictrue"},{default:m((()=>[p(u,{src:k(x)("common/data_empty.png")},null,8,["src"])])),_:1}),p(t,{class:"txt"},{default:m((()=>[_(b(a.$t("暂无数据")),1)])),_:1})])),_:1})):i("",!0),p(c,{modelValue:C.value,"onUpdate:modelValue":e[0]||(e[0]=a=>C.value=a),page:S.page,length:I.value.length},null,8,["modelValue","page","length"])],64)}}}),[["__scopeId","data-v-0d2a245d"]]),ua=$(a({__name:"log",props:{activeTab:{},activeTabModifiers:{}},emits:["update:activeTab"],setup(a){const{t:g}=e(),$=t(a,"activeTab"),N=l(0),w=l(!1),C=l(!1),V=u({page:1,size:10}),S=l([]),I=async()=>{V.page>1?w.value=!0:T({title:g("加载中")});try{const a=await K({...V});N.value=a.total,S.value=[...S.value,...a.records]}catch(a){console.error(a)}finally{D(),w.value=!1,C.value=!0}};return I(),c((()=>{$.value&&"log"===$.value&&V.page<Math.ceil(N.value/V.size)&&(V.page++,I())})),(a,e)=>{const t=v,l=o(s("format-price"),P),u=h,c=o(s("loading-box"),G);return r(),n(f,null,[S.value.length>0?(r(),d(t,{key:0,class:"log-main"},{default:m((()=>[(r(!0),n(f,null,y(S.value,((e,u)=>(r(),d(t,{key:u,class:"item"},{default:m((()=>[p(t,{class:"tit"},{default:m((()=>[_(b(e.type),1)])),_:2},1024),p(t,{class:"time"},{default:m((()=>[_(b(e.addTime),1)])),_:2},1024),p(t,{class:"real_total"},{default:m((()=>[p(l,{showText:!1,decimalsStyle:{fontSize:"25rpx",fontWeight:"bold"},currencyStyle:{fontSize:"23rpx",fontWeight:"bold"},priceData:e.amount},null,8,["priceData"])])),_:2},1024),p(t,{class:"actions"},{default:m((()=>[p(t,{class:"txt"},{default:m((()=>[_(b(a.$t("管理员备注"))+"："+b(e.postscript||a.$t("无")),1)])),_:2},1024),p(t,{class:"status"},{default:m((()=>[_(b(e.statusType),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})):i("",!0),0===S.value.length&&!0===C.value?(r(),d(t,{key:1,class:"empty-box"},{default:m((()=>[p(t,{class:"pictrue"},{default:m((()=>[p(u,{src:k(x)("common/data_empty.png")},null,8,["src"])])),_:1}),p(t,{class:"txt"},{default:m((()=>[_(b(a.$t("暂无数据"))+"！",1)])),_:1})])),_:1})):i("",!0),p(c,{modelValue:w.value,"onUpdate:modelValue":e[0]||(e[0]=a=>w.value=a),page:V.page,length:S.value.length},null,8,["modelValue","page","length"])],64)}}}),[["__scopeId","data-v-f4a62d72"]]),ca=$(a({__name:"deposit",emits:["backDetail"],setup(a,{emit:t}){const{t:u}=e(),c=l([]);N((()=>{(async()=>{T({title:u("加载中")});try{const a=await X();c.value=a;let e={rechargeId:0};c.value.push(e),c.value.forEach((a=>{a.selected=!1}))}catch(a){console.log(a.message)}finally{D()}})()}));const g=l(!1),h=a=>{g.value=5===a,c.value.forEach(((e,t)=>{e.selected=t===a}))},k=l({id:0,amount:0,money:"",payType:"recharge"}),x=()=>{let a=!1;if(c.value.forEach(((e,t)=>{e.selected&&(a=!0,k.value.id=e.rechargeId,0!=e.rechargeId?(k.value.amount=null,k.value.money=e.money):k.value.money=k.value.amount)})),!k.value.money)return V({title:u("请输入充值金额"),icon:"none"});a?$(k.value):V({title:u("请选择充值金额"),icon:"none"})},$=async a=>{try{const e=await Y(a);S({url:`/pages/order/pay?orderId=${e.orderId}&type=recharge`})}catch(e){V({title:e.message,icon:"none",duration:1e3})}},I=t,z=()=>{I("backDetail")};return(a,e)=>{const t=o(s("format-price"),P),l=v,u=o(s("up-input"),w),g=o(s("tig-button"),Q),T=o(s("tig-fixed-placeholder"),ta);return r(),n(f,null,[p(l,{class:"recharge-box"},{default:m((()=>[c.value.length>0?(r(),d(l,{key:0,class:"recharge-wrap"},{default:m((()=>[(r(!0),n(f,null,y(c.value,((c,o)=>(r(),n(f,{key:o},[0!=c.rechargeId?(r(),d(l,{key:0,class:C(["recharge-item",{selected:c.selected}]),onClick:a=>h(o)},{default:m((()=>[p(l,{class:"recharge-amount"},{default:m((()=>[p(t,{showText:!1,priceData:c.money,decimalsStyle:{fontSize:"25rpx"},currencyStyle:{fontSize:"23rpx"}},null,8,["priceData"])])),_:2},1024),Number(c.discountMoney)>0?(r(),d(l,{key:0,class:"recharge-give"},{default:m((()=>[_(b(a.$t("赠送"))+" ",1),p(t,{showText:!1,priceData:c.discountMoney,isBottom:!1,fontStyle:{fontSize:"11px"}},null,8,["priceData"])])),_:2},1024)):i("",!0)])),_:2},1032,["class","onClick"])):(r(),d(l,{key:1,class:C(["recharge-item",{selected:c.selected}]),onClick:a=>h(o)},{default:m((()=>[p(l,{class:"recharge-amount"},{default:m((()=>[c.selected?(r(),d(u,{key:0,modelValue:k.value.amount,"onUpdate:modelValue":e[0]||(e[0]=a=>k.value.amount=a),type:"digit",color:"var(--color)",inputAlign:"center",border:"none"},null,8,["modelValue"])):(r(),d(l,{key:1,style:{height:"42rpx"}}))])),_:2},1024),p(l,{class:"recharge-give"},{default:m((()=>[_(b(a.$t("自定义金额")),1)])),_:1})])),_:2},1032,["class","onClick"]))],64)))),128))])),_:1})):i("",!0)])),_:1}),p(T,{backgroundColor:"#fff"},{default:m((()=>[p(l,{class:"btn-box"},{default:m((()=>[p(g,{class:"btn",plain:"",onClick:z},{default:m((()=>[_(b(a.$t("取消充值")),1)])),_:1}),p(g,{class:"btn",onClick:x},{default:m((()=>[_(b(a.$t("提交申请")),1)])),_:1})])),_:1})])),_:1})],64)}}}),[["__scopeId","data-v-0330315d"]]),oa=$(a({__name:"raplyToCard",props:{balance:{type:[Number,String],default:0}},emits:["backDetail"],setup(a,{emit:t}){const{t:u}=e(),c=[{title:"银行卡",accountType:1},{title:"支付宝",accountType:2},{title:"微信",accountType:3}],g=I(),h=l(1),x=()=>{S.value={id:"",text:u("请选择")},H.value={accountData:{accountNo:"",accountName:"",accountType:h.value,bankName:""},amount:""}},$=l(!1),S=l({id:"",text:u("请选择")}),O=()=>{$.value=!1},q=a=>{$.value=!1,S.value.id=a.value[0].id,S.value.text=a.value[0].text,F(a.value[0].id)},F=a=>{let e=(1===H.value.accountData.accountType?L:2===H.value.accountData.accountType?P:Z).value[0].find((e=>e.accountId===a));H.value.accountData.accountNo=null==e?void 0:e.accountNo,H.value.accountData.accountName=null==e?void 0:e.accountName,H.value.accountData.bankName=null==e?void 0:e.bankName},L=l([]),P=l([]),Z=l([]),G=async a=>{T({title:u("加载中")});try{let e={accountType:a};const t=await aa({...e});let l=[];1==a?(l=t.records.map((a=>({id:a.accountId,text:a.accountNo,...a}))),L.value.push(l)):2===a?(l=t.records.map((a=>({id:a.accountId,text:a.accountNo,...a}))),P.value.push(l)):(l=t.records.map((a=>({id:a.accountId,text:a.accountNo,...a}))),Z.value.push(l))}catch(e){console.error(e.message)}finally{D()}};N((()=>{G(h.value)}));const H=l({accountData:{accountNo:"",accountName:"",accountType:1,bankName:""},amount:""}),K=z((()=>{switch(H.value.accountData.accountType){case 1:return u("银行卡");case 2:return u("支付宝");case 3:return u("微信");default:return""}})),X=z((()=>{switch(H.value.accountData.accountType){case 1:return L.value;case 2:return P.value;case 3:return Z.value;default:return[]}})),Y={amount:{validator:(a,e,t)=>(0==e&&uni.$u.toast(u("提现金额必须大于0")),e>0),message:u("请输入提现金额"),trigger:["blur"]}};j((()=>{U((()=>{g.value.setRules(Y)}))}));const la=async()=>{0!==S.value.id.length?g.value.validate().then((async a=>{if(a)try{await ea({...H.value});V({title:u("操作成功"),icon:"success",duration:1e3}),setTimeout((()=>{ca()}),1500)}catch(e){console.error(e),uni.$u.toast(e.message)}})).catch((()=>{})):V({title:u("请选择需要提现的账号"),icon:"none",duration:1e3})},ua=t,ca=()=>{ua("backDetail")};return(a,e)=>{const t=v,l=o(s("up-picker"),M),u=o(s("up-button"),B),T=o(s("up-form-item"),W),D=J,N=o(s("up-input"),w),V=o(s("up-textarea"),E),I=o(s("up-form"),A),z=o(s("tig-button"),Q),j=o(s("tig-fixed-placeholder"),ta);return r(),n(f,null,[p(t,{class:"custom-tabs"},{default:m((()=>[(r(),n(f,null,y(c,((e,l)=>p(t,{key:l,class:C([{"active-tab":h.value===e.accountType},"tab"]),onClick:a=>(async a=>{a!==h.value&&(h.value=a,H.value.accountData.accountType=a,L.value=[],P.value=[],Z.value=[],x(),G(a))})(e.accountType)},{default:m((()=>[p(t,null,{default:m((()=>[_(b(a.$t(e.title)),1)])),_:2},1024)])),_:2},1032,["class","onClick"]))),64))])),_:1}),p(t,{class:"reply-main"},{default:m((()=>[p(t,{class:"reply-content"},{default:m((()=>[p(I,{ref_key:"formRef",ref:g,model:H.value,"label-width":"170rpx",errorType:"toast"},{default:m((()=>[p(T,{label:a.$t("提现至")},{default:m((()=>[p(l,{show:$.value,columns:X.value,keyName:"text",onConfirm:q,onCancel:O},null,8,["show","columns"]),p(u,{onClick:e[0]||(e[0]=a=>$.value=!0),style:{"justify-content":"flex-start"}},{default:m((()=>[_(b(S.value.text),1)])),_:1})])),_:1},8,["label"]),p(t,{class:"tips"},{default:m((()=>[_(b(a.$t("当前"))+b(K.value)+b(a.$t("账号已不用"))+"？",1),p(D,{url:"/pages/user/account/cardManagement/list",class:"font-color"},{default:m((()=>[_(b(a.$t("点击这里")),1)])),_:1}),_(b(a.$t("去添加新的"))+b(K.value)+b(a.$t("账号"))+"。",1)])),_:1}),p(T,{label:a.$t("提现姓名"),prop:"accountData.accountName"},{default:m((()=>[p(N,{modelValue:H.value.accountData.accountName,"onUpdate:modelValue":e[1]||(e[1]=a=>H.value.accountData.accountName=a),placeholder:k(R)()?a.$t("请选择{0}账号",K.value):`请选择${K.value}账号`,disabled:"",fontSize:"12"},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),1===H.value.accountData.accountType?(r(),d(T,{key:0,label:a.$t("银行详情"),prop:"accountData.bankName"},{default:m((()=>[p(V,{modelValue:H.value.accountData.bankName,"onUpdate:modelValue":e[2]||(e[2]=a=>H.value.accountData.bankName=a),placeholder:a.$t("请选择银行卡账号"),disabled:"",fontSize:"12"},null,8,["modelValue","placeholder"])])),_:1},8,["label"])):i("",!0),p(T,{label:a.$t("提现金额"),prop:"amount"},{default:m((()=>[p(N,{type:"number",modelValue:H.value.amount,"onUpdate:modelValue":e[3]||(e[3]=a=>H.value.amount=a),placeholder:a.$t("请输入提现金额"),clearable:"",fontSize:"12"},null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1},8,["model"])])),_:1})])),_:1}),p(j,{backgroundColor:"#fff"},{default:m((()=>[p(t,{class:"btn-box"},{default:m((()=>[p(z,{class:"btn",plain:"",onClick:ca},{default:m((()=>[_(b(a.$t("返回列表")),1)])),_:1}),p(z,{class:"btn",onClick:la},{default:m((()=>[_(b(a.$t("提交申请")),1)])),_:1})])),_:1})])),_:1})],64)}}}),[["__scopeId","data-v-64744f2e"]]),sa=$(a({__name:"index",setup(a){const e=l({}),t=[{title:"账户明细",action:"detail"},{title:"申请记录",action:"log"}],u=l("detail"),c=a=>{a!==u.value&&(u.value=a)},g=()=>{u.value="detail"};return O((()=>{(async()=>{try{const a=await q();Object.assign(e.value,a)}catch(a){console.error(a.message)}})()})),(a,l)=>{const h=v,k=o(s("format-price"),P),x=o(s("tig-layout"),Z);return r(),d(x,{title:"资金管理"},{default:m((()=>[p(h,{class:"top-card"},{default:m((()=>[p(h,{class:"balance-row"},{default:m((()=>[_(b(a.$t("可用余额")),1)])),_:1}),p(h,{class:"amount-row"},{default:m((()=>[p(k,{showText:!1,priceData:e.value.balance,decimalsStyle:{fontSize:"40rpx",fontWeight:"bold"},currencyStyle:{fontSize:"38rpx",fontWeight:"bold"}},null,8,["priceData"])])),_:1}),p(h,{class:"button-row"},{default:m((()=>[p(h,{class:C(["round-button",{active:"deposit"===u.value}]),onClick:l[0]||(l[0]=a=>c("deposit"))},{default:m((()=>[_(b(a.$t("充值")),1)])),_:1},8,["class"]),p(h,{class:C(["round-button",{active:"raplytocard"===u.value}]),onClick:l[1]||(l[1]=a=>c("raplytocard"))},{default:m((()=>[_(b(a.$t("提现")),1)])),_:1},8,["class"])])),_:1})])),_:1}),"detail"===u.value||"log"===u.value?(r(),d(h,{key:0,class:"custom-tabs"},{default:m((()=>[(r(),n(f,null,y(t,((e,t)=>p(h,{key:t,class:C([{"active-tab":u.value===e.action},"tab"]),onClick:a=>c(e.action)},{default:m((()=>[p(h,null,{default:m((()=>[_(b(a.$t(e.title)),1)])),_:2},1024)])),_:2},1032,["class","onClick"]))),64))])),_:1})):i("",!0),F(p(h,null,{default:m((()=>[p(la,{"active-tab":u.value,"onUpdate:activeTab":l[2]||(l[2]=a=>u.value=a)},null,8,["active-tab"])])),_:1},512),[[L,"detail"===u.value]]),F(p(h,null,{default:m((()=>[p(ua,{"active-tab":u.value,"onUpdate:activeTab":l[3]||(l[3]=a=>u.value=a)},null,8,["active-tab"])])),_:1},512),[[L,"log"===u.value]]),"deposit"===u.value?(r(),d(ca,{key:1,onBackDetail:g})):i("",!0),"raplytocard"===u.value?(r(),d(oa,{key:2,balance:e.value.balance,onBackDetail:g},null,8,["balance"])):i("",!0)])),_:1})}}}),[["__scopeId","data-v-161d5209"]]);export{sa as default};
