import{e,r as a,O as l,q as t,y as s,c as o,z as c,o as r,i as u,w as i,a as d,b as n,t as p,d as f,S as y,D as m,J as v,F as g,P as _,_ as b,E as h,Q as k,R as x,f as I,L as C,H as w,T as j,U as z,V as $,A as L,W as S,X as V,I as N}from"./index-BKzbZvRR.js";import{_ as U}from"./uni-icons.DELFdrY8.js";import{_ as D}from"./empty-box.vue_vue_type_script_setup_true_lang.CeENwGmf.js";import{_ as M}from"./loading-box.C4egri0r.js";import{a as O,_ as P,b as J}from"./tig-layout.BpNdXByQ.js";import{m as T}from"./masonry.XQRK2NFB.js";import{g as W,a as A,b as E,c as F}from"./search.BVFvN7yJ.js";import{u as H}from"./useList.qLYpICh7.js";import{_ as K}from"./tig-image.DrOwWlV9.js";import{_ as R}from"./format-price.kSnuguuz.js";import{g as q}from"./shop.C37ErgAh.js";import"./specification.DeG19GHJ.js";import"./uni-number-box.CzE6YkX8.js";import"./product.BqL6tr7k.js";import"./activityCard.DDPb7Kxq.js";const G=b(e({__name:"shopInfo",props:{keyword:{type:String,default:""}},setup(e){const b=e,h=a({});l((()=>b.keyword),(e=>{e&&(async()=>{try{const e=await q({keyword:b.keyword,size:1});h.value=e.records[0]}catch(e){console.error(e)}})()}),{immediate:!0});const k=e=>{e&&_({url:e})};return(e,a)=>{const l=t(s("tig-image"),K),_=u,b=t(s("tig-button"),O),x=f,I=t(s("format-price"),R),C=y;return h.value&&Object.keys(h.value).length>0?(r(),o(_,{key:0,class:"shop-info-box"},{default:i((()=>[d(_,{class:"shop-info"},{default:i((()=>[d(_,{class:"shop-title",onClick:a[1]||(a[1]=e=>k(`/pages/shop/index?shopId=${h.value.shopId}`))},{default:i((()=>[d(_,{class:"shop-logo"},{default:i((()=>[d(l,{src:h.value.shopLogo},null,8,["src"])])),_:1}),d(_,{class:"shop-title-text line1"},{default:i((()=>[n(p(h.value.shopTitle),1)])),_:1}),d(_,{class:"shop-btn"},{default:i((()=>[d(b,{class:"btn",plain:!0,plainMainColor:!0,onClick:a[0]||(a[0]=e=>k(`/pages/shop/index?shopId=${h.value.shopId}`))},{default:i((()=>[n(p(e.$t("进店")),1)])),_:1})])),_:1})])),_:1}),d(_,{class:"shop-desc"},{default:i((()=>[d(x,{class:"shop-info-text"},{default:i((()=>[n("上架商品："+p(h.value.listingCount),1)])),_:1}),d(x,{class:"shop-info-text"},{default:i((()=>[n("店铺收藏："+p(h.value.collectCount),1)])),_:1})])),_:1}),d(_,{class:"shop-product"},{default:i((()=>[d(C,{"scroll-x":"true"},{default:i((()=>[d(_,{class:"shop-product-scroll"},{default:i((()=>[(r(!0),m(g,null,v(h.value.listingProduct,(e=>(r(),o(_,{key:e.productId,class:"shop-product-image",onClick:a=>k(`/pages/product/index?id=${e.productId}`)},{default:i((()=>[d(l,{src:e.picUrl},null,8,["src"]),d(_,{class:"product-price"},{default:i((()=>[d(I,{fontStyle:{fontSize:"24rpx"},currencyStyle:{fontSize:"20rpx"},decimalsStyle:{fontSize:"22rpx"},priceData:e.productPrice},null,8,["priceData"])])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})):c("",!0)}}}),[["__scopeId","data-v-d477c965"]]),Q=b(e({__name:"result",setup(e){console.log("result");const{t:l}=h(),b=a("商品搜索"),O=k({page:1,size:10,sort:"",order:"asc",keyword:"",max:"",min:"",cat:0,couponId:0,brand:[],intro:"",pageType:"search"}),K=a([]),R=a([]),q=a(""),Q=a([]),X=a([]),B={new:l("新品"),hot:l("热销"),best:l("精品")},Y=a([]),Z=x((()=>Q.value.length>3&&!ve.value?Q.value.slice(0,3):Q.value)),ee=x((()=>X.value.length>3&&!ve.value?X.value.slice(0,3):X.value)),ae=x((()=>O.cat?Y.value:O.shopCategoryId?X.value:[])),{getList:le,total:te,data:se,promotionList:oe,isLoadMore:ce,isLoading:re}=H(W,{params:O,path:{dataKey:"records"},needPromotionList:!0}),ue=async()=>{try{O.brand=R.value.join(",");const e=await A({...O});if(K.value=e.filter.brand,Q.value=e.filter.category,X.value=e.filter.shopCategory,q.value=e.filterSelected.brand,O.cat){const e=await E(O.cat);Y.value=e}if(O.shopCategoryId){const e=await F(O.shopCategoryId);X.value=e}}catch(e){C({title:e.message,icon:"none"})}},ie=a("default"),de=a([{label:"默认",value:"default"},{label:"销量",value:"sale"},{label:"价格",value:"price",order:"desc"}]),ne=e=>{switch(e){case"brand":R.value=[],q.value="";break;case"price":O.min="",O.max="";break;case"keyword":O.keyword="";break;case"intro":O.intro="";break;case"couponInfo":me.value={},O.couponId=0}ue(),he(),le((()=>({brand:R.value.join(",")})))},pe=a(!1),fe=()=>{pe.value=!0},ye=()=>{_({url:"/pages/search/index"})},me=a({});I((e=>{e&&(e.keyWords&&(O.keyword=e.keyWords),e.intro&&(O.intro=e.intro),e.categoryId&&(O.cat=e.categoryId),e.brandId&&R.value.push(e.brandId),e.shopId&&(O.shopId=e.shopId,b.value="店铺商品搜索"),e.shopCategoryId&&(O.shopCategoryId=e.shopCategoryId),e.couponInfo&&(me.value=JSON.parse(decodeURIComponent(e.couponInfo)),O.couponId=me.value.couponId)),ue(),le((()=>({brand:R.value.join(",")})))}));const ve=a(!1),ge=a(!1),_e=()=>{Number(O.min)>Number(O.max)?C({title:l("最低价不能大于最高价"),icon:"none"}):(ue(),pe.value=!1,he(),le((()=>({brand:R.value.join(",")}))))},be=()=>{O.min="",O.max="",R.value=[],O.cat=0},he=()=>{te.value=0,O.page=1,O.intro="",se.value=[],oe.value={}};return(e,a)=>{const l=t(s("uni-icons"),U),_=u,h=f,k=t(s("empty-box"),D),x=t(s("loading-box"),M),I=N,C=y,W=t(s("tig-popup"),J),A=t(s("tig-layout"),P);return r(),o(A,{title:b.value,shopId:O.shopId,shopCategoryId:O.shopCategoryId},{default:i((()=>[d(_,{class:"pageMain productSort"},{default:i((()=>[d(_,{class:"header acea-row row-center-wrapper"},{default:i((()=>[d(_,{onClick:w(ye,["stop"]),class:"acea-row row-between-wrapper input"},{default:i((()=>[d(l,{type:"search",size:"18",class:"sousuo"}),d(_,{class:"txt"},{default:i((()=>[n(p(e.$t("请输入搜索内容")),1)])),_:1})])),_:1})])),_:1}),d(_,{class:"tab-box flex align-center justify-between"},{default:i((()=>[(r(!0),m(g,null,v(de.value,(a=>(r(),o(_,{key:a.value,class:j(["item flex align-center",{active:ie.value===a.value}]),onClick:e=>(e=>{"price"==e.value?e.order="desc"===e.order?"asc":"desc":e.order="",ie.value=e.value,O.sort=e.value,O.order=e.order,ue(),he(),le((()=>O.brand=R.value.join(",")))})(a)},{default:i((()=>[d(h,null,{default:i((()=>[n(p(e.$t(a.label)),1)])),_:2},1024),z(d(_,{class:"price-ico-box flex flex-column"},{default:i((()=>[d(l,{type:"up",size:"8",class:j({order:"price"===ie.value&&"asc"===a.order})},null,8,["class"]),d(l,{type:"down",size:"8",class:j({order:"price"===ie.value&&"desc"===a.order})},null,8,["class"])])),_:2},1536),[[$,"price"===a.value]])])),_:2},1032,["class","onClick"])))),128)),d(_,{class:"item flex",onClick:fe},{default:i((()=>[d(h,null,{default:i((()=>[n(p(e.$t("筛选")),1)])),_:1}),d(l,{type:"right",size:"12",class:"sanjiaoright"})])),_:1})])),_:1}),d(_,{class:"tag-row"},{default:i((()=>[d(_,{class:"tag-list flex-wrap align-center"},{default:i((()=>[O.keyword?(r(),o(_,{key:0,class:"tag-item mr10 line1",onClick:a[0]||(a[0]=e=>ne("keyword"))},{default:i((()=>[d(h,{class:"line1"},{default:i((()=>[n(p(e.$t("搜索关键词"))+'"'+p(O.keyword)+'"',1)])),_:1}),d(l,{type:"closeempty",size:"10"})])),_:1})):c("",!0),O.intro?(r(),o(_,{key:1,class:"tag-item mr10",onClick:a[1]||(a[1]=e=>ne("intro"))},{default:i((()=>[d(h,null,{default:i((()=>[n(p(B[O.intro]),1)])),_:1}),d(l,{type:"closeempty",size:"10"})])),_:1})):c("",!0),me.value&&me.value.couponName?(r(),o(_,{key:2,class:"tag-item mr10",onClick:a[2]||(a[2]=e=>ne("coupon_info"))},{default:i((()=>[d(h,null,{default:i((()=>[n(p(e.$t("优惠券"))+': "'+p(me.value.couponName)+'"',1)])),_:1}),d(l,{type:"closeempty",size:"10"})])),_:1})):c("",!0),q.value?(r(),o(_,{key:3,class:"tag-item mr10 brand",onClick:a[3]||(a[3]=e=>ne("brand"))},{default:i((()=>[d(h,null,{default:i((()=>[n(p(q.value),1)])),_:1}),d(l,{type:"closeempty",size:"10"})])),_:1})):c("",!0),O.max||O.min?(r(),o(_,{key:4,class:"tag-item mr10",onClick:a[4]||(a[4]=e=>ne("price"))},{default:i((()=>[d(h,null,{default:i((()=>[n(p(O.min||0)+" - "+p(O.max||0),1)])),_:1}),d(l,{type:"closeempty",size:"10"})])),_:1})):c("",!0),ae.value.length>0?(r(!0),m(g,{key:5},v(ae.value,((e,a)=>(r(),o(_,{class:"flex align-center",key:a,onClick:e=>(e=>{e>0?O.shopCategoryId?O.shopCategoryId=X.value[e-1].categoryId:O.cat=Y.value[e-1].categoryId:O.shopCategoryId?O.shopCategoryId=0:O.cat=0,ue(),he(),le((()=>({brand:R.value.join(",")})))})(a)},{default:i((()=>[d(_,{class:"tag-item"},{default:i((()=>[d(h,null,{default:i((()=>[n(p(e.categoryName),1)])),_:2},1024),d(l,{type:"closeempty",size:"10"})])),_:2},1024),a<ae.value.length-1?(r(),o(_,{key:0,class:"tag-interval"},{default:i((()=>[d(l,{type:"right",size:"10"})])),_:1})):c("",!0)])),_:2},1032,["onClick"])))),128)):c("",!0)])),_:1})])),_:1}),L(S)()&&O.keyword?(r(),o(G,{key:0,keyword:O.keyword},null,8,["keyword"])):c("",!0),!L(re)&&L(te)>0?(r(),o(_,{key:1,class:"goods-container"},{default:i((()=>[d(T,{commodityList:L(se),promotionList:L(oe)},null,8,["commodityList","promotionList"])])),_:1})):c("",!0),L(re)||0!==L(te)?c("",!0):(r(),o(k,{key:2,mode:"search",background:"#f5f5f5"})),d(x,{modelValue:L(ce),"onUpdate:modelValue":a[5]||(a[5]=e=>V(ce)?ce.value=e:null),page:O.page,length:L(se).length},null,8,["modelValue","page","length"]),d(W,{show:pe.value,"onUpdate:show":a[10]||(a[10]=e=>pe.value=e),position:"right",zIndex:900,showClose:!1},{default:i((()=>[d(C,{"scroll-y":"true",class:"search_condition"},{default:i((()=>[d(_,{class:"search_condition-box"},{default:i((()=>[Q.value.length>0?(r(),o(_,{key:0,class:"tab_box"},{default:i((()=>[d(_,{class:"title-box flex justify-between"},{default:i((()=>[d(_,{class:"txt"},{default:i((()=>[n(p(e.$t("分类")),1)])),_:1}),d(_,{class:"more",onClick:a[6]||(a[6]=e=>ve.value=!ve.value)},{default:i((()=>[ve.value?(r(),o(l,{key:0,type:"up",size:"16",color:"#bfbfbf"})):(r(),o(l,{key:1,type:"down",size:"16",color:"#bfbfbf"}))])),_:1})])),_:1}),O.shopId?(r(),o(_,{key:0,class:"tabs flex-wrap"},{default:i((()=>[(r(!0),m(g,null,v(ee.value,((e,a)=>(r(),o(_,{class:j(["item",{active:O.shopCategoryId==e.categoryId}]),key:a,onClick:a=>O.shopCategoryId=e.categoryId},{default:i((()=>[O.shopCategoryId==e.categoryId?(r(),o(l,{key:0,type:"checkmarkempty",size:"12"})):c("",!0),n(" "+p(e.categoryName),1)])),_:2},1032,["onClick","class"])))),128))])),_:1})):(r(),o(_,{key:1,class:"tabs flex-wrap"},{default:i((()=>[(r(!0),m(g,null,v(Z.value,((e,a)=>(r(),o(_,{class:j(["item",{active:O.cat==e.categoryId}]),key:a,onClick:a=>O.cat=e.categoryId},{default:i((()=>[O.cat==e.categoryId?(r(),o(l,{key:0,type:"checkmarkempty",size:"12"})):c("",!0),n(" "+p(e.categoryName),1)])),_:2},1032,["onClick","class"])))),128))])),_:1}))])),_:1})):c("",!0),K.value.length>0?(r(),o(_,{key:1,class:"tab_box"},{default:i((()=>[d(_,{class:"title-box flex justify-between"},{default:i((()=>[d(_,{class:"txt"},{default:i((()=>[n(p(e.$t("品牌")),1)])),_:1}),d(_,{class:"more",onClick:a[7]||(a[7]=e=>ge.value=!ge.value)},{default:i((()=>[ge.value?(r(),o(l,{key:0,type:"up",size:"16",color:"#bfbfbf"})):(r(),o(l,{key:1,type:"down",size:"16",color:"#bfbfbf"}))])),_:1})])),_:1}),d(_,{class:"tabs flex-wrap"},{default:i((()=>[(r(!0),m(g,null,v(ge.value?K.value:K.value.slice(0,3),((e,a)=>(r(),o(_,{key:a,class:j(["item",{active:R.value.includes(e.brandId)}]),onClick:a=>(e=>{let a=R.value.indexOf(e.brandId);-1!==a?R.value.splice(a,1):R.value.push(e.brandId)})(e)},{default:i((()=>[R.value.includes(e.brandId)?(r(),o(l,{key:0,type:"checkmarkempty",size:"12"})):c("",!0),n(" "+p(e.brandName),1)])),_:2},1032,["onClick","class"])))),128))])),_:1})])),_:1})):c("",!0),d(_,{class:"tab_box"},{default:i((()=>[d(_,{class:"title-box flex justify-between"},{default:i((()=>[d(_,{class:"txt"},{default:i((()=>[n(p(e.$t("价格")),1)])),_:1})])),_:1}),d(_,{class:"tabs flex justify-between align-center"},{default:i((()=>[d(I,{class:"uni-input",type:"number",modelValue:O.min,"onUpdate:modelValue":a[8]||(a[8]=e=>O.min=e),placeholder:e.$t("最低价")},null,8,["modelValue","placeholder"]),d(_,{class:"xian"}),d(I,{class:"uni-input",type:"number",modelValue:O.max,"onUpdate:modelValue":a[9]||(a[9]=e=>O.max=e),placeholder:e.$t("最高价")},null,8,["modelValue","placeholder"])])),_:1})])),_:1})])),_:1}),d(_,{class:"btn-box"},{default:i((()=>[d(_,{class:"flex"},{default:i((()=>[d(_,{class:"btn",onClick:be},{default:i((()=>[n(p(e.$t("重置")),1)])),_:1}),d(_,{class:"btn submit",onClick:_e},{default:i((()=>[n(p(e.$t("确定")),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["show"])])),_:1})])),_:1},8,["title","shopId","shopCategoryId"])}}}),[["__scopeId","data-v-1ef0ff7e"]]);export{Q as default};
