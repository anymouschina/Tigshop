import{d as e,r as a,P as l,k as t,l as s,m as o,n as i,w as c,q as r,t as u,v as n,y as d,J as p,F as _,x as f,L as y,C as m,B as v,S as g,G as h,u as b,Q as k,R as x,o as w,T as j,s as C,I as z,U as $,M as L,N as S,V as I,W as V,X as U,Y as M}from"./index-Do_Cb7fn.js";import{_ as N}from"./uni-icons.DK0ZiICA.js";import{_ as B}from"./empty-box.vue_vue_type_script_setup_true_lang.D7M9aYx3.js";import{_ as O}from"./loading-box.Cez_qIZa.js";import{a as D,b as J,c as P,_ as W}from"./tig-layout.BV0ZvCt0.js";import{n as q}from"./index.Y6J4G1_A.js";import{m as G}from"./masonry.CX4MOC2F.js";import{g as H,a as K,b as Q,c as R}from"./search.DrJHzBfC.js";import{_ as F}from"./tig-image.D5KdQk-t.js";import{_ as T}from"./format-price.D2lH_-yv.js";import{g as X}from"./shop.Bj95X61o.js";import{_ as Y}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{u as A}from"./useList.Dtpd-ehd.js";import"./u-empty.DRH0yXs0.js";import"./u-icon.CBDMG2rO.js";import"./u-loading-icon.rQrrZF_r.js";import"./specification.C7sO8fab.js";import"./uni-number-box.Bfp_yH4M.js";import"./product.Cqsfbx9G.js";import"./activityCard._4qx8gud.js";const E=Y(e({__name:"shopInfo",props:{keyword:{type:String,default:""}},setup(e){const h=e,b=a({});l((()=>h.keyword),(e=>{e&&(async()=>{try{const e=await X({keyword:h.keyword,size:1});b.value=e.item[0]}catch(e){console.error(e)}})()}),{immediate:!0});const k=e=>{e&&y({url:e})};return(e,a)=>{const l=t(s("tig-image"),F),y=m,h=t(s("tig-button"),D),x=v,w=t(s("format-price"),T),j=g;return b.value&&Object.keys(b.value).length>0?(o(),i(y,{key:0,class:"shop-info-box"},{default:c((()=>[r(y,{class:"shop-info"},{default:c((()=>[r(y,{class:"shop-title",onClick:a[2]||(a[2]=e=>k(`/pages/shop/index?shop_id=${b.value.shop_id}`))},{default:c((()=>[r(y,{class:"shop-logo"},{default:c((()=>[r(l,{src:b.value.shop_logo,"onUpdate:src":a[0]||(a[0]=e=>b.value.shop_logo=e)},null,8,["src"])])),_:1}),r(y,{class:"shop-title-text line1"},{default:c((()=>[u(n(b.value.shop_title),1)])),_:1}),r(y,{class:"shop-btn"},{default:c((()=>[r(h,{customStyle:{height:"40rpx",width:"100rpx"},plain:!0,plainMainColor:!0,onClick:a[1]||(a[1]=()=>{})},{default:c((()=>[u(n(e.$t("进店")),1)])),_:1})])),_:1})])),_:1}),r(y,{class:"shop-desc"},{default:c((()=>[r(x,{class:"shop-info-text"},{default:c((()=>[u("上架商品："+n(b.value.listing_count),1)])),_:1}),r(x,{class:"shop-info-text"},{default:c((()=>[u("店铺收藏："+n(b.value.collect_count),1)])),_:1})])),_:1}),r(y,{class:"shop-product"},{default:c((()=>[r(j,{"scroll-x":"true"},{default:c((()=>[r(y,{class:"shop-product-scroll"},{default:c((()=>[(o(!0),d(_,null,p(b.value.listing_product,(e=>(o(),i(y,{key:e.product_id,class:"shop-product-image",onClick:a=>k(`/pages/productDetail/index?id=${e.product_id}`)},{default:c((()=>[r(l,{src:e.pic_url,"onUpdate:src":a=>e.pic_url=a},null,8,["src","onUpdate:src"]),r(y,{class:"product-price"},{default:c((()=>[r(w,{fontStyle:{fontSize:"24rpx"},currencyStyle:{fontSize:"20rpx"},decimalsStyle:{fontSize:"22rpx"},priceData:e.product_price},null,8,["priceData"])])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})):f("",!0)}}}),[["__scopeId","data-v-275c2a19"]]),Z=Y(e({__name:"result",setup(e){const{t:l}=h(),{saveBottom:g}=J(),D=b(),F=a({navbar:"1",return:"1",title:"商品搜索"}),T=D.navHeight,X=k({page:1,size:20,sort:"",order:"asc",keyword:"",max:"",min:"",cat:0,coupon_id:0,brand:[],intro:"",page_type:"search"}),Y=a([]),Z=a([]),ee=a(""),ae=a([]),le=a([]),te={new:l("新品"),hot:l("热销"),best:l("精品")},se=a([]),oe=x((()=>ae.value.length>3&&!xe.value?ae.value.slice(0,3):ae.value)),ie=x((()=>le.value.length>3&&!xe.value?le.value.slice(0,3):le.value)),ce=x((()=>X.cat?se.value:X.shop_category_id?le.value:[])),{getList:re,total:ue,data:ne,promotionList:de,isLoadMore:pe,isLoading:_e}=A(H,{params:X,path:{dataKey:"product_list"},needPromotionList:!0}),fe=async()=>{try{X.brand=Z.value.join(",");const e=await K({...X});if(Y.value=e.filter.brand,ae.value=e.filter.category,le.value=e.filter.shop_category,ee.value=e.filter_selected.brand,X.cat){const e=await Q(X.cat);se.value=e.category_tree}if(X.shop_category_id){const e=await R(X.shop_category_id);le.value=e.category_tree}}catch(e){L({title:e.message,icon:"none"})}},ye=a("default"),me=a([{label:"默认",value:"default"},{label:"销量",value:"sales"},{label:"价格",value:"price",order:"desc"}]),ve=e=>{switch(e){case"brand":Z.value=[],ee.value="";break;case"price":X.min="",X.max="";break;case"keyword":X.keyword="";break;case"intro":X.intro="";break;case"coupon_info":ke.value={},X.coupon_id=0}fe(),ze(),re((()=>({brand:Z.value.join(",")})))},ge=a(!1),he=()=>{ge.value=!0},be=()=>{y({url:"/pages/search/index"})},ke=a({});w((e=>{e&&(e.keyWords&&(X.keyword=e.keyWords),e.intro&&(X.intro=e.intro),e.category_id&&(X.cat=e.category_id),e.brand_id&&Z.value.push(e.brand_id),e.shop_id&&(X.shop_id=e.shop_id,F.value.title="店铺商品搜索"),e.shop_category_id&&(X.shop_category_id=e.shop_category_id),e.coupon_info&&(ke.value=JSON.parse(decodeURIComponent(e.coupon_info)),X.coupon_id=ke.value.coupon_id)),fe(),re((()=>({brand:Z.value.join(",")})))}));const xe=a(!1),we=a(!1),je=()=>{Number(X.min)>Number(X.max)?L({title:l("最低价不能大于最高价"),icon:"none"}):(fe(),ge.value=!1,ze(),re((()=>({brand:Z.value.join(",")}))))},Ce=()=>{X.min="",X.max="",Z.value=[],X.cat=0},ze=()=>{ue.value=0,X.page=1,X.intro="",ne.value=[],de.value={}};return(e,a)=>{const l=t(s("uni-icons"),N),y=m,h=v,b=t(s("empty-box"),B),k=t(s("loading-box"),O),x=S,w=t(s("tig-popup"),P),L=t(s("tig-layout"),W);return o(),i(y,null,{default:c((()=>[r(L,{shopId:X.shop_id,shopCategoryId:X.shop_category_id},{default:c((()=>[r(q,{parameter:F.value},null,8,["parameter"]),r(y,{class:"pageMain productSort"},{default:c((()=>[r(y,{class:"header acea-row row-center-wrapper",style:j("top:"+C(T)+"rpx")},{default:c((()=>[r(y,{onClick:z(be,["stop"]),class:"acea-row row-between-wrapper input"},{default:c((()=>[r(l,{type:"search",size:"18",class:"sousuo"}),r(y,{class:"txt"},{default:c((()=>[u(n(e.$t("请输入搜索内容")),1)])),_:1})])),_:1})])),_:1},8,["style"]),r(y,{class:"tab-box flex align-center justify-between"},{default:c((()=>[(o(!0),d(_,null,p(me.value,(a=>(o(),i(y,{class:I(["item flex align-center",{active:ye.value===a.value}]),key:a.value,onClick:e=>(e=>{"price"==e.value?e.order="desc"===e.order?"asc":"desc":e.order="",ye.value=e.value,X.sort=e.value,X.order=e.order,fe(),ze(),re((()=>X.brand=Z.value.join(",")))})(a)},{default:c((()=>[r(h,null,{default:c((()=>[u(n(e.$t(a.label)),1)])),_:2},1024),V(r(y,{class:"price-ico-box flex flex-column"},{default:c((()=>[r(l,{type:"up",size:"8",class:I({order:"price"===ye.value&&"asc"===a.order})},null,8,["class"]),r(l,{type:"down",size:"8",class:I({order:"price"===ye.value&&"desc"===a.order})},null,8,["class"])])),_:2},1536),[[U,"price"===a.value]])])),_:2},1032,["class","onClick"])))),128)),r(y,{class:"item flex",onClick:he},{default:c((()=>[r(h,null,{default:c((()=>[u(n(e.$t("筛选")),1)])),_:1}),r(l,{type:"right",size:"12",class:"sanjiaoright"})])),_:1})])),_:1}),r(y,{class:"tag-row"},{default:c((()=>[r(y,{class:"tag-list flex-wrap align-center"},{default:c((()=>[X.keyword?(o(),i(y,{key:0,class:"tag-item mr10",onClick:a[0]||(a[0]=e=>ve("keyword"))},{default:c((()=>[r(h,null,{default:c((()=>[u(n(e.$t("搜索关键词"))+'"'+n(X.keyword)+'"',1)])),_:1}),r(l,{type:"closeempty",size:"10"})])),_:1})):f("",!0),X.intro?(o(),i(y,{key:1,class:"tag-item mr10",onClick:a[1]||(a[1]=e=>ve("intro"))},{default:c((()=>[r(h,null,{default:c((()=>[u(n(te[X.intro]),1)])),_:1}),r(l,{type:"closeempty",size:"10"})])),_:1})):f("",!0),ke.value&&ke.value.coupon_name?(o(),i(y,{key:2,class:"tag-item mr10",onClick:a[2]||(a[2]=e=>ve("coupon_info"))},{default:c((()=>[r(h,null,{default:c((()=>[u(n(e.$t("优惠券"))+': "'+n(ke.value.coupon_name)+'"',1)])),_:1}),r(l,{type:"closeempty",size:"10"})])),_:1})):f("",!0),ee.value?(o(),i(y,{key:3,class:"tag-item mr10 brand",onClick:a[3]||(a[3]=e=>ve("brand"))},{default:c((()=>[r(h,null,{default:c((()=>[u(n(ee.value),1)])),_:1}),r(l,{type:"closeempty",size:"10"})])),_:1})):f("",!0),X.max||X.min?(o(),i(y,{key:4,class:"tag-item mr10",onClick:a[4]||(a[4]=e=>ve("price"))},{default:c((()=>[r(h,null,{default:c((()=>[u(n(X.min||0)+" - "+n(X.max||0),1)])),_:1}),r(l,{type:"closeempty",size:"10"})])),_:1})):f("",!0),ce.value.length>0?(o(!0),d(_,{key:5},p(ce.value,((e,a)=>(o(),i(y,{class:"flex align-center",key:a,onClick:e=>(e=>{e>0?X.shop_category_id?X.shop_category_id=le.value[e-1].category_id:X.cat=se.value[e-1].category_id:X.shop_category_id?X.shop_category_id=0:X.cat=0,fe(),ze(),re((()=>({brand:Z.value.join(",")})))})(a)},{default:c((()=>[r(y,{class:"tag-item"},{default:c((()=>[r(h,null,{default:c((()=>[u(n(e.category_name),1)])),_:2},1024),r(l,{type:"closeempty",size:"10"})])),_:2},1024),a<ce.value.length-1?(o(),i(y,{key:0,class:"tag-interval"},{default:c((()=>[r(l,{type:"right",size:"10"})])),_:1})):f("",!0)])),_:2},1032,["onClick"])))),128)):f("",!0)])),_:1})])),_:1}),C(M)()&&X.keyword?(o(),i(E,{key:0,keyword:X.keyword},null,8,["keyword"])):f("",!0),C(_e)?f("",!0):(o(),i(y,{key:1,class:"goods-container"},{default:c((()=>[C(ne).length>0?(o(),i(G,{key:0,commodityList:C(ne),promotionList:C(de)},null,8,["commodityList","promotionList"])):f("",!0),0===C(ne).length?(o(),i(b,{key:1,mode:"search",background:"#f5f5f5"})):f("",!0)])),_:1})),r(k,{modelValue:C(pe),"onUpdate:modelValue":a[5]||(a[5]=e=>$(pe)?pe.value=e:null),page:X.page,length:C(ne).length},null,8,["modelValue","page","length"]),r(w,{show:ge.value,"onUpdate:show":a[10]||(a[10]=e=>ge.value=e),position:"right",showClose:!1,paddingBottom:"40"},{default:c((()=>[r(y,{class:"search_condition"},{default:c((()=>[ae.value.length>0?(o(),i(y,{key:0,class:"tab_box"},{default:c((()=>[r(y,{class:"title-box flex justify-between"},{default:c((()=>[r(y,{class:"txt"},{default:c((()=>[u(n(e.$t("分类")),1)])),_:1}),r(y,{class:"more",onClick:a[6]||(a[6]=e=>xe.value=!xe.value)},{default:c((()=>[xe.value?(o(),i(l,{key:0,type:"up",size:"16",color:"#bfbfbf"})):(o(),i(l,{key:1,type:"down",size:"16",color:"#bfbfbf"}))])),_:1})])),_:1}),X.shop_id?(o(),i(y,{key:0,class:"tabs flex-wrap"},{default:c((()=>[(o(!0),d(_,null,p(ie.value,((e,a)=>(o(),i(y,{class:I(["item",{active:X.shop_category_id==e.category_id}]),key:a,onClick:a=>X.shop_category_id=e.category_id},{default:c((()=>[X.shop_category_id==e.category_id?(o(),i(l,{key:0,type:"checkmarkempty",size:"12"})):f("",!0),u(" "+n(e.category_name),1)])),_:2},1032,["onClick","class"])))),128))])),_:1})):(o(),i(y,{key:1,class:"tabs flex-wrap"},{default:c((()=>[(o(!0),d(_,null,p(oe.value,((e,a)=>(o(),i(y,{class:I(["item",{active:X.cat==e.category_id}]),key:a,onClick:a=>X.cat=e.category_id},{default:c((()=>[X.cat==e.category_id?(o(),i(l,{key:0,type:"checkmarkempty",size:"12"})):f("",!0),u(" "+n(e.category_name),1)])),_:2},1032,["onClick","class"])))),128))])),_:1}))])),_:1})):f("",!0),Y.value.length>0?(o(),i(y,{key:1,class:"tab_box"},{default:c((()=>[r(y,{class:"title-box flex justify-between"},{default:c((()=>[r(y,{class:"txt"},{default:c((()=>[u(n(e.$t("品牌")),1)])),_:1}),r(y,{class:"more",onClick:a[7]||(a[7]=e=>we.value=!we.value)},{default:c((()=>[we.value?(o(),i(l,{key:0,type:"up",size:"16",color:"#bfbfbf"})):(o(),i(l,{key:1,type:"down",size:"16",color:"#bfbfbf"}))])),_:1})])),_:1}),r(y,{class:"tabs flex-wrap"},{default:c((()=>[(o(!0),d(_,null,p(we.value?Y.value:Y.value.slice(0,3),((e,a)=>(o(),i(y,{class:I(["item",{active:Z.value.includes(e.brand_id)}]),onClick:a=>(e=>{let a=Z.value.indexOf(e.brand_id);-1!==a?Z.value.splice(a,1):Z.value.push(e.brand_id)})(e),key:a},{default:c((()=>[Z.value.includes(e.brand_id)?(o(),i(l,{key:0,type:"checkmarkempty",size:"12"})):f("",!0),u(" "+n(e.brand_name),1)])),_:2},1032,["onClick","class"])))),128))])),_:1})])),_:1})):f("",!0),r(y,{class:"tab_box"},{default:c((()=>[r(y,{class:"title-box flex justify-between"},{default:c((()=>[r(y,{class:"txt"},{default:c((()=>[u(n(e.$t("价格")),1)])),_:1})])),_:1}),r(y,{class:"tabs flex justify-between align-center"},{default:c((()=>[r(x,{class:"uni-input",type:"number",modelValue:X.min,"onUpdate:modelValue":a[8]||(a[8]=e=>X.min=e),placeholder:e.$t("最低价")},null,8,["modelValue","placeholder"]),r(y,{class:"xian"}),r(x,{class:"uni-input",type:"number",modelValue:X.max,"onUpdate:modelValue":a[9]||(a[9]=e=>X.max=e),placeholder:e.$t("最高价")},null,8,["modelValue","placeholder"])])),_:1})])),_:1}),r(y,{class:"btn-box"},{default:c((()=>[r(y,{class:"flex",style:j({"padding-bottom":C(g)+"px"})},{default:c((()=>[r(y,{class:"btn",onClick:Ce},{default:c((()=>[u(n(e.$t("重置")),1)])),_:1}),r(y,{class:"btn submit",onClick:je},{default:c((()=>[u(n(e.$t("确定")),1)])),_:1})])),_:1},8,["style"])])),_:1})])),_:1})])),_:1},8,["show"])])),_:1})])),_:1},8,["shopId","shopCategoryId"])])),_:1})}}}),[["__scopeId","data-v-0c3cef66"]]);export{Z as default};
