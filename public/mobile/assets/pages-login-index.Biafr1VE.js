import{d as e,u as a,G as l,ac as s,Q as t,r as o,R as u,o as i,K as c,f as n,H as d,ad as r,k as p,l as _,m as v,n as m,w as f,q as x,t as h,v as k,y as g,s as b,x as E,F as y,V as I,I as T,M as V,a4 as R,O as w,L as C,C as S,N as U,B as A,a0 as O}from"./index-Ce4FtYLL.js";import{_ as $}from"./tig-mobile-areacode.DTUH7F-6.js";import{f as j,a as D,e as L,_ as N,s as P}from"./tig-layout.nM03J4I_.js";import{V as q,a as M}from"./verificationCode.vdLVoKDN.js";import{n as B}from"./index.v2UirNFN.js";import{_ as F}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./u-picker.DYwBhpy0.js";import"./u-loading-icon.CaEeBur7.js";import"./u-icon.BDQrrWMI.js";var z={VITE_NODE_ENV:"production",VITE_API_URL:"",VITE_API_PREFIX:"/api/",VITE_STATIC_RESOURCE:"static/mini",VITE_SOCKET_URL:"",VITE_IS_MERCHANT:"0",VITE_IS_PRO:"0",VITE_IS_B2B:"0",VITE_IS_OVERSEAS:"0",VITE_PROXY:"0",VITE_CJS_IGNORE_WARNING:"true",VITE_USER_NODE_ENV:"production",VITE_ROOT_DIR:"/home/tigshop/.jenkins/workspace/发布到gitee和github/Api发布到github/default/project/view/Tigshop-Uniapp",BASE_URL:"/mobile",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const G=F(e({__name:"index",setup(e){const F=a(),{t:G}=l(),H=s(),K=t({navbar:"1",return:"1",title:"登录"}),W=o("mobile"),X=o(""),J=o(""),Q=o(""),Y=o(""),Z=o(!1),ee=o(""),ae=o(!1),le=o(),se=o("86"),te=u((()=>"password"===W.value?!Q.value||!Y.value:!X.value||!J.value||!ee.value)),oe=e=>{X.value=e.detail.value},ue=e=>{J.value=e.detail.value},ie=e=>{V({title:e,duration:1500,icon:"none"})},ce=()=>{if(!Z.value)return V({title:G("请先同意用户协议"),duration:1500,icon:"none"});de()},ne=()=>{W.value="mobile"===W.value?"password":"mobile",Q.value=z.VITE_DEFAULT_USER_NAME||"",Y.value=z.VITE_DEFAULT_USER_PASSWORD||"",X.value="",J.value="",ee.value="",Z.value=!1},de=async()=>{try{ae.value=!0;const e=await j({login_type:W.value,username:Q.value,password:Y.value,mobile:F.is_open_mobile_area_code?se.value+X.value:X.value,mobile_code:J.value,verify_token:ee.value});H.setToken(e.token),H.getUserInfo(),V({title:G("登录成功"),duration:1e3});const a=d("URL");setTimeout((()=>{a?R({url:a,success:()=>{w("URL")}}):r({url:"/pages/index/index"})}),800)}catch(e){1002==e.errcode&&le.value?le.value.show():e.errcode>0&&(V({title:e.message,duration:1500,icon:"none"}),J.value="")}finally{ae.value=!1}},re=e=>{ee.value=e.verifyToken,de()},pe=o("password"),_e=()=>{pe.value="password"===pe.value?"text":"password"},ve=e=>{Q.value=e.detail.value},me=e=>{Y.value=e.detail.value},fe=()=>{C({url:"/pages/login/mallAgreement"})};i((e=>{e&&(e.type&&(W.value=e.type),e.url&&c("URL",e.url))})),n((()=>{(d("token")||H.token)&&r({url:"/pages/index/index"})}));const xe=()=>{C({url:"/pages/reset/index"})};return(e,a)=>{const l=S,s=p(_("tig-mobile-areacode"),$),t=U,o=p(_("tig-button"),D),u=p(_("tig-checkbox"),L),i=A,c=O,n=p(_("tig-layout"),N);return v(),m(l,null,{default:f((()=>[x(n,null,{default:f((()=>[x(l,{class:"login-box"},{default:f((()=>[x(B,{parameter:K},null,8,["parameter"]),x(l,{class:"wechat-login-warp"},{default:f((()=>[x(l,{class:"plr-40"},{default:f((()=>[x(l,{class:"h1_tit"},{default:f((()=>[h(k(e.$t("mobile"===W.value?"手机登录":"账号登录")),1)])),_:1}),x(l,{class:"form-box"},{default:f((()=>[x(l,{class:"form"},{default:f((()=>["mobile"===W.value?(v(),g(y,{key:0},[x(l,{class:"item"},{default:f((()=>[x(l,{class:"text mobileareacode-box"},{default:f((()=>[b(F).is_open_mobile_area_code?(v(),m(s,{key:0,modelValue:se.value,"onUpdate:modelValue":a[0]||(a[0]=e=>se.value=e)},null,8,["modelValue"])):E("",!0),x(t,{type:"text",onInput:oe,value:X.value,placeholder:e.$t("请输入手机号"),"placeholder-class":"placeholder",class:"mobile-text"},null,8,["value","placeholder"])])),_:1})])),_:1}),x(l,{class:"item mobile_code_text"},{default:f((()=>[x(l,{style:{width:"68%","margin-right":"10rpx"}},{default:f((()=>[x(t,{onInput:ue,type:"text",placeholder:e.$t("手机短信验证码"),"placeholder-class":"placeholder",value:J.value,name:"mobile_code",class:"text"},null,8,["placeholder","value"])])),_:1}),x(q,{style:{height:"65rpx"},mobile:b(F).is_open_mobile_area_code?se.value+X.value:X.value,isChecked:Z.value,"onUpdate:isChecked":a[1]||(a[1]=e=>Z.value=e),"verify-token-data":ee.value,"onUpdate:verifyTokenData":a[2]||(a[2]=e=>ee.value=e),requestApi:b(P),onMobileErrorCallback:ie},null,8,["mobile","isChecked","verify-token-data","requestApi"])])),_:1})],64)):E("",!0),"password"===W.value?(v(),g(y,{key:1},[x(l,{class:"item"},{default:f((()=>[x(t,{type:"text",onInput:ve,placeholder:e.$t("用户名/手机号"),"placeholder-class":"placeholder",class:"text username-text",value:Q.value},null,8,["placeholder","value"])])),_:1}),x(l,{class:"item"},{default:f((()=>[x(t,{type:pe.value,onInput:me,placeholder:e.$t("请输入密码"),"placeholder-class":"placeholder",class:"text password-text",value:Y.value},null,8,["type","placeholder","value"]),x(l,{onClick:_e,class:I("password_show_hide iconfont "+("text"==pe.value?"icon-xianshi":"icon-yincang"))},null,8,["class"])])),_:1})],64)):E("",!0),x(l,{class:"btn2-css3"},{default:f((()=>[x(o,{loadingText:e.$t("登录中"),loading:ae.value,onClick:ce,disabled:te.value},{default:f((()=>[h(k(e.$t("确 认")),1)])),_:1},8,["loadingText","loading","disabled"])])),_:1}),x(l,{class:I(["desc-box",{flex:"password"===W.value}])},{default:f((()=>[x(l,{class:"rule-text",onClick:a[4]||(a[4]=e=>Z.value=!Z.value)},{default:f((()=>[x(u,{checked:Z.value,"onUpdate:checked":a[3]||(a[3]=e=>Z.value=e)},null,8,["checked"]),x(l,{class:"rule-xieyi"},{default:f((()=>[x(i,null,{default:f((()=>[h(k(e.$t("登录即为同意")),1)])),_:1}),x(i,{class:"special-color",onClick:T(fe,["stop"])},{default:f((()=>[h(k(e.$t("《商城用户服务协议》")),1)])),_:1})])),_:1})])),_:1}),"password"===W.value?(v(),m(l,{key:0,class:"",onClick:xe},{default:f((()=>[h(k(e.$t("忘记密码")),1)])),_:1})):E("",!0)])),_:1},8,["class"]),x(l,{class:"register"},{default:f((()=>[h(k(e.$t("没有账号"))+"？",1),x(c,{"open-type":"redirect",url:"/pages/register/index",class:"special-color"},{default:f((()=>[h(k(e.$t("立即注册")),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),x(l,{class:"btns-box"},{default:f((()=>[x(l,{class:"quick-login"},{default:f((()=>[x(l,{class:"login-dtit"},{default:f((()=>[x(i,{class:"tit"},{default:f((()=>[h(k(e.$t("其他登录方式")),1)])),_:1}),x(i,{class:"line1 line"}),x(i,{class:"line2 line"})])),_:1}),x(l,{class:"quick-type-box"},{default:f((()=>["password"===W.value?(v(),m(l,{key:0,class:"quick-type",onClick:ne},{default:f((()=>[x(l,{class:"go-link icon-mobile"}),x(l,{class:"text"},{default:f((()=>[h(k(e.$t("手机号登录")),1)])),_:1})])),_:1})):E("",!0),"mobile"===W.value?(v(),m(l,{key:1,class:"quick-type",onClick:ne},{default:f((()=>[x(l,{class:"go-link icon-userlogin"}),x(l,{class:"text"},{default:f((()=>[h(k(e.$t("账号登入")),1)])),_:1})])),_:1})):E("",!0)])),_:1})])),_:1})])),_:1})])),_:1}),x(M,{ref_key:"verify",ref:le,mode:"pop",captchaType:"blockPuzzle",imgSize:{width:"310px",height:"155px"},onOkCallback:re},null,512)])),_:1})])),_:1})}}}),[["__scopeId","data-v-ab92797a"]]);export{G as default};
