import{e,G as a,Q as l,r as o,l as r,af as t,g as s,c as n,w as i,i as d,v as u,z as m,ap as c,o as p,a as f,b as g,t as b,N as _,ao as h,aq as V,_ as v}from"./index-BKXBH4vI.js";import{_ as y}from"./uni-easyinput.D0KhEVqd.js";import{_ as $,a as j}from"./uni-forms.lNaSstdl.js";import{a as w,_ as C}from"./tig-layout.DMoUsUKf.js";import{_ as U}from"./tig-fixed-placeholder.BHdfEiP8.js";import{n as q}from"./index.xrDesKlL.js";import{s as N}from"./selectRegion.DxCxx1Pt.js";import{a as x,b as B,u as k}from"./address.BvACR2GO.js";import"./uni-icons.C94_g2wt.js";const R=v(e({__name:"editRegion",setup(e){const{t:v}=a(),R=l({navbar:"1",return:"1",title:"添加地址"}),I=o(null),M=l({consignee:"",region_ids:[],address:"",mobile:"",telephone:"",email:"",regionNames:"",is_default:0}),F=o(!1),D={consignee:{rules:[{required:!0,errorMessage:v("请您填写收货人姓名")}]},regionNames:{rules:[{required:!0,errorMessage:v("请选择所在地区")},{validateFunction:function(e,a,l,o){return M.region_ids.length<1&&o(v("请选择所在地区")),!0}}]},address:{rules:[{required:!0,errorMessage:v("请您填写详细收货地址")}]},mobile:{rules:[{required:!0,errorMessage:v("请您填写收货人手机号码")},{validateFunction:function(e,a,l,o){return/^(?:(?:\+|00)86)?1[3-9]\d{9}$/.test(a)||o(v("请输入正确的手机号码")),!0}}]}};r((()=>{t((()=>{O.value.setRules(D)}))})),s((e=>{e&&e.id&&(R.title="编辑地址",I.value=e.id,T())}));const T=async()=>{try{const e=await x({id:I.value}),{region_names:a}=e.item;Object.assign(M,e.item),M.regionNames=a.join(" "),F.value=1===M.is_default}catch(e){}},z=e=>{M.regionNames=e.join(" ")},E=o(!1),G=()=>{E.value=!0},O=o(),Q=e=>{O.value.validate().then((()=>{M.is_default=F.value?1:0,I.value?Z():S()})).catch((e=>{}))},S=async()=>{try{const e=await B(M);e.message&&_({title:e.message,icon:"none",duration:1e3}),setTimeout((()=>{h({success:function(e){V("refreshData")}})}),1e3)}catch(e){_({title:e.message,icon:"none",duration:1e3})}},Z=async()=>{try{const e=await k({id:I.value,...M});e.message&&_({title:e.message,icon:"none",duration:1e3}),setTimeout((()=>{h({success:function(e){V("refreshData")}})}),1e3)}catch(e){_({title:e.message,icon:"none",duration:1e3})}};return(e,a)=>{const l=u(m("uni-easyinput"),y),o=u(m("uni-forms-item"),$),r=u(m("u-switch"),c),t=d,s=u(m("uni-forms"),j),_=u(m("tig-button"),w),h=u(m("tig-fixed-placeholder"),U),V=u(m("tig-layout"),C);return p(),n(t,null,{default:i((()=>[f(V,null,{default:i((()=>[f(q,{parameter:R},null,8,["parameter"]),f(t,{class:"address-edit-main"},{default:i((()=>[f(t,{class:"address-edit-content"},{default:i((()=>[f(s,{ref_key:"formRef",ref:O,modelValue:M,"label-width":"165rpx"},{default:i((()=>[f(o,{label:e.$t("收货人："),name:"consignee",required:""},{default:i((()=>[f(l,{primaryColor:"rgb(192, 196, 204)",inputBorder:!1,modelValue:M.consignee,"onUpdate:modelValue":a[0]||(a[0]=e=>M.consignee=e),placeholder:e.$t("请输入姓名")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),f(o,{label:e.$t("所在地区："),name:"regionNames",required:""},{default:i((()=>[f(l,{onIconClick:G,onFocus:G,style:{"background-color":"#fff"},suffixIcon:"right",primaryColor:"rgb(192, 196, 204)",inputBorder:!1,modelValue:M.regionNames,"onUpdate:modelValue":a[1]||(a[1]=e=>M.regionNames=e),placeholder:e.$t("点击选择所在地区")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),f(o,{label:e.$t("详细地址："),name:"address",required:""},{default:i((()=>[f(l,{primaryColor:"rgb(192, 196, 204)",inputBorder:!1,modelValue:M.address,"onUpdate:modelValue":a[2]||(a[2]=e=>M.address=e),placeholder:e.$t("请您填写详细收货地址")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),f(o,{label:e.$t("手机号码："),name:"mobile",required:""},{default:i((()=>[f(l,{primaryColor:"rgb(192, 196, 204)",inputBorder:!1,modelValue:M.mobile,"onUpdate:modelValue":a[3]||(a[3]=e=>M.mobile=e),placeholder:e.$t("请输入手机号码")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),f(o,{label:e.$t("固定电话："),name:"telephone"},{default:i((()=>[f(l,{primaryColor:"rgb(192, 196, 204)",inputBorder:!1,modelValue:M.telephone,"onUpdate:modelValue":a[4]||(a[4]=e=>M.telephone=e),placeholder:e.$t("请输入固定电话")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),f(o,{label:e.$t("邮箱地址："),name:"email"},{default:i((()=>[f(l,{primaryColor:"rgb(192, 196, 204)",inputBorder:!1,modelValue:M.email,"onUpdate:modelValue":a[5]||(a[5]=e=>M.email=e),placeholder:e.$t("请输入邮箱地址")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),f(o,{label:e.$t("默认地址"),name:"email"},{default:i((()=>[f(t,{class:"switch"},{default:i((()=>[f(r,{modelValue:F.value,"onUpdate:modelValue":a[6]||(a[6]=e=>F.value=e),activeColor:"var(--general)"},null,8,["modelValue"])])),_:1})])),_:1},8,["label"])])),_:1},8,["modelValue"])])),_:1})])),_:1}),f(h,{backgroundColor:"#fff"},{default:i((()=>[f(t,{class:"btn-box"},{default:i((()=>[f(_,{onClick:Q},{default:i((()=>[g(b(e.$t("提交")),1)])),_:1})])),_:1})])),_:1})])),_:1}),f(N,{show:E.value,"onUpdate:show":a[7]||(a[7]=e=>E.value=e),modelValue:M.region_ids,"onUpdate:modelValue":a[8]||(a[8]=e=>M.region_ids=e),onSendRegionNames:z},null,8,["show","modelValue"])])),_:1})}}}),[["__scopeId","data-v-bee44444"]]);export{R as default};
