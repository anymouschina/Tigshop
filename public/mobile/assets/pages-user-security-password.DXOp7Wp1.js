import{d as e,G as a,r as l,R as t,Q as s,o,k as r,l as i,m as u,n,w as d,q as m,t as p,v as c,s as f,M as v,af as _,C as b}from"./index-Ce4FtYLL.js";import{_ as w}from"./uni-easyinput.Do0WG9vl.js";import{_ as g,a as $}from"./uni-forms.DtUDd6v6.js";import{a as h,_ as y}from"./tig-layout.nM03J4I_.js";import{n as C}from"./index.v2UirNFN.js";import{V as j}from"./verificationCode.vdLVoKDN.js";import{c as k,d as x}from"./security.DnVy-TMb.js";import{_ as E}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./uni-icons.yuSuVTUg.js";import"./u-loading-icon.CaEeBur7.js";import"./u-icon.BDQrrWMI.js";const q=E(e({__name:"password",setup(e){const{t:E}=a(),q={navbar:"1",return:"1",title:"账户安全",color:!1},A=e=>{V.value.mobileCode=e},I=e=>{V.value.password=e},P=e=>{V.value.confirmPassword=e},V=l({mobile:"",mobileCode:"",password:"",confirmPassword:""}),B=t((()=>!(V.value.mobile&&V.value.mobileCode&&V.value.password&&V.value.confirmPassword))),U=s({password:[{validator:(e,a,l)=>a?a.length>20||a.length<6?l(new Error(E("密码应为6-20位字符"))):/\s/.test(a)?l(new Error(E("密码中不允许有空格"))):/^\d+$/.test(a)?l(new Error(E("密码不能全为数字"))):/^(?=.*[\d\W]).+$/.test(a)?/^(?=.*[a-zA-Z0-9]).+$/.test(a)?/^(?!([a-zA-Z0-9])\1*$).+$/.test(a)?void l():l(new Error(E("密码不能全为相同字符或数字"))):l(new Error(E("密码不能全为符号"))):l(new Error(E("密码不能全为字母"))):l(new Error(E("密码不能为空"))),trigger:"blur",required:!0}],confirm_password:[{validator:(e,a,l)=>a?a!=V.value.password?l(new Error(E("两次密码不一致"))):void l():l(new Error(E("请再次输入密码"))),trigger:"change",required:!0}]}),z=l(""),M=l(!0);o((e=>{V.value.mobile=e.mobile}));const R=e=>{v({title:e,duration:1500,icon:"none"})},T=l();return(e,a)=>{const l=b,t=r(i("uni-easyinput"),w),s=r(i("uni-forms-item"),g),o=r(i("uni-forms"),$),E=r(i("tig-button"),h),W=r(i("tig-layout"),y);return u(),n(l,null,{default:d((()=>[m(W,null,{default:d((()=>[m(C,{parameter:q}),m(l,{class:"profile-edit-main"},{default:d((()=>[m(l,{class:"profile-edit-content"},{default:d((()=>[m(l,{class:"item"},{default:d((()=>[m(l,{class:"title"},{default:d((()=>[m(l,null,{default:d((()=>[p(c(e.$t("请输入")),1)])),_:1}),m(l,{class:"info"},{default:d((()=>[p(c(V.value.mobile.replace(/(\d{2})\d*(\d{4})$/,"$1*****$2")),1)])),_:1}),m(l,null,{default:d((()=>[p(c(e.$t("收到的短信验证码")),1)])),_:1})])),_:1})])),_:1}),m(o,{"label-width":80,ref_key:"formRef",ref:T,modelValue:V.value,rules:U},{default:d((()=>[m(s,{label:e.$t("验证码"),name:"mobileCode",required:""},{default:d((()=>[m(l,{class:"flex align-center"},{default:d((()=>[m(l,{class:"item-one input"},{default:d((()=>[m(t,{inputBorder:!1,value:V.value.mobileCode,class:"uni-input item-input",focus:"",placeholder:e.$t("手机短信验证码"),primaryColor:"rgb(192, 196, 204)",onInput:A},null,8,["value","placeholder"])])),_:1}),m(j,{style:{height:"65rpx"},isChecked:M.value,"onUpdate:isChecked":a[0]||(a[0]=e=>M.value=e),mobile:V.value.mobile,"onUpdate:mobile":a[1]||(a[1]=e=>V.value.mobile=e),"verify-token-data":z.value,"onUpdate:verifyTokenData":a[2]||(a[2]=e=>z.value=e),requestApi:f(x),onMobileErrorCallback:R},null,8,["isChecked","mobile","verify-token-data","requestApi"])])),_:1})])),_:1},8,["label"]),m(s,{label:e.$t("新密码"),name:"password",required:""},{default:d((()=>[m(l,{class:"input"},{default:d((()=>[m(t,{inputBorder:!1,value:V.value.password,class:"uni-input item-input",placeholder:e.$t("请输入新密码"),primaryColor:"rgb(192, 196, 204)",onInput:I},null,8,["value","placeholder"])])),_:1})])),_:1},8,["label"]),m(s,{label:e.$t("确认密码"),name:"confirm_password",required:""},{default:d((()=>[m(l,{class:"input"},{default:d((()=>[m(t,{inputBorder:!1,value:V.value.confirmPassword,class:"uni-input item-input",placeholder:e.$t("请再次输入新密码"),primaryColor:"rgb(192, 196, 204)",onInput:P},null,8,["value","placeholder"])])),_:1})])),_:1},8,["label"])])),_:1},8,["modelValue","rules"]),m(l,{class:"item"},{default:d((()=>[m(E,{disabled:B.value,class:"next",onClick:a[3]||(a[3]=e=>(async()=>{T.value.validate().then((async()=>{try{let e={password:V.value.password,code:V.value.mobileCode};const a=await k({...e});v({title:a.message,icon:"none"}),setTimeout((()=>{_({url:"/pages/user/profile/index"})}),1e3)}catch(e){e.message&&v({title:e.message,icon:"none"})}})).catch((e=>{console.log("表单错误信息：",e)}))})())},{default:d((()=>[p(c(e.$t("提交")),1)])),_:1},8,["disabled"])])),_:1})])),_:1}),m(l,{class:"profile-edit-content"},{default:d((()=>[m(l,{class:"btn-item"},{default:d((()=>[m(l,{class:"title"},{default:d((()=>[m(l,{class:"big-title"},{default:d((()=>[p(c(e.$t("为什么要进行身份验证"))+"？",1)])),_:1})])),_:1}),m(l,{class:"info"},{default:d((()=>[p("1. "+c(e.$t("为保障您的账户信息安全，在变更账户中的重要信息时需要进行身份验证，感谢您的理解和支持"))+"。",1)])),_:1}),m(l,{class:"info"},{default:d((()=>[p("2. "+c(e.$t("验证身份遇到问题？您可以通知我们的客服，我们将尽快联系您"))+"。",1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-b8a41589"]]);export{q as default};
