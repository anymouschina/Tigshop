import{e as a,G as l,Q as e,r as t,g as s,k as u,E as c,a as o,c as n,A as i,w as r,F as d,N as f,a9 as p,aa as _,i as m,v,z as y,o as g,C as k,B as b,a7 as x,b as h,t as j,K as w,d as z,D as A,_ as D}from"./index-BKXBH4vI.js";import{_ as G}from"./format-price.0qAAshfo.js";import{n as B}from"./index.xrDesKlL.js";import{h as I,c as Q}from"./product.BhwveQst.js";const C=D(a({__name:"consult",setup(a){const{t:D}=l(),C=e({navbar:"1",return:"1",title:"商品咨询",class:"pageGoods"}),E=t({product_id:0,product_stock:0}),F=t(!1),K=t(1),L=t(10),M=t(0),N=t(!1),$=t([]),q=t(0),H=async()=>{K.value>1&&(N.value=!0),p({title:D("加载中")});try{const a=await Q({product_id:J.value,page:K.value,size:L.value});$.value=[...$.value,...a.filter_result],q.value=a.total}catch(a){f({title:a.message,icon:"none"})}finally{N.value=!1,_()}},J=t("");return s((a=>{if(a){const{id:l}=a;l&&(J.value=l,(async a=>{try{let l=await I(a);E.value=l.item}catch(l){f({title:l.message,icon:"none"})}})(l),H())}})),u((()=>{K.value<Math.ceil(M.value/L.value)&&(K.value++,H())})),(a,l)=>{const e=k,t=m,s=v(y("format-price"),G),u=z;return g(),c(d,null,[o(B,{parameter:C},null,8,["parameter"]),o(t,{class:"product-info flex"},{default:r((()=>[o(t,{class:"product-info-img"},{default:r((()=>[o(e,{"lazy-load":"",class:"product-img",src:b(x)(E.value.pic_thumb||"")},null,8,["src"])])),_:1}),o(t,null,{default:r((()=>[o(t,{class:"product-info-title line2"},{default:r((()=>[h(j(E.value.product_name),1)])),_:1}),o(t,{class:"product-info-price"},{default:r((()=>[o(s,{isBottom:!1,priceData:E.value.market_price},null,8,["priceData"])])),_:1})])),_:1})])),_:1}),o(t,{class:"product-consult-card"},{default:r((()=>[(g(!0),c(d,null,w($.value,((a,l)=>(g(),n(t,{class:"consult-item",key:l},{default:r((()=>[o(t,{class:"consult-item-tit flex justify-between"},{default:r((()=>[o(t,{class:"time"},{default:r((()=>[h(j(a.add_time),1)])),_:2},1024),o(t,{class:"name"},{default:r((()=>[h(j(a.username),1)])),_:2},1024)])),_:2},1024),o(t,{class:"consult-con line1"},{default:r((()=>[o(u,null,{default:r((()=>[h("Q")])),_:1}),h(" "+j(a.content),1)])),_:2},1024),a.reply?(g(),n(t,{key:0,class:"consult-con line1 reply"},{default:r((()=>[o(u,null,{default:r((()=>[h("A")])),_:1}),h(" "+j(a.reply.content),1)])),_:2},1024)):i("",!0)])),_:2},1024)))),128))])),_:1}),K.value>1?(g(),n(t,{key:0,class:"loading-box"},{default:r((()=>[F.value?(g(),n(t,{key:0,class:"bottomLoading"},{default:r((()=>[o(e,{"lazy-load":"",class:"loading",src:b(A)("common/loading.gif")},null,8,["src"])])),_:1})):i("",!0)])),_:1})):i("",!0),o(t,{class:"loading-box"},{default:r((()=>[$.value.length<1?(g(),n(t,{key:0},{default:r((()=>[h(j(a.$t("暂无咨询")),1)])),_:1})):i("",!0)])),_:1})],64)}}}),[["__scopeId","data-v-e91cae0a"]]);export{C as default};
