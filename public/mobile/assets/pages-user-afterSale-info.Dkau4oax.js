import{d as e,G as a,o as t,f as l,ah as s,b as u,ai as i,r,M as f,k as c,l as n,m as o,n as d,w as _,q as m,y as p,t as v,v as g,x as b,F as y,J as h,a9 as $,af as k,L as x,C as S}from"./index-Do_Cb7fn.js";import{_ as j}from"./uni-steps.Do9oSIoh.js";import{_ as D}from"./uni-icons.DK0ZiICA.js";import{_ as w}from"./tig-image.D5KdQk-t.js";import{_ as C}from"./format-price.D2lH_-yv.js";import{a as T,_ as z}from"./tig-layout.BV0ZvCt0.js";import{_ as B}from"./save-bottom-box.BM5fwIJO.js";import{b as I,d as N}from"./afterSale.BxfvHbgK.js";import{_ as q}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./u-loading-icon.rQrrZF_r.js";import"./u-icon.CBDMG2rO.js";const U=q(e({__name:"info",setup(e){const{t:q}=a();t((e=>{e&&e.id&&(U.value=Number(e.id),F())})),l((()=>{s("refreshInfo",(e=>{U.value=e,F()}))})),u((()=>{i("refreshInfo")}));const U=r(),W=r({}),E=r(0),F=async()=>{try{const e=await I(U.value);W.value=e.item,W.value.aftersales_items.forEach((e=>{E.value+=e.number}))}catch(e){console.error(e),f({title:e.message,icon:"none"})}},G=()=>{$({title:q("提示"),content:q("确认要撤销申请吗？"),success:async e=>{if(e.confirm)try{await N({aftersale_id:W.value.aftersale_id});f({title:q("撤销成功")}),k({url:"/pages/user/afterSale/list"})}catch(a){console.error(a)}}})},H=async()=>{try{1===W.value.aftersales_items.length?k({url:`/pages/user/afterSale/edit?aftersale_id=${W.value.aftersale_id}&item_id=${W.value.aftersales_items[0].order_item_id}`}):k({url:`/pages/user/afterSale/edit?aftersale_id=${W.value.aftersale_id}`})}catch(e){console.error(e)}},J=()=>{x({url:"/pages/user/afterSale/negotiate?id="+W.value.aftersale_id})},L=()=>{x({url:"/pages/user/afterSale/shipments?id="+W.value.aftersale_id})};return(e,a)=>{const t=c(n("uni-steps"),j),l=S,s=c(n("uni-icons"),D),u=c(n("tig-image"),w),i=c(n("format-price"),C),r=c(n("tig-button"),T),f=c(n("save-bottom-box"),B),$=c(n("tig-layout"),z);return o(),d(l,{class:"after-sale-info"},{default:_((()=>[m($,{specialNum:55,needSaveTop:!0},{default:_((()=>[Object.keys(W.value).length?(o(),p(y,{key:0},[m(l,{class:"after-sal-info-steps"},{default:_((()=>[m(t,{"active-color":"var(--general)",options:W.value.step_status.steps,active:W.value.step_status.current},null,8,["options","active"])])),_:1}),3===W.value.status?(o(),d(l,{key:0,class:"refuse-reply"},{default:_((()=>[m(l,{class:"refuse-reply-title"},{default:_((()=>[v(g(e.$t("拒绝原因"))+": ",1)])),_:1}),m(l,{class:"refuse-reply-content line1"},{default:_((()=>[v(g(W.value.reply),1)])),_:1})])),_:1})):b("",!0),m(l,{class:"negotiate",onClick:J},{default:_((()=>[m(l,{class:"negotiate-text"},{default:_((()=>[v(g(e.$t("查看协商记录")),1)])),_:1}),m(l,{class:"negotiate-icon"},{default:_((()=>[m(s,{type:"right",size:"20",color:"#999"})])),_:1})])),_:1}),4===W.value.status?(o(),d(l,{key:1,class:"negotiate",onClick:L},{default:_((()=>[m(l,{class:"negotiate-text"},{default:_((()=>[v(g(e.$t("去发货")),1)])),_:1}),m(l,{class:"negotiate-icon"},{default:_((()=>[m(s,{type:"right",size:"20",color:"#999"})])),_:1})])),_:1})):b("",!0),m(l,{class:"info-content"},{default:_((()=>[m(l,{class:"info-content-title"},{default:_((()=>[v(g(e.$t("售后信息")),1)])),_:1}),m(l,{class:"info-content-product"},{default:_((()=>[(o(!0),p(y,null,h(W.value.aftersales_items,(e=>(o(),d(l,{class:"info-content-product-item",onClick:a=>{return t=e.product_id,void x({url:`/pages/productDetail/index?id=${t}`});var t},key:e.aftersales_item_id},{default:_((()=>[m(l,{class:"product-item-left"},{default:_((()=>[m(u,{src:e.pic_thumb,"onUpdate:src":a=>e.pic_thumb=a},null,8,["src","onUpdate:src"])])),_:2},1024),m(l,{class:"product-item-right"},{default:_((()=>[m(l,{class:"product-item-name line2"},{default:_((()=>[v(g(e.product_name),1)])),_:2},1024),m(l,{class:"right-price"},{default:_((()=>[m(i,{showText:!1,decimalsStyle:{fontSize:"23rpx",fontWeight:"bold"},currencyStyle:{fontSize:"21rpx",fontWeight:"bold"},class:"right-price-pricenum",priceData:e.price},null,8,["priceData"]),m(l,{class:"right-price-quantity"},{default:_((()=>[v("x "+g(e.number),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1}),m(l,{class:"refund-info"},{default:_((()=>[Number(W.value.refund_amount)>0?(o(),d(l,{key:0,class:"refund-info-item"},{default:_((()=>[m(l,{class:"label"},{default:_((()=>[v(g(e.$t("退款金额"))+"：",1)])),_:1}),m(l,{class:"value price"},{default:_((()=>[m(i,{showText:!1,isBottom:!1,priceData:W.value.refund_amount},null,8,["priceData"])])),_:1})])),_:1})):b("",!0),m(l,{class:"refund-info-item"},{default:_((()=>[m(l,{class:"label"},{default:_((()=>[v(g(e.$t("售后方式"))+"：",1)])),_:1}),m(l,{class:"value"},{default:_((()=>[v(g(W.value.aftersales_type_name),1)])),_:1})])),_:1}),m(l,{class:"refund-info-item"},{default:_((()=>[m(l,{class:"label"},{default:_((()=>[v(g(e.$t("退款原因"))+"：",1)])),_:1}),m(l,{class:"value"},{default:_((()=>[v(g(W.value.aftersale_reason),1)])),_:1})])),_:1})])),_:1}),m(l,{class:"after-sale"},{default:_((()=>[m(l,{class:"after-sale-item"},{default:_((()=>[m(l,{class:"label"},{default:_((()=>[v(g(e.$t("售后编号"))+"：",1)])),_:1}),m(l,{class:"value"},{default:_((()=>[v(g(W.value.aftersales_sn),1)])),_:1})])),_:1}),m(l,{class:"after-sale-item"},{default:_((()=>[m(l,{class:"label"},{default:_((()=>[v(g(e.$t("申请时间"))+"：",1)])),_:1}),m(l,{class:"value"},{default:_((()=>[v(g(W.value.add_time),1)])),_:1})])),_:1}),m(l,{class:"after-sale-item"},{default:_((()=>[m(l,{class:"label"},{default:_((()=>[v(g(e.$t("退货数量"))+"：",1)])),_:1}),m(l,{class:"value"},{default:_((()=>[v(g(E.value),1)])),_:1})])),_:1})])),_:1})])),_:1}),W.value.logistics_name&&W.value.tracking_no?(o(),d(l,{key:2,class:"info-content"},{default:_((()=>[m(l,{class:"info-content-title"},{default:_((()=>[v(g(e.$t("退货信息")),1)])),_:1}),m(l,{class:"after-sale"},{default:_((()=>[m(l,{class:"after-sale-item"},{default:_((()=>[m(l,{class:"label"},{default:_((()=>[v(g(e.$t("快递公司"))+"：",1)])),_:1}),m(l,{class:"value"},{default:_((()=>[v(g(W.value.logistics_name),1)])),_:1})])),_:1}),m(l,{class:"after-sale-item"},{default:_((()=>[m(l,{class:"label"},{default:_((()=>[v(g(e.$t("快递单号"))+"：",1)])),_:1}),m(l,{class:"value"},{default:_((()=>[v(g(W.value.tracking_no),1)])),_:1})])),_:1})])),_:1})])),_:1})):b("",!0),W.value.refund?(o(),d(l,{key:3,class:"info-content"},{default:_((()=>[m(l,{class:"info-content-title"},{default:_((()=>[v(g(e.$t("退款进度")),1)])),_:1}),m(l,{class:"after-sale"},{default:_((()=>[W.value.refund.online_balance>0?(o(),d(l,{key:0,class:"after-sale-item"},{default:_((()=>[m(l,{class:"label"},{default:_((()=>[v(g(e.$t("线上退款"))+"：",1)])),_:1}),m(l,{class:"value"},{default:_((()=>[m(i,{showText:!1,isBottom:!1,priceData:W.value.refund.online_balance},null,8,["priceData"])])),_:1}),m(l,{class:"after-sale-status"},{default:_((()=>[v(g(2===W.value.refund.is_online?e.$t("退款成功"):e.$t("退款中")),1)])),_:1})])),_:1})):b("",!0),W.value.refund.offline_balance>0?(o(),d(l,{key:1,class:"after-sale-item"},{default:_((()=>[m(l,{class:"label"},{default:_((()=>[v(g(e.$t("线下退款"))+"：",1)])),_:1}),m(l,{class:"value"},{default:_((()=>[m(i,{showText:!1,isBottom:!1,priceData:W.value.refund.offline_balance},null,8,["priceData"])])),_:1}),m(l,{class:"after-sale-status"},{default:_((()=>[v(g(2===W.value.refund.is_online?e.$t("退款成功"):e.$t("退款中")),1)])),_:1})])),_:1})):b("",!0),W.value.refund.refund_balance>0?(o(),d(l,{key:2,class:"after-sale-item"},{default:_((()=>[m(l,{class:"label"},{default:_((()=>[v(g(e.$t("余额退款"))+"：",1)])),_:1}),m(l,{class:"value"},{default:_((()=>[m(i,{showText:!1,isBottom:!1,priceData:W.value.refund.refund_balance},null,8,["priceData"])])),_:1}),m(l,{class:"after-sale-status"},{default:_((()=>[v(g(2===W.value.refund.is_online?e.$t("退款成功"):e.$t("退款中")),1)])),_:1})])),_:1})):b("",!0)])),_:1})])),_:1})):b("",!0),W.value.can_cancel?(o(),d(f,{key:4,height:"55",backgroundColor:"#fff"},{default:_((()=>[m(l,{class:"after-sale-btn"},{default:_((()=>[m(l,{class:"after-sale-btn-box"},{default:_((()=>[m(r,{class:"btn",customStyle:{height:"55rpx"},plain:!0,onClick:G},{default:_((()=>[v(g(e.$t("撤销申请")),1)])),_:1}),m(r,{plain:!0,customStyle:{height:"55rpx"},onClick:H},{default:_((()=>[v(g(e.$t("修改申请")),1)])),_:1})])),_:1})])),_:1})])),_:1})):b("",!0)],64)):b("",!0)])),_:1})])),_:1})}}}),[["__scopeId","data-v-4a695440"]]);export{U as default};
