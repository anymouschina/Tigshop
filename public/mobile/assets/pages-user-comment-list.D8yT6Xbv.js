import{d as e,G as a,Q as t,r as l,o as s,e as c,b as u,b4 as o,k as n,l as r,m as i,n as d,w as m,q as p,y as _,J as f,F as v,s as g,t as y,v as b,x,M as h,a6 as k,a7 as w,C as j,D as $,V as z,a5 as C,E as U,aZ as S,L as D,B as T,a0 as V}from"./index-Ce4FtYLL.js";import{_ as q}from"./uni-badge.DwjSh_3D.js";import{_ as F}from"./tig-image.bUT1hZK2.js";import{_ as M}from"./format-price.C2WNeN1M.js";import{a as B,_ as H}from"./tig-layout.nM03J4I_.js";import{_ as L}from"./uni-rate.BdAT1cYl.js";import{_ as N}from"./loading-box.PIJN5CrK.js";import{n as E}from"./index.v2UirNFN.js";import{b as G}from"./order.CCBaGQMp.js";import{g as I,a as J,b as Q}from"./comment.BL4BlWvq.js";import{_ as Z}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./u-loading-icon.CaEeBur7.js";import"./u-icon.BDQrrWMI.js";import"./uni-icons.yuSuVTUg.js";const A=Z(e({__name:"list",setup(e){const{t:Z}=a(),A={navbar:"1",return:"1",title:"订单评价",showHome:!0,color:!1},K=t([{type:0,value:Z("待评价"),num:0},{type:1,value:Z("待晒单"),num:0},{type:2,value:Z("已评价"),num:0}]),O=l(0),P=t({page:1,size:10}),R=l(!1),W=l([]),X=l(0),Y=async()=>{P.page>1?R.value=!0:k({title:Z("加载中")});try{let e=[];0==O.value&&(e=await G({...P,comment_status:0})),1==O.value&&(e=await J({...P})),2==O.value&&(e=await Q({...P})),W.value=[...W.value,...e.filter_result],X.value=e.total}catch(e){h({title:e.message,icon:"none",duration:1e3})}finally{w(),R.value=!1}};return s((e=>{e&&e.currentType&&(O.value=Number(e.currentType)),(async()=>{try{const e=await I();K[0].size=e.item.await_comment,K[1].size=e.item.show_pics,K[2].size=e.item.commented}catch(e){h({title:e.message,icon:"none",duration:1e3})}})(),Y()})),c((()=>{P.page<Math.ceil(X.value/P.size)&&(P.page++,Y())})),u((()=>{o()})),(e,a)=>{const t=T,l=n(r("uni-badge"),q),s=j,c=n(r("tig-image"),F),u=n(r("format-price"),M),o=V,h=n(r("tig-button"),B),k=n(r("uni-rate"),L),w=$,G=n(r("loading-box"),N),I=n(r("tig-layout"),H);return i(),d(I,null,{default:m((()=>[p(s,{class:"order"},{default:m((()=>[p(E,{parameter:A}),p(s,{class:"order-menu"},{default:m((()=>[(i(!0),_(v,null,f(K,(e=>(i(),d(s,{key:e.type,class:z(["order-menu-item",{active:O.value===e.type}]),onClick:a=>{return t=e.type,O.value=t,W.value=[],P.page=1,void Y();var t}},{default:m((()=>[e.num>0?(i(),d(l,{key:0,class:"badgecolor",text:e.num,absolute:"rightTop",size:"small"},{default:m((()=>[p(t,{class:"order-menu-item-text"},{default:m((()=>[y(b(e.value),1)])),_:2},1024)])),_:2},1032,["text"])):(i(),d(t,{key:1,class:"order-menu-item-text"},{default:m((()=>[y(b(e.value),1)])),_:2},1024))])),_:2},1032,["class","onClick"])))),128))])),_:1}),p(s,{class:"placeholder"}),O.value<2?(i(),d(s,{key:0,class:"order-list"},{default:m((()=>[(i(!0),_(v,null,f(W.value,(a=>(i(),d(s,{key:a.order_id,class:"order-list-item"},{default:m((()=>[p(s,{class:"order-list-item-header"},{default:m((()=>[p(t,{class:"special-text"},{default:m((()=>[y(b(e.$t("订单编号"))+"：",1),p(t,{class:"special-color"},{default:m((()=>[y(b(a.order_sn),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),p(s,{class:"order-list-item-content"},{default:m((()=>[p(s,{class:"item-content-product"},{default:m((()=>[(i(!0),_(v,null,f(a.items,(e=>(i(),d(o,{key:e.product_id,url:"/pages/productDetail/index?id="+e.product_id,"hover-class":"navigator-hover"},{default:m((()=>[p(s,{class:"item-content-product-item"},{default:m((()=>[p(s,{class:"item-content-product-img"},{default:m((()=>[p(c,{src:e.pic_thumb,"onUpdate:src":a=>e.pic_thumb=a},null,8,["src","onUpdate:src"])])),_:2},1024),p(s,{class:"item-content-product-info"},{default:m((()=>[p(s,{class:"product-item-title"},{default:m((()=>[y(b(e.product_name),1)])),_:2},1024),p(s,{class:"product-item-price"},{default:m((()=>[p(u,{showText:!1,decimalsStyle:{fontSize:"25rpx"},currencyStyle:{fontSize:"23rpx"},class:"product-item-pricenum",priceData:e.price},null,8,["priceData"]),p(s,{class:"product-item-quantity"},{default:m((()=>[y("x "+b(e.quantity),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["url"])))),128))])),_:2},1024)])),_:2},1024),p(s,{class:"order-list-item-btn"},{default:m((()=>[p(s,{class:"item-btn-box"},{default:m((()=>[p(h,{plain:!0,customStyle:{height:"55rpx"},plainMainColor:!0,onClick:e=>{return t=a.order_id,void D({url:`/pages/user/comment/info?id=${t}`});var t}},{default:m((()=>[y(b(0==O.value?e.$t("去评价"):e.$t("待晒单")),1)])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})):(i(),d(s,{key:1,class:"comment-list"},{default:m((()=>[(i(!0),_(v,null,f(W.value,(a=>(i(),d(s,{class:"comment-item flex",key:a.order_id},{default:m((()=>[p(s,{class:"comment-header"},{default:m((()=>[a.pic_thumb?(i(),d(c,{key:0,class:"head",src:a.pic_thumb,"onUpdate:src":e=>a.pic_thumb=e,mode:"aspectFill"},null,8,["src","onUpdate:src"])):x("",!0)])),_:2},1024),p(s,{class:"comment-info"},{default:m((()=>[p(s,{class:"comment-label flex align-center"},{default:m((()=>[p(s,{class:"name"},{default:m((()=>[y(b(e.$t("评价"))+":",1)])),_:1}),p(s,{class:"content flex align-center justify-between"},{default:m((()=>[p(k,{value:a.comment_rank,color:"#bfbfbf",readonly:!0,"active-color":"#ffa800",size:"18"},null,8,["value"]),p(s,{class:"time"},{default:m((()=>[y(b(a.add_time),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),p(s,{class:"comment-label flex"},{default:m((()=>[p(s,{class:"name"},{default:m((()=>[y(b(e.$t("商品名称"))+":",1)])),_:1}),p(s,{class:"content"},{default:m((()=>[p(s,{class:"product-name line1"},{default:m((()=>[y(b(a.product_name||"--"),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),p(s,{class:"comment-label flex"},{default:m((()=>[p(s,{class:"name"},{default:m((()=>[y(b(e.$t("评价标签"))+":",1)])),_:1}),p(s,{class:"content flex-wrap"},{default:m((()=>[(i(!0),_(v,null,f(a.comment_tag,(e=>(i(),d(s,{class:"product-tag"},{default:m((()=>[y(b(e),1)])),_:2},1024)))),256))])),_:2},1024)])),_:2},1024),p(s,{class:"comment-label flex"},{default:m((()=>[p(s,{class:"name"},{default:m((()=>[y(b(e.$t("评价内容"))+":",1)])),_:1}),p(s,{class:"content"},{default:m((()=>[p(s,{class:"cont"},{default:m((()=>[y(b(a.content),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),a.reply?(i(),d(s,{key:0,class:"comment-label flex"},{default:m((()=>[p(s,{class:"name"},{default:m((()=>[y(b(e.$t("客服答复"))+":",1)])),_:1}),p(s,{class:"content"},{default:m((()=>[p(t,{class:"cont"},{default:m((()=>{var e;return[y(b(null==(e=a.reply)?void 0:e.content),1)]})),_:2},1024)])),_:2},1024)])),_:2},1024)):x("",!0),p(s,{class:"comment-label flex"},{default:m((()=>[p(s,{class:"name"},{default:m((()=>[y(b(e.$t("晒单"))+":",1)])),_:1}),a.show_pics.length>0?(i(),d(s,{key:0,class:"content flex-wrap"},{default:m((()=>[(i(!0),_(v,null,f(a.show_pics,(e=>(i(),d(s,{class:"product-pic"},{default:m((()=>[p(c,{src:e.pic_thumb,"onUpdate:src":a=>e.pic_thumb=a,mode:"aspectFill",onClick:a=>{return t=g(C)(e.pic_url),void S({urls:[t]});var t}},null,8,["src","onUpdate:src","onClick"])])),_:2},1024)))),256))])),_:2},1024)):x("",!0)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})),0==W.value.length?(i(),d(s,{key:2,class:"empty-box"},{default:m((()=>[p(s,{class:"pictrue"},{default:m((()=>[p(w,{src:g(U)("common/data_empty.png")},null,8,["src"])])),_:1}),p(s,{class:"txt"},{default:m((()=>[y(b(e.$t("暂无评价")),1)])),_:1})])),_:1})):x("",!0),p(G,{modelValue:R.value,"onUpdate:modelValue":a[0]||(a[0]=e=>R.value=e),page:P.page,length:W.value.length},null,8,["modelValue","page","length"])])),_:1})])),_:1})}}}),[["__scopeId","data-v-650559ea"]]);export{A as default};
