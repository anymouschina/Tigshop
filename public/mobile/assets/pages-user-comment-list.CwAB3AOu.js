import{e,E as a,Q as t,r as l,f as s,ag as u,j as c,g as n,b4 as o,ah as r,c as d,w as i,L as m,a5 as f,a6 as p,q as _,y as g,o as v,a as y,i as k,z as b,D as h,F as x,J as $,T as w,d as j,b as C,t as D,$ as T,A as z,a7 as I,B as S,C as F,aX as N,N as P,P as q,_ as V}from"./index-BKzbZvRR.js";import{_ as A}from"./uni-badge.D9pmvW-4.js";import{_ as E}from"./tig-image.DrOwWlV9.js";import{_ as J}from"./format-price.kSnuguuz.js";import{_ as M,a as U}from"./tig-layout.BpNdXByQ.js";import{_ as B}from"./uni-rate.CHwxaVXA.js";import{_ as L}from"./loading-box.C4egri0r.js";import{b as Q}from"./order.BKDxR0lS.js";import{g as R,a as X,b as G}from"./comment.B5Ue74l_.js";import"./uni-icons.DELFdrY8.js";const H=V(e({__name:"list",setup(e){const{t:V}=a(),H=t([{type:0,value:V("待评价"),num:0},{type:1,value:V("待晒单"),num:0},{type:2,value:V("已评价"),num:0}]),K=l(0),O=t({page:1,size:10}),W=l(!1),Y=l([]),Z=l(0),ee=async()=>{O.page>1?W.value=!0:f({title:V("加载中")});try{let e=[];0==K.value&&(e=await Q({...O,commentStatus:0})),1==K.value&&(e=await X({...O})),2==K.value&&(e=await G({...O})),Y.value=[...Y.value,...e.records],Z.value=e.total}catch(e){m({title:e.message,icon:"none",duration:1e3})}finally{p(),W.value=!1}};return s((e=>{e&&e.currentType&&(K.value=Number(e.currentType)),u("commentFinished",(e=>{e&&(K.value=2,Y.value=[],O.page=1,ee())})),(async()=>{try{const e=await R();H[0].size=e.awaitComment,H[1].size=e.showPics,H[2].size=e.commented}catch(e){m({title:e.message,icon:"none",duration:1e3})}})(),ee()})),c((()=>{O.page<Math.ceil(Z.value/O.size)&&(O.page++,ee())})),n((()=>{o(),r("commentFinished")})),(e,a)=>{const t=j,l=_(g("uni-badge"),A),s=k,u=_(g("tig-image"),E),c=_(g("format-price"),J),n=T,o=_(g("tig-button"),U),r=_(g("uni-rate"),B),m=S,f=_(g("loading-box"),L),p=_(g("tig-layout"),M);return v(),d(p,{title:"订单评价"},{default:i((()=>[y(s,{class:"order"},{default:i((()=>[y(s,{class:"order-menu"},{default:i((()=>[(v(!0),h(x,null,$(H,(e=>(v(),d(s,{key:e.type,class:w(["order-menu-item",{active:K.value===e.type}]),onClick:a=>{return t=e.type,console.log("type",t),K.value=t,Y.value=[],O.page=1,void ee();var t}},{default:i((()=>[e.num>0?(v(),d(l,{key:0,class:"badgecolor",text:e.num,absolute:"rightTop",size:"small"},{default:i((()=>[y(t,{class:"order-menu-item-text"},{default:i((()=>[C(D(e.value),1)])),_:2},1024)])),_:2},1032,["text"])):(v(),d(t,{key:1,class:"order-menu-item-text"},{default:i((()=>[C(D(e.value),1)])),_:2},1024))])),_:2},1032,["class","onClick"])))),128))])),_:1}),y(s,{class:"placeholder"}),K.value<2?(v(),d(s,{key:0,class:"order-list"},{default:i((()=>[(v(!0),h(x,null,$(Y.value,(a=>(v(),d(s,{key:a.orderId,class:"order-list-item"},{default:i((()=>[y(s,{class:"order-list-item-header"},{default:i((()=>[y(t,{class:"special-text"},{default:i((()=>[C(D(e.$t("订单编号"))+"：",1),y(t,{class:"special-color"},{default:i((()=>[C(D(a.orderSn),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),y(s,{class:"order-list-item-content"},{default:i((()=>[y(s,{class:"item-content-product"},{default:i((()=>[(v(!0),h(x,null,$(a.items,(e=>(v(),d(n,{key:e.productId,url:"/pages/product/index?id="+e.productId,"hover-class":"navigator-hover"},{default:i((()=>[y(s,{class:"item-content-product-item"},{default:i((()=>[y(s,{class:"item-content-product-img"},{default:i((()=>[y(u,{src:e.picThumb},null,8,["src"])])),_:2},1024),y(s,null,{default:i((()=>[y(s,{class:"item-content-product-info"},{default:i((()=>[y(s,{class:"product-item-title"},{default:i((()=>[C(D(e.productName),1)])),_:2},1024),y(s,{class:"product-item-price"},{default:i((()=>[y(c,{showText:!1,decimalsStyle:{fontSize:"25rpx"},currencyStyle:{fontSize:"23rpx"},class:"product-item-pricenum",priceData:e.price},null,8,["priceData"]),y(s,{class:"product-item-quantity"},{default:i((()=>[C("x "+D(e.quantity),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),y(s,{class:w(["sku-card",{nodata:!e.skuData||0===e.skuData.length}])},{default:i((()=>[e.skuData&&e.skuData.length>0?(v(!0),h(x,{key:0},$(e.skuData,((e,a)=>(v(),d(s,{key:a,class:"sku-item line1"},{default:i((()=>[C(D(e.value),1)])),_:2},1024)))),128)):b("",!0)])),_:2},1032,["class"])])),_:2},1024)])),_:2},1024)])),_:2},1032,["url"])))),128))])),_:2},1024)])),_:2},1024),y(s,{class:"order-list-item-btn"},{default:i((()=>[y(s,{class:"item-btn-box"},{default:i((()=>[y(o,{plain:!0,customStyle:{height:"55rpx"},plainMainColor:!0,onClick:e=>{return t=a.orderId,void q({url:`/pages/user/comment/info?id=${t}`});var t}},{default:i((()=>[C(D(0==K.value?e.$t("去评价"):e.$t("待晒单")),1)])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})):(v(),d(s,{key:1,class:"comment-list"},{default:i((()=>[(v(!0),h(x,null,$(Y.value,(a=>(v(),d(s,{class:"comment-item flex",key:a.orderId},{default:i((()=>[y(s,{class:"comment-header"},{default:i((()=>[a.picThumb?(v(),d(u,{key:0,class:"head",src:a.picThumb,mode:"aspectFill"},null,8,["src"])):b("",!0)])),_:2},1024),y(s,{class:"comment-info"},{default:i((()=>[y(s,{class:"comment-label flex align-center"},{default:i((()=>[y(s,{class:"name"},{default:i((()=>[C(D(e.$t("评价"))+":",1)])),_:1}),y(s,{class:"content flex align-center justify-between"},{default:i((()=>[y(r,{value:a.commentRank,color:"#bfbfbf",readonly:!0,"active-color":"#ffa800",size:"18"},null,8,["value"]),y(s,{class:"time"},{default:i((()=>[C(D(a.addTime),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),y(s,{class:"comment-label flex",onClick:e=>{return t=a.productId,void P({url:`/pages/product/index?id=${t}`});var t}},{default:i((()=>[y(s,{class:"name"},{default:i((()=>[C(D(e.$t("商品名称"))+":",1)])),_:1}),y(s,{class:"content"},{default:i((()=>[y(s,{class:"product-name line1"},{default:i((()=>[C(D(a.productName||"--"),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"]),a.skuData&&a.skuData.length>0?(v(),d(s,{key:0,class:"comment-label flex"},{default:i((()=>[y(s,{class:"name"},{default:i((()=>[C(D(e.$t("商品规格"))+":",1)])),_:1}),y(s,{class:"content flex-wrap"},{default:i((()=>[(v(!0),h(x,null,$(a.skuData,(e=>(v(),d(s,{class:"product-tag"},{default:i((()=>[C(D(e.value),1)])),_:2},1024)))),256))])),_:2},1024)])),_:2},1024)):b("",!0),y(s,{class:"comment-label flex"},{default:i((()=>[y(s,{class:"name"},{default:i((()=>[C(D(e.$t("评价标签"))+":",1)])),_:1}),y(s,{class:"content flex-wrap"},{default:i((()=>[(v(!0),h(x,null,$(a.commentTag,(e=>(v(),d(s,{class:"product-tag"},{default:i((()=>[C(D(e),1)])),_:2},1024)))),256))])),_:2},1024)])),_:2},1024),y(s,{class:"comment-label flex"},{default:i((()=>[y(s,{class:"name"},{default:i((()=>[C(D(e.$t("评价内容"))+":",1)])),_:1}),y(s,{class:"content"},{default:i((()=>[y(s,{class:"cont"},{default:i((()=>[C(D(a.content),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),a.reply?(v(),d(s,{key:1,class:"comment-label flex"},{default:i((()=>[y(s,{class:"name"},{default:i((()=>[C(D(e.$t("客服答复"))+":",1)])),_:1}),y(s,{class:"content"},{default:i((()=>[y(t,{class:"cont"},{default:i((()=>{var e;return[C(D(null==(e=a.reply)?void 0:e.content),1)]})),_:2},1024)])),_:2},1024)])),_:2},1024)):b("",!0),y(s,{class:"comment-label flex"},{default:i((()=>[y(s,{class:"name"},{default:i((()=>[C(D(e.$t("晒单"))+":",1)])),_:1}),a.showPics.length>0?(v(),d(s,{key:0,class:"content flex-wrap"},{default:i((()=>[(v(!0),h(x,null,$(a.showPics,(e=>(v(),d(s,{class:"product-pic"},{default:i((()=>[y(u,{src:e.picThumb,mode:"aspectFill",onClick:a=>{return t=z(I)(e.picUrl),void N({urls:[t]});var t}},null,8,["src","onClick"])])),_:2},1024)))),256))])),_:2},1024)):b("",!0)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})),0==Y.value.length?(v(),d(s,{key:2,class:"empty-box"},{default:i((()=>[y(s,{class:"pictrue"},{default:i((()=>[y(m,{src:z(F)("common/data_empty.png")},null,8,["src"])])),_:1}),y(s,{class:"txt"},{default:i((()=>[C(D(e.$t("暂无评价")),1)])),_:1})])),_:1})):b("",!0),y(f,{modelValue:W.value,"onUpdate:modelValue":a[0]||(a[0]=e=>W.value=e),page:O.page,length:Y.value.length},null,8,["modelValue","page","length"])])),_:1})])),_:1})}}}),[["__scopeId","data-v-3ae66b26"]]);export{H as default};
