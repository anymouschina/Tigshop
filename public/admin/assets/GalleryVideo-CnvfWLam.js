import{M as re}from"./index-CeQDmMxd.js";import{i as B}from"./format-CRgx78oe.js";import{d as ce,i as y,aU as ue,ad as pe,q as ve,I as k,r as v,c,o as n,e as l,f as m,n as $,g as a,F as L,a as E,D as x,b as i,w as d,E as N,j as S,_ as me}from"./index-DrbzVNl6.js";/* empty css                                                                    */import{P as fe}from"./Pagination-wR9huHyl.js";import{u as ye}from"./gallery-CAAqG0aI.js";import{h as K,i as ge,j as _e,k as ke}from"./gallery-DHkpVoP3.js";import{_ as C}from"./DialogForm.vue_vue_type_script_setup_true_lang-DqYSRv0_.js";const be={class:"gallery_warp",id:"gallery_warp"},Ce={class:"lyecs_gallery_box"},Ie={class:"gallery-folder-warp"},we={class:"gallery-folder-list"},xe=["onClick"],he={class:"item-name"},Ve={class:"folder-item-edit"},Ge={class:"add-gallery-folder-con"},Oe={class:"gallery-pics-warp"},$e={class:"gallery-main",id:"gallery-main"},Le={class:"gallery-pic-action"},Ee={class:"gallery-pic-action-l"},Ne={class:"gallery-pic-action-r"},Se={class:"gallery-list",suppressScrollX:!1},Te={key:0},Ue=["onClick"],ze={key:0,class:"video-empty"},Fe={class:"video-actions"},Be={class:"desc"},Me={key:1,class:"gallery-list-ul"},je=["onClick"],Re={class:"video-item-box-icon"},De=["src"],qe={class:"video-actions"},Xe={class:"flex flex-justify-between",style:{width:"100%"}},Ae={class:"duration"},He={class:"flex"},Je={class:"duration"},Ke={class:"desc"},Qe={key:2,class:"empty-warp"},We={key:0,class:"empty-bg"},Ye={class:"gallery-list-page"},Ze=ce({__name:"GalleryVideo",props:{isMultiple:{type:Boolean,default:!1}},emits:["submitCallback","okType"],setup(Q,{expose:W,emit:Y}){const Z=Q,s=ye(),h=y([]),M=y([]),j=y([]),R=y(),g=y({}),I=y([]),{isMultiple:P}=ue(Z),f=y([]),D=y(15),V=y(!0),_=pe(()=>j.value.concat(M.value)),G=async o=>{try{const e=await K({galleryId:o});Object.assign(h.value,e.records),p(o,s.page),T()}catch(e){k.error(e.message)}};ve(()=>{T()});const T=async()=>{try{const o=await K({galleryId:0});h.value=o.records,p(s.galleryId,s.page)}catch(o){k.error(o.message)}},q=o=>{p(o),s.page=1,s.topGalleryId=o},ee=o=>{p(s.galleryId,o)},p=async(o,e=1)=>{V.value=!0,s.page=e;try{const r=await ge({id:o,page:e,sortOrder:s.sortOrder});j.value=[],M.value=r.galleryVideoInfoPage.records,I.value=r.childGalleryList,R.value=r.galleryVideoInfoPage.total,s.galleryId=o,g.value=r.galleryVideo}catch(r){k.error(r.message)}finally{V.value=!1}},le=o=>{s.sortOrder=o,p(s.galleryId)},U=(o,e)=>{e==!0?G(s.galleryId):p(s.galleryId)},z=o=>{o==0?G(s.galleryId):p(s.galleryId)},te=async o=>{try{const e=await _e({id:o});k.success("操作成功"),s.topGalleryId=0,s.galleryId=0,G(s.galleryId)}catch(e){k.error(e.message)}},X=async(o,e)=>{try{const r=await ke({id:o});k.success("操作成功"),I.value.splice(e,1),s.galleryId==o&&(s.topGalleryId=0,s.galleryId=0),G(s.galleryId)}catch(r){k.error(r.message)}},oe=(o,e)=>{re.confirm({title:"您确认要删除所选相册吗？",okType:"danger",onOk(){X(o,e),T()}})},F=Y;F("okType",!1);const se=(o,e)=>{let r=!1;if(f.value.length>0)for(let b in f.value)f.value[b].id==o.id&&(_.value[e].selected=!1,f.value.splice(b,1),r=!0);if(r==!1){if(P.value==!1){f.value=[];for(let b in _.value)_.value[b].selected=!1}_.value[e].selected=!0,f.value.push({id:o.id,videoId:o.id,videoCover:o.videoCover,videoUrl:o.videoUrl,videoName:o.videoName,format:o.format})}F("okType",f.value.length>0)};return W({onFormSubmit:()=>{F("submitCallback",f.value)}}),(o,e)=>{const r=v("el-dropdown-item"),b=v("el-dropdown-menu"),ae=v("el-dropdown"),O=v("el-button"),ie=v("el-space"),A=v("el-option"),de=v("el-select"),H=v("el-image"),J=v("a-popconfirm"),ne=v("a-spin");return n(),c("div",be,[l("div",Ce,[l("div",Ie,[l("div",we,[h.value?(n(),c("div",{key:0,class:$("gallery-folder-item "+(a(s).topGalleryId==0?"current":"")),onClick:e[0]||(e[0]=t=>q(0))},e[9]||(e[9]=[l("div",{class:"folder-item-con"},[l("i",{class:"item-ico"}),l("div",{class:"item-name"},"全部")],-1)]),2)):m("",!0),(n(!0),c(L,null,E(h.value,(t,w)=>(n(),c("div",{class:$("gallery-folder-item "+(a(s).topGalleryId==t.id?"current":""))},[l("div",{class:$("folder-item-con"),onClick:u=>q(t.id)},[e[10]||(e[10]=l("i",{class:"item-ico"},null,-1)),l("div",he,x(t.name),1)],8,xe),l("div",Ve,[i(ae,{trigger:"click"},{dropdown:d(()=>[i(b,null,{default:d(()=>[i(a(C),{width:"600px",onOkCallback:u=>U(t.id,!0),title:"编辑相册",path:"gallery/video/GalleryVideoEdit",params:{act:"detail",id:t.id}},{default:d(()=>[i(r,null,{default:d(()=>e[11]||(e[11]=[l("div",null,"编辑相册",-1)])),_:1})]),_:2},1032,["onOkCallback","params"]),i(r,{onClick:u=>oe(t.id,w)},{default:d(()=>e[12]||(e[12]=[l("div",null,"删除",-1)])),_:2},1032,["onClick"])]),_:2},1024)]),default:d(()=>[e[13]||(e[13]=l("i",{title:"编辑",class:"ico-font"},"",-1))]),_:2},1024)])],2))),256))]),l("div",Ge,[i(a(C),{width:"600px",onOkCallback:e[1]||(e[1]=t=>z(0)),title:"添加视频相册",path:"gallery/video/GalleryVideoEdit",params:{act:"add",parentId:0}},{default:d(()=>[i(O,{class:"add-gallery-folder-btn"},{default:d(()=>e[14]||(e[14]=[l("em",null,"+",-1),N(" 添加视频相册")])),_:1})]),_:1})])]),l("div",Oe,[l("div",$e,[l("div",Le,[l("div",Ee,[i(ie,null,{default:d(()=>[i(a(C),{width:"700px",onOkCallback:e[2]||(e[2]=t=>p(a(s).galleryId,a(s).page)),title:"上传视频",path:"gallery/video/VideoEdit",params:{act:"add"},onCallback:e[3]||(e[3]=t=>z(0))},{default:d(()=>[i(O,{type:"primary"},{default:d(()=>e[15]||(e[15]=[N("上传视频")])),_:1})]),_:1}),g.value&&g.value.parentId>0?(n(),S(O,{key:0,class:"lyecs-btn return-gallery-btn",onClick:e[4]||(e[4]=t=>p(g.value.parentId))},{default:d(()=>e[16]||(e[16]=[N("返回上一级")])),_:1})):m("",!0),g.value&&a(s).galleryId>0?(n(),S(a(C),{key:1,width:"600px",onOkCallback:e[5]||(e[5]=t=>z(g.value.id)),title:"添加子相册",path:"gallery/video/GalleryVideoEdit",params:{act:"add",parentId:g.value.id}},{default:d(()=>[i(O,{class:"lyecs-btn add-gallery-btn"},{default:d(()=>e[17]||(e[17]=[N("添加子相册")])),_:1})]),_:1},8,["params"])):m("",!0)]),_:1})]),l("div",Ne,[e[18]||(e[18]=l("span",{style:{"word-break":"keep-all"}},"排序：",-1)),i(de,{onChange:le,class:"a-select-ui gallery_pic_sort",modelValue:a(s).sortOrder,"onUpdate:modelValue":e[6]||(e[6]=t=>a(s).sortOrder=t)},{default:d(()=>[i(A,{label:"时间从先到后",value:"asc"}),i(A,{label:"时间从后到先",value:"desc"})]),_:1},8,["modelValue"])])]),i(ne,{spinning:V.value},{default:d(()=>[l("div",Se,[I.value.length>0&&a(s).galleryId>0?(n(),c("ul",Te,[(n(!0),c(L,null,E(I.value,(t,w)=>(n(),c("li",{key:t.id,class:"gallery-video-item"},[l("div",{class:"video-item-box",onClick:u=>p(t.id)},[t.galleryVideoInfoList.length==0?(n(),c("span",ze,"相册为空")):m("",!0),(n(!0),c(L,null,E(t.galleryVideoInfoList,(u,el)=>(n(),S(H,{fit:"cover",class:"gallery_pics",src:a(B)(u.videoCover)},null,8,["src"]))),256))],8,Ue),l("p",Fe,[i(a(C),{width:"600px",onOkCallback:u=>U(t.id,!1),title:"编辑相册",path:"gallery/video/GalleryVideoEdit",params:{act:"detail",id:t.id,parentId:t.parentId}},{default:d(()=>e[19]||(e[19]=[l("a",{class:"btn-edit ico-font"},"",-1)])),_:2},1032,["onOkCallback","params"]),i(J,{title:"您确认要删掉该相册吗？",onConfirm:u=>X(t.id,w),placement:"bottom"},{default:d(()=>e[20]||(e[20]=[l("a",{class:"btn-del ico-font",title:"删除"},"",-1)])),_:2},1032,["onConfirm"])]),l("div",Be,x(t.name),1)]))),128))])):m("",!0),_.value.length>0?(n(),c("ul",Me,[(n(!0),c(L,null,E(_.value,(t,w)=>(n(),c("li",{class:$("gallery-video-item "+(f.value.some(u=>u.id===t.id)?"selected":""))},[l("div",null,[l("div",{class:"video-item-box",onClick:u=>se(t,w)},[l("div",Re,[i(a(C),{width:"600px",onOkCallback:u=>U(t.id,!1),title:"编辑视频",path:"gallery/video/VideoEdit",params:{act:"detail",id:t.id}},{default:d(()=>e[21]||(e[21]=[l("i",{class:"iconfont-admin icon-shipin"},null,-1)])),_:2},1032,["onOkCallback","params"])]),t.videoCover?(n(),S(H,{key:0,fit:"cover",class:"gallery_pics",style:{width:"100%",height:"100%"},src:a(B)(t.videoCover)},null,8,["src"])):m("",!0),t.videoCover?m("",!0):(n(),c("video",{key:1,src:a(B)(t.videoUrl)},null,8,De))],8,je),l("div",qe,[l("div",Xe,[l("p",Ae,x(t.duration),1),l("div",He,[l("p",Je,x(t.size),1),i(J,{title:"您确认要删掉该视频吗？",onConfirm:u=>te(t.id),placement:"bottom"},{default:d(()=>e[22]||(e[22]=[l("a",{class:"btn-del ico-font",title:"删除"},"",-1)])),_:2},1032,["onConfirm"])])])]),l("div",Ke,x(t.videoName),1),e[23]||(e[23]=l("div",{class:"img-selected-box"},[l("div",{class:"img-selected-box-angle"}),l("div",{class:"img-selected-box-sort ico-font"},"")],-1))])],2))),256))])):m("",!0),_.value.length==0&&I.value.length==0?(n(),c("div",Qe,[V.value?m("",!0):(n(),c("div",We,"暂无数据"))])):m("",!0)]),l("div",Ye,[i(a(fe),{page:a(s).page,"onUpdate:page":e[7]||(e[7]=t=>a(s).page=t),size:D.value,"onUpdate:size":e[8]||(e[8]=t=>D.value=t),total:R.value,onCallback:ee,layout:"slot ,prev, pager, next",background:!1},null,8,["page","size","total"])])]),_:1},8,["spinning"])])])])])}}}),rl=me(Ze,[["__scopeId","data-v-83e1ed75"]]);export{rl as default};
