import{d as P,i as f,C as W,s as J,q as Q,I,r as d,c as g,o as r,e as v,f as k,j as _,b as l,w as o,a0 as X,g as m,ev as w,E as s,F as Z,a as h,D as x,L as ee,a1 as te,A as le,_ as oe}from"./index-CGYuOau0.js";import"./index-B-GURfkM.js";import{F as N}from"./UploadAvatar.vue_vue_type_style_index_0_scoped_9bfcfc35_lang-CjXfTDg5.js";import{a as ae,c as se}from"./comment-D0vM8ilm.js";import"./SelectTimeInterval.vue_vue_type_style_index_0_scoped_207fe586_lang-t3_hMxDC.js";import{S as ue}from"./SelectProduct-Dqera5O0.js";/* empty css                                                                    *//* empty css                                                                              *//* empty css             */import{_ as ne}from"./DialogForm.vue_vue_type_script_setup_true_lang-Bmm-M6gU.js";import"./vuedraggable.umd-_1km55l4.js";import"./Image.vue_vue_type_script_setup_true_lang-D9PqZe9n.js";import"./format-DFT-VJzO.js";import"./config-DNllFJyR.js";import"./config-DU8_t5BN.js";import"./time-ClyPenjC.js";import"./product-CxWf3yyB.js";import"./Pagination-yOfjsBuR.js";import"./SelectSku-DpuXlI1z.js";/* empty css                                                                  */const re={class:"container"},ie={class:"content_wrapper"},de={class:"lyecs-form-table"},me={class:"flex flex-wrap"},pe={key:0,class:"container-card"},fe={class:"title"},ve={key:0},_e={key:1},ce={style:{"text-align":"end","margin-top":"10px"}},ye=P({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(q,{expose:E,emit:H}){const b=H,c=q,p=f(!0),R=W().currentRoute.value.query,V=f(c.isDialog?c.act:String(R.act)),C=f(c.isDialog?c.id:Number(R.id)),z=V.value==="add"?"create":"update",Y=J(),t=f({comment_rank:5,is_recommend:1,is_top:0,sort_order:50,product_ids:[],comment_tag:[]}),y=f(""),D=f(!1),B=f(),O=u=>{t.value.comment_tag.splice(t.value.comment_tag.indexOf(u),1)},$=()=>{D.value=!0,le(()=>{B.value.input.focus()})},M=()=>{y.value&&t.value.comment_tag.push(y.value),D.value=!1,y.value=""};Q(()=>{V.value==="detail"?F():p.value=!1});const F=async()=>{try{const u=await ae(V.value,{id:C.value});let e=[];u.item.product_id&&(e=[u.item.product_id]),Object.assign(t.value,u.item,{product_ids:e})}catch(u){I.error(u.message),b("close")}finally{p.value=!1}},j=()=>{F()},L=async()=>{await Y.value.validate();try{b("update:confirmLoading",!0);let u=0;t.value.product_ids.length>0&&(u=t.value.product_ids[0]);const e=await se(z,{id:C.value,...t.value,product_id:u});b("submitCallback",e),I.success(e.message)}catch(u){I.error(u.message)}finally{b("update:confirmLoading",!1)}};return E({onFormSubmit:()=>{L()}}),(u,e)=>{const n=d("el-form-item"),i=d("el-radio"),U=d("el-radio-group"),A=d("el-tag"),S=d("el-button"),K=d("el-date-picker"),T=d("el-form"),G=d("a-spin");return r(),g("div",re,[v("div",ie,[v("div",de,[p.value?k("",!0):(r(),_(T,{key:0,ref_key:"formRef",ref:Y,model:t.value,"label-width":"auto"},{default:o(()=>[l(n,{label:"评论商品",prop:"product_ids"},{default:o(()=>[p.value?k("",!0):(r(),_(m(ue),{key:0,isMultiple:!1,ids:t.value.product_ids,"onUpdate:ids":e[0]||(e[0]=a=>t.value.product_ids=a)},null,8,["ids"]))]),_:1}),l(n,{rules:[{required:!0,message:"会员名称不能为空!"}],label:"会员名称",prop:"username"},{default:o(()=>[l(m(w),{modelValue:t.value.username,"onUpdate:modelValue":e[1]||(e[1]=a=>t.value.username=a)},null,8,["modelValue"])]),_:1}),l(n,{label:"会员头像",prop:"avatar"},{default:o(()=>[l(m(N),{photo:t.value.avatar,"onUpdate:photo":e[2]||(e[2]=a=>t.value.avatar=a)},null,8,["photo"]),e[12]||(e[12]=v("div",{class:"extra"},"请统一上传比例为1:1的图片，宽100px，高100px（高清））",-1))]),_:1}),l(n,{label:"评论星级",prop:"comment_rank"},{default:o(()=>[l(U,{modelValue:t.value.comment_rank,"onUpdate:modelValue":e[3]||(e[3]=a=>t.value.comment_rank=a)},{default:o(()=>[l(i,{value:1},{default:o(()=>e[13]||(e[13]=[s("一星")])),_:1}),l(i,{value:2},{default:o(()=>e[14]||(e[14]=[s("二星")])),_:1}),l(i,{value:3},{default:o(()=>e[15]||(e[15]=[s("三星")])),_:1}),l(i,{value:4},{default:o(()=>e[16]||(e[16]=[s("四星")])),_:1}),l(i,{value:5},{default:o(()=>e[17]||(e[17]=[s("五星")])),_:1})]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"标签",prop:"comment_tag"},{default:o(()=>[v("div",me,[(r(!0),g(Z,null,h(t.value.comment_tag,a=>(r(),_(A,{style:{margin:"5px"},key:a,closable:"","disable-transitions":!1,onClose:be=>O(a)},{default:o(()=>[s(x(a),1)]),_:2},1032,["onClose"]))),128)),D.value?(r(),_(m(w),{key:0,style:{margin:"5px"},ref_key:"InputRef",ref:B,modelValue:y.value,"onUpdate:modelValue":e[4]||(e[4]=a=>y.value=a),class:"w-20",size:"small",onKeyup:ee(M,["enter"]),onBlur:M},null,8,["modelValue"])):(r(),_(S,{key:1,style:{margin:"5px"},class:"button-new-tag",size:"small",onClick:$},{default:o(()=>e[18]||(e[18]=[s(" + 新增标签 ")])),_:1}))])]),_:1}),l(n,{rules:[{required:!0,message:"评论内容不能为空!"}],label:"评论内容",prop:"content"},{default:o(()=>[l(m(w),{modelValue:t.value.content,"onUpdate:modelValue":e[5]||(e[5]=a=>t.value.content=a),type:"textarea"},null,8,["modelValue"])]),_:1}),l(n,{label:"评论日期",prop:"add_time"},{default:o(()=>[l(K,{modelValue:t.value.add_time,"onUpdate:modelValue":e[6]||(e[6]=a=>t.value.add_time=a),format:"YYYY-MM-DD HH:mm:ss",placeholder:"请选择日期",type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1}),l(n,{label:"晒单",prop:"show_pics"},{default:o(()=>[p.value?k("",!0):(r(),_(m(N),{key:0,photos:t.value.show_pics,"onUpdate:photos":e[7]||(e[7]=a=>t.value.show_pics=a),isMultiple:!0},null,8,["photos"]))]),_:1}),l(n,{label:"排序",prop:"sort_order"},{default:o(()=>[l(m(w),{modelValue:t.value.sort_order,"onUpdate:modelValue":e[8]||(e[8]=a=>t.value.sort_order=a)},null,8,["modelValue"])]),_:1}),l(n,{label:"是否推荐",prop:"is_recommend"},{default:o(()=>[l(U,{modelValue:t.value.is_recommend,"onUpdate:modelValue":e[9]||(e[9]=a=>t.value.is_recommend=a)},{default:o(()=>[l(i,{value:1},{default:o(()=>e[19]||(e[19]=[s("是")])),_:1}),l(i,{value:0},{default:o(()=>e[20]||(e[20]=[s("否")])),_:1})]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"是否置顶",prop:"is_top"},{default:o(()=>[l(U,{modelValue:t.value.is_top,"onUpdate:modelValue":e[10]||(e[10]=a=>t.value.is_top=a)},{default:o(()=>[l(i,{value:1},{default:o(()=>e[21]||(e[21]=[s("是")])),_:1}),l(i,{value:0},{default:o(()=>e[22]||(e[22]=[s("否")])),_:1})]),_:1},8,["modelValue"])]),_:1}),X(l(n,{"wrapper-col":{offset:4,span:16}},{default:o(()=>[l(S,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:e[11]||(e[11]=a=>L())},{default:o(()=>e[23]||(e[23]=[s("提交 ")])),_:1},512)]),_:1},512),[[te,!c.isDialog]])]),_:1},8,["model"])),l(G,{spinning:p.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])]),!p.value&&V.value!=="add"?(r(),g("div",pe,[v("div",fe,[e[25]||(e[25]=s(" 管理员回复 ")),l(m(ne),{params:{id:C.value},isDrawer:"",path:"product/comment/src/EditRemark",title:"回复评论",width:"600px",onOkCallback:j},{default:o(()=>[l(S,{bg:"",class:"buttonColor",size:"small",text:"",type:"primary"},{default:o(()=>e[24]||(e[24]=[s(" 回复评论 ")])),_:1})]),_:1},8,["params"])]),t.value.reply?(r(),g("div",_e,[v("p",null,"内容："+x(t.value.reply.content),1),v("p",ce,x(t.value.reply.username)+"@"+x(t.value.reply.add_time),1)])):(r(),g("div",ve,"暂无回复！"))])):k("",!0)])])}}}),Oe=oe(ye,[["__scopeId","data-v-914b22ca"]]);export{Oe as default};
