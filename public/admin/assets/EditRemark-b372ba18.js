import{d as B,j as u,E as R,s as D,x as O,K as m,r as s,o as y,c as j,e as w,k as L,w as c,b as l,$ as E,a0 as q,H as F,h as $}from"./index-7c2d2aef.js";import{a as A,j as H,k as K}from"./order-5e1a3c9e.js";const M={class:"container"},T={class:"content_wrapper"},U={class:"lyecs-form-table"},J=B({__name:"EditRemark",props:{id:{type:Number,default:0},act:{type:String,default:""},valueName:{type:String,default:""},form:{type:Object,default:()=>({})},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(n,{expose:h,emit:N}){const o=N,a=n,r=u(!0),p=R().currentRoute.value.query,f=u(a.isDialog?a.act:String(p.act)),d=u(a.isDialog?a.id:Number(p.id));f.value;const v=D(),t=u(a.form);O(()=>{k()});const k=async()=>{try{r.value=!0;const e=await A(f.value,{id:d.value});Object.assign(t.value,e.item)}catch(e){m.error(e.message),o("close")}finally{r.value=!1}},_=async()=>{await v.value.validate();try{if(o("update:confirmLoading",!0),a.valueName=="add_note"){const e=await H({order_id:d.value,order_sn:t.value.order_sn,shop_id:t.value.shop_id,description:t.value[a.valueName]});o("submitCallback",e),m.success(e.message)}if(a.valueName=="admin_note"){const e=await K({id:d.value,admin_note:t.value[a.valueName]});o("submitCallback",e),m.success(e.message)}}catch(e){m.error(e.message)}finally{o("update:confirmLoading",!1)}};return h({onFormSubmit:()=>{_()}}),(e,i)=>{const x=s("el-input"),g=s("el-form-item"),C=s("el-button"),S=s("el-form"),V=s("a-spin");return y(),j("div",M,[w("div",T,[w("div",U,[r.value?$("",!0):(y(),L(S,{key:0,ref_key:"formRef",ref:v,model:t.value,"label-width":"auto"},{default:c(()=>[l(g,{label:"备注",prop:n.valueName},{default:c(()=>[l(x,{modelValue:t.value[n.valueName],"onUpdate:modelValue":i[0]||(i[0]=b=>t.value[n.valueName]=b),rows:4,placeholder:"请输入备注",type:"textarea","show-word-limit":"",maxlength:"200"},null,8,["modelValue"])]),_:1},8,["prop"]),E(l(g,{"wrapper-col":{offset:4,span:16}},{default:c(()=>[l(C,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:i[1]||(i[1]=b=>_())},{default:c(()=>[F("提交 ")]),_:1},512)]),_:1},512),[[q,!a.isDialog]])]),_:1},8,["model"])),l(V,{spinning:r.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}});export{J as default};
