/* empty css             */import"./index-6c62cf9b.js";import{d as oe,de as le,j as d,I as $,x as re,K as D,r as p,o as _,c as f,e as l,b as s,w as o,f as n,h as y,F as ne,E as ie,aV as ce,k as N,H as m,G as C,p as de,i as _e,_ as pe}from"./index-7c2d2aef.js";import{_ as E}from"./DeleteRecord.vue_vue_type_script_setup_true_lang-ae1bade7.js";/* empty css                                                                    */import{P as ue}from"./Pagination-8eb7b6b1.js";import{u as ge}from"./config-9548fa9b.js";import{P as T}from"./PopFormElm-61cd9b7d.js";import{a as S,u as U,d as M,b as me}from"./articleCategory-7e779613.js";import{_ as F}from"./DialogForm.vue_vue_type_script_setup_true_lang-c57b9a11.js";import"./config-e2aa16d1.js";const q=x=>(de("data-v-858b4b08"),x=x(),_e(),x),fe=["href"],ye={class:"container"},ve={class:"content_wrapper"},he={class:"lyecs-table-list-warp"},be={class:"list-table-tool lyecs-search-warp"},ke=q(()=>l("div",{class:"list-table-tips"},[l("div",null,"分类编号对应了系统一些内置分类"),l("div",null," 帮助中心：[bzzx]     客服中心：[kfzx]     热门问题：[rmwt]     客服中心：[kfzx]     本站公告：[bzgg]     资讯中心：[zxzx]    卖家中心：[mjzx] ")],-1)),Ce={class:"list-table-tool-row"},xe={class:"list-table-tool-col"},ze=q(()=>l("i",{class:"iconfont icon-fanhui",style:{"font-size":"14px","padding-right":"5px"}},null,-1)),Ie={key:1},Ae={class:"table-container"},Se={style:{position:"relative"}},qe=["onClick"],Ve={key:1},De=q(()=>l("a",{class:"btn-link"},"编辑",-1)),Ne=q(()=>l("a",{class:"btn-link"},"添加子分类",-1)),Te={class:"empty-warp"},Ue={key:0,class:"empty-bg"},Fe={key:0,class:"pagination-con"},Pe=oe({__name:"List",setup(x){const{currentRoute:H}=ie(),P=le(),R=ge(),O=d(R.icoDefinedCss),w=d([]),z=d(!0),I=d(0),v=d([]),j=d([]),i=$({page:1,size:R.get("page_size"),sort_field:"",sort_order:"",keyword:"",parent_id:0}),A=d([0]),G=d(),K=ce();re(()=>{const t=H.value.query;t.id>0&&(i.parent_id=t.id),K.meta.title="",c()});const c=async()=>{z.value=!0;try{const t=await S({...i});w.value=t.filter_result,I.value=t.total,G.value=t.parent_name,t.parent_name?P.setHeaderTitle("文章分类列表 - "+t.parent_name):P.setHeaderTitle("文章分类列表")}catch(t){D.error(t.message)}finally{z.value=!1}},h=$({}),J=async(t,a,r)=>{h[t.article_category_id]={},h[t.article_category_id].resolve=r,h[t.article_category_id].expandCount=0;const u=await S({page:1,parent_id:t.article_category_id,size:1e3});r(u.filter_result)},Q=async(t,a)=>{const r=h[t.article_category_id];if(r.expandCount++,a&&r.expandCount>1&&!r.prevStatus){const u=await S({page:1,parent_id:t.article_category_id,size:1e3});r.resolve(u.filter_result)}r.prevStatus=a},b=d(null),V=async(t,a)=>{const r=h[a.parentId];if(console.log(b.value),r){const u=await S({page:1,parent_id:a.parentId,size:1e3});b.value.store.states.lazyTreeNodeMap.value[a.parentId].length>1?b.value.store.states.lazyTreeNodeMap[a.parentId]=[]:b.value.store.states.lazyTreeNodeMap.value[a.parentId]=[],r.resolve(u.filter_result)}else c()},W=t=>{A.value.push(t),i.parent_id=t,c()},X=()=>{A.value.pop(),i.parent_id=A.value[A.value.length-1],c()},Y=async t=>{try{const a=await me(t,{ids:v.value});D.success(a.message),await c()}catch(a){D.error(a.message)}},Z=({prop:t,order:a})=>{i.sort_field=t,i.sort_order=a=="ascending"?"asc":a=="descending"?"desc":"",c()},ee=t=>{v.value=t.map(a=>a.article_category_id)};return(t,a)=>{const r=p("el-button"),u=p("el-popconfirm"),B=p("el-space"),te=p("el-form"),k=p("el-table-column"),L=p("el-divider"),ae=p("el-table"),se=p("a-spin");return _(),f(ne,null,[l("link",{href:O.value,rel:"stylesheet"},null,8,fe),l("div",ye,[l("div",ve,[l("div",he,[l("div",be,[ke,s(te,{model:i,name:"form"},{default:o(()=>[l("div",Ce,[l("div",xe,[s(B,null,{default:o(()=>[i.parent_id>0?(_(),N(r,{key:0,onClick:X},{default:o(()=>[ze,m(" 返回上一级 ")]),_:1})):y("",!0),s(n(F),{params:{act:"add",parentId:i.parent_id},isDrawer:"",path:"content/articleCategory/Info",title:"添加文章分类",width:"600px",onOkCallback:c},{default:o(()=>[s(r,{type:"primary"},{default:o(()=>[m("添加文章分类")]),_:1})]),_:1},8,["params"]),s(u,{title:"您确认要批量删除所选数据吗？",onConfirm:a[0]||(a[0]=e=>Y("del"))},{reference:o(()=>[s(r,{disabled:v.value.length===0},{default:o(()=>[m("批量删除")]),_:1},8,["disabled"])]),_:1}),v.value.length>0?(_(),f("span",Ie,[m(" 已选择："),l("b",null,C(v.value.length),1),m(" 项 ")])):y("",!0)]),_:1})])])]),_:1},8,["model"])]),l("div",Ae,[s(se,{spinning:z.value},{default:o(()=>[s(ae,{onSortChange:Z,data:w.value,"expand-row-keys":j.value,indent:30,load:J,total:I.value,"tree-props":{children:"children",hasChildren:"has_children"},lazy:"","row-key":"article_category_id",onSelectionChange:ee,onExpandChange:Q,ref_key:"tableRef",ref:b},{empty:o(()=>[l("div",Te,[z.value?y("",!0):(_(),f("div",Ue,"暂无数据"))])]),default:o(()=>[s(k,{type:"selection",width:"32"}),s(k,{width:200,label:"文章分类名称"},{default:o(({row:e})=>[s(B,{style:{height:"30px"}},{default:o(()=>[l("div",Se,[s(n(T),{"org-value":e.article_category_name,"onUpdate:orgValue":g=>e.article_category_name=g,params:{id:e.article_category_id,field:"article_category_name"},requestApi:n(U),label:"权限名称",type:"textarea"},{default:o(()=>[e.has_children?(_(),f("a",{key:0,onClick:g=>W(e.article_category_id)},C(e.article_category_name),9,qe)):(_(),f("span",Ve,C(e.article_category_name),1))]),_:2},1032,["org-value","onUpdate:orgValue","params","requestApi"])])]),_:2},1024)]),_:1}),s(k,{label:"分类编号"},{default:o(({row:e})=>[s(n(T),{"org-value":e.category_sn,"onUpdate:orgValue":g=>e.category_sn=g,params:{id:e.article_category_id,field:"category_sn"},requestApi:n(U),label:"分类编号",type:"textarea"},{default:o(()=>[l("div",null,C(e.category_sn||"-"),1)]),_:2},1032,["org-value","onUpdate:orgValue","params","requestApi"])]),_:1}),s(k,{key:"sort_order",sortable:"custom",label:"排序"},{default:o(({row:e})=>[s(n(T),{"org-value":e.sort_order,"onUpdate:orgValue":g=>e.sort_order=g,params:{id:e.article_category_id,field:"sort_order"},requestApi:n(U),label:"排序",type:"input"},{default:o(()=>[l("div",null,C(e.sort_order),1)]),_:2},1032,["org-value","onUpdate:orgValue","params","requestApi"])]),_:1}),s(k,{width:220,fixed:"right",label:"操作"},{default:o(({row:e})=>[s(n(F),{params:{act:"detail",id:e.article_category_id,parentId:e.parent_id},data:{parentId:e.parent_id},isDrawer:"",path:"content/articleCategory/Info",title:"编辑分类",width:"600px",onOkCallback:V},{default:o(()=>[De]),_:2},1032,["params","data"]),s(L,{direction:"vertical"}),s(n(F),{params:{act:"add",parentId:e.article_category_id},data:{parentId:e.parent_id||e.article_category_id},isDrawer:"",path:"content/articleCategory/Info",title:"编辑分类",width:"600px",onOkCallback:V},{default:o(()=>[Ne]),_:2},1032,["params","data"]),s(L,{direction:"vertical"}),e.parent_id?(_(),N(n(E),{key:0,params:{id:e.article_category_id},requestApi:n(M),onAfterDelete:g=>V({},{parentId:e.parent_id})},{default:o(()=>[m("删除")]),_:2},1032,["params","requestApi","onAfterDelete"])):y("",!0),e.parent_id?y("",!0):(_(),N(n(E),{key:1,params:{id:e.article_category_id},requestApi:n(M),onAfterDelete:c},{default:o(()=>[m("删除")]),_:2},1032,["params","requestApi"]))]),_:1})]),_:1},8,["data","expand-row-keys","total"])]),_:1},8,["spinning"]),I.value>0?(_(),f("div",Fe,[s(n(ue),{page:i.page,"onUpdate:page":a[1]||(a[1]=e=>i.page=e),size:i.size,"onUpdate:size":a[2]||(a[2]=e=>i.size=e),total:I.value,onCallback:c},null,8,["page","size","total"])])):y("",!0)])])])])],64)}}});const Ke=pe(Pe,[["__scopeId","data-v-858b4b08"]]);export{Ke as default};
