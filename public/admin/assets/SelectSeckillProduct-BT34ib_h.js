import"./index-CeQDmMxd.js";import{i as A}from"./format-CRgx78oe.js";import{e as O}from"./product-DEi2MlvQ.js";import{_ as j}from"./DialogForm.vue_vue_type_script_setup_true_lang-DqYSRv0_.js";import{d as q,u as h,i as m,q as z,p as G,r as C,c as n,o as u,b as c,f as V,w as p,j as I,g as T,E as f,e as d,b0 as H,F as D,a as E,D as y,I as J,_ as K}from"./index-DrbzVNl6.js";const Q={class:"lyecs-product-select-group"},R={key:0,class:"lyecs-product-selected-con"},W={class:"product-selected-list"},X={class:"product-selected-list-tr"},Y={class:"col col2 product-info"},Z={style:{display:"flex"}},ee=["src"],le={style:{"line-height":"2"}},te={class:"col col1"},oe={class:"extra"},se={class:"col col1"},ae={class:"extra"},ue={class:"col col3"},de={class:"batch"},ie={key:1,class:"setting"},ce={key:3,class:"setting"},re=q({__name:"SelectSeckillProduct",props:{productId:{default:()=>0},productIdModifiers:{},verify:{default:()=>!1},verifyModifiers:{},productList:{default:()=>[]},productListModifiers:{}},emits:["update:productId","update:verify","update:productList"],setup(P){const b=h(P,"productId");h(P,"verify");const L=h(P,"productList"),i=m([]),$=m(!1),U=m(!0);z(()=>{});const v=m(!0),k=m(!0),_=m(""),g=m(),M=a=>{a===1?(i.value.forEach(e=>{e.secondsSeckill&&(e.seckillPrice=_.value)}),_.value="",v.value=!v.value):(i.value.forEach(e=>{e.secondsSeckill&&(e.seckillStock=g.value)}),g.value=void 0,k.value=!k.value)},w=a=>{b.value=a[0],F()},B=()=>{i.value=[]},N=a=>{i.value[a].secondsSeckill=i.value[a].secondsSeckill?0:1},F=async()=>{var a;$.value=!0;try{const e=await O("detail",{id:b.value});console.log(e.productList);let t=e;if(t.productList.length==0){let o={};o.secondsSeckill=1,o.tipValue="已参加",o.seckillPrice="",o.seckillStock="",o.picThumb=t.picThumb,o.productName=t.productName,o.skuPrice=t.productPrice,o.skuStock=t.productStock,i.value.push(o)}else(a=t.productList)==null||a.forEach(o=>{let s={};s.secondsSeckill=1,s.tipValue="已参加",s.seckillPrice="",s.seckillStock="",s.picThumb=t.picThumb,s.productName=t.productName,s.skuPrice=o.skuPrice,s.skuStock=o.skuStock,s.skuId=o.skuId,s.skuData=o.skuData,i.value.push(s)})}catch(e){J.error(e.message)}finally{$.value=!1}};return G(()=>i.value,a=>{console.log(a);let e=[];a.length>0&&(a[0].skuId&&a.forEach(t=>{let o={};t.secondsSeckill&&(o.skuId=t.skuId,o.seckillPrice=t.seckillPrice,o.seckillStock=t.seckillStock,e.push(o))}),L.value=e)},{deep:!0,immediate:!0}),(a,e)=>{var x;const t=C("el-button"),o=C("el-space"),s=C("TigInput");return u(),n("div",Q,[c(o,null,{default:p(()=>{var l;return[c(T(j),{params:{selectedIds:L.value,isMultiple:!1},isDrawer:"",path:"product/product/src/SelectProduct",title:"选择商品",width:"600px",onOkCallback:w},{default:p(()=>{var S;return[c(t,{disabled:((S=i.value)==null?void 0:S.length)>0,type:"primary"},{default:p(()=>e[8]||(e[8]=[f("选择商品")])),_:1},8,["disabled"])]}),_:1},8,["params"]),((l=i.value)==null?void 0:l.length)>0?(u(),I(t,{key:0,onClick:B},{default:p(()=>e[9]||(e[9]=[f("清空")])),_:1})):V("",!0)]}),_:1}),((x=i.value)==null?void 0:x.length)>0&&U.value?(u(),n("div",R,[d("div",W,[e[11]||(e[11]=H('<div class="product-selected-list-tr product-selected-list-th" data-v-45ff6e2a><div class="col col2" data-v-45ff6e2a>商品信息</div><div class="col col1" data-v-45ff6e2a>秒杀价</div><div class="col col1" data-v-45ff6e2a>秒杀库存</div><div class="col col3" data-v-45ff6e2a>操作</div></div>',1)),(u(!0),n(D,null,E(i.value,(l,S)=>(u(),n("div",X,[d("div",Y,[d("div",Z,[d("img",{src:T(A)(l.picThumb),height:"50",width:"50"},null,8,ee),d("span",le,y(l.productName),1)]),d("ul",null,[(u(!0),n(D,null,E(l.skuData,r=>(u(),n("li",null,y(r.name)+"："+y(r.value),1))),256))])]),d("div",te,[c(s,{type:"decimal",modelValue:l.seckillPrice,"onUpdate:modelValue":r=>l.seckillPrice=r},null,8,["modelValue","onUpdate:modelValue"]),d("div",oe,"价格(元)："+y(l.skuPrice),1)]),d("div",se,[c(s,{type:"integer",modelValue:l.seckillStock,"onUpdate:modelValue":r=>l.seckillStock=r},null,8,["modelValue","onUpdate:modelValue"]),d("div",ae,"现有库存："+y(l.skuStock),1)]),d("div",ue,[l.secondsSeckill?(u(),I(t,{key:0,type:l.tipValue=="取消参加"?"danger":"primary",link:"",onClick:r=>N(S),onMouseout:r=>l.tipValue="已参加",onMouseover:r=>l.tipValue="取消参加"},{default:p(()=>[f(y(l.tipValue),1)]),_:2},1032,["type","onClick","onMouseout","onMouseover"])):(u(),I(t,{key:1,link:"",type:"primary",onClick:r=>N(S)},{default:p(()=>e[10]||(e[10]=[f("参加秒杀")])),_:2},1032,["onClick"]))])]))),256))]),d("div",de,[e[16]||(e[16]=d("span",null,"批量设置：",-1)),k.value&&v.value?(u(),n("div",{key:0,onClick:e[0]||(e[0]=l=>v.value=!v.value)},"秒杀价格")):v.value?V("",!0):(u(),n("div",ie,[c(s,{type:"decimal",modelValue:_.value,"onUpdate:modelValue":e[1]||(e[1]=l=>_.value=l),placeholder:"请输入秒杀价格"},null,8,["modelValue"]),c(t,{link:"",type:"primary",onClick:e[2]||(e[2]=l=>M(1))},{default:p(()=>e[12]||(e[12]=[f("保存")])),_:1}),c(t,{link:"",type:"primary",onClick:e[3]||(e[3]=l=>v.value=!v.value)},{default:p(()=>e[13]||(e[13]=[f("取消")])),_:1})])),k.value&&v.value?(u(),n("div",{key:2,onClick:e[4]||(e[4]=l=>k.value=!k.value)},"秒杀库存")):k.value?V("",!0):(u(),n("div",ce,[c(s,{type:"integer",modelValue:g.value,"onUpdate:modelValue":e[5]||(e[5]=l=>g.value=l),placeholder:"请输入秒杀库存"},null,8,["modelValue"]),c(t,{link:"",type:"primary",onClick:e[6]||(e[6]=l=>M(2))},{default:p(()=>e[14]||(e[14]=[f("保存")])),_:1}),c(t,{link:"",type:"primary",onClick:e[7]||(e[7]=l=>k.value=!k.value)},{default:p(()=>e[15]||(e[15]=[f("取消")])),_:1})]))])])):V("",!0)])}}}),me=K(re,[["__scopeId","data-v-45ff6e2a"]]);export{me as default};
