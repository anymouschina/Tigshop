import{d as O,j as d,E as $,s as z,I as G,x as J,r as i,o as n,c as h,e as A,k as c,w as r,b as t,f as P,H as v,F as B,a as Q,h as R,$ as W,a0 as X,K as g,_ as Y}from"./index-7c2d2aef.js";import"./index-6c62cf9b.js";import"./vuedraggable.umd-75ad0f8f.js";import"./config-9548fa9b.js";import{e as Z}from"./util-1ee03ed8.js";import"./UploadAvatar.vue_vue_type_style_index_0_scoped_9bfcfc35_lang-9b6073fb.js";import{U as ee}from"./UploadAvatar-a0818e55.js";import{i as ae,j as te,h as le,k as oe}from"./adminUser-fb41eb63.js";import re from"./AuthoritySelect-0317ca22.js";import"./config-e2aa16d1.js";import"./Image.vue_vue_type_script_setup_true_lang-36bd437b.js";import"./format-4e0206d3.js";import"./DialogForm.vue_vue_type_script_setup_true_lang-c57b9a11.js";import"./authority-44614dad.js";const se={class:"container"},ie={class:"content_wrapper"},ne={class:"lyecs-form-table"},ue=O({__name:"ShopInfo",props:{id:{type:Number,default:0},suppliers_id:{type:Number,default:0},act:{type:String,default:""},type:{type:String,default:""},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(D,{expose:T,emit:q}){const f=q;d(localStorage.getItem("adminType"));const u=D,m=d(!0),S=$().currentRoute.value.query,b=d(u.isDialog?u.act:String(S.act)),U=d(u.isDialog?u.id:Number(S.id)),y=b.value==="add"?"create":"update",k=z(),e=G({user_id:""}),x=d(),p=d({}),F=async o=>{if(o){const a=await ae(o);a.item!==null&&(p.value=a.item)}else p.value={}},V=d(!0),L=async()=>{var o;try{const a=await te(b.value,{id:U.value});p.value=a.item.user,Object.assign(e,a.item),e.mobile=(o=a.item.admin_user)==null?void 0:o.mobile;let _=Z(String(e.avatar));_=="one"?V.value=!0:_=="def"&&(V.value=!1)}catch(a){g.error(a.message),f("close")}finally{m.value=!1}},j=async()=>{try{const o=await le();x.value=o.Role_list}catch(o){g.error(o.message)}};J(()=>{b.value==="detail"?L():m.value=!1,y!="update"&&u.type==="suppliers"&&(e.role_id=2,e.suppliers_id=u.suppliers_id),j()});const C=async()=>{await k.value.validate();try{f("update:confirmLoading",!0);let o={avatar:""};!e.avatar&&e.def_avatar?o.avatar=e.def_avatar:o.avatar=e.avatar,console.log(y);const a=await oe(y,{id:U.value,...e,avatar:o.avatar});f("submitCallback",a),g.success(a.message)}catch(o){g.error(o.message)}finally{f("update:confirmLoading",!1)}};return T({onFormSubmit:()=>{C()}}),(o,a)=>{const _=i("el-input"),s=i("el-form-item"),w=i("el-option"),I=i("el-select"),N=i("el-radio"),E=i("el-radio-group"),M=i("el-button"),H=i("el-form"),K=i("a-spin");return n(),h("div",se,[A("div",ie,[A("div",ne,[m.value?R("",!0):(n(),c(H,{key:0,ref_key:"formRef",ref:k,model:e,"label-width":"auto"},{default:r(()=>[t(s,{rules:[{required:!0,message:"员工名称不能为空!"}],label:"员工名称",prop:"username"},{default:r(()=>[t(_,{modelValue:e.username,"onUpdate:modelValue":a[0]||(a[0]=l=>e.username=l)},null,8,["modelValue"])]),_:1}),t(s,{rules:[{required:!0,message:"请选择绑定会员"}],prop:"user_id",label:"绑定会员"},{default:r(()=>[t(I,{modelValue:e.user_id,"onUpdate:modelValue":a[1]||(a[1]=l=>e.user_id=l),filterable:"",remote:"","reserve-keyword":"",placeholder:"可输入手机号查询绑定会员","remote-method":F,loading:m.value,style:{width:"240px"}},{default:r(()=>[(n(),c(w,{key:p.value.user_id,label:p.value.username,value:p.value.user_id},null,8,["label","value"]))]),_:1},8,["modelValue","loading"])]),_:1}),t(s,{label:"手机号",prop:"mobile",rules:[{required:!0,message:"手机号不能为空!"}]},{default:r(()=>[t(_,{modelValue:e.mobile,"onUpdate:modelValue":a[2]||(a[2]=l=>e.mobile=l)},null,8,["modelValue"])]),_:1}),t(s,{label:"邮箱",prop:"email"},{default:r(()=>[t(_,{modelValue:e.email,"onUpdate:modelValue":a[3]||(a[3]=l=>e.email=l)},null,8,["modelValue"])]),_:1}),t(s,{label:"头像",prop:"avatar"},{default:r(()=>[t(P(ee),{avatar:e.avatar,"onUpdate:avatar":a[4]||(a[4]=l=>e.avatar=l),avatarType:V.value,loading:m.value},null,8,["avatar","avatarType","loading"])]),_:1}),t(s,{label:"是否停用",prop:"is_using"},{default:r(()=>[t(E,{style:{width:"100%"},modelValue:e.is_using,"onUpdate:modelValue":a[5]||(a[5]=l=>e.is_using=l)},{default:r(()=>[t(N,{value:1},{default:r(()=>[v("是")]),_:1}),t(N,{value:0},{default:r(()=>[v("否")]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(s,{label:"员工权限组",prop:"role_id"},{default:r(()=>[e.role_id!=2?(n(),c(I,{key:0,modelValue:e.role_id,"onUpdate:modelValue":a[6]||(a[6]=l=>e.role_id=l),style:{width:"100%"}},{default:r(()=>[t(w,{value:0,label:"自定义权限"}),(n(!0),h(B,null,Q(x.value,l=>(n(),c(w,{label:l.role_name,value:l.role_id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])):(n(),h(B,{key:1},[v(" 供应商")],64))]),_:1}),e.role_id===0?(n(),c(s,{key:0,label:"",prop:"auth_list"},{default:r(()=>[t(re,{modelValue:e.auth_list,"onUpdate:modelValue":a[7]||(a[7]=l=>e.auth_list=l)},null,8,["modelValue"])]),_:1})):R("",!0),W(t(s,{"wrapper-col":{offset:4,span:16}},{default:r(()=>[t(M,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:C},{default:r(()=>[v("提交")]),_:1},512)]),_:1},512),[[X,!u.isDialog]])]),_:1},8,["model"])),t(K,{spinning:m.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}});const ke=Y(ue,[["__scopeId","data-v-43f57bac"]]);export{ke as default};
