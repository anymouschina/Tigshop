import{d as E,i as v,G as K,q as O,c as b,e as o,b as t,w as s,f as h,g as m,I as k,r as i,o as g,L as F,E as u,D as S}from"./index-CGYuOau0.js";/* empty css             */import"./index-B-GURfkM.js";import{_ as G}from"./DeleteRecord.vue_vue_type_script_setup_true_lang-BTFcBk5t.js";/* empty css                                                                    */import{P as M}from"./Pagination-yOfjsBuR.js";import{u as T}from"./config-DNllFJyR.js";import{g as j,d as H,b as J}from"./limitdiscount-_RZGkKbT.js";import{_ as V}from"./DialogForm.vue_vue_type_script_setup_true_lang-Bmm-M6gU.js";import"./config-DU8_t5BN.js";const Q={class:"container"},R={class:"content_wrapper"},W={class:"lyecs-table-list-warp"},X={class:"list-table-tool lyecs-search-warp"},Y={class:"advanced-search-warp list-table-tool-row"},Z={class:"simple-form-warp"},ee={class:"simple-form-field"},te={class:"form-group"},oe={class:"control-container"},se={class:"simple-form-field"},ae={class:"form-group"},le={class:"control-container"},ne={class:"list-table-tool-row"},ie={class:"list-table-tool-col"},re={key:0},de={class:"table-container"},ce={style:{position:"relative"}},pe={class:"empty-warp"},_e={key:0,class:"empty-bg"},me={key:0,class:"pagination-con"},Ve=E({__name:"List",setup(ue){const x=T(),C=v(),c=v(!0),f=v(0),p=v([]),l=K({page:1,size:x.get("page_size"),sort_field:"",sort_order:"",keyword:""}),r=async()=>{c.value=!0;try{const n=await j({...l});C.value=n.filter_result,f.value=n.total}catch(n){k.error(n.message)}finally{c.value=!1}};O(()=>{r()});const _=()=>{r()},z=({prop:n,order:e})=>{l.sort_field=n,l.sort_order=e=="ascending"?"asc":e=="descending"?"desc":"",r()},A=async n=>{try{const e=await J(n,{ids:p.value});k.success(e.message),r()}catch(e){k.error(e.message)}},D=n=>{p.value=n.map(e=>e.discount_id)};return(n,e)=>{const y=i("el-button"),L=i("el-input"),w=i("el-option"),B=i("el-select"),I=i("el-popconfirm"),N=i("el-space"),U=i("el-form"),d=i("el-table-column"),q=i("el-divider"),P=i("el-table"),$=i("a-spin");return g(),b("div",Q,[o("div",R,[o("div",W,[o("div",X,[t(U,{model:l,name:"form"},{default:s(()=>[o("div",Y,[o("div",Z,[o("div",ee,[o("div",te,[o("div",oe,[t(L,{modelValue:l.keyword,"onUpdate:modelValue":e[0]||(e[0]=a=>l.keyword=a),name:"keyword",placeholder:"输入活动名称",onKeyup:F(_,["enter"]),clearable:"",onClear:_},{append:s(()=>[t(y,{onClick:_},{default:s(()=>e[5]||(e[5]=[o("span",{class:"iconfont icon-chakan1"},null,-1)])),_:1})]),_:1},8,["modelValue"])])])]),o("div",se,[o("div",ae,[e[6]||(e[6]=o("label",{class:"control-label"},[o("span",null,"活动状态：")],-1)),o("div",le,[t(B,{modelValue:l.active_state,"onUpdate:modelValue":e[1]||(e[1]=a=>l.active_state=a),placeholder:"请选择活动状态",clearable:"",onClear:_,onChange:_},{default:s(()=>[t(w,{label:"活动进行中",value:1}),t(w,{label:"活动已结束",value:2}),t(w,{label:"活动未开始",value:3})]),_:1},8,["modelValue"])])])])])]),o("div",ne,[o("div",ie,[t(N,null,{default:s(()=>[t(m(V),{params:{act:"add"},isDrawer:"",path:"promotion/productActivity/limitdiscount/Info",title:"新增限时折扣活动",width:"900px",onOkCallback:r},{default:s(()=>[t(y,{type:"primary"},{default:s(()=>e[7]||(e[7]=[u("新增限时折扣活动")])),_:1})]),_:1}),t(I,{title:"您确认要批量删除所选数据吗？",onConfirm:e[2]||(e[2]=a=>A("del"))},{reference:s(()=>[t(y,{disabled:p.value.length===0},{default:s(()=>e[8]||(e[8]=[u("批量删除")])),_:1},8,["disabled"])]),_:1}),p.value.length>0?(g(),b("span",re,[e[9]||(e[9]=u(" 已选择：")),o("b",null,S(p.value.length),1),e[10]||(e[10]=u(" 项 "))])):h("",!0)]),_:1})])])]),_:1},8,["model"])]),o("div",de,[t($,{spinning:c.value},{default:s(()=>[t(P,{data:C.value,"row-key":"coupon_id",onSelectionChange:D,total:f.value,onSortChange:z,loading:c.value},{empty:s(()=>[o("div",pe,[c.value?h("",!0):(g(),b("div",_e,"暂无数据"))])]),default:s(()=>[t(d,{type:"selection",width:"32"}),t(d,{label:"活动名称",prop:"promotion_name",width:150},{default:s(({row:a})=>[o("div",ce,[o("div",null,S(a.promotion_name||"--"),1)])]),_:1}),t(d,{label:"起始日期",prop:"start_time",sortable:"custom"}),t(d,{label:"截止日期",prop:"end_time",sortable:"custom"}),t(d,{label:"状态",prop:"status_name"}),t(d,{label:"操作",fixed:"right"},{default:s(({row:a})=>[t(m(V),{isDrawer:"",onOkCallback:r,title:"编辑限时折扣",width:"900px",path:"promotion/productActivity/limitdiscount/Info",params:{act:"detail",id:a.discount_id}},{default:s(()=>e[11]||(e[11]=[o("a",{class:"btn-link"},"编辑",-1)])),_:2},1032,["params"]),t(q,{direction:"vertical"}),t(m(G),{onAfterDelete:r,requestApi:m(H),params:{id:a.discount_id}},{default:s(()=>e[12]||(e[12]=[u("删除")])),_:2},1032,["requestApi","params"])]),_:1})]),_:1},8,["data","total","loading"])]),_:1},8,["spinning"]),f.value>0?(g(),b("div",me,[t(m(M),{page:l.page,"onUpdate:page":e[3]||(e[3]=a=>l.page=a),size:l.size,"onUpdate:size":e[4]||(e[4]=a=>l.size=a),total:f.value,onCallback:r},null,8,["page","size","total"])])):h("",!0)])])])])}}});export{Ve as default};
