import{d as P,i as c,C as j,s as O,q as M,r as d,c as $,o as y,e as i,j as S,f as B,b as l,w as r,a0 as z,g as U,E as g,a1 as G,I as v}from"./index-CGYuOau0.js";import{a as H,c as J}from"./pcCatFloor-BM4hEN4m.js";import{D as L}from"./DynamicList-DoNez1gA.js";import{S as K}from"./SelectBrand-DsStZmqh.js";import{_ as Q}from"./SelectCategory.vue_vue_type_script_setup_true_lang-D0pGcDY-.js";import"./index-B-GURfkM.js";import"./SelectTimeInterval.vue_vue_type_style_index_0_scoped_207fe586_lang-t3_hMxDC.js";/* empty css                                                                    *//* empty css                                                                  *//* empty css                                                                              *//* empty css             */import{S as W}from"./SelectIco-CyYwvohC.js";import"./brand-BWQ0xslz.js";import"./category-BQcUsnE8.js";import"./category-DpIl2IOo.js";import"./time-ClyPenjC.js";import"./config-DNllFJyR.js";import"./config-DU8_t5BN.js";import"./DialogForm.vue_vue_type_script_setup_true_lang-Bmm-M6gU.js";const X={class:"container"},Y={class:"content_wrapper"},Z={class:"lyecs-form-table"},ee={class:"dynamic-div"},te={class:"dynamic-div"},Ce=P({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},isDialog:{type:Boolean,default:!1}},emits:["submitCallback","update:confirmLoading","close"],setup(N,{expose:k,emit:A}){const _=A,u=N,m=c(!0),b=j().currentRoute.value.query,f=c(u.isDialog?u.act:String(b.act)),V=c(u.isDialog?u.id:Number(b.id)),D=f.value==="add"?"create":"update",w=O(),t=c({is_show:1,sort_order:50}),T=async()=>{try{const a=await H(f.value,{id:V.value});Object.assign(t.value,a.item),a.item.category_ids&&a.item.category_names&&a.item.category_ids.length===a.item.category_names.length&&(t.value.category_list=a.item.category_ids.map((e,n)=>{var s;return{category_id:Number(e),category_name:((s=a.item.category_names)==null?void 0:s[n])||""}}),a.item.brand_ids&&a.item.brand_ids.length>0&&(t.value.brand_list=a.item.brand_ids.map((e,n)=>({brand_id:Number(e)}))))}catch(a){v.error(a.message),_("close")}finally{m.value=!1}};M(()=>{f.value==="detail"?T():m.value=!1});const C=async()=>{await w.value.validate();try{_("update:confirmLoading",!0),F(),R();const a=await J(D,{id:V.value,...t.value});_("submitCallback",a),v.success(a.message)}catch(a){v.error(a.message)}finally{_("update:confirmLoading",!1)}};function F(){var a;t.value.category_ids=t.value.category_ids||[],t.value.category_names=t.value.category_names||[],t.value.category_ids.length=0,t.value.category_names.length=0,(a=t.value.category_list)==null||a.forEach(e=>{var n,s;typeof e.category_id=="number"&&typeof e.category_name=="string"&&((n=t.value.category_ids)==null||n.push(e.category_id),(s=t.value.category_names)==null||s.push(e.category_name))})}function R(){var a;t.value.brand_ids=t.value.brand_ids||[],t.value.brand_ids.length=0,(a=t.value.brand_list)==null||a.forEach(e=>{var n;typeof e.brand_id=="number"&&((n=t.value.brand_ids)==null||n.push(e.brand_id))})}return k({onFormSubmit:()=>{C()}}),(a,e)=>{const n=d("el-input"),s=d("el-form-item"),x=d("el-radio"),E=d("el-radio-group"),I=d("el-button"),h=d("el-form"),q=d("a-spin");return y(),$("div",X,[i("div",Y,[i("div",Z,[m.value?B("",!0):(y(),S(h,{key:0,ref_key:"formRef",ref:w,model:t.value,"label-width":"auto"},{default:r(()=>[l(s,{label:"添加分类",prop:"brand_name"},{default:r(()=>[l(L,{modelValue:t.value.category_list,"onUpdate:modelValue":e[0]||(e[0]=o=>t.value.category_list=o),templateList:["category_id","category_name"],templateListType:["number","string"],buttonName:"增加",buttonType:"primary",style:{width:"100%"}},{dynamicSlot:r(({item:o})=>[i("div",ee,[m.value?B("",!0):(y(),S(U(Q),{key:0,category_id:o.category_id,"onUpdate:category_id":p=>o.category_id=p,multiple:!1,style:{width:"100%"}},null,8,["category_id","onUpdate:category_id"])),e[5]||(e[5]=i("span",null,"重命名：",-1)),l(n,{modelValue:o.category_name,"onUpdate:modelValue":p=>o.category_name=p},null,8,["modelValue","onUpdate:modelValue"])])]),_:1},8,["modelValue"]),e[6]||(e[6]=i("div",{class:"extra"},"提示：只能设置为一级或二级分类，且必须含有一个一级分类，如果存在二级分类，则必须存在该二级分类上一级分类；",-1)),e[7]||(e[7]=i("div",{class:"extra"},"重命名为空则显示原分类名称，重命名的作用为方便排列",-1)),e[8]||(e[8]=i("div",{class:"extra"},"设置规则如下：",-1)),e[9]||(e[9]=i("div",{class:"extra"},"1、如果添加的分类为一级分类A、B、C，则抽屉一级会显示：A/B/C三个链接，二级为A、B、C下的所有二级分类",-1)),e[10]||(e[10]=i("div",{class:"extra"}," 2、如果添加的分类为一级分类A和A下面的二级分类a1、a2，则，会显示A/a1/a2三个链接，二级为A下的所有二级分类（包含了a1、a2） ",-1)),e[11]||(e[11]=i("div",{class:"extra"},"3、如果重命名为“-”符号，则不会显示",-1))]),_:1}),l(s,{label:"热门品牌",prop:"brand_list"},{default:r(()=>[l(L,{modelValue:t.value.brand_list,"onUpdate:modelValue":e[1]||(e[1]=o=>t.value.brand_list=o),templateList:["brand_id"],templateListType:["number"],buttonName:"增加",buttonType:"primary",style:{width:"100%"}},{dynamicSlot:r(({item:o})=>[i("div",te,[l(U(K),{modelValue:o.brand_id,"onUpdate:modelValue":p=>o.brand_id=p,style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])])]),_:1},8,["modelValue"])]),_:1}),l(s,{label:"ICO编码",prop:"floor_ico_font"},{default:r(()=>[l(W,{modelValue:t.value.floor_ico_font,"onUpdate:modelValue":e[2]||(e[2]=o=>t.value.floor_ico_font=o)},null,8,["modelValue"]),e[12]||(e[12]=i("div",{class:"extra"},'请先在Tigshop设置中的"接口设置"中设置"ico图标库地址"',-1))]),_:1}),l(s,{label:"排序",prop:"sort_order"},{default:r(()=>[l(n,{modelValue:t.value.sort_order,"onUpdate:modelValue":e[3]||(e[3]=o=>t.value.sort_order=o)},null,8,["modelValue"])]),_:1}),l(s,{label:"是否显示",prop:"is_show"},{default:r(()=>[l(E,{modelValue:t.value.is_show,"onUpdate:modelValue":e[4]||(e[4]=o=>t.value.is_show=o)},{default:r(()=>[l(x,{value:1},{default:r(()=>e[13]||(e[13]=[g("是")])),_:1}),l(x,{value:0},{default:r(()=>e[14]||(e[14]=[g("否")])),_:1})]),_:1},8,["modelValue"])]),_:1}),z(l(s,{"wrapper-col":{offset:4,span:16}},{default:r(()=>[l(I,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:C},{default:r(()=>e[15]||(e[15]=[g("提交")])),_:1},512)]),_:1},512),[[G,!u.isDialog]])]),_:1},8,["model"])),l(q,{spinning:m.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}});export{Ce as default};
