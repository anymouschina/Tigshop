import{d as q,i as f,p as F,q as M,I as N,j as x,o as I,g as D,dF as $,dT as P,C as Z,s as G,r as m,c as H,e as h,f as B,b as a,w as o,a3 as J,E as v,a4 as K,_ as Q}from"./index-DrbzVNl6.js";import"./SelectTimeInterval.vue_vue_type_style_index_0_scoped_207fe586_lang-MgR9Z6jO.js";import{a as W,c as X,e as Y}from"./authority-C-nKXejU.js";import"./index-CeQDmMxd.js";/* empty css                                                                    */import{D as ee}from"./DynamicList-Nrk8tyuf.js";/* empty css                                                                  *//* empty css                                                                              *//* empty css             */import{S as te}from"./SelectIco-CHo0EoOQ.js";import{u as ae}from"./menus-Cfe5Mqim.js";import"./time-Bh5UhrfW.js";import"./DialogForm.vue_vue_type_script_setup_true_lang-DqYSRv0_.js";const le=q({__name:"SelectAuthority",props:{authorityId:{type:[Number,Array],default:0},multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},adminType:{type:String,default:"admin"}},emits:["update:authorityId"],setup(V,{emit:C}){const i=V,U={label:"authorityName",value:"authorityId",children:"children",multiple:i.multiple,checkStrictly:!0},y=f([]),u=f(!1),r=f();f(!1);const g=C;F(()=>i.adminType,t=>{u.value=!1,p()}),M(()=>{i.authorityId&&p()});const p=async()=>{if(!u.value){u.value=!0;try{const t=await W({adminType:i.adminType});y.value=t,r.value=i.authorityId}catch(t){N.error(t.message)}}},_=t=>{if(i.multiple==!0){const b=t.map(c=>c[c.length-1]);g("update:authorityId",b)}else g("update:authorityId",t?t[t.length-1]:0)},S=t=>{t&&p()},w=()=>{i.multiple==!0?r.value=[]:r.value=0};return(t,b)=>(I(),x(D($),{class:"cascader",props:U,disabled:V.disabled,placeholder:"顶级权限",options:y.value,modelValue:r.value,"onUpdate:modelValue":b[0]||(b[0]=c=>r.value=c),clearable:"",onChange:_,onClear:w,onVisibleChange:S},null,8,["disabled","options","modelValue"]))}}),oe={class:"container"},ue={class:"content_wrapper"},re={class:"lyecs-form-table"},ne=q({__name:"Info",props:{id:{type:Number,default:0},parentId:{type:Number,default:0},act:{type:String,default:""},adminType:{type:String,default:"admin"},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(V,{expose:C,emit:i}){const U=P(),y=i,u=V,r=f(!0),g=Z().currentRoute.value.query,p=f(u.isDialog?u.act:String(g.act)),_=f(u.isDialog?u.id:Number(g.id)),S=p.value==="add"?"create":"update",w=G(),t=f({childAuth:[],adminType:u.isDialog?u.adminType:String(g.adminType),isShow:1}),b=async()=>{try{const s=await X(p.value,{id:_.value});Object.assign(t.value,s)}catch(s){N.error(s.message),y("close")}finally{r.value=!1}};M(()=>{p.value==="detail"?b():r.value=!1,S==="create"&&(t.value.parentId=u.parentId)});const c=async()=>{await w.value.validate();try{y("update:confirmLoading",!0);const s=await Y(S,{id:_.value,...t.value});y("submitCallback",s),N.success("操作成功"),U.mainMenu=await ae()}catch(s){N.error(s.message)}finally{y("update:confirmLoading",!1)}},E=()=>{c()},O=(s,e,d)=>{/^[a-zA-Z]+$/.test(e)?d():d(new Error("只能输入英文字母"))};return C({onFormSubmit:E}),(s,e)=>{const d=m("TigInput"),n=m("el-form-item"),T=m("el-radio"),L=m("el-radio-group"),k=m("el-space"),R=m("el-button"),z=m("el-form"),j=m("a-spin");return I(),H("div",oe,[h("div",ue,[h("div",re,[r.value?B("",!0):(I(),x(z,{key:0,ref_key:"formRef",ref:w,model:t.value,"label-width":"auto"},{default:o(()=>[a(n,{rules:[{required:!0,message:"权限名称不能为空!"}],label:"权限名称",prop:"authorityName"},{default:o(()=>[a(d,{classType:"tig-form-input",modelValue:t.value.authorityName,"onUpdate:modelValue":e[0]||(e[0]=l=>t.value.authorityName=l)},null,8,["modelValue"])]),_:1}),a(n,{rules:[{required:!0,message:"唯一编号不能为空!"},{validator:O,trigger:"blur"}],label:"唯一编号",prop:"authoritySn"},{default:o(()=>[a(d,{classType:"tig-form-input",modelValue:t.value.authoritySn,"onUpdate:modelValue":e[1]||(e[1]=l=>t.value.authoritySn=l)},null,8,["modelValue"]),e[9]||(e[9]=h("div",{class:"extra"},"只能为英文字母，推荐小驼峰，非目录权限则以Manage结尾，如：productManage",-1))]),_:1},8,["rules"]),a(n,{rules:[{required:!0,message:"路由地址不能为空!"}],label:"路由地址",prop:"routeLink"},{default:o(()=>[a(d,{classType:"tig-form-input",modelValue:t.value.routeLink,"onUpdate:modelValue":e[2]||(e[2]=l=>t.value.routeLink=l)},null,8,["modelValue"]),e[10]||(e[10]=h("div",{class:"extra"},"格式为 product/list/ 或 product/brand/list/",-1))]),_:1}),a(n,{label:"上级分类",prop:"parentId"},{default:o(()=>[r.value?B("",!0):(I(),x(D(le),{key:0,authorityId:t.value.parentId,"onUpdate:authorityId":e[3]||(e[3]=l=>t.value.parentId=l),multiple:!1,style:{width:"100%"},disabled:p.value=="add"&&!V.parentId,adminType:t.value.adminType},null,8,["authorityId","disabled","adminType"]))]),_:1}),t.value.parentId===0?(I(),x(n,{key:0,label:"ICO编码",prop:"authorityIco"},{default:o(()=>[a(te,{modelValue:t.value.authorityIco,"onUpdate:modelValue":e[4]||(e[4]=l=>t.value.authorityIco=l)},null,8,["modelValue"]),e[11]||(e[11]=h("div",{class:"extra"},'请先在Tigshop设置中的"接口设置"中设置"ico图标库地址"',-1))]),_:1})):B("",!0),a(n,{label:"排序",prop:"sortOrder"},{default:o(()=>[a(d,{classType:"tig-form-input",TigInput:"",type:"integer",modelValue:t.value.sortOrder,"onUpdate:modelValue":e[5]||(e[5]=l=>t.value.sortOrder=l)},null,8,["modelValue"])]),_:1}),a(n,{label:"权限所属系统",prop:"adminType"},{default:o(()=>[a(L,{modelValue:t.value.adminType,"onUpdate:modelValue":e[6]||(e[6]=l=>t.value.adminType=l),disabled:""},{default:o(()=>[a(T,{value:"admin"},{default:o(()=>e[12]||(e[12]=[v("管理后台")])),_:1}),a(T,{value:"shop"},{default:o(()=>e[13]||(e[13]=[v("店铺后台")])),_:1})]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"是否显示",prop:"isShow"},{default:o(()=>[a(L,{modelValue:t.value.isShow,"onUpdate:modelValue":e[7]||(e[7]=l=>t.value.isShow=l)},{default:o(()=>[a(T,{value:1},{default:o(()=>e[14]||(e[14]=[v("是")])),_:1}),a(T,{value:0},{default:o(()=>e[15]||(e[15]=[v("否")])),_:1})]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"细分权限"},{default:o(()=>[a(D(ee),{modelValue:t.value.childAuth,"onUpdate:modelValue":e[8]||(e[8]=l=>t.value.childAuth=l),templateList:["authName","authSn"],buttonName:"新增细分权限"},{dynamicSlot:o(l=>[a(k,{size:16},{default:o(()=>[a(k,{size:0},{default:o(()=>[e[16]||(e[16]=v(" 权限名称： ")),a(d,{modelValue:l.item.authName,"onUpdate:modelValue":A=>l.item.authName=A,placeholder:"权限名称",style:{width:"100px"}},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),a(k,{size:0},{default:o(()=>[e[17]||(e[17]=v(" 权限编码： ")),a(d,{modelValue:l.item.authSn,"onUpdate:modelValue":A=>l.item.authSn=A,placeholder:"权限编码",style:{width:"100px"}},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:1},8,["modelValue"])]),_:1}),J(a(n,{"wrapper-col":{offset:4,span:16}},{default:o(()=>[a(R,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:c},{default:o(()=>e[18]||(e[18]=[v("提交 ")])),_:1},512)]),_:1},512),[[K,!u.isDialog]])]),_:1},8,["model"])),a(j,{spinning:r.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}}),Ie=Q(ne,[["__scopeId","data-v-000baf75"]]);export{Ie as default};
