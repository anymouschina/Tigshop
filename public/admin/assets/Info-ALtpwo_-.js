import{d as E,s as W,i as _,C as K,G as P,q as Y,r as s,c as x,o as C,e as n,b as t,w as a,g as U,bh as Z,E as v,D as B,f as $,I as y,_ as z}from"./index-CGYuOau0.js";import{a as A,u as H}from"./levelManage-DUMhrtzb.js";import{F as J}from"./UploadAvatar.vue_vue_type_style_index_0_scoped_9bfcfc35_lang-CjXfTDg5.js";import"./index-B-GURfkM.js";import"./vuedraggable.umd-_1km55l4.js";import"./Image.vue_vue_type_script_setup_true_lang-D9PqZe9n.js";import"./format-DFT-VJzO.js";import"./config-DNllFJyR.js";import"./config-DU8_t5BN.js";import"./DialogForm.vue_vue_type_script_setup_true_lang-Bmm-M6gU.js";const ee={class:"container"},te={class:"content_wrapper"},ae={class:"lyecs-form-table"},oe={class:"flex mb10"},le={class:"flex"},se={class:"level_txt"},ne={class:"flex flex-align-center"},ie={key:0},re=E({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(V,{expose:D,emit:N}){const d=N,p=V,c=W(),m=_(!0),b=K().currentRoute.value.query,f=_(p.isDialog?p.act:String(b.act)),S=_(p.isDialog?p.id:Number(b.id)),q=f.value==="add"?"create":"update",M={2:"铂金会员",3:"黑金会员",4:"钻石会员",5:"至尊会员"},e=_({data:[{rank_level:1,rank_name:"黄金会员",rank_logo:"https://oss.tigshop.com/img/gallery/202501/1735803176Yh9mCaE2r9ebXK3bGm.png"}]}),k=P({rank_name:[{required:!0,message:"请输入",trigger:"blur"}]}),R=async()=>{try{m.value=!0;const o=await A(f.value);e.value.data=o.item.user_rank_list}catch(o){y.error(o.message),d("close")}finally{m.value=!1}},T=["https://oss.tigshop.com/img/gallery/202501/1737524324ro1DJxNm3aQowZKnPU.png","https://oss.tigshop.com/img/gallery/202501/1737524324ZUrDWMFqTPMBTCOlhg.png","https://oss.tigshop.com/img/gallery/202501/1737524324ptLNB2WynLJBBwSHHj.png","https://oss.tigshop.com/img/gallery/202501/1737524324hhmoz188M0ejyXEBhT.png","https://oss.tigshop.com/img/gallery/202501/1737524324O1BXVeurAyDMj9QG8f.png","https://oss.tigshop.com/img/gallery/202501/1737524324T7eKXTpMiCeVQOyFb6.png","https://oss.tigshop.com/img/gallery/202501/1737524324bUufpiVaGcaUad1CWd.png","https://oss.tigshop.com/img/gallery/202501/1737524324NhZbUn45wj1eSaIbjY.png","https://oss.tigshop.com/img/gallery/202501/1737524324bv68MBsoQXa2rLUO9i.png","https://oss.tigshop.com/img/gallery/202501/1737524324urqONY3QDjaTqW7d56.png"],j=async()=>{if(await c.value.validate(),e.value.data.length<=10){let o={rank_level:e.value.data.length+1,rank_name:M[e.value.data.length+1],rank_logo:T[e.value.data.length]};e.value.data.push(o),await c.value.validate()}},F=o=>{e.value.data.splice(o,1)};Y(()=>{f.value==="detail"?R():m.value=!1});const I=async()=>{await c.value.validate();try{d("update:confirmLoading",!0);const o=await H(q,{id:S.value,...e.value});d("submitCallback",o),y.success(o.message)}catch(o){y.error(o.message)}finally{d("update:confirmLoading",!1)}};return D({onFormSubmit:()=>{I()}}),(o,i)=>{const w=s("el-button"),h=s("el-form-item"),u=s("el-table-column"),L=s("el-image"),G=s("el-tooltip"),O=s("el-input"),Q=s("el-table"),X=s("el-form");return C(),x("div",ee,[n("div",te,[n("div",ae,[i[2]||(i[2]=n("div",{class:"title"},"等级方案",-1)),t(X,{ref_key:"formRef",ref:c,rules:k,model:e.value,"label-width":"auto"},{default:a(()=>[t(h,{prop:"data",style:{"margin-bottom":"0"}},{default:a(()=>[n("div",oe,[n("div",le,[t(w,{type:"primary",icon:U(Z),link:"",onClick:j,disabled:e.value.data.length>=10},{default:a(()=>[v(B(e.value.data.length>=10?"多添加10级":`添加等级(${e.value.data.length}/10)`),1)]),_:1},8,["icon","disabled"])])])]),_:1}),t(h,{prop:"data"},{default:a(()=>[t(Q,{data:e.value.data,loading:m.value,"row-key":"user_id"},{default:a(()=>[t(u,{width:120,label:"等级",prop:"level"},{default:a(({row:l,$index:r})=>[n("div",se,"vip"+B(l.rank_level),1)]),_:1}),t(u,{width:130,label:"会员图标",prop:"rank_logo",align:"center"},{default:a(({row:l,$index:r})=>[t(G,{effect:"light",placement:"bottom","show-after":150},{content:a(()=>i[0]||(i[0]=[v(" 点击修改 ")])),default:a(()=>[n("div",null,[t(U(J),{photo:l.rank_logo,"onUpdate:photo":g=>l.rank_logo=g,type:2},{default:a(()=>[t(L,{style:{height:"20px"},src:l.rank_logo},null,8,["src"])]),_:2},1032,["photo","onUpdate:photo"])])]),_:2},1024)]),_:1}),t(u,{width:300,label:"会员名称*",prop:"rank_name"},{default:a(({row:l,$index:r})=>[t(h,{prop:"data."+r+".rank_name",rules:k.rank_name},{default:a(()=>[n("div",ne,[t(O,{modelValue:l.rank_name,"onUpdate:modelValue":g=>l.rank_name=g,style:{width:"100px"}},null,8,["modelValue","onUpdate:modelValue"])])]),_:2},1032,["prop","rules"])]),_:1}),t(u,{fixed:"right",width:80,label:"操作",class:"setBtn"},{default:a(({row:l,$index:r})=>[r===e.value.data.length-1&&e.value.data.length>1?(C(),x("div",ie,[t(w,{type:"text",size:"mini",onClick:g=>F(r)},{default:a(()=>i[1]||(i[1]=[v("删除")])),_:2},1032,["onClick"])])):$("",!0)]),_:1})]),_:1},8,["data","loading"])]),_:1})]),_:1},8,["rules","model"])])])])}}}),be=z(re,[["__scopeId","data-v-8609fd84"]]);export{be as default};
