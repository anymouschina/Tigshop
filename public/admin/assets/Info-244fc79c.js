import{d as j,j as c,E,s as F,x as H,r as l,o as w,c as I,e as V,k as K,w as o,b as a,H as p,$ as M,a0 as O,h as T,K as d}from"./index-7c2d2aef.js";import{c as $,a as z,e as A}from"./region-05802f67.js";import{u as G}from"./region-e0d291a6.js";const J={class:"container"},P={class:"content_wrapper"},Q={class:"lyecs-form-table"},ee=j({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},isDialog:Boolean,region_id:{type:Number,default:0}},emits:["submitCallback","update:confirmLoading","close"],setup(R,{expose:k,emit:S}){const x=G(),i=S,n=R,u=c(!0),f=E().currentRoute.value.query,_=c(n.isDialog?n.act:String(f.act)),g=c(n.isDialog?n.id:Number(f.id)),C=_.value==="add"?"create":"update",v=F(),t=c({is_hot:0}),N=async()=>{try{const e=await $(_.value,{id:g.value});Object.assign(t.value,e.item)}catch(e){d.error(e.message),i("close")}finally{u.value=!1}},B=async()=>{try{const e=await z({region_id:n.region_id});e.filter_result&&e.filter_result.length>0?(t.value.parent_id=e.filter_result[0].region_id,t.value.parent_name=e.filter_result[0].region_name):(t.value.parent_id=0,t.value.parent_name="顶级地区")}catch(e){d.error(e.message)}};H(()=>{_.value==="detail"?N():u.value=!1,B()});const b=async()=>{await v.value.validate();try{i("update:confirmLoading",!0);const e=await A(C,{id:g.value,...t.value});x.clearRegion(),i("submitCallback",e),d.success(e.message)}catch(e){d.error(e.message)}finally{i("update:confirmLoading",!1)}};return k({onFormSubmit:()=>{b()}}),(e,s)=>{const y=l("el-input"),m=l("el-form-item"),h=l("el-radio"),D=l("el-radio-group"),L=l("el-button"),q=l("el-form"),U=l("a-spin");return w(),I("div",J,[V("div",P,[V("div",Q,[u.value?T("",!0):(w(),K(q,{key:0,ref_key:"formRef",ref:v,model:t.value,"label-width":"auto"},{default:o(()=>[a(m,{rules:[{required:!0,message:"地区名称不能为空!"}],label:"地区名称",prop:"region_name"},{default:o(()=>[a(y,{modelValue:t.value.region_name,"onUpdate:modelValue":s[0]||(s[0]=r=>t.value.region_name=r)},null,8,["modelValue"])]),_:1}),a(m,{label:"上级地区",prop:"parent_name"},{default:o(()=>[a(y,{disabled:"",modelValue:t.value.parent_name,"onUpdate:modelValue":s[1]||(s[1]=r=>t.value.parent_name=r)},null,8,["modelValue"])]),_:1}),a(m,{label:"是否热门",prop:"is_hot"},{default:o(()=>[a(D,{modelValue:t.value.is_hot,"onUpdate:modelValue":s[2]||(s[2]=r=>t.value.is_hot=r),style:{width:"100%"}},{default:o(()=>[a(h,{value:1},{default:o(()=>[p("是")]),_:1}),a(h,{value:0},{default:o(()=>[p("否")]),_:1})]),_:1},8,["modelValue"])]),_:1}),M(a(m,{"wrapper-col":{offset:4,span:16}},{default:o(()=>[a(L,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:b},{default:o(()=>[p("提交")]),_:1},512)]),_:1},512),[[O,!n.isDialog]])]),_:1},8,["model"])),a(U,{spinning:u.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}});export{ee as default};
