import{d as E,j as c,v as F,x as L,K as C,o as V,k as U,f as T,dg as H,dm as K,E as P,s as Z,r as _,c as G,e as b,w as l,b as t,h as D,H as v,$ as J,a0 as Q,p as W,i as X,_ as Y}from"./index-7c2d2aef.js";import"./SelectTimeInterval.vue_vue_type_style_index_0_scoped_207fe586_lang-b4d9216b.js";import"./category-a8bd4d11.js";import{a as ee,c as te,e as ae}from"./authority-44614dad.js";import"./index-6c62cf9b.js";import"./config-9548fa9b.js";import{D as le}from"./DynamicList-d16d6b61.js";/* empty css                                                                    *//* empty css                                                                  *//* empty css                                                                              */import"./region-e0d291a6.js";import"./shopProductCategory-792e0c23.js";/* empty css             */import{S as oe}from"./SelectIco-7f1b5693.js";import{u as ue}from"./menus-a5eaec1a.js";import"./time-290942a2.js";import"./util-1ee03ed8.js";import"./config-e2aa16d1.js";import"./region-05802f67.js";import"./DialogForm.vue_vue_type_script_setup_true_lang-c57b9a11.js";const ie=E({__name:"SelectAuthority",props:{authority_id:{type:[Number,Array],default:0},multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},adminType:{type:String,default:"admin"}},emits:["update:authority_id"],setup(n,{emit:I}){const d=n,N={label:"authority_name",value:"authority_id",children:"children",multiple:d.multiple,checkStrictly:!0},f=c([]),u=c(!1),i=c();c(!1);const h=I;F(()=>d.adminType,e=>{u.value=!1,m()}),L(()=>{d.authority_id&&m()});const m=async()=>{if(!u.value){u.value=!0;try{const e=await ee({admin_type:d.adminType});f.value=e.item,i.value=d.authority_id}catch(e){C.error(e.message)}}},w=e=>{if(d.multiple==!0){const g=e.map(y=>y[y.length-1]);h("update:authority_id",g)}else h("update:authority_id",e?e[e.length-1]:0)},S=e=>{e&&m()},x=()=>{d.multiple==!0?i.value=[]:i.value=0};return(e,g)=>(V(),U(T(H),{class:"cascader",props:N,disabled:n.disabled,placeholder:"顶级权限",options:f.value,modelValue:i.value,"onUpdate:modelValue":g[0]||(g[0]=y=>i.value=y),clearable:"",onChange:w,onClear:x,onVisibleChange:S},null,8,["disabled","options","modelValue"]))}}),M=n=>(W("data-v-30f81c82"),n=n(),X(),n),se={class:"container"},re={class:"content_wrapper"},ne={class:"lyecs-form-table"},de=M(()=>b("div",{class:"extra"},"只能为英文字母，推荐小驼峰，非目录权限则以Manage结尾，如：productManage",-1)),pe=M(()=>b("div",{class:"extra"},"格式为 product/list/ 或 product/brand/list/",-1)),me=M(()=>b("div",{class:"extra"},'请先在Tigshop设置中的"接口设置"中设置"ico图标库地址"',-1)),_e=E({__name:"Info",props:{id:{type:Number,default:0},parentId:{type:Number,default:0},act:{type:String,default:""},admin_type:{type:String,default:"admin"},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(n,{expose:I,emit:d}){const N=K(),f=d,u=n,i=c(!0),h=P().currentRoute.value.query,m=c(u.isDialog?u.act:String(h.act)),w=c(u.isDialog?u.id:Number(h.id)),S=m.value==="add"?"create":"update",x=Z(),e=c({child_auth:[],admin_type:u.isDialog?u.admin_type:String(h.admin_type),is_show:1}),g=async()=>{try{const r=await te(m.value,{id:w.value});Object.assign(e.value,r.item)}catch(r){C.error(r.message),f("close")}finally{i.value=!1}};L(()=>{m.value==="detail"?g():i.value=!1,S==="create"&&(e.value.parent_id=u.parentId)});const y=async()=>{await x.value.validate();try{f("update:confirmLoading",!0);const r=await ae(S,{id:w.value,...e.value});f("submitCallback",r),C.success(r.message),N.mainMenu=await ue()}catch(r){C.error(r.message)}finally{f("update:confirmLoading",!1)}},R=()=>{y()},z=(r,o,p)=>{/^[a-zA-Z]+$/.test(o)?p():p(new Error("只能输入英文字母"))};return I({onFormSubmit:R}),(r,o)=>{const p=_("el-input"),s=_("el-form-item"),k=_("el-radio"),q=_("el-radio-group"),A=_("el-space"),$=_("el-button"),j=_("el-form"),O=_("a-spin");return V(),G("div",se,[b("div",re,[b("div",ne,[i.value?D("",!0):(V(),U(j,{key:0,ref_key:"formRef",ref:x,model:e.value,"label-width":"auto"},{default:l(()=>[t(s,{rules:[{required:!0,message:"权限名称不能为空!"}],label:"权限名称",prop:"authority_name"},{default:l(()=>[t(p,{modelValue:e.value.authority_name,"onUpdate:modelValue":o[0]||(o[0]=a=>e.value.authority_name=a)},null,8,["modelValue"])]),_:1}),t(s,{rules:[{required:!0,message:"唯一编号不能为空!"},{validator:z,trigger:"blur"}],label:"唯一编号",prop:"authority_sn"},{default:l(()=>[t(p,{modelValue:e.value.authority_sn,"onUpdate:modelValue":o[1]||(o[1]=a=>e.value.authority_sn=a)},null,8,["modelValue"]),de]),_:1},8,["rules"]),t(s,{rules:[{required:!0,message:"路由地址不能为空!"}],label:"路由地址",prop:"route_link"},{default:l(()=>[t(p,{modelValue:e.value.route_link,"onUpdate:modelValue":o[2]||(o[2]=a=>e.value.route_link=a)},null,8,["modelValue"]),pe]),_:1}),t(s,{label:"上级分类",prop:"parent_id"},{default:l(()=>[i.value?D("",!0):(V(),U(T(ie),{key:0,authority_id:e.value.parent_id,"onUpdate:authority_id":o[3]||(o[3]=a=>e.value.parent_id=a),multiple:!1,style:{width:"100%"},disabled:m.value=="add"&&!n.parentId,adminType:e.value.admin_type},null,8,["authority_id","disabled","adminType"]))]),_:1}),e.value.parent_id===0?(V(),U(s,{key:0,label:"ICO编码",prop:"authority_ico"},{default:l(()=>[t(oe,{modelValue:e.value.authority_ico,"onUpdate:modelValue":o[4]||(o[4]=a=>e.value.authority_ico=a)},null,8,["modelValue"]),me]),_:1})):D("",!0),t(s,{label:"排序",prop:"sort_order"},{default:l(()=>[t(p,{modelValue:e.value.sort_order,"onUpdate:modelValue":o[5]||(o[5]=a=>e.value.sort_order=a)},null,8,["modelValue"])]),_:1}),t(s,{label:"权限所属系统",prop:"admin_type"},{default:l(()=>[t(q,{modelValue:e.value.admin_type,"onUpdate:modelValue":o[6]||(o[6]=a=>e.value.admin_type=a),disabled:""},{default:l(()=>[t(k,{value:"admin"},{default:l(()=>[v("管理后台")]),_:1}),t(k,{value:"shop"},{default:l(()=>[v("店铺后台")]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(s,{label:"是否显示",prop:"is_show"},{default:l(()=>[t(q,{modelValue:e.value.is_show,"onUpdate:modelValue":o[7]||(o[7]=a=>e.value.is_show=a)},{default:l(()=>[t(k,{value:1},{default:l(()=>[v("是")]),_:1}),t(k,{value:0},{default:l(()=>[v("否")]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(s,{label:"细分权限"},{default:l(()=>[t(T(le),{modelValue:e.value.child_auth,"onUpdate:modelValue":o[8]||(o[8]=a=>e.value.child_auth=a),templateList:["auth_name","auth_sn"],buttonName:"新增细分权限"},{dynamicSlot:l(a=>[t(A,{size:16},{default:l(()=>[t(A,{size:0},{default:l(()=>[v(" 权限名称： "),t(p,{modelValue:a.item.auth_name,"onUpdate:modelValue":B=>a.item.auth_name=B,placeholder:"权限名称",style:{width:"100px"}},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(A,{size:0},{default:l(()=>[v(" 权限编码： "),t(p,{modelValue:a.item.auth_sn,"onUpdate:modelValue":B=>a.item.auth_sn=B,placeholder:"权限编码",style:{width:"100px"}},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:1},8,["modelValue"])]),_:1}),J(t(s,{"wrapper-col":{offset:4,span:16}},{default:l(()=>[t($,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:y},{default:l(()=>[v("提交 ")]),_:1},512)]),_:1},512),[[Q,!u.isDialog]])]),_:1},8,["model"])),t(O,{spinning:i.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}});const Me=Y(_e,[["__scopeId","data-v-30f81c82"]]);export{Me as default};
