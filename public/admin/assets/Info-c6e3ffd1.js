import{d as H,j as y,E as K,s as M,x as O,K as $,r as _,o as c,c as V,e as r,k,w as a,b as e,F as I,a as U,H as x,$ as z,a0 as G,h as J,p as Q,i as W,_ as X}from"./index-7c2d2aef.js";import{a as Y,c as Z}from"./productAttributesTpl-24fae2a8.js";const A=d=>(Q("data-v-1fe49f44"),d=d(),W(),d),ee={class:"container"},te={class:"content_wrapper"},ae={class:"lyecs-form-table"},le={class:"attr-warp-box"},oe=["onClick"],se=A(()=>r("i",{class:"btn-ico"},"+",-1)),ne={class:"attr-warp-box"},re=["onClick"],ue=A(()=>r("i",{class:"btn-ico"},"+",-1)),ie={class:"attr-warp-box"},ce=["onClick"],de=A(()=>r("i",{class:"btn-ico"},"+",-1)),me=H({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(d,{expose:L,emit:T}){const v=T,b=d,h=y(!0),B=K().currentRoute.value.query,C=y(b.isDialog?b.act:String(B.act)),D=y(b.isDialog?b.id:Number(B.id)),j=C.value==="add"?"create":"update",R=M(),l=y({});O(()=>{C.value==="detail"?q():h.value=!1});const q=async()=>{try{const t=await Y(C.value,{id:D.value});Object.assign(l.value,t.item)}catch(t){$.error(t.message),v("close")}finally{h.value=!1}},S=(t,o)=>{l.value.tpl_data[t].splice(o,1)},N=t=>{if(l.value.tpl_data)Array.isArray(l.value.tpl_data[t])||(l.value.tpl_data[t]=[]);else{let o={};o[t]=[],l.value.tpl_data=o}l.value.tpl_data[t].push({attr_name:""})},F=async()=>{await R.value.validate();try{console.log(l.value),v("update:confirmLoading",!0);const t=await Z(j,{id:D.value,...l.value});v("submitCallback",t),$.success(t.message)}catch(t){$.error(t.message)}finally{v("update:confirmLoading",!1)}};return L({onFormSubmit:()=>{F()}}),(t,o)=>{const w=_("el-input"),p=_("el-form-item"),m=_("el-space"),g=_("el-button"),E=_("el-form"),P=_("a-spin");return c(),V("div",ee,[r("div",te,[r("div",ae,[h.value?J("",!0):(c(),k(E,{key:0,ref_key:"formRef",ref:R,model:l.value,"label-width":"auto"},{default:a(()=>[e(p,{rules:[{required:!0,message:"属性模板名称不能为空!"}],label:"属性模板名称",prop:"tpl_name"},{default:a(()=>[e(w,{modelValue:l.value.tpl_name,"onUpdate:modelValue":o[0]||(o[0]=s=>l.value.tpl_name=s)},null,8,["modelValue"])]),_:1}),e(p,{label:"属性名称",prop:"brand_logo"},{default:a(()=>{var s,u;return[r("div",le,[(c(!0),V(I,null,U((u=(s=l.value)==null?void 0:s.tpl_data)==null?void 0:u.normal,(n,f)=>(c(),k(m,{class:"attr-row"},{default:a(()=>[e(w,{modelValue:n.attr_name,"onUpdate:modelValue":i=>n.attr_name=i,placeholder:"",style:{width:"260px"}},null,8,["modelValue","onUpdate:modelValue"]),r("div",{class:"iconfont icon-cha1 btn-remove",onClick:i=>S("normal",Number(f))},null,8,oe)]),_:2},1024))),256)),e(m,{class:"attr-row"},{default:a(()=>[e(g,{onClick:o[1]||(o[1]=n=>N("normal"))},{default:a(()=>[se,x("增加新属性")]),_:1})]),_:1})])]}),_:1}),e(p,{label:"规格名称"},{default:a(()=>{var s,u;return[r("div",ne,[(c(!0),V(I,null,U((u=(s=l.value)==null?void 0:s.tpl_data)==null?void 0:u.spe,(n,f)=>(c(),k(m,{class:"attr-row"},{default:a(()=>[e(w,{modelValue:n.attr_name,"onUpdate:modelValue":i=>n.attr_name=i,placeholder:"",style:{width:"260px"}},null,8,["modelValue","onUpdate:modelValue"]),r("div",{class:"iconfont icon-cha1 btn-remove",onClick:i=>S("spe",Number(f))},null,8,re)]),_:2},1024))),256)),e(m,{class:"attr-row"},{default:a(()=>[e(g,{onClick:o[2]||(o[2]=n=>N("spe"))},{default:a(()=>[ue,x("增加新规格")]),_:1})]),_:1})])]}),_:1}),e(p,{label:"附加规格"},{default:a(()=>{var s,u;return[r("div",ie,[(c(!0),V(I,null,U((u=(s=l.value)==null?void 0:s.tpl_data)==null?void 0:u.extra,(n,f)=>(c(),k(m,{class:"attr-row"},{default:a(()=>[e(w,{modelValue:n.attr_name,"onUpdate:modelValue":i=>n.attr_name=i,placeholder:"",style:{width:"260px"}},null,8,["modelValue","onUpdate:modelValue"]),r("div",{class:"iconfont icon-cha1 btn-remove",onClick:i=>S("extra",Number(f))},null,8,ce)]),_:2},1024))),256)),e(m,{class:"attr-row"},{default:a(()=>[e(g,{onClick:o[3]||(o[3]=n=>N("extra"))},{default:a(()=>[de,x("增加附加规格")]),_:1})]),_:1})])]}),_:1}),z(e(p,{"wrapper-col":{offset:4,span:16}},{default:a(()=>[e(g,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:o[4]||(o[4]=s=>F())},{default:a(()=>[x("提交 ")]),_:1},512)]),_:1},512),[[G,!d.isDialog]])]),_:1},8,["model"])),e(P,{spinning:h.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}});const ve=X(me,[["__scopeId","data-v-1fe49f44"]]);export{ve as default};
