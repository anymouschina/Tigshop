import{d as F,j as u,E as L,s as M,x as j,r as i,o as V,c as E,e as _,k as $,w as a,b as t,f as h,H as f,$ as A,a0 as G,h as H,K as m}from"./index-7c2d2aef.js";import{F as I}from"./UploadAvatar.vue_vue_type_style_index_0_scoped_9bfcfc35_lang-9b6073fb.js";import{a as K,b as O}from"./material-3027f8a4.js";import{_ as P}from"./selectCategory.vue_vue_type_script_setup_true_lang-eb911e44.js";import"./SelectTimeInterval.vue_vue_type_style_index_0_scoped_207fe586_lang-b4d9216b.js";import"./category-a8bd4d11.js";import"./index-6c62cf9b.js";import"./config-9548fa9b.js";import{S as T}from"./SelectProduct-5f7c1e31.js";/* empty css                                                                    *//* empty css                                                                              */import"./region-e0d291a6.js";import"./shopProductCategory-792e0c23.js";/* empty css             */import"./vuedraggable.umd-75ad0f8f.js";import"./Image.vue_vue_type_script_setup_true_lang-36bd437b.js";import"./format-4e0206d3.js";import"./util-1ee03ed8.js";import"./DialogForm.vue_vue_type_script_setup_true_lang-c57b9a11.js";import"./category-201d31a3.js";import"./time-290942a2.js";import"./config-e2aa16d1.js";import"./product-689c7c1e.js";import"./Pagination-8eb7b6b1.js";import"./SelectSku-94aa3072.js";/* empty css                                                                  */import"./region-05802f67.js";const z={class:"container"},J={class:"content_wrapper"},Q={class:"lyecs-form-table"},W={class:"lyecs-form-table"},xe=F({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(k,{expose:S,emit:x}){const p=x,n=k;u(1);const d=u(!0),v=L().currentRoute.value.query,c=u(n.isDialog?n.act:String(v.act)),g=u(n.isDialog?n.id:Number(v.id)),B=c.value==="add"?"create":"update",b=M(),e=u({is_top:0,content:""}),C=async()=>{try{const o=await K(c.value,{id:g.value});o.item.product_id&&(o.item.product_id=[o.item.product_id]),Object.assign(e.value,o.item)}catch(o){m.error(o.message),p("close")}finally{d.value=!1}};j(()=>{c.value==="detail"?C():d.value=!1});const y=async()=>{if(await b.value.validate(),e.value.product_id&&e.value.product_id.length>0)e.value.product_id=e.value.product_id[0];else{m.error("请选择商品!");return}try{p("update:confirmLoading",!0);const o=await O(B,{id:g.value,...e.value});p("submitCallback",o),m.success(o.message)}catch(o){m.error(o.message)}finally{p("update:confirmLoading",!1)}};return S({onFormSubmit:()=>{y()}}),(o,r)=>{const s=i("el-form-item"),q=i("el-input"),w=i("el-radio"),N=i("el-radio-group"),D=i("el-button"),R=i("el-form"),U=i("a-spin");return V(),E("div",z,[_("div",J,[_("div",Q,[_("div",W,[d.value?H("",!0):(V(),$(R,{key:0,ref_key:"formRef",ref:b,model:e.value,"label-width":"auto"},{default:a(()=>[t(s,{label:"素材图片",prop:"pics",rules:[{required:!0,message:"素材图片不能为空!"}]},{default:a(()=>[t(h(I),{photos:e.value.pics,"onUpdate:photos":r[0]||(r[0]=l=>e.value.pics=l),isMultiple:""},null,8,["photos"])]),_:1}),t(s,{rules:[{required:!0,message:"素材内容不能为空!"}],label:"素材内容",prop:"content"},{default:a(()=>[t(q,{modelValue:e.value.content,"onUpdate:modelValue":r[1]||(r[1]=l=>e.value.content=l),rows:2,type:"textarea"},null,8,["modelValue"])]),_:1}),t(s,{label:"素材分类",prop:"category_id",rules:[{required:!0,message:"请选择素材分类!"}]},{default:a(()=>[t(P,{category_id:e.value.category_id,"onUpdate:category_id":r[2]||(r[2]=l=>e.value.category_id=l)},null,8,["category_id"])]),_:1}),t(s,{label:"选择商品",prop:"product_id",rules:[{required:!0,message:"请选择商品!"}]},{default:a(()=>[t(h(T),{isMultiple:!1,ids:e.value.product_id,"onUpdate:ids":r[3]||(r[3]=l=>e.value.product_id=l)},null,8,["ids"])]),_:1}),t(s,{label:"是否置顶",prop:"is_top"},{default:a(()=>[t(N,{modelValue:e.value.is_top,"onUpdate:modelValue":r[4]||(r[4]=l=>e.value.is_top=l)},{default:a(()=>[t(w,{value:1},{default:a(()=>[f("置顶")]),_:1}),t(w,{value:0},{default:a(()=>[f("不置顶")]),_:1})]),_:1},8,["modelValue"])]),_:1}),A(t(s,{"wrapper-col":{offset:4,span:16}},{default:a(()=>[t(D,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:y},{default:a(()=>[f("提交")]),_:1},512)]),_:1},512),[[G,!n.isDialog]])]),_:1},8,["model"]))]),t(U,{spinning:d.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}});export{xe as default};
