import{d as G,i as p,C as W,s as J,q as Q,I as D,r as i,c as g,o as r,e as f,f as k,j as v,b as l,w as o,a3 as X,g as w,E as s,F as Z,a as h,D as T,M as ee,a4 as te,A as le,_ as oe}from"./index-DrbzVNl6.js";import"./index-CeQDmMxd.js";import{F}from"./UploadAvatar.vue_vue_type_style_index_0_scoped_9bfcfc35_lang-BDvYUQtN.js";import"./vuedraggable.umd-DAKh-e3Q.js";import{a as ae,c as se}from"./comment-BsJ8TlD5.js";import"./SelectTimeInterval.vue_vue_type_style_index_0_scoped_207fe586_lang-MgR9Z6jO.js";import{S as ue}from"./SelectProduct-BHvR_Ddk.js";/* empty css                                                                    *//* empty css                                                                              *//* empty css             */import{_ as ne}from"./DialogForm.vue_vue_type_script_setup_true_lang-DqYSRv0_.js";import"./Image.vue_vue_type_script_setup_true_lang-BWzCs9jv.js";import"./format-CRgx78oe.js";import"./time-Bh5UhrfW.js";import"./product-DEi2MlvQ.js";import"./Pagination-wR9huHyl.js";import"./SelectSku--IXQGnUO.js";/* empty css                                                                  */const re={class:"container"},de={class:"content_wrapper"},ie={class:"lyecs-form-table"},me={class:"flex flex-wrap"},pe={key:0,class:"container-card"},fe={class:"title"},ve={key:0},ce={key:1},ye={style:{"text-align":"end","margin-top":"10px"}},ge=G({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(N,{expose:q,emit:L}){const _=L,c=N,m=p(!0),U=W().currentRoute.value.query,b=p(c.isDialog?c.act:String(U.act)),x=p(c.isDialog?c.id:Number(U.id)),H=b.value==="add"?"create":"update",S=J(),t=p({commentRank:5,isRecommend:1,isTop:0,sortOrder:50,productIds:[],commentTag:[]}),y=p(""),I=p(!1),M=p(),P=u=>{t.value.commentTag.splice(t.value.commentTag.indexOf(u),1)},z=()=>{I.value=!0,le(()=>{M.value.input.focus()})},Y=()=>{y.value&&t.value.commentTag.push(y.value),I.value=!1,y.value=""};Q(()=>{b.value==="detail"?B():m.value=!1});const B=async()=>{try{const u=await ae(b.value,{id:x.value});let e=[];u.productId&&(e=[u.productId]),Object.assign(t.value,u,{productIds:e})}catch(u){D.error(u.message),_("close")}finally{m.value=!1}},E=()=>{B()},O=async()=>{await S.value.validate();try{_("update:confirmLoading",!0);let u=0;t.value.productIds.length>0&&(u=t.value.productIds[0]);const e=await se(H,{id:x.value,...t.value,productId:u});_("submitCallback",e),D.success("操作成功")}catch(u){D.error(u.message)}finally{_("update:confirmLoading",!1)}};return q({onFormSubmit:()=>{O()}}),(u,e)=>{const n=i("el-form-item"),V=i("TigInput"),d=i("el-radio"),C=i("el-radio-group"),$=i("el-tag"),R=i("el-button"),j=i("el-date-picker"),A=i("el-form"),K=i("a-spin");return r(),g("div",re,[f("div",de,[f("div",ie,[m.value?k("",!0):(r(),v(A,{key:0,ref_key:"formRef",ref:S,model:t.value,"label-width":"auto"},{default:o(()=>[l(n,{label:"评论商品",prop:"productIds"},{default:o(()=>[m.value?k("",!0):(r(),v(w(ue),{key:0,isMultiple:!1,ids:t.value.productIds,"onUpdate:ids":e[0]||(e[0]=a=>t.value.productIds=a)},null,8,["ids"]))]),_:1}),l(n,{rules:[{required:!0,message:"会员名称不能为空!"}],label:"会员名称",prop:"username"},{default:o(()=>[l(V,{classType:"tig-form-input",modelValue:t.value.username,"onUpdate:modelValue":e[1]||(e[1]=a=>t.value.username=a)},null,8,["modelValue"])]),_:1}),l(n,{label:"会员头像",prop:"avatar"},{default:o(()=>[l(w(F),{photo:t.value.avatar,"onUpdate:photo":e[2]||(e[2]=a=>t.value.avatar=a)},null,8,["photo"]),e[12]||(e[12]=f("div",{class:"extra"},"请统一上传比例为1:1的图片，宽100px，高100px（高清））",-1))]),_:1}),l(n,{label:"评论星级",prop:"commentRank"},{default:o(()=>[l(C,{modelValue:t.value.commentRank,"onUpdate:modelValue":e[3]||(e[3]=a=>t.value.commentRank=a)},{default:o(()=>[l(d,{value:1},{default:o(()=>e[13]||(e[13]=[s("一星")])),_:1}),l(d,{value:2},{default:o(()=>e[14]||(e[14]=[s("二星")])),_:1}),l(d,{value:3},{default:o(()=>e[15]||(e[15]=[s("三星")])),_:1}),l(d,{value:4},{default:o(()=>e[16]||(e[16]=[s("四星")])),_:1}),l(d,{value:5},{default:o(()=>e[17]||(e[17]=[s("五星")])),_:1})]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"标签",prop:"commentTag"},{default:o(()=>[f("div",me,[(r(!0),g(Z,null,h(t.value.commentTag,a=>(r(),v($,{style:{margin:"5px"},key:a,closable:"","disable-transitions":!1,onClose:be=>P(a)},{default:o(()=>[s(T(a),1)]),_:2},1032,["onClose"]))),128)),I.value?(r(),v(V,{key:0,classType:"tig-form-input",ref_key:"InputRef",ref:M,modelValue:y.value,"onUpdate:modelValue":e[4]||(e[4]=a=>y.value=a),class:"w-20",size:"small",onKeyup:ee(Y,["enter"]),onBlur:Y},null,8,["modelValue"])):(r(),v(R,{key:1,style:{margin:"5px"},class:"button-new-tag",size:"small",onClick:z},{default:o(()=>e[18]||(e[18]=[s(" + 新增标签 ")])),_:1}))])]),_:1}),l(n,{rules:[{required:!0,message:"评论内容不能为空!"}],label:"评论内容",prop:"content"},{default:o(()=>[l(V,{classType:"tig-form-input",modelValue:t.value.content,"onUpdate:modelValue":e[5]||(e[5]=a=>t.value.content=a),type:"textarea"},null,8,["modelValue"])]),_:1}),l(n,{label:"评论日期",prop:"addTime"},{default:o(()=>[l(j,{modelValue:t.value.addTime,"onUpdate:modelValue":e[6]||(e[6]=a=>t.value.addTime=a),format:"YYYY-MM-DD HH:mm:ss",placeholder:"请选择日期",type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1}),l(n,{label:"晒单",prop:"showPics"},{default:o(()=>[m.value?k("",!0):(r(),v(w(F),{key:0,photos:t.value.showPics,"onUpdate:photos":e[7]||(e[7]=a=>t.value.showPics=a),isMultiple:!0},null,8,["photos"]))]),_:1}),l(n,{label:"排序",prop:"sortOrder"},{default:o(()=>[l(V,{classType:"tig-form-input",type:"integer",modelValue:t.value.sortOrder,"onUpdate:modelValue":e[8]||(e[8]=a=>t.value.sortOrder=a)},null,8,["modelValue"])]),_:1}),l(n,{label:"是否推荐",prop:"isRecommend"},{default:o(()=>[l(C,{modelValue:t.value.isRecommend,"onUpdate:modelValue":e[9]||(e[9]=a=>t.value.isRecommend=a)},{default:o(()=>[l(d,{value:1},{default:o(()=>e[19]||(e[19]=[s("是")])),_:1}),l(d,{value:0},{default:o(()=>e[20]||(e[20]=[s("否")])),_:1})]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"是否置顶",prop:"isTop"},{default:o(()=>[l(C,{modelValue:t.value.isTop,"onUpdate:modelValue":e[10]||(e[10]=a=>t.value.isTop=a)},{default:o(()=>[l(d,{value:1},{default:o(()=>e[21]||(e[21]=[s("是")])),_:1}),l(d,{value:0},{default:o(()=>e[22]||(e[22]=[s("否")])),_:1})]),_:1},8,["modelValue"])]),_:1}),X(l(n,{"wrapper-col":{offset:4,span:16}},{default:o(()=>[l(R,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:e[11]||(e[11]=a=>O())},{default:o(()=>e[23]||(e[23]=[s("提交 ")])),_:1},512)]),_:1},512),[[te,!c.isDialog]])]),_:1},8,["model"])),l(K,{spinning:m.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])]),!m.value&&b.value!=="add"?(r(),g("div",pe,[f("div",fe,[e[25]||(e[25]=s(" 管理员回复 ")),l(w(ne),{params:{id:x.value},isDrawer:"",path:"product/comment/src/EditRemark",title:"回复评论",width:"600px",onOkCallback:E},{default:o(()=>[l(R,{bg:"",class:"buttonColor",size:"small",text:"",type:"primary"},{default:o(()=>e[24]||(e[24]=[s(" 回复评论 ")])),_:1})]),_:1},8,["params"])]),t.value.reply?(r(),g("div",ce,[f("p",null,"内容："+T(t.value.reply.content),1),f("p",ye,T(t.value.reply.username)+"@"+T(t.value.reply.addTime),1)])):(r(),g("div",ve,"暂无回复！"))])):k("",!0)])])}}}),Le=oe(ge,[["__scopeId","data-v-0cc2a1fd"]]);export{Le as default};
