import{a as k}from"./category-7b076a22.js";import{u as N}from"./category-a8bd4d11.js";import{d as S,m as x,u as m,j as o,x as M,K as L,o as V,k as b,f as B,dg as w}from"./index-7c2d2aef.js";const j=S({__name:"SelectCategory",props:x({multiple:{type:Boolean,default:!1},categoryList:{type:Array,default:()=>[]}},{category_id:{},category_idModifiers:{},categoryName:{},categoryNameModifiers:{}}),emits:["update:category_id","update:categoryName"],setup(s,{expose:y}){const l=s,t=m(s,"category_id"),u=m(s,"categoryName"),p={label:"category_name",value:"category_id",children:"children",multiple:l.multiple,checkStrictly:!0},i=N(),c=o([]),g=o(!1),n=o(!1);o(!1),M(()=>{l.categoryList.length>1?c.value=l.categoryList:d()});const d=async a=>{if(n.value!==!0){g.value=!0;try{const e=await k(a);c.value=e.filter_result,i.categoryTree=e.filter_result}catch(e){L.error(e.message)}finally{g.value=!1,n.value=!0}}},f=o(),v=a=>{if(l.multiple==!0){const e=a.map(r=>r[r.length-1]);t.value=e}else{const e=f.value.getCheckedNodes();u.value=e[0]?e[0].text:"",t.value=a?a[a.length-1]:0}},h=a=>{a&&(n.value=!1,i.categoryTree=null,l.multiple==!0?t.value=[]:t.value="")},C=a=>{a&&d()},_=()=>{l.multiple==!0?t.value=[]:(t.value=0,u.value="")};return y({SelectShopChange:h}),(a,e)=>(V(),b(B(w),{ref_key:"cascaderRef",ref:f,modelValue:t.value,"onUpdate:modelValue":e[0]||(e[0]=r=>t.value=r),options:c.value,props:p,class:"cascader",clearable:"",placeholder:"选择分类",onChange:v,onClear:_,onVisibleChange:C},null,8,["modelValue","options"]))}});export{j as _};
