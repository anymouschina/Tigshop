import{i as q}from"./index-u3wYLQ4o.js";import{y as M,d as R,G as E,i as x,q as I,A as j,H as G,B as H,c as k,e as _,b as r,w as i,I as A,r as c,o as p,F as P,a as X,j as w,f as T,E as U,_ as J}from"./index-DrbzVNl6.js";import{r as K}from"./export-D_WXJj3y.js";const Q=m=>M({url:"panel/statisticsUser/addUserTrends",method:"get",params:m}),W=m=>M({url:"panel/statisticsUser/addUserTrends",method:"get",responseType:"arraybuffer",params:m}),Z={class:"container"},$={class:"content_wrapper"},ee={class:"filtrate-menu"},te=R({__name:"List",setup(m){const l=E({1:"",2:"",3:""}),h=x();let s;const f=x({title:{text:"新增会员趋势",left:"center"},grid:{left:"3%",right:"4%"},tooltip:{trigger:"axis"},legend:{data:["新增会员数"],left:"center",bottom:"bottom"},xAxis:{type:"category",data:[]},yAxis:{type:"value",name:"(人)"},series:[{name:"新增会员数",data:[],type:"line",smooth:!0,lineStyle:{color:"#F7DD32"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(247,221,50,0.25)"},{offset:1,color:"rgba(247,221,50,0)"}],global:!1}},color:"#F7DD32",emphasis:{scale:!1},tooltip:{valueFormatter:function(e){return e+"人"}}}]}),a=E({dateType:"1",startEndTime:"",isExport:"0"});x();const D=async()=>{try{a.startEndTime=l[a.dateType];const e=await Q({dateType:a.dateType,startEndTime:a.startEndTime}),{horizontalAxis:t,longitudinalAxis:o}=e,g=t.map(u=>{let d="月";return a.dateType==="2"&&(d="日"),a.dateType==="3"&&(d="时"),u+d});f.value.xAxis.data=g,f.value.series[0].data=o,s.setOption(f.value)}catch(e){A.error(e.message),console.error(e)}},Y=()=>{D()},v=x(!1),F=async()=>{v.value=!0;try{const e=await W({...a,isExport:"1"});v.value=!1,K(e,"新增会员数导出")}catch(e){A.error(e.message)}finally{v.value=!1}},b=()=>{s==null||s.resize()},S=()=>{s=q(h.value),s.setOption(f.value),window.addEventListener("resize",b)},z=[{label:"按年筛选",value:"1"},{label:"按月筛选",value:"2"},{label:"按日筛选",value:"3"}],L=[{text:"本年",value:()=>y(0)},{text:"去年",value:()=>y(1)},{text:"三年前",value:()=>y(3)},{text:"五年前",value:()=>y(5)}],C=[{text:"本月",value:new Date},{text:"上月",value:()=>{const e=new Date;return e.setTime(e.getTime()-3600*1e3*24*30),e}},{text:"本年一月",value:()=>{const e=new Date;return new Date(e.getFullYear(),0,1)}}],B=[{text:"今天",value:new Date},{text:"昨天",value:()=>{const e=new Date;return e.setTime(e.getTime()-3600*1e3*24),e}},{text:"本月第一天",value:()=>{const e=new Date,t=e.getFullYear(),o=e.getMonth();return new Date(t,o,1)}}],y=e=>{const t=new Date;return new Date(t.getFullYear()-e,t.getMonth(),t.getDate())};return I(()=>{j(()=>{S()}),window.onresize=()=>{s==null||s.resize()};const e=G(new Date);if(e){const t=e.split("-");for(const o in l)o==="3"&&(l[o]=e),o==="1"&&(l[o]=t[0]),o==="2"&&(l[o]=t[0]+"-"+t[1])}D()}),H(()=>{s==null||s.dispose(),window.removeEventListener("resize",b)}),(e,t)=>{const o=c("el-option"),g=c("el-select"),u=c("el-form-item"),d=c("el-date-picker"),V=c("el-button"),O=c("el-form");return p(),k("div",Z,[_("div",$,[_("div",null,[r(O,{model:a},{default:i(()=>[_("div",ee,[r(u,{class:"mr-10"},{default:i(()=>[r(g,{modelValue:a.dateType,"onUpdate:modelValue":t[0]||(t[0]=n=>a.dateType=n),placeholder:"Select",style:{width:"94.5px"},onChange:Y},{default:i(()=>[(p(),k(P,null,X(z,(n,N)=>r(o,{key:N,label:n.label,value:n.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),r(u,{class:"mr-10"},{default:i(()=>[a.dateType==="3"?(p(),w(d,{key:0,style:{width:"200px"},shortcuts:B,modelValue:l[3],"onUpdate:modelValue":t[1]||(t[1]=n=>l[3]=n),"value-format":"YYYY-MM-DD",editable:!1,type:"date"},null,8,["modelValue"])):T("",!0),a.dateType==="2"?(p(),w(d,{key:1,style:{width:"200px"},shortcuts:C,modelValue:l[2],"onUpdate:modelValue":t[2]||(t[2]=n=>l[2]=n),"value-format":"YYYY-MM",editable:!1,type:"month"},null,8,["modelValue"])):T("",!0),a.dateType==="1"?(p(),w(d,{key:2,modelValue:l[1],"onUpdate:modelValue":t[3]||(t[3]=n=>l[1]=n),type:"year","value-format":"YYYY",style:{width:"200px"},shortcuts:L,editable:!1},null,8,["modelValue"])):T("",!0)]),_:1}),r(u,{class:"mr-10"},{default:i(()=>[r(V,{plain:"",onClick:Y},{default:i(()=>t[4]||(t[4]=[U("搜索")])),_:1})]),_:1}),r(u,null,{default:i(()=>[r(V,{plain:"",onClick:F,loading:v.value},{default:i(()=>t[5]||(t[5]=[U("导出EXCEL")])),_:1},8,["loading"])]),_:1})])]),_:1},8,["model"])]),_("div",{class:"chart",ref_key:"chartRef",ref:h},null,512)])])}}}),le=J(te,[["__scopeId","data-v-1baf640a"]]);export{le as default};
