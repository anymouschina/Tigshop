import{d as T,i as m,C as j,G,q as M,c as r,e as l,b as o,w as a,f as v,g as C,I as w,r as i,o as d,L as H,F as q,a as F,E as h,D as f}from"./index-CGYuOau0.js";/* empty css             */import"./index-B-GURfkM.js";import{_ as J}from"./DeleteRecord.vue_vue_type_script_setup_true_lang-BTFcBk5t.js";/* empty css                                                                    */import{P as Q}from"./Pagination-yOfjsBuR.js";import{u as W}from"./config-DNllFJyR.js";import{g as X,d as Y,b as Z}from"./feedback-Cs35kFoj.js";import{_ as ee}from"./DialogForm.vue_vue_type_script_setup_true_lang-Bmm-M6gU.js";import"./config-DU8_t5BN.js";const te={class:"container"},le={class:"content_wrapper"},oe={class:"lyecs-table-list-warp"},ae={class:"list-table-tool lyecs-search-warp"},se={class:"advanced-search-warp list-table-tool-row"},ne={class:"simple-form-warp"},ie={class:"simple-form-field"},re={class:"form-group"},de={class:"control-container"},ue={class:"simple-form-field"},ce={class:"form-group"},pe={class:"control-container"},_e={class:"simple-form-field"},me={class:"form-group"},ve={class:"control-container"},fe={class:"simple-form-field"},be={class:"form-group"},ge={class:"control-container"},ye={key:0},he={class:"table-container"},ke={key:0,style:{color:"#999"}},Ce={key:1,style:{color:"#999"}},we={key:2,style:{color:"#999"}},Ve={class:"empty-warp"},Se={key:0,class:"empty-bg"},ze={key:0,class:"pagination-con"},$e=T({__name:"List",setup(xe){const U=W(),V=m([]),b=m(!0),k=m(0),g=m([]);m(!1);const _=j().currentRoute.value.query,y=m([]),s=G({page:1,size:U.get("page_size"),sort_field:"",sort_order:"",keyword:"",type:"",status:""}),A=[{label:"建议",value:0},{label:"投诉",value:1},{label:"商品",value:2},{label:"其他",value:3},{label:"店铺投诉",value:4},{label:"订单问题",value:5},{label:"订单咨询",value:6}],B=[{label:"待回复",value:0},{label:"已回复",value:1},{label:"无效",value:2}],u=async()=>{b.value=!0;try{y.value.length>0&&(s.type=y.value.join(","));const n=await X({...s});V.value=n.filter_result,k.value=n.total}catch(n){w.error(n.message)}finally{b.value=!1}};M(()=>{if(_&&_.type){const n=_.type.split(",").map(Number);console.log(n),y.value=n}_&&_.status&&(s.status=Number(_.status)),u()});const c=()=>{u()},D=({prop:n,order:e})=>{s.sort_field=n,s.sort_order=e=="ascending"?"asc":e=="descending"?"desc":"",u()},L=async n=>{try{const e=await Z(n,{ids:g.value});w.success(e.message),await u()}catch(e){w.error(e.message)}},I=n=>{g.value=n.map(e=>e.id)};return(n,e)=>{const S=i("el-button"),P=i("el-input"),z=i("el-option"),x=i("el-select"),$=i("el-popconfirm"),E=i("el-form"),p=i("el-table-column"),K=i("el-divider"),O=i("el-table"),R=i("a-spin");return d(),r("div",te,[l("div",le,[l("div",oe,[l("div",ae,[o(E,{model:s},{default:a(()=>[l("div",se,[l("div",ne,[l("div",ie,[l("div",re,[l("div",de,[o(P,{modelValue:s.keyword,"onUpdate:modelValue":e[0]||(e[0]=t=>s.keyword=t),name:"keyword",placeholder:"输入留言内容",onKeyup:H(c,["enter"]),clearable:"",onClear:c},{append:a(()=>[o(S,{onClick:c},{default:a(()=>e[6]||(e[6]=[l("span",{class:"iconfont icon-chakan1"},null,-1)])),_:1})]),_:1},8,["modelValue"])])])]),l("div",ue,[l("div",ce,[e[7]||(e[7]=l("label",{class:"control-label"},[l("span",null,"留言类型：")],-1)),l("div",pe,[o(x,{modelValue:y.value,"onUpdate:modelValue":e[1]||(e[1]=t=>y.value=t),multiple:"",clearable:"",placeholder:"请选择",onClear:c,onChange:c},{default:a(()=>[(d(),r(q,null,F(A,t=>o(z,{label:t.label,value:t.value,key:t.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])])])]),l("div",_e,[l("div",me,[e[8]||(e[8]=l("label",{class:"control-label"},[l("span",null,"回复状态：")],-1)),l("div",ve,[o(x,{modelValue:s.status,"onUpdate:modelValue":e[2]||(e[2]=t=>s.status=t),clearable:"",placeholder:"请选择",onClear:c,onChange:c},{default:a(()=>[(d(),r(q,null,F(B,t=>o(z,{label:t.label,value:t.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])])])]),l("div",fe,[l("div",be,[l("div",ge,[o($,{title:"您确认要批量删除所选数据吗？",onConfirm:e[3]||(e[3]=t=>L("del"))},{reference:a(()=>[o(S,{disabled:g.value.length===0},{default:a(()=>e[9]||(e[9]=[h("批量删除")])),_:1},8,["disabled"])]),_:1}),g.value.length>0?(d(),r("span",ye,[e[10]||(e[10]=h(" 已选择：")),l("b",null,f(g.value.length),1),e[11]||(e[11]=h(" 项 "))])):v("",!0)])])])])])]),_:1},8,["model"])]),l("div",he,[o(R,{spinning:b.value},{default:a(()=>[o(O,{data:V.value,loading:b.value,total:k.value,"row-key":"rank_id",onSelectionChange:I,onSortChange:D},{empty:a(()=>[l("div",Ve,[b.value?v("",!0):(d(),r("div",Se,"暂无数据"))])]),default:a(()=>[o(p,{type:"selection",width:"32"}),o(p,{width:120,label:"会员名称",prop:"username"}),o(p,{label:"类型",prop:"type_name"},{default:a(({row:t})=>{var N;return[l("p",null,f(t.type_name),1),t.order_sn?(d(),r("div",ke,f(t.order_sn),1)):v("",!0),t.shop_id&&t.store?(d(),r("div",Ce,f(t.store.store_title),1)):v("",!0),t.product_id>0?(d(),r("div",we,f(((N=t.product)==null?void 0:N.product_name)||"--"),1)):v("",!0)]}),_:1}),o(p,{label:"留言内容",prop:"content"},{default:a(({row:t})=>[h(f(t.content),1)]),_:1}),o(p,{width:160,label:"留言时间",prop:"add_time"}),o(p,{width:80,label:"回复",prop:"status_name"}),o(p,{width:150,fixed:"right",label:"操作"},{default:a(({row:t})=>[o(C(ee),{params:{act:"detail",id:t.id},isDrawer:"",path:"user/feedback/Info",title:"编辑会员留言",width:"600px",onOkCallback:u},{default:a(()=>e[12]||(e[12]=[l("a",{class:"btn-link"},"查看",-1)])),_:2},1032,["params"]),o(K,{direction:"vertical"}),o(C(J),{params:{id:t.id},requestApi:C(Y),onAfterDelete:u},{default:a(()=>e[13]||(e[13]=[h("删除 ")])),_:2},1032,["params","requestApi"])]),_:1})]),_:1},8,["data","loading","total"])]),_:1},8,["spinning"]),k.value>0?(d(),r("div",ze,[o(C(Q),{page:s.page,"onUpdate:page":e[4]||(e[4]=t=>s.page=t),size:s.size,"onUpdate:size":e[5]||(e[5]=t=>s.size=t),total:k.value,onCallback:u},null,8,["page","size","total"])])):v("",!0)])])])])}}});export{$e as default};
