import{d as J,i as v,C as K,s as P,G as W,q as X,r as m,c as b,o as s,e as x,j as p,f,b as l,w as o,a3 as Y,g as A,F as h,a as Z,E as w,D as I,a4 as $,aQ as ee,I as k,_ as ae}from"./index-DrbzVNl6.js";import{i as te}from"./format-CRgx78oe.js";import"./index-CeQDmMxd.js";import"./vuedraggable.umd-DAKh-e3Q.js";import"./UploadAvatar.vue_vue_type_style_index_0_scoped_9bfcfc35_lang-BDvYUQtN.js";import{U as le}from"./UploadAvatar-BpP27mBH.js";import{f as oe,h as re,u as se}from"./adminUser-CTRuV4iV.js";import ne from"./AuthoritySelect-C_HT6Og3.js";import"./Image.vue_vue_type_script_setup_true_lang-BWzCs9jv.js";import"./DialogForm.vue_vue_type_script_setup_true_lang-DqYSRv0_.js";import"./authority-C-nKXejU.js";const ue={class:"container"},de={class:"content_wrapper"},ie={class:"lyecs-form-table"},me={class:"empty-warp"},pe={key:0,class:"empty-bg"},fe=J({__name:"Info",props:{id:{type:Number,default:0},suppliersId:{type:Number,default:0},act:{type:String,default:""},type:{type:String,default:""},adminType:{type:String,default:"admin"},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(d,{expose:B,emit:F}){const V=F,c=d,y=v(!0),L=K().currentRoute.value.query,T=v(c.isDialog?c.act:String(L.act)),N=v(c.isDialog?c.id:Number(L.id)),U=T.value==="add"?"create":"update",q=P(),e=W({userId:""}),C=v(),R=v({}),S=v(!0),j=async()=>{var u,t;try{const n=await oe(T.value,{id:N.value});R.value=n.user,Object.assign(e,n),(u=C.value)!=null&&u.some(_=>_.roleId===e.roleId)||(e.roleId=0),e.mobile=((t=n.adminUser)==null?void 0:t.mobile)||n.mobile;let r=ee(String(e.avatar));r=="one"?S.value=!0:r=="def"&&(S.value=!1)}catch(n){k.error(n.message),V("close")}finally{y.value=!1}},E=async()=>{try{const u=await re();C.value=u}catch(u){k.error(u.message)}};X(()=>{E(),T.value==="detail"?j():y.value=!1,U!="update"&&c.type==="suppliers"&&(e.roleId=2,e.suppliersId=c.suppliersId)});const D=async()=>{await q.value.validate();try{V("update:confirmLoading",!0);let u={avatar:""};!e.avatar&&e.defAvatar?u.avatar=e.defAvatar:u.avatar=e.avatar;const t=await se(U,{id:N.value,...e,avatar:u.avatar});V("submitCallback",t),k.success("操作成功")}catch(u){k.error(u.message)}finally{V("update:confirmLoading",!1)}};return B({onFormSubmit:()=>{D()}}),(u,t)=>{const n=m("TigInput"),r=m("el-form-item"),_=m("el-option"),z=m("el-select"),G=m("el-avatar"),g=m("el-table-column"),M=m("el-table"),O=m("el-button"),Q=m("el-form"),H=m("a-spin");return s(),b("div",ue,[x("div",de,[x("div",ie,[y.value?f("",!0):(s(),p(Q,{key:0,ref_key:"formRef",ref:q,model:e,"label-width":"auto"},{default:o(()=>[l(r,{rules:[{required:!0,message:(d.adminType=="shop"?"员工名称":"管理员名称")+"不能为空!"}],label:d.adminType=="shop"?"员工名称":"管理员名称",prop:"username"},{default:o(()=>[l(n,{width:"100%",modelValue:e.username,"onUpdate:modelValue":t[0]||(t[0]=a=>e.username=a)},null,8,["modelValue"])]),_:1},8,["rules","label"]),d.adminType=="admin"?(s(),p(r,{key:0,label:"手机号",prop:"mobile",rules:[{required:!0,message:"手机号不能为空!"}]},{default:o(()=>[l(n,{width:"100%",modelValue:e.mobile,"onUpdate:modelValue":t[1]||(t[1]=a=>e.mobile=a)},null,8,["modelValue"])]),_:1})):f("",!0),d.adminType!="shop"?(s(),p(r,{key:1,label:"邮箱",prop:"email"},{default:o(()=>[l(n,{width:"100%",modelValue:e.email,"onUpdate:modelValue":t[2]||(t[2]=a=>e.email=a)},null,8,["modelValue"])]),_:1})):f("",!0),d.adminType!="shop"?(s(),p(r,{key:2,label:"头像",prop:"avatar"},{default:o(()=>[l(A(le),{avatar:e.avatar,"onUpdate:avatar":t[3]||(t[3]=a=>e.avatar=a),avatarType:S.value,loading:y.value},null,8,["avatar","avatarType","loading"])]),_:1})):f("",!0),A(U)=="create"&&d.adminType!="shop"?(s(),b(h,{key:3},[l(r,{rules:[{required:!0,message:"设置密码不能为空!"}],label:"设置密码",prop:"password"},{default:o(()=>[l(n,{width:"100%",modelValue:e.password,"onUpdate:modelValue":t[4]||(t[4]=a=>e.password=a),type:"password"},null,8,["modelValue"])]),_:1}),l(r,{rules:[{required:!0,message:"确认密码不能为空!"}],label:"确认密码",prop:"pwdConfirm"},{default:o(()=>[l(n,{width:"100%",modelValue:e.pwdConfirm,"onUpdate:modelValue":t[5]||(t[5]=a=>e.pwdConfirm=a),type:"password"},null,8,["modelValue"])]),_:1})],64)):d.adminType=="shop"?(s(),b(h,{key:4},[l(r,{label:"修改密码",prop:"password"},{default:o(()=>[l(n,{width:"100%",modelValue:e.password,"onUpdate:modelValue":t[6]||(t[6]=a=>e.password=a),type:"password"},null,8,["modelValue"])]),_:1}),l(r,{label:"确认密码",prop:"pwdConfirm"},{default:o(()=>[l(n,{width:"100%",modelValue:e.pwdConfirm,"onUpdate:modelValue":t[7]||(t[7]=a=>e.pwdConfirm=a),type:"password"},null,8,["modelValue"])]),_:1})],64)):f("",!0),d.adminType!="shop"?(s(),p(r,{key:5,label:d.adminType=="shop"?"员工权限组":"管理员权限组",prop:"roleId"},{default:o(()=>[e.roleId!=2?(s(),p(z,{key:0,modelValue:e.roleId,"onUpdate:modelValue":t[8]||(t[8]=a=>e.roleId=a),style:{width:"100%"}},{default:o(()=>[l(_,{value:0,label:"自定义权限"}),(s(!0),b(h,null,Z(C.value,a=>(s(),p(_,{label:a.roleName,value:a.roleId},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])):(s(),b(h,{key:1},[w(" 供应商")],64))]),_:1},8,["label"])):f("",!0),e.roleId===0&&d.adminType!="shop"?(s(),p(r,{key:6,label:"",prop:"authList"},{default:o(()=>[l(ne,{modelValue:e.authList,"onUpdate:modelValue":t[9]||(t[9]=a=>e.authList=a)},null,8,["modelValue"])]),_:1})):f("",!0),d.adminType=="shop"?(s(),p(r,{key:7,label:"店铺列表",prop:"userShop"},{default:o(()=>[l(M,{data:e.userShop,"row-key":"id"},{empty:o(()=>[x("div",me,[y.value?f("",!0):(s(),b("div",pe,"暂无数据"))])]),default:o(()=>[l(g,{label:"店铺logo",prop:"username"},{default:o(({row:a})=>{var i;return[l(G,{size:40,src:A(te)((i=a.shop)==null?void 0:i.shopLogo)},null,8,["src"])]}),_:1}),l(g,{label:"所属店铺",prop:"username"},{default:o(({row:a})=>{var i;return[w(I((i=a.shop)==null?void 0:i.shopTitle),1)]}),_:1}),l(g,{width:"100",label:"状态",prop:"username"},{default:o(({row:a})=>{var i;return[w(I((i=a.shop)==null?void 0:i.statusText),1)]}),_:1}),l(g,{width:"100",label:"员工昵称",prop:"username"},{default:o(({row:a})=>[w(I(a.username||e.username||"-"),1)]),_:1}),l(g,{label:"联系方式",prop:"username"},{default:o(({row:a})=>{var i;return[w(I(((i=a.user)==null?void 0:i.mobile)||"-"),1)]}),_:1})]),_:1},8,["data"])]),_:1})):f("",!0),Y(l(r,{"wrapper-col":{offset:4,span:16}},{default:o(()=>[l(O,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:D},{default:o(()=>t[10]||(t[10]=[w("提交")])),_:1},512)]),_:1},512),[[$,!c.isDialog]])]),_:1},8,["model"])),l(H,{spinning:y.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}}),Ue=ae(fe,[["__scopeId","data-v-63b881c3"]]);export{Ue as default};
