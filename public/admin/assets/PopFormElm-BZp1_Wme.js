import{d as A,y as H,G as B,i as p,s as U,c as d,o as s,f as E,aR as S,e as f,b as c,r as v,w as u,g as _,D as G,j,E as N,I as w,_ as O}from"./index-DrbzVNl6.js";const J={class:"lyecs-popedit"},K={key:0,class:"flex flex-align-center pop-form-wrap"},L={key:1,style:{width:"100%"},class:"flex flex-align-center flex-justify-center pop-form-wrap"},M={key:2,style:{position:"relative"}},Q={class:"popForm-con",style:{width:"100%",padding:"8px 6px 5px","box-sizing":"border-box"}},W={key:0,class:"extra"},X={class:"flex",style:{"justify-content":"right"}},Y=A({__name:"PopFormElm",props:{orgValue:[String,Number],requestApi:{type:Function,default:H},label:{type:String,default:"编辑项"},extra:{tyoe:String,default:""},max:{type:Number,default:0},min:{type:Number,default:0},maxNum:{type:Number,default:0},minNum:{type:Number,default:0},len:{type:Number,default:0},required:{type:Boolean,default:!0},type:{type:String,default:"text"},params:{type:Object,default:{id:null,field:""}},isDirect:{type:Boolean,default:!1},isHover:{type:Boolean,default:!0},isPrice:{type:Boolean,default:!1}},emits:["update:orgValue","callback"],setup(m,{expose:R,emit:q}){const e=m,z=B({paramValue:[{required:!0,validator:(r,a,o)=>{let i=l.paramValue;if(!i){o(new Error("请输入"+e.label));return}if(e.type==="textarea"||e.type==="input"){if(e.max>0&&i.length>e.max){o(new Error("请输入不超过"+e.max+"个字符的"+e.label));return}if(e.len>0&&i.length>e.len){o(new Error("请输入不超过"+e.len+"个字符的"+e.label));return}}if(e.type==="number"&&isNaN(i)){o(new Error("请输入数字"));return}if(e.type==="number"&&e.minNum>0&&i<e.minNum){o(new Error("请输入不少于"+e.minNum+"的数字"));return}if(e.type==="number"&&e.maxNum>0&&i>e.maxNum){o(new Error("请输入不大于"+e.maxNum+"的数字"));return}o()},trigger:"blur"}]}),t=p(e.extra);e.max>0&&(t.value||(t.value="请输入不超"+e.max+"个字符的"+e.label)),e.min>0&&(t.value||(t.value="请输入不少于"+e.min+"个字符的"+e.label)),e.len>0&&(t.value||(t.value="请输入"+e.len+"个字符的"+e.label)),e.minNum>0&&e.maxNum>0&&(t.value||(t.value="请输入"+e.minNum+"-"+e.maxNum+"之间的数字"));const n=p(!1),k=p(!1),D=p(e.type),y=U();let l=B({paramValue:e.orgValue});const x=q,b=p(!1),h=async()=>{await y.value.validate();try{b.value=!0;const r=await e.requestApi({id:e.params.id,field:e.params.field,val:l.paramValue});x("update:orgValue",l.paramValue),x("callback"),w.success("操作成功"),n.value=!1}catch(r){w.error(r.message)}finally{b.value=!1}},F=async()=>{await y.value.validate();try{x("update:orgValue",l.paramValue),x("callback"),n.value=!1}catch(r){w.error(r.message)}},C=()=>{k.value=!0,n.value=!0,l.paramValue=e.orgValue},I=r=>{n.value=!0},P=()=>{l.paramValue=e.orgValue,y.value.clearValidate()};return R({show:I}),(r,a)=>{const o=v("TigInput"),i=v("el-form-item"),T=v("el-form"),V=v("el-button"),$=v("el-popover");return s(),d("div",J,[m.isHover?(s(),d("div",K,[S(r.$slots,"default",{},void 0,!0),f("span",{class:"lyecs-popedit-btn iconfont icon-bianji1",ref:"buttonRef",onClick:C},null,512)])):(s(),d("div",L,[S(r.$slots,"default",{},void 0,!0),f("span",{class:"lyecs-popedit-btn2 iconfont icon-bianji1",onClick:C})])),k.value?(s(),d("div",M,[c($,{ref:"popoverRef",trigger:"click",placement:"bottom-start","hide-after":0,visible:n.value,"onUpdate:visible":a[2]||(a[2]=g=>n.value=g),onConfirm:h,onCancel:P,teleported:!0,width:"360px"},{reference:u(()=>a[3]||(a[3]=[f("div",{style:{position:"absolute",left:"-32px",width:"50px",height:"5px",visibility:"hidden"}},null,-1)])),default:u(()=>[f("div",Q,[c(T,{ref_key:"formRef",ref:y,model:_(l),layout:"horizontal",rules:z,name:"form_in_modal","wrapper-col":{span:38},"label-wrap":!1},{default:u(()=>[c(i,{prop:"paramValue",label:m.label,extra:t.value,max:m.max},{default:u(()=>[c(o,{width:"100%",type:D.value,modelValue:_(l).paramValue,"onUpdate:modelValue":a[0]||(a[0]=g=>_(l).paramValue=g)},null,8,["type","modelValue"]),t.value?(s(),d("div",W,G(t.value),1)):E("",!0)]),_:1},8,["label","extra","max"])]),_:1},8,["model","rules"]),f("div",X,[c(V,{size:"small",onClick:a[1]||(a[1]=g=>n.value=!1)},{default:u(()=>a[4]||(a[4]=[N("取消")])),_:1}),m.isDirect?(s(),j(V,{key:1,size:"small",type:"primary",onClick:F,loading:b.value},{default:u(()=>a[6]||(a[6]=[N("确认")])),_:1},8,["loading"])):(s(),j(V,{key:0,size:"small",type:"primary",onClick:h,loading:b.value},{default:u(()=>a[5]||(a[5]=[N("确认")])),_:1},8,["loading"]))])])]),_:1},8,["visible"])])):E("",!0)])}}}),ae=O(Y,[["__scopeId","data-v-6ad553cf"]]);export{ae as P};
