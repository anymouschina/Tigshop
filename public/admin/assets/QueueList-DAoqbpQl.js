/* empty css             */import{d as C,R as _,i as v,aa as N,Q as P,c as u,o as f,D as L,G as j,q as E,e as a,b as e,r,w as l,E as S,f as x,g as m,F as U,a as $,I as H,_ as O}from"./index-CGYuOau0.js";import{_ as z}from"./DeleteRecord.vue_vue_type_script_setup_true_lang-BTFcBk5t.js";/* empty css                                                                    */import{P as R}from"./Pagination-yOfjsBuR.js";import{i as G}from"./format-DFT-VJzO.js";import{u as W}from"./config-DNllFJyR.js";import{d as J}from"./brand-BWQ0xslz.js";import{t as K,g as X}from"./conversation-BfOs7vot.js";/* empty css                                               */import{r as Y}from"./zh-cn-BAb8a1B9.js";import{S as Z}from"./StatusDot-YMdUi2kT.js";const ee=C({__name:"RelativeTime",props:{time:{type:String,default:""}},setup(k){_.extend(Y),_.locale("zh-cn");const b=k,g=v(_()),h=N(()=>_(b.time).from(g.value));return P(d=>{const n=_().diff(_(b.time),"second");let t;n<60?t=1e4:n<3600?t=6e4:n<86400?t=6e5:n<604800?t=36e5:t=864e5;const i=setInterval(()=>{g.value=_()},t);d(()=>clearInterval(i))}),(d,n)=>(f(),u("span",null,L(h.value),1))}}),te={class:"container"},se={class:"content_wrapper"},ae={class:"lyecs-table-list-warp",style:{"margin-bottom":"0"}},oe={class:"list-table-tool lyecs-search-warp"},le={class:"advanced-search-warp list-table-tool-row"},ne={class:"simple-form-warp"},re={class:"simple-form-field"},ie={class:"form-group"},de={class:"control-container"},ce={class:"simple-form-field"},_e={class:"table-container"},me={class:"kehu"},pe={class:"title"},ue={class:"message-list"},fe={class:"item"},ve={class:"empty-warp"},be={key:0,class:"empty-bg"},ge={key:0,class:"pagination-con"},he=C({__name:"QueueList",setup(k,{expose:b}){const g=W(),h=v([]),d=v(!0),n=v(0);v([]);const t=j({page:1,size:g.get("page_size"),sort_field:"",sort_order:"",keyword:"",first_word:"",user_from:""}),i=async()=>{d.value=!0;try{const c=await X({...t});h.value=c.filter_result,n.value=c.total}catch(c){H.error(c.message)}finally{d.value=!1}};E(()=>{i()});const T=()=>{i()},I=({prop:c,order:s})=>{t.sort_field=c,t.sort_order=s=="ascending"?"asc":s=="descending"?"desc":"",i()};return b({loadFilter:i}),(c,s)=>{const w=r("el-option"),V=r("el-select"),A=r("el-button"),q=r("el-form"),D=r("el-avatar"),p=r("el-table-column"),M=r("sapn"),Q=r("el-divider"),B=r("el-table"),F=r("a-spin");return f(),u("div",te,[a("div",se,[a("div",ae,[a("div",oe,[e(q,{model:t},{default:l(()=>[a("div",le,[a("div",ne,[a("div",re,[a("div",ie,[s[3]||(s[3]=a("label",{class:"control-label"},[a("span",null,"咨询来源：")],-1)),a("div",de,[e(V,{modelValue:t.user_from,"onUpdate:modelValue":s[0]||(s[0]=o=>t.user_from=o),clearable:""},{default:l(()=>[e(w,{value:"",label:"全部"}),e(w,{value:"pc",label:"pc"}),e(w,{value:"h5",label:"h5"})]),_:1},8,["modelValue"])])])]),a("div",ce,[e(A,{type:"primary",onClick:T},{default:l(()=>s[4]||(s[4]=[S("搜索")])),_:1})])])])]),_:1},8,["model"])]),a("div",_e,[e(F,{spinning:d.value},{default:l(()=>[e(B,{data:h.value,loading:d.value,total:n.value,"row-key":"brand_id",onSortChange:I},{empty:l(()=>[a("div",ve,[d.value?x("",!0):(f(),u("div",be,"暂无数据"))])]),default:l(()=>[e(p,{label:"客户",prop:"brand_id"},{default:l(({row:o})=>{var y;return[a("div",me,[e(D,{class:"av",src:m(G)(o.user.avatar)},null,8,["src"]),a("div",pe,L((y=o.user)==null?void 0:y.nickname),1)])]}),_:1}),e(p,{label:"最新两条消息"},{default:l(({row:o})=>[a("div",ue,[(f(!0),u(U,null,$(o.userLastTwoMessage.slice(0,2),y=>(f(),u("div",fe,[e(Z,{color:"#44bb00",flicker:!1}),e(M,{innerHTML:y.content.content},null,8,["innerHTML"])]))),256))])]),_:1}),e(p,{prop:"add_time",width:160,label:"进入排队时间"}),e(p,{width:100,label:"排队时长",sortable:"custom"},{default:l(({row:o})=>[e(m(ee),{time:o.add_time},null,8,["time"])]),_:1}),e(p,{width:100,label:"咨询来源",prop:"user_from",sortable:"custom"}),e(p,{width:120,fixed:"right",label:"操作"},{default:l(({row:o})=>[e(m(z),{title:"您确定要接入会话吗？",params:{conversation_id:o.id},requestApi:m(K),onAfterDelete:i},{default:l(()=>s[5]||(s[5]=[S("接入会话")])),_:2},1032,["params","requestApi"]),e(Q,{direction:"vertical"}),e(m(z),{params:{id:o.id},requestApi:m(J),onAfterDelete:i},{default:l(()=>s[6]||(s[6]=[S("删除")])),_:2},1032,["params","requestApi"])]),_:1})]),_:1},8,["data","loading","total"])]),_:1},8,["spinning"]),n.value>0?(f(),u("div",ge,[e(m(R),{page:t.page,"onUpdate:page":s[1]||(s[1]=o=>t.page=o),size:t.size,"onUpdate:size":s[2]||(s[2]=o=>t.size=o),total:n.value,onCallback:i},null,8,["page","size","total"])])):x("",!0)])])])])}}}),ye=O(he,[["__scopeId","data-v-1fed06ac"]]),De=Object.freeze(Object.defineProperty({__proto__:null,default:ye},Symbol.toStringTag,{value:"Module"}));export{ye as Q,ee as _,De as a};
