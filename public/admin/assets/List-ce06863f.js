import{i as R}from"./index-05c93ee4.js";import{f as q}from"./util-1ee03ed8.js";import{A as E,d as I,I as k,j as y,x as j,C as H,D as K,r as c,o as _,c as A,e as x,b as n,w as i,K as M,F as P,a as X,k as h,h as w,H as T,_ as G}from"./index-7c2d2aef.js";import{r as J}from"./export-59d12e73.js";const Q=p=>E({url:"panel/statistics_user/add_user_trends",method:"get",params:p}),W=p=>E({url:"panel/statistics_user/add_user_trends",method:"get",responseType:"arraybuffer",params:p}),Z={class:"container"},$={class:"content_wrapper"},ee={class:"filtrate-menu"},te=I({__name:"List",setup(p){const l=k({1:"",2:"",3:""}),D=y();let s;const m=y({title:{text:"新增会员趋势",left:"center"},grid:{left:"3%",right:"4%"},tooltip:{trigger:"axis"},legend:{data:["新增会员数"],left:"center",bottom:"bottom"},xAxis:{type:"category",data:[]},yAxis:{type:"value",name:"(人)"},series:[{name:"新增会员数",data:[],type:"line",smooth:!0,lineStyle:{color:"#F7DD32"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(247,221,50,0.25)"},{offset:1,color:"rgba(247,221,50,0)"}],global:!1}},color:"#F7DD32",emphasis:{scale:!1},tooltip:{valueFormatter:function(e){return e+"人"}}}]}),a=k({date_type:"1",start_end_time:"",is_export:"0"});y();const Y=async()=>{try{a.start_end_time=l[a.date_type];const e=await Q({date_type:a.date_type,start_end_time:a.start_end_time});if(e.errcode===0){const{horizontal_axis:t,longitudinal_axis:o}=e.filter_result,g=t.map(u=>{let d="月";return a.date_type==="2"&&(d="日"),a.date_type==="3"&&(d="时"),u+d});m.value.xAxis.data=g,m.value.series[0].data=o,s.setOption(m.value)}}catch(e){M.error(e.message),console.error(e)}},F=()=>{Y()},f=y(!1),L=async()=>{f.value=!0;try{const e=await W({...a,is_export:"1"});f.value=!1,J(e,"新增会员数导出")}catch(e){M.error(e.message)}finally{f.value=!1}},b=()=>{s==null||s.resize()},S=()=>{s=R(D.value),s.setOption(m.value),window.addEventListener("resize",b)},z=[{label:"按年筛选",value:"1"},{label:"按月筛选",value:"2"},{label:"按日筛选",value:"3"}],U=[{text:"本年",value:()=>v(0)},{text:"去年",value:()=>v(1)},{text:"三年前",value:()=>v(3)},{text:"五年前",value:()=>v(5)}],C=[{text:"本月",value:new Date},{text:"上月",value:()=>{const e=new Date;return e.setTime(e.getTime()-3600*1e3*24*30),e}},{text:"本年一月",value:()=>{const e=new Date;return new Date(e.getFullYear(),0,1)}}],O=[{text:"今天",value:new Date},{text:"昨天",value:()=>{const e=new Date;return e.setTime(e.getTime()-3600*1e3*24),e}},{text:"本月第一天",value:()=>{const e=new Date,t=e.getFullYear(),o=e.getMonth();return new Date(t,o,1)}}],v=e=>{const t=new Date;return new Date(t.getFullYear()-e,t.getMonth(),t.getDate())};return j(()=>{H(()=>{S()}),window.onresize=()=>{s==null||s.resize()};const e=q(new Date);if(e){const t=e.split("-");for(const o in l)o==="3"&&(l[o]=e),o==="1"&&(l[o]=t[0]),o==="2"&&(l[o]=t[0]+"-"+t[1])}Y()}),K(()=>{s==null||s.dispose(),window.removeEventListener("resize",b)}),(e,t)=>{const o=c("el-option"),g=c("el-select"),u=c("el-form-item"),d=c("el-date-picker"),V=c("el-button"),B=c("el-form");return _(),A("div",Z,[x("div",$,[x("div",null,[n(B,{model:a},{default:i(()=>[x("div",ee,[n(u,{class:"mr-10"},{default:i(()=>[n(g,{modelValue:a.date_type,"onUpdate:modelValue":t[0]||(t[0]=r=>a.date_type=r),placeholder:"Select",style:{width:"94.5px"}},{default:i(()=>[(_(),A(P,null,X(z,(r,N)=>n(o,{key:N,label:r.label,value:r.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),n(u,{class:"mr-10"},{default:i(()=>[a.date_type==="3"?(_(),h(d,{key:0,style:{width:"200px"},shortcuts:O,modelValue:l[3],"onUpdate:modelValue":t[1]||(t[1]=r=>l[3]=r),"value-format":"YYYY-MM-DD",editable:!1,type:"date"},null,8,["modelValue"])):w("",!0),a.date_type==="2"?(_(),h(d,{key:1,style:{width:"200px"},shortcuts:C,modelValue:l[2],"onUpdate:modelValue":t[2]||(t[2]=r=>l[2]=r),"value-format":"YYYY-MM",editable:!1,type:"month"},null,8,["modelValue"])):w("",!0),a.date_type==="1"?(_(),h(d,{key:2,modelValue:l[1],"onUpdate:modelValue":t[3]||(t[3]=r=>l[1]=r),type:"year","value-format":"YYYY",style:{width:"200px"},shortcuts:U,editable:!1},null,8,["modelValue"])):w("",!0)]),_:1}),n(u,{class:"mr-10"},{default:i(()=>[n(V,{plain:"",onClick:F},{default:i(()=>[T("搜索")]),_:1})]),_:1}),n(u,null,{default:i(()=>[n(V,{plain:"",onClick:L,loading:f.value},{default:i(()=>[T("导出EXCEL")]),_:1},8,["loading"])]),_:1})])]),_:1},8,["model"])]),x("div",{class:"chart",ref_key:"chartRef",ref:D},null,512)])])}}});const re=G(te,[["__scopeId","data-v-0109867f"]]);export{re as default};
