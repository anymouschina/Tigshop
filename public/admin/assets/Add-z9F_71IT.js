import{d as H,i,C as J,s as K,q as P,r,c as Q,o as n,e as k,j as u,f as c,b as a,w as o,a0 as W,g as O,E as m,D as y,a1 as X,I as x}from"./index-CGYuOau0.js";import"./index-B-GURfkM.js";import{F as Y}from"./UploadAvatar.vue_vue_type_style_index_0_scoped_9bfcfc35_lang-CjXfTDg5.js";import{g as Z}from"./merchant-dL4BdMQj.js";import{e as ee,u as te}from"./shop-Daw3OFCx.js";import{_ as ae}from"./DialogForm.vue_vue_type_script_setup_true_lang-Bmm-M6gU.js";import"./vuedraggable.umd-_1km55l4.js";import"./Image.vue_vue_type_script_setup_true_lang-D9PqZe9n.js";import"./format-DFT-VJzO.js";import"./config-DNllFJyR.js";import"./config-DU8_t5BN.js";const oe={class:"container"},se={class:"content_wrapper"},le={class:"lyecs-form-table"},re={class:"ssdw"},ye=H({__name:"Add",props:{id:{type:Number,default:0},act:{type:String,default:""},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(R,{expose:T,emit:E}){const p=E,d=R,_=i(!1),S=J().currentRoute.value.query,D=i(d.isDialog?d.act:String(S.act)),f=i(d.isDialog?d.id:Number(S.id)),w=D.value==="add"?"create":"update",C=K(),L=i(!1),s=i({merchant_id:Number(S.id)}),G=async()=>{try{const t=await ee(D.value,{shop_id:f.value});Object.assign(s.value,t.item)}catch(t){x.error(t.message),p("close")}finally{_.value=!1}},I=async()=>{try{const t=await Z({merchant_id:f.value});s.value.merchant_id=f.value,v.value=t.filter_result}catch(t){x.error(t.message),p("close")}finally{_.value=!1}},v=i([]),j=async t=>{v.value=t.merchant,s.value.merchant_id=t.merchant_id};P(()=>{w==="update"&&G(),v.value=[],s.value.merchant_id=0,f.value!=0&&(L.value=!0,I())});const N=async()=>{await C.value.validate();try{p("update:confirmLoading",!0);const t=await te(w,{id:f.value,...s.value});p("submitCallback",t),x.success(t.message)}catch(t){x.error(t.message)}finally{p("update:confirmLoading",!1)}};return T({onFormSubmit:()=>{N()}}),(t,l)=>{const A=r("el-input"),g=r("el-form-item"),V=r("el-button"),q=r("Tag"),b=r("el-table-column"),B=r("StatusDot"),U=r("el-table"),$=r("el-form"),z=r("a-spin");return n(),Q("div",oe,[k("div",se,[k("div",le,[_.value?c("",!0):(n(),u($,{key:0,ref_key:"formRef",ref:C,model:s.value,"label-width":"auto"},{default:o(()=>[a(g,{label:"店铺名称",prop:"shop_title",rules:[{required:!0,message:"店铺名称不能为空!"}]},{default:o(()=>[a(A,{modelValue:s.value.shop_title,"onUpdate:modelValue":l[0]||(l[0]=e=>s.value.shop_title=e)},null,8,["modelValue"])]),_:1}),a(g,{label:"所属商户",prop:"merchant_id",rules:[{required:!0,message:"请选择所属商户!"}]},{default:o(()=>[L.value?c("",!0):(n(),u(O(ae),{key:0,params:{isMultiple:!1,selected_ids:[s.value.merchant_id]},isDrawer:"",path:"adminMerchant/merchant/src/SelectMerchant",title:"选择商户",width:"900px",onOkCallback:j},{default:o(()=>[a(V,{type:"primary"},{default:o(()=>l[2]||(l[2]=[m("选择商户")])),_:1})]),_:1},8,["params"])),v.value.length>0?(n(),u(U,{key:1,data:v.value,"row-key":"merchant_id",class:"mt10"},{default:o(()=>[a(b,{label:"商户所属单位"},{default:o(({row:e})=>[k("div",re,[e.type==1?(n(),u(q,{key:0,transparent:!0,text:"个人"})):(n(),u(q,{key:1,color:"#409EFF",transparent:!1,text:"企业"})),m(" "+y(e.type==1?""+e.corporate_name:""+e.company_name),1)])]),_:1}),a(b,{label:"商户所属会员(ID)"},{default:o(({row:e})=>{var h,F,M;return[m(y((h=e.user)==null?void 0:h.username)+y((F=e.user)!=null&&F.user_id?"("+((M=e.user)==null?void 0:M.user_id)+")":""),1)]}),_:1}),a(b,{label:"商户类型",prop:"type_text",sortable:"custom"}),a(b,{label:"管理员",sortable:"custom"},{default:o(({row:e})=>{var h;return[m(y(((h=e.admin)==null?void 0:h.username)||"--"),1)]}),_:1}),a(b,{label:"认证状态",prop:"status_text",sortable:"custom"},{default:o(({row:e})=>[e.status==1?(n(),u(B,{key:0,color:"#52c41a",flicker:!0})):c("",!0),e.status==2?(n(),u(B,{key:1,color:"#f5222d",flicker:!1})):c("",!0),m(" "+y(e.status_text),1)]),_:1})]),_:1},8,["data"])):c("",!0)]),_:1}),a(g,{label:"店铺LOGO",prop:"shop_logo",rules:[{required:!0,message:"请上传店铺LOGO!"}]},{default:o(()=>[_.value?c("",!0):(n(),u(O(Y),{key:0,photo:s.value.shop_logo,"onUpdate:photo":l[1]||(l[1]=e=>s.value.shop_logo=e)},null,8,["photo"])),l[3]||(l[3]=k("div",{class:"extra"},"请统一上传比例为2:1的图片，宽200px，高100px（高清）",-1))]),_:1}),W(a(g,{"wrapper-col":{offset:4,span:16}},{default:o(()=>[a(V,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:N},{default:o(()=>l[4]||(l[4]=[m("提交")])),_:1},512)]),_:1},512),[[X,!d.isDialog]])]),_:1},8,["model"])),a(z,{spinning:_.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}});export{ye as default};
