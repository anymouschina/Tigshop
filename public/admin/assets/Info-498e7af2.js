import{p as A,i as ae}from"./format-4e0206d3.js";import"./index-6c62cf9b.js";import{_ as pe}from"./Image.vue_vue_type_script_setup_true_lang-36bd437b.js";import{d as K,a4 as ce,aa as ue,a9 as k,b as a,U as P,aZ as _e,ea as me,a6 as fe,a7 as ve,T as se,am as he,a_ as ge,d6 as be,bC as ye,Y as oe,a1 as ne,j as z,E as $e,s as xe,x as Se,r as B,aW as Ie,$ as Ce,o as s,c as r,e as t,w as o,f as v,G as c,H as x,h as u,k as O,F as re,a as de,K as E,p as we,i as Le,_ as He}from"./index-7c2d2aef.js";import{F as Be}from"./UploadAvatar.vue_vue_type_style_index_0_scoped_9bfcfc35_lang-9b6073fb.js";import{a as Te,b as De,c as ze}from"./aftersales-393a32d4.js";/* empty css                                                                    */import{P as Oe}from"./ProductCard-5b1dbc4c.js";import{_ as q}from"./DialogForm.vue_vue_type_script_setup_true_lang-c57b9a11.js";import"./config-9548fa9b.js";import"./config-e2aa16d1.js";import"./util-1ee03ed8.js";import"./vuedraggable.umd-75ad0f8f.js";const Pe=()=>({prefixCls:String,color:String,dot:P.any,pending:_e(),position:P.oneOf(me("left","right","")).def(""),label:P.any}),j=K({compatConfig:{MODE:3},name:"ATimelineItem",props:ce(Pe(),{color:"blue",pending:!1}),slots:Object,setup(e,l){let{slots:h}=l;const{prefixCls:g}=ue("timeline",e),d=k(()=>({[`${g.value}-item`]:!0,[`${g.value}-item-pending`]:e.pending})),I=k(()=>/blue|red|green|gray/.test(e.color||"")?void 0:e.color||"blue"),D=k(()=>({[`${g.value}-item-head`]:!0,[`${g.value}-item-head-${e.color||"blue"}`]:!I.value}));return()=>{var L,H,i;const{label:b=(L=h.label)===null||L===void 0?void 0:L.call(h),dot:_=(H=h.dot)===null||H===void 0?void 0:H.call(h)}=e;return a("li",{class:d.value},[b&&a("div",{class:`${g.value}-item-label`},[b]),a("div",{class:`${g.value}-item-tail`},null),a("div",{class:[D.value,!!_&&`${g.value}-item-head-custom`],style:{borderColor:I.value,color:I.value}},[_]),a("div",{class:`${g.value}-item-content`},[(i=h.default)===null||i===void 0?void 0:i.call(h)])])}}}),We=e=>{const{componentCls:l}=e;return{[l]:se(se({},he(e)),{margin:0,padding:0,listStyle:"none",[`${l}-item`]:{position:"relative",margin:0,paddingBottom:e.timeLineItemPaddingBottom,fontSize:e.fontSize,listStyle:"none","&-tail":{position:"absolute",insetBlockStart:e.timeLineItemHeadSize,insetInlineStart:(e.timeLineItemHeadSize-e.timeLineItemTailWidth)/2,height:`calc(100% - ${e.timeLineItemHeadSize}px)`,borderInlineStart:`${e.timeLineItemTailWidth}px ${e.lineType} ${e.colorSplit}`},"&-pending":{[`${l}-item-head`]:{fontSize:e.fontSizeSM,backgroundColor:"transparent"},[`${l}-item-tail`]:{display:"none"}},"&-head":{position:"absolute",width:e.timeLineItemHeadSize,height:e.timeLineItemHeadSize,backgroundColor:e.colorBgContainer,border:`${e.timeLineHeadBorderWidth}px ${e.lineType} transparent`,borderRadius:"50%","&-blue":{color:e.colorPrimary,borderColor:e.colorPrimary},"&-red":{color:e.colorError,borderColor:e.colorError},"&-green":{color:e.colorSuccess,borderColor:e.colorSuccess},"&-gray":{color:e.colorTextDisabled,borderColor:e.colorTextDisabled}},"&-head-custom":{position:"absolute",insetBlockStart:e.timeLineItemHeadSize/2,insetInlineStart:e.timeLineItemHeadSize/2,width:"auto",height:"auto",marginBlockStart:0,paddingBlock:e.timeLineItemCustomHeadPaddingVertical,lineHeight:1,textAlign:"center",border:0,borderRadius:0,transform:"translate(-50%, -50%)"},"&-content":{position:"relative",insetBlockStart:-(e.fontSize*e.lineHeight-e.fontSize)+e.lineWidth,marginInlineStart:e.margin+e.timeLineItemHeadSize,marginInlineEnd:0,marginBlockStart:0,marginBlockEnd:0,wordBreak:"break-word"},"&-last":{[`> ${l}-item-tail`]:{display:"none"},[`> ${l}-item-content`]:{minHeight:e.controlHeightLG*1.2}}},[`&${l}-alternate,
        &${l}-right,
        &${l}-label`]:{[`${l}-item`]:{"&-tail, &-head, &-head-custom":{insetInlineStart:"50%"},"&-head":{marginInlineStart:`-${e.marginXXS}px`,"&-custom":{marginInlineStart:e.timeLineItemTailWidth/2}},"&-left":{[`${l}-item-content`]:{insetInlineStart:`calc(50% - ${e.marginXXS}px)`,width:`calc(50% - ${e.marginSM}px)`,textAlign:"start"}},"&-right":{[`${l}-item-content`]:{width:`calc(50% - ${e.marginSM}px)`,margin:0,textAlign:"end"}}}},[`&${l}-right`]:{[`${l}-item-right`]:{[`${l}-item-tail,
            ${l}-item-head,
            ${l}-item-head-custom`]:{insetInlineStart:`calc(100% - ${(e.timeLineItemHeadSize+e.timeLineItemTailWidth)/2}px)`},[`${l}-item-content`]:{width:`calc(100% - ${e.timeLineItemHeadSize+e.marginXS}px)`}}},[`&${l}-pending
        ${l}-item-last
        ${l}-item-tail`]:{display:"block",height:`calc(100% - ${e.margin}px)`,borderInlineStart:`${e.timeLineItemTailWidth}px dotted ${e.colorSplit}`},[`&${l}-reverse
        ${l}-item-last
        ${l}-item-tail`]:{display:"none"},[`&${l}-reverse ${l}-item-pending`]:{[`${l}-item-tail`]:{insetBlockStart:e.margin,display:"block",height:`calc(100% - ${e.margin}px)`,borderInlineStart:`${e.timeLineItemTailWidth}px dotted ${e.colorSplit}`},[`${l}-item-content`]:{minHeight:e.controlHeightLG*1.2}},[`&${l}-label`]:{[`${l}-item-label`]:{position:"absolute",insetBlockStart:-(e.fontSize*e.lineHeight-e.fontSize)+e.timeLineItemTailWidth,width:`calc(50% - ${e.marginSM}px)`,textAlign:"end"},[`${l}-item-right`]:{[`${l}-item-label`]:{insetInlineStart:`calc(50% + ${e.marginSM}px)`,width:`calc(50% - ${e.marginSM}px)`,textAlign:"start"}}},"&-rtl":{direction:"rtl",[`${l}-item-head-custom`]:{transform:"translate(50%, -50%)"}}})}},Me=fe("Timeline",e=>{const l=ve(e,{timeLineItemPaddingBottom:e.padding*1.25,timeLineItemHeadSize:10,timeLineItemCustomHeadPaddingVertical:e.paddingXXS,timeLinePaddingInlineEnd:2,timeLineItemTailWidth:e.lineWidthBold,timeLineHeadBorderWidth:e.wireframe?e.lineWidthBold:e.lineWidth*3});return[We(l)]}),Ne=()=>({prefixCls:String,pending:P.any,pendingDot:P.any,reverse:_e(),mode:P.oneOf(me("left","alternate","right",""))}),V=K({compatConfig:{MODE:3},name:"ATimeline",inheritAttrs:!1,props:ce(Ne(),{reverse:!1,mode:""}),slots:Object,setup(e,l){let{slots:h,attrs:g}=l;const{prefixCls:d,direction:I}=ue("timeline",e),[D,L]=Me(d),H=(i,b)=>{const _=i.props||{};return e.mode==="alternate"?_.position==="right"?`${d.value}-item-right`:_.position==="left"?`${d.value}-item-left`:b%2===0?`${d.value}-item-left`:`${d.value}-item-right`:e.mode==="left"?`${d.value}-item-left`:e.mode==="right"?`${d.value}-item-right`:_.position==="right"?`${d.value}-item-right`:""};return()=>{var i,b,_;const{pending:$=(i=h.pending)===null||i===void 0?void 0:i.call(h),pendingDot:F=(b=h.pendingDot)===null||b===void 0?void 0:b.call(h),reverse:W,mode:M}=e,Y=typeof $=="boolean"?null:$,m=ge((_=h.default)===null||_===void 0?void 0:_.call(h)),p=$?a(j,{pending:!!$,dot:F||a(be,null,null)},{default:()=>[Y]}):null;p&&m.push(p);const S=W?m.reverse():m,R=S.length,y=`${d.value}-item-last`,X=S.map((C,w)=>{const T=w===R-2?y:"",n=w===R-1?y:"";return ye(C,{class:oe([!W&&$?T:n,H(C,w)])})}),G=S.some(C=>{var w,T;return!!(!((w=C.props)===null||w===void 0)&&w.label||!((T=C.children)===null||T===void 0)&&T.label)}),U=oe(d.value,{[`${d.value}-pending`]:!!$,[`${d.value}-reverse`]:!!W,[`${d.value}-${M}`]:!!M&&!G,[`${d.value}-label`]:G,[`${d.value}-rtl`]:I.value==="rtl"},g.class,L.value);return D(a("ul",ne(ne({},g),{},{class:U}),[X]))}}});V.Item=j;V.install=function(e){return e.component(V.name,V),e.component(j.name,j),e};const f=e=>(we("data-v-7df8698d"),e=e(),Le(),e),Ae={class:"container"},Ee={key:0,class:"content_wrapper"},Ve={class:"lyecs-form-table"},je={class:"flex"},Fe={class:"container-card"},Re={class:"title flex flex-justify-between"},Xe=f(()=>t("p",null,"售后明细",-1)),Ge={key:0,class:"btn flex"},qe={key:0},Ue={key:1},ke={key:2},Ke={key:3},Ye={class:"info-card"},Ze={class:"card-title"},Je={class:"card-li"},Qe=f(()=>t("div",null,"售后方式：",-1)),et={class:"li-info red"},tt={class:"card-li"},it=f(()=>t("div",null,"售后状态：",-1)),lt={class:"li-info"},at={class:"card-li"},st=f(()=>t("div",null,"申请时间：",-1)),ot={class:"li-info"},nt={class:"card-li"},rt=f(()=>t("div",null,"退款原因：",-1)),dt={class:"li-info"},ct={class:"card-li"},ut=f(()=>t("div",null,"退款说明：",-1)),_t={class:"li-info"},mt={class:"card-title"},pt={key:0,class:"card-li"},ft=f(()=>t("div",null,"退款进度：",-1)),vt={class:"li-info"},ht={class:"refund-info flex"},gt=f(()=>t("div",{style:{color:"#666"}},"线上退款：",-1)),bt={class:"li-info"},yt={style:{"margin-left":"10px"}},$t={class:"refund-info flex"},xt=f(()=>t("div",{style:{color:"#666"}},"线下退款：",-1)),St={class:"li-info"},It={style:{"margin-left":"10px"}},Ct={class:"flex"},wt=f(()=>t("div",{style:{color:"#666"}},"余额退款：",-1)),Lt={class:"li-info"},Ht={style:{"margin-left":"10px"}},Bt={key:1,class:"card-li"},Tt=f(()=>t("div",null,"退款金额：",-1)),Dt={class:"li-info"},zt={class:"card-li"},Ot=f(()=>t("div",null,"物流公司：",-1)),Pt={class:"li-info"},Wt={class:"card-li"},Mt=f(()=>t("div",null,"物流单号：",-1)),Nt={class:"li-info"},At={key:2,class:"card-li"},Et={class:"li-info"},Vt={class:"negotiation-box"},jt={class:"negotiation-title flex flex-justify-between"},Ft=f(()=>t("div",null,"协商记录",-1)),Rt={key:0,class:"btn"},Xt={class:"btn-box"},Gt={class:"negotiation-content"},qt={key:0,class:"logo"},Ut={key:1,class:"logo-b"},kt={class:"info-box"},Kt={class:"tit"},Yt={key:0,class:"txt"},Zt={key:1,class:"txt"},Jt={key:0},Qt={key:1},ei={class:"time"},ti={class:"detail"},ii={key:0,class:"content"},li={key:1,class:"card-li"},ai=f(()=>t("span",null,"售后方式：",-1)),si={class:"li-info"},oi={key:2,class:"card-li"},ni=f(()=>t("span",null,"退款原因：",-1)),ri={class:"li-info"},di={key:3,class:"card-li"},ci=f(()=>t("span",null,"退款说明：",-1)),ui={class:"li-info"},_i={key:4,class:"card-li"},mi=f(()=>t("span",null,"上传凭证：",-1)),pi={class:"li-info"},fi=K({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},type:{type:Number,default:0},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(e,{expose:l,emit:h}){const g=h,d=e,I=z(!0),D=$e().currentRoute.value.query,L=z(d.isDialog?d.act:String(D.act)),H=z(d.isDialog?d.id:Number(D.id));L.value,xe();const i=z({pic_thumb:"",number:1}),b=z(!1),_=z({log_info:"",return_pic:[]}),$=async()=>{try{const m=await Te(L.value,{id:H.value});Object.assign(i.value,m.item),i.value.aftersales_type_config=F(i.value.aftersales_type_config),i.value.status_config=F(i.value.status_config),i.value.modify_number=i.value.number}catch(m){E.error(m.message),g("close")}finally{I.value=!1}},F=m=>{if(typeof m=="object"){var p=[];for(let S in m)p.push(m[S]);return p}else return m},W=async m=>{if(_.value.log_info=="")return E.error("请输入留言内容"),!1;try{const p=await De({aftersale_id:m,..._.value});b.value=!1;let S={log_info:"",return_pic:[]};_.value=S,$()}catch(p){E.error(p.message)}finally{I.value=!1}};Se(()=>{$()});const M=async()=>{try{const m=await ze({id:H.value});E.success(m.message),g("submitCallback")}catch(m){E.error(m.message)}};return l({onFormSubmit:()=>{}}),(m,p)=>{const S=B("el-table-column"),R=B("el-table"),y=B("el-button"),X=B("el-popconfirm"),G=B("el-popover"),U=B("el-input"),C=B("el-form-item"),w=B("el-form"),T=Ie("loading");return Ce((s(),r("div",Ae,[I.value?u("",!0):(s(),r("div",Ee,[t("div",Ve,[a(R,{data:i.value.aftersales_items,style:{width:"100%","margin-bottom":"20px"},border:""},{default:o(()=>[a(S,{label:"商品信息",width:"400"},{default:o(({row:n})=>[t("div",je,[a(v(Oe),{pic_thumb:n.pic_thumb,product_id:n.product_id,product_name:n.product_name},null,8,["pic_thumb","product_id","product_name"])])]),_:1}),a(S,{label:"商品价格",align:"center"},{default:o(({row:n})=>[t("div",null,c(v(A)(n.price)),1)]),_:1}),a(S,{prop:"quantity",label:"商品数量",align:"center"}),a(S,{prop:"number",label:"退货数量",align:"center"})]),_:1},8,["data"]),t("div",Fe,[t("div",Re,[Xe,e.type!=2?(s(),r("div",Ge,[i.value.aftersale_type==1&&i.value.status!=6?(s(),r("div",qe,[a(v(q),{params:{status:2,formData:i.value},isDrawer:"",path:"order/aftersales/Handle",title:"处理售后",width:"600px",showClose:!1,showOnOk:!1,onOkCallback:$},{default:o(()=>[a(y,{type:"primary",style:{"margin-right":"10px"}},{default:o(()=>[x(" 同意并发送退货地址 ")]),_:1})]),_:1},8,["params"]),a(v(q),{params:{status:3,formData:i.value},isDrawer:"",path:"order/aftersales/Handle",title:"处理售后",width:"600px",showClose:!1,showOnOk:!1,onOkCallback:$},{default:o(()=>[a(y,null,{default:o(()=>[x(" 拒绝退货退款 ")]),_:1})]),_:1},8,["params"])])):u("",!0),i.value.aftersale_type==2&&i.value.status!=6?(s(),r("div",Ue,[a(v(q),{params:{status:2,formData:i.value},isDrawer:"",path:"order/aftersales/Handle",title:"处理售后",width:"600px",showClose:!1,showOnOk:!1,onOkCallback:$},{default:o(()=>[a(y,{type:"primary",style:{"margin-right":"10px"}},{default:o(()=>[x(" 同意仅退款 ")]),_:1})]),_:1},8,["params"]),a(v(q),{params:{status:3,formData:i.value},isDrawer:"",path:"order/aftersales/Handle",title:"处理售后",width:"600px",showClose:!1,showOnOk:!1,onOkCallback:$},{default:o(()=>[a(y,null,{default:o(()=>[x(" 拒绝仅退款 ")]),_:1})]),_:1},8,["params"])])):u("",!0),i.value.status!=6?(s(),r("div",ke,[a(X,{width:"220","confirm-button-text":"确认","cancel-button-text":"取消",title:"确认已收到货?",onConfirm:M},{reference:o(()=>[a(y,{style:{"margin-left":"10px"}},{default:o(()=>[x(" 关闭订单 ")]),_:1})]),_:1})])):u("",!0),i.value.aftersale_type==1&&i.value.status==5?(s(),r("div",Ke,[a(X,{width:"220","confirm-button-text":"确认","cancel-button-text":"取消",title:"确认已收到货?",onConfirm:M},{reference:o(()=>[a(y,{type:"primary"},{default:o(()=>[x(" 确认收货 ")]),_:1})]),_:1})])):u("",!0)])):u("",!0)]),t("div",Ye,[t("div",Ze,[t("ul",null,[t("li",Je,[Qe,t("div",et,c(i.value.aftersales_type_name),1)]),t("li",tt,[it,t("div",lt,c(i.value.status_name),1)]),t("li",at,[st,t("div",ot,c(i.value.add_time?i.value.add_time:"--"),1)]),t("li",nt,[rt,t("div",dt,c(i.value.aftersale_reason),1)]),t("li",ct,[ut,t("div",_t,c(i.value.description?i.value.description:"--"),1)])])]),t("div",mt,[t("ul",null,[i.value.refund?(s(),r("li",pt,[ft,t("div",vt,[a(G,{width:220,"popper-style":"box-shadow: rgb(14 18 22 / 35%) 0px 10px 38px -10px, rgb(14 18 22 / 20%) 0px 10px 20px -15px; padding: 20px;"},{reference:o(()=>[i.value.refund.refund_status==2?(s(),O(y,{key:0,type:"primary",link:""},{default:o(()=>[x("退款完成")]),_:1})):(s(),O(y,{key:1,type:"danger",link:""},{default:o(()=>[x("退款中")]),_:1}))]),default:o(()=>[t("div",ht,[gt,t("div",bt,c(v(A)(i.value.refund.online_balance)||"0"),1),t("div",yt," ( "+c(i.value.refund.is_online==2?"退款成功":i.value.refund.is_online==1?"退款中":"无需退款")+" ) ",1)]),t("div",$t,[xt,t("div",St,c(v(A)(i.value.refund.offline_balance)||"0"),1),t("div",It," ( "+c(i.value.refund.is_offline==2?"退款成功":i.value.refund.is_offline==1?"退款中":"无需退款")+" ) ",1)]),t("div",Ct,[wt,t("div",Lt,c(v(A)(i.value.refund.refund_balance)||"0"),1),t("div",Ht," ( "+c(i.value.refund.is_receive==2?"退款成功":i.value.refund.is_receive==1?"退款中":"无需退款")+" ) ",1)])]),_:1})])])):u("",!0),i.value.status==2?(s(),r("li",Bt,[Tt,t("div",Dt,c(v(A)(i.value.suggest_refund_amount)||"0"),1)])):u("",!0),t("li",zt,[Ot,t("div",Pt,c(i.value.logistics_name||"--"),1)]),t("li",Wt,[Mt,t("div",Nt,c(i.value.tracking_no||"--"),1)]),i.value.aftersales_items?(s(),r("li",At,[x(" 订单编号："),t("span",Et,c(i.value.aftersales_items[0].order_sn),1)])):u("",!0)])])])]),t("div",Vt,[t("div",jt,[Ft,i.value.status==1&&e.type!=2?(s(),r("div",Rt,[a(y,{bg:"",size:"small",text:"",type:"primary",disabled:b.value,onClick:p[0]||(p[0]=n=>b.value=!0)},{default:o(()=>[x(" 点击发表留言 ")]),_:1},8,["disabled"])])):u("",!0)]),b.value?(s(),O(w,{key:0,model:_.value,"label-width":"auto",style:{"margin-top":"20px"}},{default:o(()=>[a(C,{label:"留言内容：",prop:"log_info"},{default:o(()=>[a(U,{modelValue:_.value.log_info,"onUpdate:modelValue":p[1]||(p[1]=n=>_.value.log_info=n),rows:4,type:"textarea",maxlength:"300","show-word-limit":"",placeholder:"你可以在这里给买家留言, 为了保证你的权益, 请尽可能详细的上传留言资料"},null,8,["modelValue"])]),_:1}),a(C,{label:"上传凭证：",prop:"return_pic"},{default:o(()=>[I.value?u("",!0):(s(),O(v(Be),{key:0,photos:_.value.return_pic,"onUpdate:photos":p[2]||(p[2]=n=>_.value.return_pic=n),isMultiple:!0},null,8,["photos"]))]),_:1}),a(C,null,{default:o(()=>[t("div",Xt,[a(y,{type:"primary",onClick:p[3]||(p[3]=n=>W(i.value.aftersale_id))},{default:o(()=>[x("发表留言")]),_:1}),a(y,{onClick:p[4]||(p[4]=n=>b.value=!1)},{default:o(()=>[x("取消")]),_:1})])]),_:1})]),_:1},8,["model"])):u("",!0),t("div",Gt,[a(v(V),null,{default:o(()=>[(s(!0),r(re,null,de(i.value.aftersales_log,(n,N)=>(s(),O(v(j),null,{dot:o(()=>[n.user_name?(s(),r("div",qt,"买")):u("",!0),n.admin_name?(s(),r("div",Ut,"商")):u("",!0)]),default:o(()=>{var Z,J,Q,ee,te,ie;return[t("div",kt,[t("div",Kt,[N+1==((Z=i.value.aftersales_log)==null?void 0:Z.length)?(s(),r("div",Yt,c(n.log_info),1)):(s(),r("div",Zt,[n.user_name?(s(),r("span",Jt,"买家")):u("",!0),n.admin_name?(s(),r("span",Qt,"商家")):u("",!0),x(" 留言 ")])),t("div",ei,c(n.add_time),1)]),t("div",ti,[N+1!=((J=i.value.aftersales_log)==null?void 0:J.length)?(s(),r("div",ii,c(n.log_info),1)):u("",!0),N+1==((Q=i.value.aftersales_log)==null?void 0:Q.length)?(s(),r("div",li,[ai,t("span",si,c(i.value.aftersales_type_name),1)])):u("",!0),N+1==((ee=i.value.aftersales_log)==null?void 0:ee.length)?(s(),r("div",oi,[ni,t("span",ri,c(i.value.aftersale_reason),1)])):u("",!0),N+1==((te=i.value.aftersales_log)==null?void 0:te.length)?(s(),r("div",di,[ci,t("span",ui,c(i.value.description),1)])):u("",!0),((ie=n.return_pic)==null?void 0:ie.length)>0?(s(),r("div",_i,[mi,t("span",pi,[(s(!0),r(re,null,de(n.return_pic,le=>(s(),O(v(pe),{style:{"margin-right":"10px",border:"1px solid rgba(5, 5, 5, 0.06)"},width:"60",height:"60",src:v(ae)(le.pic_thumb),"preview-src-list":[v(ae)(le.pic_url)],fit:"cover"},null,8,["src","preview-src-list"]))),256))])])):u("",!0)])])]}),_:2},1024))),256))]),_:1})])])])]))])),[[T,I.value]])}}});const Bi=He(fi,[["__scopeId","data-v-7df8698d"]]);export{Bi as default};
