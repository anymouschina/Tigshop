import{d as K,i as V,C as O,s as G,q as H,r as _,c as i,o as u,e as g,b as a,j as B,f as v,w as o,F as x,a as J,g as Q,a0 as W,E as d,a1 as X,I as R,_ as Y}from"./index-CGYuOau0.js";import{a as Z,b as $}from"./messageType-BdToDhus.js";const c={class:"container"},h={class:"content_wrapper"},ee={class:"lyecs-form-table"},ae={key:0},le={class:"tznr"},te={class:"fl1 right-div"},oe={key:1},se={key:1},me={key:2},ue={key:3},de={key:4},ne={key:5},pe=K({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(N,{expose:T,emit:F}){const y=F,b=N,w=V(!0),C=O().currentRoute.value.query,k=V(b.isDialog?b.act:String(C.act)),D=V(b.isDialog?b.id:Number(C.id)),L=k.value==="add"?"create":"update",z=G(),l=V({template_message:{wechat_data:{},app_data:{},ding_data:{},message_data:{},mini_program_data:{},msg_data:{}}}),r=V("站内信"),M=p=>{console.log(p)};let I=V([{prop:"is_message",label:"站内信"},{prop:"is_msg",label:"短信通知"},{prop:"is_wechat",label:"微信模板消息"},{prop:"is_mini_program",label:"小程序订阅消息"}]);const q=async()=>{try{const p=await Z(k.value,{id:D.value});Object.assign(l.value,p.item);for(const e of I.value){const U=l.value[e.prop];if(typeof U=="number"&&U>-1){r.value=e.label;break}}}catch(p){R.error(p.message),y("close")}finally{w.value=!1}};H(()=>{k.value==="detail"?q():w.value=!1});const S=async()=>{await z.value.validate();try{y("update:confirmLoading",!0);const p=await $(L,{id:D.value,...l.value});y("submitCallback",p),R.success(p.message)}catch(p){R.error(p.message)}finally{y("update:confirmLoading",!1)}};return T({onFormSubmit:()=>{S()}}),(p,e)=>{const U=_("el-tab-pane"),j=_("el-tabs"),m=_("el-input"),s=_("el-form-item"),n=_("el-radio"),f=_("el-radio-group"),E=_("el-button"),P=_("el-form"),A=_("a-spin");return u(),i("div",c,[g("div",h,[g("div",ee,[a(j,{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=t=>r.value=t),class:"lyecs-tabs","tab-position":"top",onTabChange:M},{default:o(()=>[(u(!0),i(x,null,J(Q(I),t=>(u(),i(x,null,[l.value[t.prop]>-1?(u(),B(U,{key:0,label:t.label,name:t.label},null,8,["label","name"])):v("",!0)],64))),256))]),_:1},8,["modelValue"]),w.value?v("",!0):(u(),B(P,{key:0,ref_key:"formRef",ref:z,model:l.value,"label-width":"auto"},{default:o(()=>[r.value==="站内信"?(u(),i("div",ae,[a(s,{label:"通知标题",prop:"template_name"},{default:o(()=>[a(m,{modelValue:l.value.template_message.message_data.template_name,"onUpdate:modelValue":e[1]||(e[1]=t=>l.value.template_message.message_data.template_name=t)},null,8,["modelValue"])]),_:1}),a(s,{label:"通知内容",prop:"content"},{default:o(()=>[g("div",le,[a(m,{modelValue:l.value.template_message.message_data.content,"onUpdate:modelValue":e[2]||(e[2]=t=>l.value.template_message.message_data.content=t),autosize:{minRows:9,maxRows:60},class:"fl1",type:"textarea"},null,8,["modelValue"]),g("div",te,[e[24]||(e[24]=g("p",null,"请输入模板消息详细内容对应的变量，关键字个数需与添加的模板一致。可以使用如下变量：",-1)),l.value.template_message.message_data.message_id==3?(u(),i(x,{key:0},[e[21]||(e[21]=g("p",null,"{order_sn}订单编号",-1)),e[22]||(e[22]=g("p",null,"{logistics_name}物流公司",-1)),e[23]||(e[23]=g("p",null,"{tracking_no}物流单号",-1))],64)):(u(),i("p",oe," {order_sn}订单编号"))])])]),_:1}),a(s,{label:"是否开启",prop:"is_message"},{default:o(()=>[a(f,{modelValue:l.value.is_message,"onUpdate:modelValue":e[3]||(e[3]=t=>l.value.is_message=t)},{default:o(()=>[a(n,{value:1},{default:o(()=>e[25]||(e[25]=[d("是")])),_:1}),a(n,{value:0},{default:o(()=>e[26]||(e[26]=[d("否")])),_:1})]),_:1},8,["modelValue"])]),_:1})])):v("",!0),r.value==="短信通知"?(u(),i("div",se,[a(s,{label:"短信模板ID",prop:"template_id"},{default:o(()=>[a(m,{modelValue:l.value.template_message.msg_data.template_id,"onUpdate:modelValue":e[4]||(e[4]=t=>l.value.template_message.msg_data.template_id=t)},null,8,["modelValue"])]),_:1}),a(s,{label:"通知内容",prop:"content"},{default:o(()=>[a(m,{modelValue:l.value.template_message.msg_data.content,"onUpdate:modelValue":e[5]||(e[5]=t=>l.value.template_message.msg_data.content=t),autosize:{minRows:9,maxRows:60},class:"fl1",disabled:"",type:"textarea"},null,8,["modelValue"])]),_:1}),a(s,{label:"是否开启",prop:"is_msg"},{default:o(()=>[a(f,{modelValue:l.value.is_msg,"onUpdate:modelValue":e[6]||(e[6]=t=>l.value.is_msg=t)},{default:o(()=>[a(n,{value:1},{default:o(()=>e[27]||(e[27]=[d("是")])),_:1}),a(n,{value:0},{default:o(()=>e[28]||(e[28]=[d("否")])),_:1})]),_:1},8,["modelValue"])]),_:1})])):v("",!0),r.value==="微信模板消息"?(u(),i("div",me,[a(s,{label:"通知标题",prop:"template_name"},{default:o(()=>[a(m,{modelValue:l.value.template_message.wechat_data.template_name,"onUpdate:modelValue":e[7]||(e[7]=t=>l.value.template_message.wechat_data.template_name=t),disabled:""},null,8,["modelValue"])]),_:1}),a(s,{label:"模板ID",prop:"template_id"},{default:o(()=>[a(m,{modelValue:l.value.template_message.wechat_data.template_id,"onUpdate:modelValue":e[8]||(e[8]=t=>l.value.template_message.wechat_data.template_id=t),disabled:""},null,8,["modelValue"])]),_:1}),a(s,{label:"模板",prop:"content"},{default:o(()=>[a(m,{modelValue:l.value.template_message.wechat_data.content,"onUpdate:modelValue":e[9]||(e[9]=t=>l.value.template_message.wechat_data.content=t),autosize:{minRows:9,maxRows:60},class:"fl1",disabled:"",type:"textarea"},null,8,["modelValue"])]),_:1}),a(s,{label:"是否开启",prop:"is_wechat"},{default:o(()=>[a(f,{modelValue:l.value.is_wechat,"onUpdate:modelValue":e[10]||(e[10]=t=>l.value.is_wechat=t)},{default:o(()=>[a(n,{value:1},{default:o(()=>e[29]||(e[29]=[d("是")])),_:1}),a(n,{value:0},{default:o(()=>e[30]||(e[30]=[d("否")])),_:1})]),_:1},8,["modelValue"])]),_:1})])):v("",!0),r.value==="小程序订阅消息"?(u(),i("div",ue,[a(s,{label:"通知标题",prop:"template_name"},{default:o(()=>[a(m,{modelValue:l.value.template_message.mini_program_data.template_name,"onUpdate:modelValue":e[11]||(e[11]=t=>l.value.template_message.mini_program_data.template_name=t),disabled:""},null,8,["modelValue"])]),_:1}),a(s,{label:"模板ID",prop:"template_id"},{default:o(()=>[a(m,{modelValue:l.value.template_message.mini_program_data.template_id,"onUpdate:modelValue":e[12]||(e[12]=t=>l.value.template_message.mini_program_data.template_id=t),disabled:""},null,8,["modelValue"])]),_:1}),a(s,{label:"模板",prop:"content"},{default:o(()=>[a(m,{modelValue:l.value.template_message.mini_program_data.content,"onUpdate:modelValue":e[13]||(e[13]=t=>l.value.template_message.mini_program_data.content=t),autosize:{minRows:9,maxRows:60},class:"fl1",disabled:"",type:"textarea"},null,8,["modelValue"])]),_:1}),a(s,{label:"是否开启",prop:"is_mini_program"},{default:o(()=>[a(f,{modelValue:l.value.is_mini_program,"onUpdate:modelValue":e[14]||(e[14]=t=>l.value.is_mini_program=t)},{default:o(()=>[a(n,{value:1},{default:o(()=>e[31]||(e[31]=[d("是")])),_:1}),a(n,{value:0},{default:o(()=>e[32]||(e[32]=[d("否")])),_:1})]),_:1},8,["modelValue"])]),_:1})])):v("",!0),r.value==="APP"?(u(),i("div",de,[a(s,{label:"通知标题",prop:"template_name"},{default:o(()=>[a(m,{modelValue:l.value.template_message.app_data.template_name,"onUpdate:modelValue":e[15]||(e[15]=t=>l.value.template_message.app_data.template_name=t)},null,8,["modelValue"])]),_:1}),a(s,{label:"通知内容",prop:"content"},{default:o(()=>[a(m,{modelValue:l.value.template_message.app_data.content,"onUpdate:modelValue":e[16]||(e[16]=t=>l.value.template_message.app_data.content=t),autosize:{minRows:9,maxRows:60},class:"fl1",type:"textarea"},null,8,["modelValue"])]),_:1}),a(s,{label:"是否开启",prop:"is_app"},{default:o(()=>[a(f,{modelValue:l.value.is_app,"onUpdate:modelValue":e[17]||(e[17]=t=>l.value.is_app=t)},{default:o(()=>[a(n,{value:1},{default:o(()=>e[33]||(e[33]=[d("是")])),_:1}),a(n,{value:0},{default:o(()=>e[34]||(e[34]=[d("否")])),_:1})]),_:1},8,["modelValue"])]),_:1})])):v("",!0),r.value==="钉钉"?(u(),i("div",ne,[a(s,{label:"选择钉钉成员",prop:"template_name"},{default:o(()=>[a(m,{modelValue:l.value.template_message.ding_data.template_name,"onUpdate:modelValue":e[18]||(e[18]=t=>l.value.template_message.ding_data.template_name=t)},null,8,["modelValue"])]),_:1}),a(s,{label:"通知内容",prop:"content"},{default:o(()=>[a(m,{modelValue:l.value.template_message.ding_data.content,"onUpdate:modelValue":e[19]||(e[19]=t=>l.value.template_message.ding_data.content=t),autosize:{minRows:9,maxRows:60},class:"fl1",type:"textarea"},null,8,["modelValue"])]),_:1}),a(s,{label:"是否开启",prop:"is_app"},{default:o(()=>[a(f,{modelValue:l.value.is_ding,"onUpdate:modelValue":e[20]||(e[20]=t=>l.value.is_ding=t)},{default:o(()=>[a(n,{value:1},{default:o(()=>e[35]||(e[35]=[d("是")])),_:1}),a(n,{value:0},{default:o(()=>e[36]||(e[36]=[d("否")])),_:1})]),_:1},8,["modelValue"])]),_:1})])):v("",!0),W(a(s,{"wrapper-col":{offset:4,span:16}},{default:o(()=>[a(E,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:S},{default:o(()=>e[37]||(e[37]=[d("提交")])),_:1},512)]),_:1},512),[[X,!b.isDialog]])]),_:1},8,["model"])),a(A,{spinning:w.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}}),ge=Y(pe,[["__scopeId","data-v-2cabd077"]]);export{ge as default};
