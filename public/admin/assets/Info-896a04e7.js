import{d as B,j as c,E as D,s as R,x as U,K as f,r as d,o as V,c as w,e as k,b as a,w as r,$ as q,a0 as L,H as j,h as E}from"./index-7c2d2aef.js";import{c as F,e as H}from"./articleCategory-7e779613.js";import{S as K}from"./SelectArticleCategory-74d7e522.js";/* empty css                                                                              */const M={class:"container"},O={class:"content_wrapper"},T={key:0,class:"lyecs-form-table"},$=k("div",{class:"extra"},"关键字为选填项，其目的在于方便外部搜索引擎搜索",-1),W=B({__name:"Info",props:{id:{type:Number,default:0},parentId:{type:Array,default:[]},act:{type:String,default:""},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(_,{expose:x,emit:C}){const u=C,o=_,i=c(!0),v=D().currentRoute.value.query,m=c(o.isDialog?o.act:String(v.act)),y=c(o.isDialog?o.id:Number(v.id)),S=m.value==="add"?"create":"update",g=R(),e=c({article_category_name:"",parent_id:o.parentId,keywords:"",description:"",sort_order:50});U(()=>{m.value==="detail"?h():i.value=!1});const h=async()=>{try{i.value=!0;const n=await F(m.value,{id:y.value});Object.assign(e.value,n.item),console.log(o.parentId),o.parentId&&(e.value.parent_id=o.parentId)}catch(n){f.error(n.message),u("close")}finally{i.value=!1}},b=async()=>{await g.value.validate();let n="";e.value.parent_id&&e.value.parent_id.length>0&&(n=e.value.parent_id[0]);try{u("update:confirmLoading",!0);const t=await H(S,{id:y.value,...e.value,parent_id:n});u("submitCallback",t),f.success(t.message)}catch(t){f.error(t.message)}finally{u("update:confirmLoading",!1)}};return x({onFormSubmit:()=>{b()}}),(n,t)=>{const p=d("el-input"),s=d("el-form-item"),I=d("el-button"),N=d("el-form"),A=d("a-spin");return V(),w("div",M,[k("div",O,[i.value?E("",!0):(V(),w("div",T,[a(N,{ref_key:"formRef",ref:g,model:e.value,"label-width":"auto"},{default:r(()=>[a(s,{rules:[{required:!0,message:"文章分类名称不能为空!"}],extra:"sfs",label:"文章分类名称",prop:"article_category_name"},{default:r(()=>[a(p,{modelValue:e.value.article_category_name,"onUpdate:modelValue":t[0]||(t[0]=l=>e.value.article_category_name=l)},null,8,["modelValue"])]),_:1}),a(s,{label:"上级分类",prop:"parent_id"},{default:r(()=>[a(K,{"min-width":"100%",modelValue:e.value.parent_id,"onUpdate:modelValue":t[1]||(t[1]=l=>e.value.parent_id=l),disabled:m.value=="add"&&!_.parentId},null,8,["modelValue","disabled"])]),_:1}),a(s,{label:"关键字",prop:"keywords"},{default:r(()=>[a(p,{modelValue:e.value.keywords,"onUpdate:modelValue":t[2]||(t[2]=l=>e.value.keywords=l)},null,8,["modelValue"])]),_:1}),a(s,{label:"描述",prop:"description"},{default:r(()=>[a(p,{modelValue:e.value.description,"onUpdate:modelValue":t[3]||(t[3]=l=>e.value.description=l),row:"2",type:"textarea"},null,8,["modelValue"]),$]),_:1}),a(s,{prop:"sort_order",label:"排序"},{default:r(()=>[a(p,{modelValue:e.value.sort_order,"onUpdate:modelValue":t[4]||(t[4]=l=>e.value.sort_order=l)},null,8,["modelValue"])]),_:1}),q(a(s,{"wrapper-col":{offset:4,span:16}},{default:r(()=>[a(I,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:b},{default:r(()=>[j("提交 ")]),_:1},512)]),_:1},512),[[L,!o.isDialog]])]),_:1},8,["model"])])),a(A,{spinning:i.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])}}});export{W as default};
