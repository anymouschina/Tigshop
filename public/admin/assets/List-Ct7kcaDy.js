import{y as Y,d as B,i as f,G as I,K,q as P,c as v,e as l,b as t,w as n,f as D,g as y,I as x,r,o as b,L as T,E as k,D as h,_ as F}from"./index-CGYuOau0.js";import{u as R}from"./config-DNllFJyR.js";import{p as G}from"./format-DFT-VJzO.js";import"./SelectTimeInterval.vue_vue_type_style_index_0_scoped_207fe586_lang-t3_hMxDC.js";import"./index-B-GURfkM.js";/* empty css                                                                    */import{P as X}from"./Pagination-yOfjsBuR.js";/* empty css                                                                  *//* empty css                                                                              */import{S as j}from"./SelectTimeInterval-BYQIPzkk.js";/* empty css             */import{f as S}from"./time-ClyPenjC.js";import{r as A}from"./export-Bb89fUlC.js";import"./config-DU8_t5BN.js";const H=i=>Y({url:"panel/statistics_user/user_consumption_ranking",method:"get",params:i}),J=i=>Y({url:"panel/statistics_user/user_consumption_ranking",method:"get",responseType:"arraybuffer",params:i}),O={class:"container"},Q={class:"content_wrapper"},W={class:"filtrate-menu"},Z={class:"empty-warp"},$={key:0,class:"empty-bg"},ee={key:0,class:"pagination-con"},te=B({__name:"List",setup(i){const z=R(),p=f(!1),w=f(),d=f(0),o=I({page:1,size:z.pageSize,keyword:"",start_time:S(K(30,"sub"),"YYYY-MM-DD"),end_time:S(new Date,"YYYY-MM-DD")}),m=async()=>{p.value=!0;try{const a=await H(o);a.errcode===0&&(w.value=a.filter_result,d.value=a.total)}catch(a){x.error(a.message),console.error(a)}p.value=!1},g=()=>{m()},u=f(!1),E=async()=>{u.value=!0;try{const a=await J({...o,is_export:"1"});u.value=!1,A(a,"消费排行导出")}catch(a){x.error(a.message)}finally{u.value=!1}},U=({prop:a,order:e})=>{console.log(a,e),o.sort_field=a,o.sort_order=e=="ascending"?"asc":e=="descending"?"desc":"",m()},V=()=>{m()};return P(()=>{m()}),(a,e)=>{const c=r("el-form-item"),M=r("el-input"),C=r("el-button"),L=r("el-form"),_=r("el-table-column"),N=r("el-table"),q=r("a-spin");return b(),v("div",O,[l("div",Q,[e[7]||(e[7]=l("div",{class:"notice-warp"},"提示：查询的时间间隔上限默认为一月，如果数据量过大导至查询时间过久或者超时报错，请尝试缩小查询的时间间隔！",-1)),t(L,{model:o},{default:n(()=>[l("div",W,[t(c,{class:"mr-10"},{default:n(()=>[t(y(j),{type:"date","start-date":o.start_time,"onUpdate:startDate":e[0]||(e[0]=s=>o.start_time=s),"end-date":o.end_time,"onUpdate:endDate":e[1]||(e[1]=s=>o.end_time=s)},null,8,["start-date","end-date"])]),_:1}),t(c,{class:"mr-10"},{default:n(()=>[t(M,{modelValue:o.keyword,"onUpdate:modelValue":e[2]||(e[2]=s=>o.keyword=s),placeholder:"输入会员名称或者手机号",onKeyup:T(g,["enter"]),clearable:"",onClear:g},null,8,["modelValue"])]),_:1}),t(c,{class:"mr-10"},{default:n(()=>[t(C,{plain:"",onClick:g},{default:n(()=>e[5]||(e[5]=[k("搜索")])),_:1})]),_:1}),t(c,{class:"mr-10"},{default:n(()=>[t(C,{plain:"",onClick:E,loading:u.value},{default:n(()=>e[6]||(e[6]=[k("导出EXCEL")])),_:1},8,["loading"])]),_:1})])]),_:1},8,["model"]),l("div",null,[t(q,{spinning:p.value},{default:n(()=>[t(N,{data:w.value,total:d.value,"row-key":"product_id",onSortChange:U},{empty:n(()=>[l("div",Z,[p.value?D("",!0):(b(),v("div",$,"暂无数据"))])]),default:n(()=>[t(_,{label:"会员名称",prop:"username"}),t(_,{label:"手机号",prop:"mobile"}),t(_,{label:"订单数",prop:"order_num",sortable:"custom"}),t(_,{label:"消费总额",prop:"order_amount",sortable:"custom"},{default:n(({row:s})=>[k(h(y(G)(s.order_amount)),1)]),_:1})]),_:1},8,["data","total"])]),_:1},8,["spinning"]),d.value>0?(b(),v("div",ee,[t(y(X),{page:o.page,"onUpdate:page":e[3]||(e[3]=s=>o.page=s),size:o.size,"onUpdate:size":e[4]||(e[4]=s=>o.size=s),total:d.value,onCallback:V},null,8,["page","size","total"])])):D("",!0)])])])}}}),ge=F(te,[["__scopeId","data-v-b1c4857e"]]);export{ge as default};
