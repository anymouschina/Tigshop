import{d as Y,i as N,C as Z,s as ee,q as le,I as k,r as m,c as _,o as b,e as u,j as B,f as U,b as l,w as a,a3 as ae,E as d,g as C,bm as te,F as oe,a as ie,D,l as ne,a4 as pe,_ as se}from"./index-DrbzVNl6.js";import{a as re,c as de,e as ue}from"./shippingTpl-CeXwguU5.js";import"./index-CeQDmMxd.js";/* empty css                                                                  */import{_ as fe}from"./Checkbox.vue_vue_type_script_setup_true_lang-B1TQ86Kt.js";import{u as me}from"./region-0UpBBzwZ.js";import{_ as E}from"./DialogForm.vue_vue_type_script_setup_true_lang-DqYSRv0_.js";import"./region-p-p629KP.js";const ge={class:"container"},Te={class:"content_wrapper"},ce={class:"lyecs-form-table"},be={key:0},he={class:"shipping-method-style"},ve={class:"flex"},Ie={key:0,class:"table-style"},ye={class:"title-style"},_e={class:"ysd"},Ve={style:{flex:"1"}},we=Y({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(L,{expose:j,emit:O}){me().getRegionList();const V=O,v=L,I=N(!0),S=Z().currentRoute.value.query,y=N(v.isDialog?v.act:String(S.act)),x=N(v.isDialog?v.id:Number(S.id)),z=y.value==="add"?"create":"update",q=ee(),n=N({shippingTplInfo:[],isDefault:0,isFree:0,pricingType:1}),T=(o,e,s)=>{e?e.length>0&&Number(e)<=0?s(new Error("需大于0")):s():s(new Error("请输入"))},A=async()=>{try{const o=await de(y.value,{id:x.value});o.shippingTplInfo.map((e,s)=>{e.isChecked=1,e.defaultTplInfo==null&&(e.defaultTplInfo=P(e.shippingTypeId,e.shippingTypeName,1),e.areaTplInfo=[],e.isChecked=0)}),Object.assign(n.value,o)}catch(o){k.error(o.message),V("close")}finally{I.value=!1}},M=o=>{for(let e=0;e<n.value.shippingTplInfo.length;e++);},G=(o,e)=>{n.value.shippingTplInfo&&n.value.shippingTplInfo[o].areaTplInfo&&n.value.shippingTplInfo[o].areaTplInfo.splice(e,1)},H=o=>{o.areaTplInfo.push(P(o.shippingTypeId,o.shippingTypeName,0))},J=o=>{n.value.shippingTplInfo[o.index].areaTplInfo[o.itemIndex].regionData.areaRegionNames=o.regionNames,n.value.shippingTplInfo[o.index].areaTplInfo[o.itemIndex].regionData.areaRegions=o.regionIds},P=(o,e,s)=>({shippingTplId:0,shippingTypeId:o,isDefault:s,startNumber:"",startPrice:"",addNumber:"",addPrice:"",freePrice:"",regionData:{areaRegions:[],areaRegionNames:[]},shippingTypeName:e});le(async()=>{await $(),y.value==="detail"?await A():I.value=!1});const $=async()=>{try{const o=await re();o.forEach(e=>{e.isChecked=1,e.defaultTplInfo==null&&(e.defaultTplInfo=P(e.shippingTypeId,e.shippingTypeName,1),e.areaTplInfo=[],e.isChecked=0)}),n.value.shippingTplInfo=o}catch(o){k.error(o.message)}finally{I.value=!1}},F=async()=>{await q.value.validate();try{V("update:confirmLoading",!0);const o=await ue(z,{id:x.value,...n.value});V("submitCallback",o),k.success("操作成功")}catch(o){k.error(o.message)}finally{V("update:confirmLoading",!1)}};return j({onFormSubmit:()=>{F()}}),(o,e)=>{const s=m("TigInput"),r=m("el-form-item"),p=m("el-option"),K=m("el-select"),h=m("el-radio"),R=m("el-radio-group"),w=m("el-button"),c=m("el-table-column"),Q=m("el-table"),W=m("el-form"),X=m("a-spin");return b(),_("div",ge,[u("div",Te,[u("div",ce,[I.value?U("",!0):(b(),B(W,{key:0,ref_key:"formRef",ref:q,model:n.value,"label-width":"auto"},{default:a(()=>[l(r,{rules:[{required:!0,message:"模板名称不能为空!"}],label:"模板名称",prop:"shippingTplName"},{default:a(()=>[l(s,{width:"100%",modelValue:n.value.shippingTplName,"onUpdate:modelValue":e[0]||(e[0]=i=>n.value.shippingTplName=i)},null,8,["modelValue"])]),_:1}),l(r,{label:"发货时间",prop:"shippingTime"},{default:a(()=>[l(K,{modelValue:n.value.shippingTime,"onUpdate:modelValue":e[1]||(e[1]=i=>n.value.shippingTime=i),placeholder:"请选择..",style:{width:"100%"}},{default:a(()=>[l(p,{label:"4小时内",value:"4小时内"}),l(p,{label:"8小时内",value:"8小时内"}),l(p,{label:"12小时内",value:"12小时内"}),l(p,{label:"16小时内",value:"16小时内"}),l(p,{label:"20小时内",value:"20小时内"}),l(p,{label:"1天内",value:"1天内"}),l(p,{label:"2天内",value:"2天内"}),l(p,{label:"3天内",value:"3天内"}),l(p,{label:"4天内",value:"4天内"}),l(p,{label:"5天内",value:"5天内"}),l(p,{label:"7天内",value:"7天内"}),l(p,{label:"8天内",value:"8天内"}),l(p,{label:"10天内",value:"10天内"}),l(p,{label:"12天内",value:"12天内"}),l(p,{label:"15天内",value:"15天内"}),l(p,{label:"17天内",value:"17天内"}),l(p,{label:"20天内",value:"20天内"}),l(p,{label:"25天内",value:"25天内"}),l(p,{label:"30天内",value:"30天内"}),l(p,{label:"45天内",value:"45天内"})]),_:1},8,["modelValue"])]),_:1}),l(r,{label:"是否默认",prop:"isDefault"},{default:a(()=>[l(R,{modelValue:n.value.isDefault,"onUpdate:modelValue":e[2]||(e[2]=i=>n.value.isDefault=i),style:{width:"100%"}},{default:a(()=>[l(h,{value:1},{default:a(()=>e[5]||(e[5]=[d("是")])),_:1}),l(h,{value:0},{default:a(()=>e[6]||(e[6]=[d("否")])),_:1})]),_:1},8,["modelValue"]),e[7]||(e[7]=u("div",{class:"extra"},"只能设置一个默认模板",-1))]),_:1}),l(r,{label:"是否包邮",prop:"isFree"},{default:a(()=>[l(R,{modelValue:n.value.isFree,"onUpdate:modelValue":e[3]||(e[3]=i=>n.value.isFree=i)},{default:a(()=>[l(h,{value:1},{default:a(()=>e[8]||(e[8]=[d("是")])),_:1}),l(h,{value:0},{default:a(()=>e[9]||(e[9]=[d("否")])),_:1})]),_:1},8,["modelValue"])]),_:1}),l(r,{label:"计价方式",prop:"pricingType"},{default:a(()=>[l(R,{modelValue:n.value.pricingType,"onUpdate:modelValue":e[4]||(e[4]=i=>n.value.pricingType=i),onChange:M},{default:a(()=>[l(h,{value:1,disabled:y.value!="add"},{default:a(()=>e[10]||(e[10]=[d("按件数")])),_:1},8,["disabled"]),l(h,{value:2,disabled:y.value!="add"},{default:a(()=>e[11]||(e[11]=[d("按重量")])),_:1},8,["disabled"])]),_:1},8,["modelValue"])]),_:1}),l(r,{label:"运送方式",prop:"shippingTplInfo",rules:[{required:!0,message:"运送方式不能为空!"}]},{default:a(()=>[n.value.shippingTplInfo.length==0?(b(),_("div",be,[l(C(E),{params:{act:"add"},isDrawer:"",path:"setting/shippingType/Info",title:"添加配送类型",width:"600px",onOkCallback:$},{default:a(()=>[l(w,{icon:C(te),type:"primary"},{default:a(()=>e[12]||(e[12]=[d(" 添加配送类型")])),_:1},8,["icon"])]),_:1})])):U("",!0),(b(!0),_(oe,null,ie(n.value.shippingTplInfo,(i,f)=>(b(),_("div",he,[u("div",ve,[l(C(fe),{modelValue:i.isChecked,"onUpdate:modelValue":t=>i.isChecked=t},{default:a(()=>[d(D(i.shippingTypeName),1)]),_:2},1032,["modelValue","onUpdate:modelValue"])]),i.isChecked>0?(b(),_("div",Ie,[u("div",ye,[e[13]||(e[13]=u("span",{class:"title"},"默认运费",-1)),l(r,{prop:"shippingTplInfo["+f+"].defaultTplInfo.startNumber",rules:[{required:!0,validator:T}],class:"hn"},{default:a(()=>[l(s,{type:"integer",modelValue:i.defaultTplInfo.startNumber,"onUpdate:modelValue":t=>i.defaultTplInfo.startNumber=t,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"]),d("  "+D(n.value.pricingType==1?"件":"kg")+"内  ",1),l(r,{prop:"shippingTplInfo["+f+"].defaultTplInfo.startPrice",rules:[{required:!0,validator:T}],class:"hn"},{default:a(()=>[l(s,{type:"decimal",modelValue:i.defaultTplInfo.startPrice,"onUpdate:modelValue":t=>i.defaultTplInfo.startPrice=t,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"]),e[14]||(e[14]=d("  元，")),e[15]||(e[15]=u("span",{class:"title"},"每增加",-1)),l(r,{prop:"shippingTplInfo["+f+"].defaultTplInfo.addNumber",rules:[{required:!0,validator:T}],class:"hn"},{default:a(()=>[l(s,{type:"integer",modelValue:i.defaultTplInfo.addNumber,"onUpdate:modelValue":t=>i.defaultTplInfo.addNumber=t,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"]),d("  "+D(n.value.pricingType==1?"件":"kg")+"，",1),e[16]||(e[16]=u("span",{class:"title"},"增加运费",-1)),l(r,{prop:"shippingTplInfo["+f+"].defaultTplInfo.addPrice",rules:[{required:!0,validator:T}],class:"hn"},{default:a(()=>[l(s,{type:"decimal",modelValue:i.defaultTplInfo.addPrice,"onUpdate:modelValue":t=>i.defaultTplInfo.addPrice=t,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"]),e[17]||(e[17]=d("  元，")),e[18]||(e[18]=u("span",{class:"title"},"满",-1)),l(s,{type:"decimal",modelValue:i.defaultTplInfo.freePrice,"onUpdate:modelValue":t=>i.defaultTplInfo.freePrice=t,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"]),e[19]||(e[19]=d("  元，")),e[20]||(e[20]=u("span",{class:"title"},"免运费",-1))]),i.areaTplInfo.length>0?(b(),B(Q,{key:0,data:i.areaTplInfo,style:{width:"100%","margin-top":"8px"}},{default:a(()=>[l(c,{label:"运送到",prop:"regionData"},{default:a(t=>[l(C(E),{params:{index:f,itemIndex:t.$index,ids:t.row.regionData.areaRegions,other:i.areaTplInfo},path:"setting/shippingTpl/SelectRegion",title:"编辑地区",width:"900px",style:{width:"100%"},onOkCallback:J},{default:a(()=>[u("div",_e,[u("div",Ve,[l(r,{prop:"shippingTplInfo."+f+".areaTplInfo["+t.$index+"].regionData.areaRegionNames",rules:[{required:!0,message:"未添加地区"}],class:"hn"},{default:a(()=>[u("span",{class:"shipping-region-list",style:ne(t.row.regionData.areaRegionNames.length>0?"":"color: red;")},D(t.row.regionData.areaRegionNames.length>0?t.row.regionData.areaRegionNames.join("、"):"请添加地区"),5)]),_:2},1032,["prop"])]),e[21]||(e[21]=u("div",null,[u("a",null,"编辑")],-1))])]),_:2},1032,["params"])]),_:2},1024),l(c,{label:n.value.pricingType==1?"首件数(件)":"首重量(kg)",width:"90"},{default:a(t=>[l(r,{prop:"shippingTplInfo."+f+".areaTplInfo["+t.$index+"].startNumber",rules:[{required:!0,validator:T}],class:"hn"},{default:a(()=>[l(s,{type:"integer",modelValue:t.row.startNumber,"onUpdate:modelValue":g=>t.row.startNumber=g,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])]),_:2},1032,["label"]),l(c,{label:"首费(元)",width:"80"},{default:a(t=>[l(r,{prop:"shippingTplInfo."+f+".areaTplInfo["+t.$index+"].startPrice",rules:[{required:!0,validator:T}],class:"hn"},{default:a(()=>[l(s,{type:"decimal",modelValue:t.row.startPrice,"onUpdate:modelValue":g=>t.row.startPrice=g,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])]),_:2},1024),l(c,{label:n.value.pricingType==1?"续件数(件)":"续重量(kg)",width:"90"},{default:a(t=>[l(r,{prop:"shippingTplInfo."+f+".areaTplInfo["+t.$index+"].addNumber",rules:[{required:!0,validator:T}],class:"hn"},{default:a(()=>[l(s,{type:"integer",modelValue:t.row.addNumber,"onUpdate:modelValue":g=>t.row.addNumber=g,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])]),_:2},1032,["label"]),l(c,{label:"续费(元)",width:"80"},{default:a(t=>[l(r,{prop:"shippingTplInfo."+f+".areaTplInfo["+t.$index+"].addPrice",rules:[{required:!0,validator:T}],class:"hn"},{default:a(()=>[l(s,{type:"decimal",modelValue:t.row.addPrice,"onUpdate:modelValue":g=>t.row.addPrice=g,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])]),_:2},1024),l(c,{label:"满免(元)",width:"80"},{default:a(t=>[l(r,{prop:"shippingTplInfo."+f+".areaTplInfo["+t.$index+"].freePrice",class:"hn"},{default:a(()=>[l(s,{type:"decimal",modelValue:t.row.freePrice,"onUpdate:modelValue":g=>t.row.freePrice=g,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"])]),_:2},1024),l(c,{label:"操作",width:"60"},{default:a(t=>[l(w,{link:"",type:"primary",onClick:g=>G(f,t.$index)},{default:a(()=>e[22]||(e[22]=[d("删除")])),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["data"])):U("",!0),l(w,{link:"",type:"primary",onClick:t=>H(i)},{default:a(()=>e[23]||(e[23]=[d("增加指定地区运费")])),_:2},1032,["onClick"])])):U("",!0)]))),256))]),_:1}),ae(l(r,{"wrapper-col":{offset:4,span:16}},{default:a(()=>[l(w,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:F},{default:a(()=>e[24]||(e[24]=[d("提交")])),_:1},512)]),_:1},512),[[pe,!v.isDialog]])]),_:1},8,["model"])),l(X,{spinning:I.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}}),$e=se(we,[["__scopeId","data-v-67432ce4"]]);export{$e as default};
