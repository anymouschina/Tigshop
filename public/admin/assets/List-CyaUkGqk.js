import{d as Z,K as ee,i as f,G as P,q as te,c as _,e as s,b as t,f as y,M as oe,w as l,g as w,L as T,I as M,r as d,o as c,E as n,D as m,bg as le,_ as se}from"./index-DrbzVNl6.js";/* empty css             */import"./SelectTimeInterval.vue_vue_type_style_index_0_scoped_207fe586_lang-MgR9Z6jO.js";import"./index-CeQDmMxd.js";import{p as F}from"./format-CRgx78oe.js";/* empty css                                                                    */import{P as ae}from"./Pagination-wR9huHyl.js";/* empty css                                                                  *//* empty css                                                                              */import{S as ne}from"./SelectTimeInterval-C-WvSG46.js";import{f as v}from"./time-Bh5UhrfW.js";import{a as re,b as de}from"./performanceSettlement-Bj4kbNnG.js";import{r as ie}from"./export-D_WXJj3y.js";import{_ as me}from"./DialogForm.vue_vue_type_script_setup_true_lang-DqYSRv0_.js";const pe={class:"container"},ue={class:"content_wrapper"},fe={class:"lyecs-table-list-warp"},_e={class:"list-table-tool lyecs-search-warp"},ce={class:"advanced-search-warp list-table-tool-row"},ve={class:"simple-form-warp"},ge={class:"simple-form-field mr10"},be={class:"form-group"},ye={class:"control-container"},we={class:"simple-form-field"},xe={class:"form-group"},Te={class:"control-container flex flex-align-center"},Ye={class:"simple-form-field"},De={class:"form-group"},Se={class:"mr10"},Ve={class:"simple-form-field"},Ce={class:"form-group"},ke={key:0,class:"simple-form-field"},Ie={class:"form-group"},Me={class:"control-container"},Ue={class:"simple-form-field"},Ee={style:{"padding-top":"30px"}},he={class:"extra"},ze={key:0},Oe={key:1},$e={class:"dialog-footer"},Ne={class:"table-container"},Pe={class:"flex flex-align-center"},Fe={class:"empty-warp"},Le={key:0,class:"empty-bg"},qe={key:0,class:"pagination-con"},Be={key:0,class:"selected-action-warp"},Ke={class:"selected-action"},Ae=Z({__name:"List",setup(Ge){const U=ee(),E=f([]),Y=f(!0),D=f(0);f(0);const k=f([]),a=P({page:1,size:U.pageSize,sortField:"",sortOrder:"",orderSn:"",orderTimeStart:"",orderTimeEnd:"",timeType:1}),S=f(!1),g=P({range:0,isExport:1}),L=()=>{a.orderTimeStart===""&&a.orderTimeEnd===""?M.error("请选择时间范围"):S.value=!0},q=async()=>{try{const r=await de({...a,...g});ie(r,"分销员业绩结算表")}catch(r){M.error(r.message)}},I=f(-1),h=r=>{if(r===-1){I.value=r;return}a.orderTimeStart=v(new Date,"YYYY-MM-DD"),r===0&&(a.orderTimeEnd=v(new Date,"YYYY-MM-DD")),r===1&&(a.orderTimeStart=v(T(1,"sub"),"YYYY-MM-DD"),a.orderTimeEnd=v(T(1,"sub"),"YYYY-MM-DD")),r===2&&(a.orderTimeEnd=v(T(7,"add"),"YYYY-MM-DD")),r===3&&(a.orderTimeEnd=v(T(30,"add"),"YYYY-MM-DD")),r===4&&(a.orderTimeEnd=v(T(180,"add"),"YYYY-MM-DD")),b()},B=(r,e)=>{let C="--",p=1;return r.commissionData&&(p=r.commissionType,C=`${p==3?"":"比例"}${e}${p==3?U.get("amountUnit"):"%"}（按实付金额计算）`),C},b=async()=>{Y.value=!0;try{const r=await re({...a});E.value=r.records,D.value=r.total}catch(r){M.error(r.message)}finally{Y.value=!1}};te(()=>{b()});const V=()=>{b()},K=({prop:r,order:e})=>{a.sortField=r,a.sortOrder=e=="ascending"?"asc":e=="descending"?"desc":"",b()},A=r=>{k.value=r.map(e=>e.productId)};return(r,e)=>{const C=d("TigInput"),p=d("el-option"),z=d("el-select"),x=d("el-radio-button"),O=d("el-radio-group"),u=d("el-button"),$=d("el-radio"),G=d("el-form-item"),W=d("el-form"),j=d("el-dialog"),i=d("el-table-column"),H=d("el-icon"),J=d("el-tooltip"),Q=d("el-table"),R=d("a-spin"),X=d("el-space");return c(),_("div",pe,[s("div",ue,[s("div",fe,[s("div",_e,[s("div",ce,[s("div",ve,[s("div",ge,[s("div",be,[e[12]||(e[12]=s("label",{class:"control-label"},[s("span",null,"订单编号：")],-1)),s("div",ye,[t(C,{modelValue:a.orderSn,"onUpdate:modelValue":e[0]||(e[0]=o=>a.orderSn=o),name:"orderSn",placeholder:"请输入订单编号",onKeyup:oe(V,["enter"]),clearable:"",onClear:V},null,8,["modelValue"])])])]),s("div",we,[s("div",xe,[e[13]||(e[13]=s("label",{class:"control-label"},[s("span",null,"筛选时间：")],-1)),s("div",Te,[t(z,{modelValue:a.timeType,"onUpdate:modelValue":e[1]||(e[1]=o=>a.timeType=o),placeholder:"请选择时间",style:{width:"100px","margin-right":"10px"}},{default:l(()=>[t(p,{label:"下单时间",value:1}),t(p,{label:"退款时间",value:2})]),_:1},8,["modelValue"])])])]),s("div",Ye,[s("div",De,[s("div",Se,[t(w(ne),{type:"date","start-date":a.orderTimeStart,"onUpdate:startDate":e[2]||(e[2]=o=>a.orderTimeStart=o),"end-date":a.orderTimeEnd,"onUpdate:endDate":e[3]||(e[3]=o=>a.orderTimeEnd=o),onCallback:e[4]||(e[4]=o=>h(-1))},null,8,["start-date","end-date"])])])]),s("div",Ve,[s("div",Ce,[t(O,{class:"itemWidth mr10",modelValue:I.value,"onUpdate:modelValue":e[5]||(e[5]=o=>I.value=o),onChange:h},{default:l(()=>[t(x,{value:0},{default:l(()=>e[14]||(e[14]=[n("今天")])),_:1}),t(x,{value:1},{default:l(()=>e[15]||(e[15]=[n("昨天")])),_:1}),t(x,{value:2},{default:l(()=>e[16]||(e[16]=[n("近7天")])),_:1}),t(x,{value:3},{default:l(()=>e[17]||(e[17]=[n("近30天")])),_:1}),t(x,{value:4},{default:l(()=>e[18]||(e[18]=[n("近半年")])),_:1})]),_:1},8,["modelValue"])])]),a.timeType===1?(c(),_("div",ke,[s("div",Ie,[e[19]||(e[19]=s("label",{class:"control-label"},[s("span",null,"结算状态：")],-1)),s("div",Me,[t(z,{modelValue:a.status,"onUpdate:modelValue":e[6]||(e[6]=o=>a.status=o),placeholder:"请选择",style:{width:"200px","margin-right":"10px"},onChange:V,clearable:""},{default:l(()=>[t(p,{label:"未结算",value:0}),t(p,{label:"已结算",value:1})]),_:1},8,["modelValue"])])])])):y("",!0),s("div",Ue,[t(u,{type:"primary",onClick:V},{default:l(()=>e[20]||(e[20]=[n("搜索")])),_:1}),t(u,{onClick:L},{default:l(()=>e[21]||(e[21]=[n("导出")])),_:1})])])])]),t(j,{modelValue:S.value,"onUpdate:modelValue":e[9]||(e[9]=o=>S.value=o),title:"导出数据",width:"500",top:"30vh","append-to-body":"",style:{zIndex:2e3}},{footer:l(()=>[s("div",$e,[t(u,{onClick:e[8]||(e[8]=o=>S.value=!1)},{default:l(()=>e[24]||(e[24]=[n("取消")])),_:1}),t(u,{type:"primary",onClick:q},{default:l(()=>e[25]||(e[25]=[n(" 导出 ")])),_:1})])]),default:l(()=>[s("div",Ee,[t(W,{model:g,"label-width":"100px"},{default:l(()=>[t(G,{label:"导出维度："},{default:l(()=>[s("div",null,[t(O,{modelValue:g.range,"onUpdate:modelValue":e[7]||(e[7]=o=>g.range=o)},{default:l(()=>[t($,{value:0},{default:l(()=>e[22]||(e[22]=[n("商品维度")])),_:1}),t($,{value:1},{default:l(()=>e[23]||(e[23]=[n("订单维度")])),_:1})]),_:1},8,["modelValue"]),s("div",he,[g.range==0?(c(),_("div",ze,"以商品维度导出，每个商品展示一行")):y("",!0),g.range==1?(c(),_("div",Oe,"以订单维度导出，每个订单展示一行")):y("",!0)])])]),_:1})]),_:1},8,["model"])])]),_:1},8,["modelValue"]),s("div",Ne,[t(R,{spinning:Y.value},{default:l(()=>[t(Q,{data:E.value,total:D.value,"row-key":"productId",onSelectionChange:A,onSortChange:K},{empty:l(()=>[s("div",Fe,[Y.value?y("",!0):(c(),_("div",Le,"暂无数据"))])]),default:l(()=>[t(i,{type:"selection",width:"32",fixed:"left"}),t(i,{label:"订单号",prop:"orderId",width:180,fixed:"left"},{default:l(({row:o})=>[t(w(me),{params:{act:"detail",id:o.orderUserInfo.orderId},showClose:!1,showOnOk:!1,title:"订单详情 "+o.orderUserInfo.orderSn,isDrawer:"",path:"order/order/Info",width:"880px",onCallback:b},{default:l(()=>[t(u,{link:"",type:"primary"},{default:l(()=>[n(m(o.orderUserInfo.orderSn),1)]),_:2},1024)]),_:2},1032,["params","title"])]),_:1}),t(i,{prop:"orderAmount",width:100},{header:l(()=>[s("div",Pe,[e[27]||(e[27]=s("p",null,"成交金额",-1)),t(J,{placement:"bottom-start",effect:"light"},{content:l(()=>e[26]||(e[26]=[n(" 不计运费、税费和附加费 ")])),default:l(()=>[t(H,{size:"16",color:"#c8c9cc",style:{"margin-left":"5px"}},{default:l(()=>[t(w(le))]),_:1})]),_:1})])]),default:l(({row:o})=>[n(m(w(F)(o.userOrderItem.totalProductMoney)),1)]),_:1}),t(i,{label:"分销员",width:140},{default:l(({row:o})=>[n(m(o.salesman.baseUserInfo.nickname||o.salesman.baseUserInfo.username),1)]),_:1}),t(i,{label:"客户",width:140},{default:l(({row:o})=>[n(m(o.orderUserInfo.user.nickname),1)]),_:1}),t(i,{label:"收益类型",width:140},{default:l(({row:o})=>e[28]||(e[28]=[n(" 商品佣金 ")])),_:1}),t(i,{label:"收益组成",width:240},{default:l(({row:o})=>[n(m(B(o.salesmanProductData,o.profitComposition)),1)]),_:1}),t(i,{label:"所属分组",width:240},{default:l(({row:o})=>[n(m(o.salesman.groupInfo.groupName),1)]),_:1}),t(i,{label:"收益",width:240},{default:l(({row:o})=>[n(m(w(F)(o.amount)),1)]),_:1}),t(i,{label:"结算方式",width:140},{default:l(({row:o})=>{var N;return[n(m(((N=o.salesmanSettlementData)==null?void 0:N.settlementType)==1?"系统结算":"人工结算"),1)]}),_:1}),t(i,{label:"结算状态",width:140,fixed:"right"},{default:l(({row:o})=>[n(m(o.statusText),1)]),_:1}),t(i,{label:"退款时间",width:150,fixed:"right"},{default:l(({row:o})=>[n(m(o.refundTime||"--"),1)]),_:1})]),_:1},8,["data","total"])]),_:1},8,["spinning"]),D.value>0?(c(),_("div",qe,[t(w(ae),{page:a.page,"onUpdate:page":e[10]||(e[10]=o=>a.page=o),size:a.size,"onUpdate:size":e[11]||(e[11]=o=>a.size=o),total:D.value,onCallback:b},null,8,["page","size","total"])])):y("",!0)]),k.value.length>0?(c(),_("div",Be,[s("div",Ke,[t(X,null,{default:l(()=>[s("span",null,[e[29]||(e[29]=n("已选择：")),s("b",null,m(k.value.length),1),e[30]||(e[30]=n(" 项"))]),t(u,null,{default:l(()=>e[31]||(e[31]=[n("设置等级")])),_:1}),t(u,null,{default:l(()=>e[32]||(e[32]=[n("分组")])),_:1}),t(u,null,{default:l(()=>e[33]||(e[33]=[n("清退")])),_:1})]),_:1})])])):y("",!0)])])])}}}),nt=se(Ae,[["__scopeId","data-v-03401939"]]);export{nt as default};
