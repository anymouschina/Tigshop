import{d as A,A as U,j as m,s as $,I as D,r as f,o as x,c as b,aM as G,e as v,b as p,w as d,f as N,G as H,h as S,H as C,K as k,p as K,i as M,_ as O}from"./index-7c2d2aef.js";const T=l=>(K("data-v-7eb84c52"),l=l(),M(),l),J={class:"lyecs-popedit"},L={key:0,style:{position:"relative"}},Q=T(()=>v("div",{style:{position:"absolute",left:"-32px",width:"50px",height:"5px",visibility:"hidden"}},null,-1)),W={class:"popForm-con",style:{width:"100%",padding:"8px 6px 5px","box-sizing":"border-box"}},X={key:0,class:"extra"},Y={class:"flex",style:{"justify-content":"right"}},Z=A({__name:"PopFormElm",props:{orgValue:[String,Number],requestApi:{type:Function,default:U},label:{type:String,default:"编辑项"},extra:{tyoe:String,default:""},max:{type:Number,default:0},min:{type:Number,default:0},maxNum:{type:Number,default:0},minNum:{type:Number,default:0},len:{type:Number,default:0},required:{type:Boolean,default:!0},type:{type:String,default:"input"},params:{type:Object,default:{id:null,field:""}}},emits:["update:orgValue","callback"],setup(l,{expose:E,emit:q}){const e=l,s=m([]),B=(o,r,u)=>{let i=t.paramValue;if(!i){u(new Error("请输入"+e.label));return}if(e.type==="number"&&isNaN(i)){u(new Error("请输入数字"));return}if(e.type==="number"&&e.minNum>0&&i<e.minNum){u(new Error("请输入不少于"+e.minNum+"的数字"));return}if(e.type==="number"&&e.maxNum>0&&i>e.maxNum){u(new Error("请输入不大于"+e.maxNum+"的数字"));return}u()};s.value.push({required:e.required,validator:B,trigger:"blur"});const a=m(e.extra);e.max>0&&(s.value.push({max:e.max}),a.value||(a.value="请输入不超"+e.max+"个字符的"+e.label)),e.min>0&&(s.value.push({min:e.min}),a.value||(a.value="请输入不少于"+e.min+"个字符的"+e.label)),e.len>0&&(s.value.push({len:e.len}),a.value||(a.value="请输入"+e.len+"个字符的"+e.label)),e.minNum>0&&e.maxNum>0&&(s.value.push({minNum:e.minNum,maxNum:e.maxNum}),a.value||(a.value="请输入"+e.minNum+"-"+e.maxNum+"之间的数字"));const n=m(!1),g=m(!1),F=m(e.type),_=$();let t=D({paramValue:e.orgValue});const V=q,y=m(!1),h=async()=>{await _.value.validate();try{y.value=!0;const o=await e.requestApi({id:e.params.id,field:e.params.field,val:t.paramValue});V("update:orgValue",t.paramValue),V("callback"),k.success(o.message||"操作成功"),n.value=!1}catch(o){k.error(o.message)}finally{y.value=!1}},I=()=>{g.value=!0,n.value=!0,t.paramValue=e.orgValue},R=o=>{n.value=!0},j=()=>{t.paramValue=e.orgValue,_.value.clearValidate()};return E({show:R}),(o,r)=>{const u=f("el-input"),i=f("el-form-item"),z=f("el-form"),w=f("el-button"),P=f("el-popover");return x(),b("div",J,[G(o.$slots,"default",{},void 0,!0),v("span",{class:"lyecs-popedit-btn iconfont icon-bianji1",ref:"buttonRef",onClick:I},null,512),g.value?(x(),b("div",L,[p(P,{ref:"popoverRef",trigger:"click",placement:"bottom-start","hide-after":0,visible:n.value,"onUpdate:visible":r[2]||(r[2]=c=>n.value=c),onConfirm:h,onCancel:j,teleported:!0,width:"360px"},{reference:d(()=>[Q]),default:d(()=>[v("div",W,[p(z,{ref_key:"formRef",ref:_,model:N(t),layout:"horizontal",name:"form_in_modal","wrapper-col":{span:38},"label-wrap":!1},{default:d(()=>[p(i,{name:"paramValue",label:l.label,rules:s.value,extra:a.value,max:l.max},{default:d(()=>[p(u,{type:F.value,modelValue:N(t).paramValue,"onUpdate:modelValue":r[0]||(r[0]=c=>N(t).paramValue=c)},null,8,["type","modelValue"]),a.value?(x(),b("div",X,H(a.value),1)):S("",!0)]),_:1},8,["label","rules","extra","max"])]),_:1},8,["model"]),v("div",Y,[p(w,{size:"small",onClick:r[1]||(r[1]=c=>n.value=!1)},{default:d(()=>[C("取消")]),_:1}),p(w,{size:"small",type:"primary",onClick:h,loading:y.value},{default:d(()=>[C("确认")]),_:1},8,["loading"])])])]),_:1},8,["visible"])])):S("",!0)])}}});const ae=O(Z,[["__scopeId","data-v-7eb84c52"]]);export{ae as P};
