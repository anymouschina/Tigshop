import{d as U,i as f,K as A,G as E,q as L,r,c as d,o as u,e as l,b as o,w as s,N as O,f as V,n as j,g as z,D as S,F as q,a as K,I as H,_ as J}from"./index-DrbzVNl6.js";/* empty css             *//* empty css                                                                    */import{P as Q}from"./Pagination-wR9huHyl.js";import{i as W}from"./format-CRgx78oe.js";import{g as X}from"./productGift-BZlu9Uns.js";const Y={class:"container"},Z={class:"content_wrapper"},$={class:"lyecs-table-list-warp"},ee={class:"list-table-tool lyecs-search-warp"},te={class:"list-table-tool-row"},oe={class:"list-table-tool-col"},ae={class:"table-container"},le={class:"product-info"},se=["src"],ne={key:0},ie={class:"product-info"},ce={key:1},re={class:"empty-warp"},de={key:0,class:"empty-bg"},ue={key:0,class:"pagination-con"},pe=U({__name:"SelectGift",props:{selectedIds:{type:Array,default:[]},modelValue:{type:Object,default:{}},isMultiple:{type:Boolean,default:!1}},emits:["submitCallback","okType","update:modelValue"],setup(w,{expose:x,emit:F}){const v=w,p=F;p("okType",!1);const n=f([]),N=A(),I=f(),m=f(!0),g=f(0),i=E({page:1,size:N.get("pageSize"),sortField:"",sortOrder:"",keyword:""}),b=async()=>{m.value=!0;try{const a=await X({...i});I.value=a.records,g.value=a.total}catch(a){H.error(a.message)}finally{m.value=!1}};L(()=>{b()});const h=()=>{b()},y=f(),T=a=>{v.isMultiple&&(a.forEach(e=>{const c=new Set(n.value);c.add(e),n.value=Array.from(c)}),p("okType",n.value.length>0))},M=(a,e)=>{if(!v.isMultiple){if(y.value.clearSelection(),a.length==0){n.value=[];return}y.value.toggleRowSelection(e,!0),n.value.length=0,n.value.push(e),p("okType",n.value.length>0)}p("update:modelValue",e)},B=(a,e)=>{let c=[];return v.selectedIds.map(k=>{c.push(k.giftId)}),!c.includes(a.giftId)};return x({onFormSubmit:()=>{p("submitCallback",n.value)}}),(a,e)=>{const c=r("el-button"),k=r("TigInput"),D=r("el-space"),G=r("el-form"),_=r("el-table-column"),P=r("el-table"),R=r("a-spin");return u(),d("div",Y,[l("div",Z,[l("div",$,[l("div",ee,[o(G,{model:i,onSubmit:O(h,["prevent"])},{default:s(()=>[l("div",te,[l("div",oe,[o(D,null,{default:s(()=>[o(k,{name:"keyword",modelValue:i.keyword,"onUpdate:modelValue":e[0]||(e[0]=t=>i.keyword=t),placeholder:"输入赠品名称",clearable:"",onClear:h},{append:s(()=>[o(c,{onClick:h},{default:s(()=>e[3]||(e[3]=[l("span",{class:"iconfont icon-chakan1"},null,-1)])),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),_:1},8,["model"])]),l("div",ae,[o(R,{spinning:m.value},{default:s(()=>[o(P,{ref_key:"tableRef",ref:y,class:j([w.isMultiple?"":"hide-checkbox","result-table"]),data:I.value,loading:m.value,total:g.value,"row-key":"giftId",onSelect:M,onSelectionChange:T},{empty:s(()=>[l("div",re,[m.value?V("",!0):(u(),d("div",de,"暂无数据"))])]),default:s(()=>[o(_,{selectable:B,type:"selection",width:"32"}),o(_,{label:"赠品名称",prop:"giftName",width:"120"}),o(_,{label:"商品信息",prop:"productName"},{default:s(({row:t})=>[l("div",le,[l("img",{src:z(W)(t.productInfo.picThumb),height:"50",width:"50"},null,8,se),l("p",null,S(t.productInfo.productName),1)])]),_:1}),o(_,{label:"商品规格",prop:"productSku"},{default:s(({row:t})=>[t.skuInfo&&t.skuInfo.skuData.length>0?(u(),d("div",ne,[(u(!0),d(q,null,K(t.skuInfo.skuData,C=>(u(),d("div",ie,S(C.name)+": "+S(C.value),1))),256))])):(u(),d("div",ce,"--"))]),_:1}),o(_,{label:"赠品库存",prop:"giftStock",sortable:"custom"})]),_:1},8,["class","data","loading","total"])]),_:1},8,["spinning"]),g.value>0?(u(),d("div",ue,[o(z(Q),{page:i.page,"onUpdate:page":e[1]||(e[1]=t=>i.page=t),size:i.size,"onUpdate:size":e[2]||(e[2]=t=>i.size=t),total:g.value,onCallback:b},null,8,["page","size","total"])])):V("",!0)])])])])}}}),ye=J(pe,[["__scopeId","data-v-e9f455a9"]]);export{ye as default};
