/* empty css             */import{d as z,Q as _,j as b,a9 as D,P as F,o as f,c as v,G as C,I as N,x as H,r as n,e as s,b as e,w as o,H as k,h as x,f as p,F as U,a as $,K as E,p as O,i as G,_ as K}from"./index-7c2d2aef.js";import{_ as I}from"./DeleteRecord.vue_vue_type_script_setup_true_lang-ae1bade7.js";/* empty css                                                                    */import{P as R}from"./Pagination-8eb7b6b1.js";import{i as W}from"./format-4e0206d3.js";import{u as J}from"./config-9548fa9b.js";import{d as X}from"./brand-995f2ca4.js";import{t as Y,a as Z}from"./conversation-43b2bd1f.js";/* empty css                                               */import{r as ee}from"./zh-cn-8c8b9709.js";import{S as te}from"./StatusDot-19af4eec.js";const se=z({__name:"RelativeTime",props:{time:{type:String,default:""}},setup(m){_.extend(ee),_.locale("zh-cn");const g=m,h=b(_()),y=D(()=>_(g.time).from(h.value));return F(c=>{const l=_().diff(_(g.time),"second");let t;l<60?t=1e4:l<3600?t=6e4:l<86400?t=6e5:l<604800?t=36e5:t=864e5;const i=setInterval(()=>{h.value=_()},t);c(()=>clearInterval(i))}),(c,l)=>(f(),v("span",null,C(y.value),1))}}),ae=m=>(O("data-v-000ad38d"),m=m(),G(),m),oe={class:"container"},le={class:"content_wrapper"},ne={class:"lyecs-table-list-warp",style:{"margin-bottom":"0"}},ie={class:"list-table-tool lyecs-search-warp"},re={class:"advanced-search-warp list-table-tool-row"},ce={class:"simple-form-warp"},de={class:"simple-form-field"},_e={class:"form-group"},pe=ae(()=>s("label",{class:"control-label"},[s("span",null,"咨询来源：")],-1)),me={class:"control-container"},ue={class:"simple-form-field"},fe={class:"table-container"},ve={class:"kehu"},be={class:"title"},ge={class:"message-list"},he={class:"item"},ye={class:"empty-warp"},we={key:0,class:"empty-bg"},Se={key:0,class:"pagination-con"},ke=z({__name:"QueueList",setup(m,{expose:g}){const h=J(),y=b([]),c=b(!0),l=b(0);b([]);const t=N({page:1,size:h.get("page_size"),sort_field:"",sort_order:"",keyword:"",first_word:"",user_from:""}),i=async()=>{c.value=!0;try{const d=await Z({...t});y.value=d.filter_result,l.value=d.total}catch(d){E.error(d.message)}finally{c.value=!1}};H(()=>{i()});const L=()=>{i()},T=({prop:d,order:r})=>{t.sort_field=d,t.sort_order=r=="ascending"?"asc":r=="descending"?"desc":"",i()};return g({loadFilter:i}),(d,r)=>{const S=n("el-option"),V=n("el-select"),A=n("el-button"),Q=n("el-form"),M=n("el-avatar"),u=n("el-table-column"),P=n("sapn"),j=n("el-divider"),q=n("el-table"),B=n("a-spin");return f(),v("div",oe,[s("div",le,[s("div",ne,[s("div",ie,[e(Q,{model:t},{default:o(()=>[s("div",re,[s("div",ce,[s("div",de,[s("div",_e,[pe,s("div",me,[e(V,{modelValue:t.user_from,"onUpdate:modelValue":r[0]||(r[0]=a=>t.user_from=a),clearable:""},{default:o(()=>[e(S,{value:"",label:"全部"}),e(S,{value:"pc",label:"pc"}),e(S,{value:"h5",label:"h5"})]),_:1},8,["modelValue"])])])]),s("div",ue,[e(A,{type:"primary",onClick:L},{default:o(()=>[k("搜索")]),_:1})])])])]),_:1},8,["model"])]),s("div",fe,[e(B,{spinning:c.value},{default:o(()=>[e(q,{data:y.value,loading:c.value,total:l.value,"row-key":"brand_id",onSortChange:T},{empty:o(()=>[s("div",ye,[c.value?x("",!0):(f(),v("div",we,"暂无数据"))])]),default:o(()=>[e(u,{label:"客户",prop:"brand_id"},{default:o(({row:a})=>{var w;return[s("div",ve,[e(M,{class:"av",src:p(W)(a.user.avatar)},null,8,["src"]),s("div",be,C((w=a.user)==null?void 0:w.nickname),1)])]}),_:1}),e(u,{label:"最新两条消息"},{default:o(({row:a})=>[s("div",ge,[(f(!0),v(U,null,$(a.userLastTwoMessage.slice(0,2),w=>(f(),v("div",he,[e(te,{color:"#44bb00",flicker:!1}),e(P,{innerHTML:w.content.content},null,8,["innerHTML"])]))),256))])]),_:1}),e(u,{prop:"add_time",width:160,label:"进入排队时间"}),e(u,{width:100,label:"排队时长",sortable:"custom"},{default:o(({row:a})=>[e(p(se),{time:a.add_time},null,8,["time"])]),_:1}),e(u,{width:100,label:"咨询来源",prop:"user_from",sortable:"custom"}),e(u,{width:120,fixed:"right",label:"操作"},{default:o(({row:a})=>[e(p(I),{title:"您确定要接入会话吗？",params:{conversation_id:a.id},requestApi:p(Y),onAfterDelete:i},{default:o(()=>[k("接入会话")]),_:2},1032,["params","requestApi"]),e(j,{direction:"vertical"}),e(p(I),{params:{conversation_id:a.id},requestApi:p(X),onAfterDelete:i},{default:o(()=>[k("删除")]),_:2},1032,["params","requestApi"])]),_:1})]),_:1},8,["data","loading","total"])]),_:1},8,["spinning"]),l.value>0?(f(),v("div",Se,[e(p(R),{page:t.page,"onUpdate:page":r[1]||(r[1]=a=>t.page=a),size:t.size,"onUpdate:size":r[2]||(r[2]=a=>t.size=a),total:l.value,onCallback:i},null,8,["page","size","total"])])):x("",!0)])])])])}}});const xe=K(ke,[["__scopeId","data-v-000ad38d"]]),Be=Object.freeze(Object.defineProperty({__proto__:null,default:xe},Symbol.toStringTag,{value:"Module"}));export{xe as Q,se as _,Be as a};
