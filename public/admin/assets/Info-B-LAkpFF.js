import{d as x,i as n,C as D,s as O,q as R,I as p,r as u,c as T,o as b,e as w,j as q,f as I,w as r,b as o,a3 as L,E as j,a4 as E}from"./index-DrbzVNl6.js";import{a as F,u as U}from"./category-CCI4VFuO.js";const G={class:"container"},M={class:"content_wrapper"},z={class:"lyecs-form-table"},K=x({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:"add"},isDialog:{type:Boolean,default:!1}},emits:["submitCallback","update:confirmLoading","close"],setup(V,{expose:N,emit:k}){const l=k,s=V,i=n(!0),f=D().currentRoute.value.query,c=n(s.isDialog?s.act:String(f.act)),g=n(s.isDialog?s.id:Number(f.id)),C=c.value==="add"?"create":"update",_=O(),t=n({sortOrder:50});R(()=>{c.value==="detail"?S():i.value=!1});const S=async()=>{try{const e=await F(c.value,{id:g.value});Object.assign(t.value,e)}catch(e){p.error(e.message),l("close")}finally{i.value=!1}},v=async()=>{await _.value.validate();try{l("update:confirmLoading",!0);const e=await U(C,{id:g.value,...t.value});l("submitCallback",e),p.success("操作成功")}catch(e){p.error(e.message)}finally{l("update:confirmLoading",!1)}};return N({onFormSubmit:()=>{v()}}),(e,a)=>{const y=u("TigInput"),m=u("el-form-item"),h=u("el-button"),B=u("el-form");return b(),T("div",G,[w("div",M,[w("div",z,[i.value?I("",!0):(b(),q(B,{key:0,ref_key:"formRef",ref:_,model:t.value,"label-width":"auto"},{default:r(()=>[o(m,{prop:"categoryName",label:"分类名称：",rules:[{required:!0,message:"分类名称不能为空!"}]},{default:r(()=>[o(y,{classType:"tig-form-input",modelValue:t.value.categoryName,"onUpdate:modelValue":a[0]||(a[0]=d=>t.value.categoryName=d),clearable:""},null,8,["modelValue"])]),_:1}),o(m,{prop:"sortOrder",label:"排序："},{default:r(()=>[o(y,{classType:"tig-form-input",type:"integer",modelValue:t.value.sortOrder,"onUpdate:modelValue":a[1]||(a[1]=d=>t.value.sortOrder=d),clearable:""},null,8,["modelValue"])]),_:1}),L(o(m,{"wrapper-col":{offset:4,span:16}},{default:r(()=>[o(h,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:v},{default:r(()=>a[2]||(a[2]=[j("提交")])),_:1},512)]),_:1},512),[[E,!s.isDialog]])]),_:1},8,["model"]))])])])}}});export{K as default};
