import{d as E,j as p,E as R,s as q,x as I,K as c,r as i,o as x,c as P,e as S,k as L,w as l,b as e,f as O,H as n,$ as j,a0 as F,h as J}from"./index-7c2d2aef.js";import{a as M,c as H}from"./pointsExchange-6ebc0d5c.js";import"./SelectTimeInterval.vue_vue_type_style_index_0_scoped_207fe586_lang-b4d9216b.js";import"./category-a8bd4d11.js";import"./index-6c62cf9b.js";import"./config-9548fa9b.js";import{S as K}from"./SelectProduct-5f7c1e31.js";/* empty css                                                                    *//* empty css                                                                              */import"./region-e0d291a6.js";import"./shopProductCategory-792e0c23.js";/* empty css             */import"./time-290942a2.js";import"./util-1ee03ed8.js";import"./config-e2aa16d1.js";import"./format-4e0206d3.js";import"./product-689c7c1e.js";import"./Pagination-8eb7b6b1.js";import"./SelectSku-94aa3072.js";/* empty css                                                                  */import"./DialogForm.vue_vue_type_script_setup_true_lang-c57b9a11.js";import"./region-05802f67.js";const T={class:"container"},$={class:"content_wrapper"},z={class:"lyecs-form-table"},ve=E({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(h,{expose:w,emit:N}){const d=N,u=h,_=p(!0),v=R().currentRoute.value.query,f=p(u.isDialog?u.act:String(v.act)),g=p(u.isDialog?u.id:Number(v.id)),C=f.value==="add"?"create":"update",b=q(),t=p({product_id:"",sku_id:"",is_enabled:1,is_hot:0});I(()=>{f.value==="detail"?B():_.value=!1});const B=async()=>{try{const a=await M(f.value,{id:g.value});a.item.product_id&&(a.item.product_id=[a.item.product_id]),Object.assign(t.value,a.item)}catch(a){c.error(a.message),d("close")}finally{_.value=!1}},y=async()=>{await b.value.validate();try{d("update:confirmLoading",!0);let a=JSON.parse(JSON.stringify(t.value));if(a.product_id)a.product_id=a.product_id[0];else{c.error("请选择商品!");return}const o=await H(C,{id:g.value,...a});d("submitCallback",o),c.success(o.message)}catch(a){c.error(a.message)}finally{d("update:confirmLoading",!1)}};return w({onFormSubmit:()=>{y()}}),(a,o)=>{const s=i("el-form-item"),k=i("el-input"),m=i("el-radio"),V=i("el-radio-group"),U=i("el-button"),D=i("el-form");return x(),P("div",T,[S("div",$,[S("div",z,[_.value?J("",!0):(x(),L(D,{key:0,ref_key:"formRef",ref:b,model:t.value,"label-width":"auto"},{default:l(()=>[e(s,{prop:"product_id",label:"选择商品"},{default:l(()=>[e(O(K),{isSku:!0,isMultiple:!1,ids:t.value.product_id,"onUpdate:ids":o[0]||(o[0]=r=>t.value.product_id=r),skuId:t.value.sku_id,"onUpdate:skuId":o[1]||(o[1]=r=>t.value.sku_id=r)},null,8,["ids","skuId"])]),_:1}),e(s,{prop:"exchange_integral",label:"兑换积分",rules:[{required:!0,message:"兑换积分不能为空!"}]},{default:l(()=>[e(k,{type:"number",modelValue:t.value.exchange_integral,"onUpdate:modelValue":o[2]||(o[2]=r=>t.value.exchange_integral=r)},null,8,["modelValue"])]),_:1}),e(s,{prop:"points_deducted_amount",label:"减免金额",rules:[{required:!0,message:"减免金额不能为空!"}]},{default:l(()=>[e(k,{type:"number",modelValue:t.value.points_deducted_amount,"onUpdate:modelValue":o[3]||(o[3]=r=>t.value.points_deducted_amount=r)},null,8,["modelValue"])]),_:1}),e(s,{prop:"is_enabled",label:"兑换"},{default:l(()=>[e(V,{modelValue:t.value.is_enabled,"onUpdate:modelValue":o[4]||(o[4]=r=>t.value.is_enabled=r)},{default:l(()=>[e(m,{value:1},{default:l(()=>[n("是")]),_:1}),e(m,{value:0},{default:l(()=>[n("否")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(s,{prop:"is_hot",label:"是否热销"},{default:l(()=>[e(V,{modelValue:t.value.is_hot,"onUpdate:modelValue":o[5]||(o[5]=r=>t.value.is_hot=r)},{default:l(()=>[e(m,{value:1},{default:l(()=>[n("是")]),_:1}),e(m,{value:0},{default:l(()=>[n("否")]),_:1})]),_:1},8,["modelValue"])]),_:1}),j(e(s,{"wrapper-col":{offset:4,span:16}},{default:l(()=>[e(U,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:y},{default:l(()=>[n("提交")]),_:1},512)]),_:1},512),[[F,!u.isDialog]])]),_:1},8,["model"]))])])])}}});export{ve as default};
