import{d as M,i as f,p as O,q as E,I as U,j as k,o as h,g as T,dv as $,dF as P,C as Z,s as G,r as p,c as H,e as b,f as D,b as a,w as o,a0 as J,E as v,a1 as K,_ as Q}from"./index-CGYuOau0.js";import"./SelectTimeInterval.vue_vue_type_style_index_0_scoped_207fe586_lang-t3_hMxDC.js";import{a as W,c as X,e as Y}from"./authority-PNyDJWKD.js";import"./index-B-GURfkM.js";import{D as ee}from"./DynamicList-DoNez1gA.js";/* empty css                                                                    *//* empty css                                                                  *//* empty css                                                                              *//* empty css             */import{S as te}from"./SelectIco-CyYwvohC.js";import{u as ae}from"./menus-twiYEIYr.js";import"./time-ClyPenjC.js";import"./config-DNllFJyR.js";import"./config-DU8_t5BN.js";import"./DialogForm.vue_vue_type_script_setup_true_lang-Bmm-M6gU.js";const le=M({__name:"SelectAuthority",props:{authority_id:{type:[Number,Array],default:0},multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},adminType:{type:String,default:"admin"}},emits:["update:authority_id"],setup(V,{emit:I}){const s=V,N={label:"authority_name",value:"authority_id",children:"children",multiple:s.multiple,checkStrictly:!0},_=f([]),u=f(!1),i=f();f(!1);const c=I;O(()=>s.adminType,t=>{u.value=!1,m()}),E(()=>{s.authority_id&&m()});const m=async()=>{if(!u.value){u.value=!0;try{const t=await W({admin_type:s.adminType});_.value=t.item,i.value=s.authority_id}catch(t){U.error(t.message)}}},w=t=>{if(s.multiple==!0){const g=t.map(y=>y[y.length-1]);c("update:authority_id",g)}else c("update:authority_id",t?t[t.length-1]:0)},S=t=>{t&&m()},x=()=>{s.multiple==!0?i.value=[]:i.value=0};return(t,g)=>(h(),k(T($),{class:"cascader",props:N,disabled:V.disabled,placeholder:"顶级权限",options:_.value,modelValue:i.value,"onUpdate:modelValue":g[0]||(g[0]=y=>i.value=y),clearable:"",onChange:w,onClear:x,onVisibleChange:S},null,8,["disabled","options","modelValue"]))}}),oe={class:"container"},ue={class:"content_wrapper"},ie={class:"lyecs-form-table"},re=M({__name:"Info",props:{id:{type:Number,default:0},parentId:{type:Number,default:0},act:{type:String,default:""},admin_type:{type:String,default:"admin"},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(V,{expose:I,emit:s}){const N=P(),_=s,u=V,i=f(!0),c=Z().currentRoute.value.query,m=f(u.isDialog?u.act:String(c.act)),w=f(u.isDialog?u.id:Number(c.id)),S=m.value==="add"?"create":"update",x=G(),t=f({child_auth:[],admin_type:u.isDialog?u.admin_type:String(c.admin_type),is_show:1}),g=async()=>{try{const n=await X(m.value,{id:w.value});Object.assign(t.value,n.item)}catch(n){U.error(n.message),_("close")}finally{i.value=!1}};E(()=>{m.value==="detail"?g():i.value=!1,S==="create"&&(t.value.parent_id=u.parentId)});const y=async()=>{await x.value.validate();try{_("update:confirmLoading",!0);const n=await Y(S,{id:w.value,...t.value});_("submitCallback",n),U.success(n.message),N.mainMenu=await ae()}catch(n){U.error(n.message)}finally{_("update:confirmLoading",!1)}},L=()=>{y()},R=(n,e,d)=>{/^[a-zA-Z]+$/.test(e)?d():d(new Error("只能输入英文字母"))};return I({onFormSubmit:L}),(n,e)=>{const d=p("el-input"),r=p("el-form-item"),C=p("el-radio"),q=p("el-radio-group"),A=p("el-space"),z=p("el-button"),j=p("el-form"),F=p("a-spin");return h(),H("div",oe,[b("div",ue,[b("div",ie,[i.value?D("",!0):(h(),k(j,{key:0,ref_key:"formRef",ref:x,model:t.value,"label-width":"auto"},{default:o(()=>[a(r,{rules:[{required:!0,message:"权限名称不能为空!"}],label:"权限名称",prop:"authority_name"},{default:o(()=>[a(d,{modelValue:t.value.authority_name,"onUpdate:modelValue":e[0]||(e[0]=l=>t.value.authority_name=l)},null,8,["modelValue"])]),_:1}),a(r,{rules:[{required:!0,message:"唯一编号不能为空!"},{validator:R,trigger:"blur"}],label:"唯一编号",prop:"authority_sn"},{default:o(()=>[a(d,{modelValue:t.value.authority_sn,"onUpdate:modelValue":e[1]||(e[1]=l=>t.value.authority_sn=l)},null,8,["modelValue"]),e[9]||(e[9]=b("div",{class:"extra"},"只能为英文字母，推荐小驼峰，非目录权限则以Manage结尾，如：productManage",-1))]),_:1},8,["rules"]),a(r,{rules:[{required:!0,message:"路由地址不能为空!"}],label:"路由地址",prop:"route_link"},{default:o(()=>[a(d,{modelValue:t.value.route_link,"onUpdate:modelValue":e[2]||(e[2]=l=>t.value.route_link=l)},null,8,["modelValue"]),e[10]||(e[10]=b("div",{class:"extra"},"格式为 product/list/ 或 product/brand/list/",-1))]),_:1}),a(r,{label:"上级分类",prop:"parent_id"},{default:o(()=>[i.value?D("",!0):(h(),k(T(le),{key:0,authority_id:t.value.parent_id,"onUpdate:authority_id":e[3]||(e[3]=l=>t.value.parent_id=l),multiple:!1,style:{width:"100%"},disabled:m.value=="add"&&!V.parentId,adminType:t.value.admin_type},null,8,["authority_id","disabled","adminType"]))]),_:1}),t.value.parent_id===0?(h(),k(r,{key:0,label:"ICO编码",prop:"authority_ico"},{default:o(()=>[a(te,{modelValue:t.value.authority_ico,"onUpdate:modelValue":e[4]||(e[4]=l=>t.value.authority_ico=l)},null,8,["modelValue"]),e[11]||(e[11]=b("div",{class:"extra"},'请先在Tigshop设置中的"接口设置"中设置"ico图标库地址"',-1))]),_:1})):D("",!0),a(r,{label:"排序",prop:"sort_order"},{default:o(()=>[a(d,{modelValue:t.value.sort_order,"onUpdate:modelValue":e[5]||(e[5]=l=>t.value.sort_order=l)},null,8,["modelValue"])]),_:1}),a(r,{label:"权限所属系统",prop:"admin_type"},{default:o(()=>[a(q,{modelValue:t.value.admin_type,"onUpdate:modelValue":e[6]||(e[6]=l=>t.value.admin_type=l),disabled:""},{default:o(()=>[a(C,{value:"admin"},{default:o(()=>e[12]||(e[12]=[v("管理后台")])),_:1}),a(C,{value:"shop"},{default:o(()=>e[13]||(e[13]=[v("店铺后台")])),_:1})]),_:1},8,["modelValue"])]),_:1}),a(r,{label:"是否显示",prop:"is_show"},{default:o(()=>[a(q,{modelValue:t.value.is_show,"onUpdate:modelValue":e[7]||(e[7]=l=>t.value.is_show=l)},{default:o(()=>[a(C,{value:1},{default:o(()=>e[14]||(e[14]=[v("是")])),_:1}),a(C,{value:0},{default:o(()=>e[15]||(e[15]=[v("否")])),_:1})]),_:1},8,["modelValue"])]),_:1}),a(r,{label:"细分权限"},{default:o(()=>[a(T(ee),{modelValue:t.value.child_auth,"onUpdate:modelValue":e[8]||(e[8]=l=>t.value.child_auth=l),templateList:["auth_name","auth_sn"],buttonName:"新增细分权限"},{dynamicSlot:o(l=>[a(A,{size:16},{default:o(()=>[a(A,{size:0},{default:o(()=>[e[16]||(e[16]=v(" 权限名称： ")),a(d,{modelValue:l.item.auth_name,"onUpdate:modelValue":B=>l.item.auth_name=B,placeholder:"权限名称",style:{width:"100px"}},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),a(A,{size:0},{default:o(()=>[e[17]||(e[17]=v(" 权限编码： ")),a(d,{modelValue:l.item.auth_sn,"onUpdate:modelValue":B=>l.item.auth_sn=B,placeholder:"权限编码",style:{width:"100px"}},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:1},8,["modelValue"])]),_:1}),J(a(r,{"wrapper-col":{offset:4,span:16}},{default:o(()=>[a(z,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:y},{default:o(()=>e[18]||(e[18]=[v("提交 ")])),_:1},512)]),_:1},512),[[K,!u.isDialog]])]),_:1},8,["model"])),a(F,{spinning:i.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}}),Se=Q(re,[["__scopeId","data-v-30f81c82"]]);export{Se as default};
