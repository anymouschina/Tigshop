import{d as P,i as V,C as M,s as O,q as z,I as S,r as m,c as y,o as d,e as r,j as k,f as G,b as t,w as l,a0 as H,F as U,a as $,E as C,a1 as J,_ as K}from"./index-CGYuOau0.js";import{a as Q,c as W}from"./productAttributesTpl-B63gKNXF.js";const X={class:"container"},Y={class:"content_wrapper"},Z={class:"lyecs-form-table"},ee={class:"attr-warp-box"},te=["onClick"],ae={class:"attr-warp-box"},le=["onClick"],oe={class:"attr-warp-box"},ne=["onClick"],se=P({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(A,{expose:F,emit:I}){const f=I,v=A,b=V(!0),B=M().currentRoute.value.query,x=V(v.isDialog?v.act:String(B.act)),D=V(v.isDialog?v.id:Number(B.id)),L=x.value==="add"?"create":"update",R=O(),o=V({});z(()=>{x.value==="detail"?T():b.value=!1});const T=async()=>{try{const a=await Q(x.value,{id:D.value});Object.assign(o.value,a.item)}catch(a){S.error(a.message),f("close")}finally{b.value=!1}},h=(a,e)=>{o.value.tpl_data[a].splice(e,1)},N=a=>{if(o.value.tpl_data)Array.isArray(o.value.tpl_data[a])||(o.value.tpl_data[a]=[]);else{let e={};e[a]=[],o.value.tpl_data=e}o.value.tpl_data[a].push({attr_name:""})},q=async()=>{await R.value.validate();try{console.log(o.value),f("update:confirmLoading",!0);const a=await W(L,{id:D.value,...o.value});f("submitCallback",a),S.success(a.message)}catch(a){S.error(a.message)}finally{f("update:confirmLoading",!1)}};return F({onFormSubmit:()=>{q()}}),(a,e)=>{const w=m("el-input"),p=m("el-form-item"),c=m("el-space"),g=m("el-button"),j=m("el-form"),E=m("a-spin");return d(),y("div",X,[r("div",Y,[r("div",Z,[b.value?G("",!0):(d(),k(j,{key:0,ref_key:"formRef",ref:R,model:o.value,"label-width":"auto"},{default:l(()=>[t(p,{rules:[{required:!0,message:"属性模板名称不能为空!"}],label:"属性模板名称",prop:"tpl_name"},{default:l(()=>[t(w,{modelValue:o.value.tpl_name,"onUpdate:modelValue":e[0]||(e[0]=n=>o.value.tpl_name=n)},null,8,["modelValue"])]),_:1}),t(p,{label:"属性名称",prop:"brand_logo"},{default:l(()=>{var n,u;return[r("div",ee,[(d(!0),y(U,null,$((u=(n=o.value)==null?void 0:n.tpl_data)==null?void 0:u.normal,(s,_)=>(d(),k(c,{class:"attr-row"},{default:l(()=>[t(w,{modelValue:s.attr_name,"onUpdate:modelValue":i=>s.attr_name=i,placeholder:"",style:{width:"260px"}},null,8,["modelValue","onUpdate:modelValue"]),r("div",{class:"iconfont icon-cha1 btn-remove",onClick:i=>h("normal",Number(_))},null,8,te)]),_:2},1024))),256)),t(c,{class:"attr-row"},{default:l(()=>[t(g,{onClick:e[1]||(e[1]=s=>N("normal"))},{default:l(()=>e[5]||(e[5]=[r("i",{class:"btn-ico"},"+",-1),C("增加新属性")])),_:1})]),_:1})])]}),_:1}),t(p,{label:"规格名称"},{default:l(()=>{var n,u;return[r("div",ae,[(d(!0),y(U,null,$((u=(n=o.value)==null?void 0:n.tpl_data)==null?void 0:u.spe,(s,_)=>(d(),k(c,{class:"attr-row"},{default:l(()=>[t(w,{modelValue:s.attr_name,"onUpdate:modelValue":i=>s.attr_name=i,placeholder:"",style:{width:"260px"}},null,8,["modelValue","onUpdate:modelValue"]),r("div",{class:"iconfont icon-cha1 btn-remove",onClick:i=>h("spe",Number(_))},null,8,le)]),_:2},1024))),256)),t(c,{class:"attr-row"},{default:l(()=>[t(g,{onClick:e[2]||(e[2]=s=>N("spe"))},{default:l(()=>e[6]||(e[6]=[r("i",{class:"btn-ico"},"+",-1),C("增加新规格")])),_:1})]),_:1})])]}),_:1}),t(p,{label:"附加规格"},{default:l(()=>{var n,u;return[r("div",oe,[(d(!0),y(U,null,$((u=(n=o.value)==null?void 0:n.tpl_data)==null?void 0:u.extra,(s,_)=>(d(),k(c,{class:"attr-row"},{default:l(()=>[t(w,{modelValue:s.attr_name,"onUpdate:modelValue":i=>s.attr_name=i,placeholder:"",style:{width:"260px"}},null,8,["modelValue","onUpdate:modelValue"]),r("div",{class:"iconfont icon-cha1 btn-remove",onClick:i=>h("extra",Number(_))},null,8,ne)]),_:2},1024))),256)),t(c,{class:"attr-row"},{default:l(()=>[t(g,{onClick:e[3]||(e[3]=s=>N("extra"))},{default:l(()=>e[7]||(e[7]=[r("i",{class:"btn-ico"},"+",-1),C("增加附加规格")])),_:1})]),_:1})])]}),_:1}),H(t(p,{"wrapper-col":{offset:4,span:16}},{default:l(()=>[t(g,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:e[4]||(e[4]=n=>q())},{default:l(()=>e[8]||(e[8]=[C("提交 ")])),_:1},512)]),_:1},512),[[J,!A.isDialog]])]),_:1},8,["model"])),t(E,{spinning:b.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}}),de=K(se,[["__scopeId","data-v-1fe49f44"]]);export{de as default};
