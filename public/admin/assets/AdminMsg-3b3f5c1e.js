import{a as G}from"./version-f7bce787.js";import{u as H}from"./config-9548fa9b.js";import{d as K,dk as T,j as l,I as q,x as J,r as w,o as s,c as a,b,w as S,e as n,F as z,a as A,f as B,n as I,G as p,h as _,k as O,H as Q,K as W,p as X,i as Y,_ as Z}from"./index-7c2d2aef.js";/* empty css                                                                    */import{P as ee}from"./Pagination-8eb7b6b1.js";import te from"./Collapse-ef51f22e.js";import{a as se,b as ae}from"./adminMsg-11a92805.js";import"./config-e2aa16d1.js";import"./Image.vue_vue_type_script_setup_true_lang-36bd437b.js";import"./format-4e0206d3.js";import"./util-1ee03ed8.js";import"./DetailBtn.vue_vue_type_script_setup_true_lang-ca8b9a40.js";import"./index-6c62cf9b.js";import"./DialogForm.vue_vue_type_script_setup_true_lang-c57b9a11.js";const ne="/admin/assets/empty-bg-e0ce9a79.png",N=v=>(X("data-v-80c0e2b4"),v=v(),Y(),v),oe={class:"message_center"},le={class:"tab_box tab_box1"},ce=["onClick"],ue={key:0,class:"num"},ie=["onClick"],re={key:0,class:"num"},_e={class:"tab_box tab_box2"},de=["onClick"],pe={key:0,class:"num"},me={class:"list_box"},ve={style:{"min-height":"200px"}},ge={key:0,class:"item"},he={key:1,class:"table-empty"},ye=N(()=>n("img",{src:ne,alt:""},null,-1)),fe=N(()=>n("p",null,"当前暂无消息哟",-1)),be=[ye,fe],ke={key:0,class:"pagination-con"},Ce={class:"btn"},xe=K({__name:"AdminMsg",emits:["submitCallback","update:confirmLoading","close"],setup(v,{emit:R}){const V=T(),F=R,P=H(),d=l([]),k=l([]),c=l(0),g=l(0),h=l(!0),y=l(!0),o=q({page:1,size:P.get("page_size"),msg_type:11}),u=l([]),C=l(0),m=async()=>{y.value=!0;try{const t=await se({...o});u.value=t.filter_result,d.value=t.msg_type_arr,k.value=x(d.value[c.value].child),C.value=t.total,h.value=!1}catch(t){W.error(t.message)}finally{y.value=!1}},U=()=>{F("close")};J(()=>{m()});const $=async()=>{await ae(),m()},M=t=>{c.value=t,g.value=0,u.value.length=0,o.msg_type=x(d.value[c.value].child)[0].msg_type,m()},j=t=>{o.page=1,g.value=t,u.value.length=0,o.msg_type=x(d.value[c.value].child)[t].msg_type,m()},D=()=>{d.value[c.value].unread_count-=1,k.value[g.value].unread_count-=1,V.messageCount-=1},x=t=>{if(typeof t=="object"){var i=[];for(let f in t)i.push(t[f]);return i}else return t};return(t,i)=>{const f=w("a-spin"),E=w("el-button");return s(),a("div",null,[b(f,{spinning:h.value},{default:S(()=>[n("div",oe,[n("div",le,[(s(!0),a(z,null,A(d.value,(e,r)=>(s(),a("div",null,[e.cat_id==4&&B(G)()?(s(),a("div",{key:0,class:I(["tab",c.value==r?"current":""]),onClick:L=>M(r)},[n("p",null,p(e.cat_name),1),e.unread_count>0?(s(),a("p",ue,p(e.unread_count),1)):_("",!0)],10,ce)):e.cat_id!=4?(s(),a("div",{key:1,class:I(["tab",c.value==r?"current":""]),onClick:L=>M(r)},[n("p",null,p(e.cat_name),1),e.unread_count>0?(s(),a("p",re,p(e.unread_count),1)):_("",!0)],10,ie)):_("",!0)]))),256))]),n("div",_e,[(s(!0),a(z,null,A(k.value,(e,r)=>(s(),a("div",{class:I(["tab",g.value==r?"current":""]),onClick:L=>j(r)},[n("p",null,p(e.name),1),e.unread_count>0?(s(),a("p",pe,p(e.unread_count),1)):_("",!0)],10,de))),256))]),n("div",me,[b(f,{spinning:y.value&&!h.value,style:{width:"100%"}},{default:S(()=>[n("div",ve,[u.value.length>0?(s(),a("div",ge,[(s(!0),a(z,null,A(u.value,e=>(s(),O(te,{item:e,msg_type:e.msg_type,key:e.msg_type,onSetReadedCallback:D,onClose:U},null,8,["item","msg_type"]))),128))])):_("",!0),u.value.length===0&&!y.value&&!h.value?(s(),a("div",he,be)):_("",!0)])]),_:1},8,["spinning"]),u.value.length>0&&C.value>0?(s(),a("div",ke,[b(B(ee),{page:o.page,"onUpdate:page":i[0]||(i[0]=e=>o.page=e),size:o.size,"onUpdate:size":i[1]||(i[1]=e=>o.size=e),background:!1,total:C.value,onCallback:m},null,8,["page","size","total"])])):_("",!0)]),n("div",Ce,[b(E,{onClick:$},{default:S(()=>[Q("全部已读")]),_:1})])])]),_:1},8,["spinning"])])}}});const $e=Z(xe,[["__scopeId","data-v-80c0e2b4"]]);export{$e as default};
