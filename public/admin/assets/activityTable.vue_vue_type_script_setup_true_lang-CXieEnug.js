import{d as L,K as M,i as f,G as R,q as j,c as b,e as a,b as o,r as i,w as l,f as k,g as p,I as w,o as c,M as H,F as J,a as Q,j as W,aR as X,E as y,D as A}from"./index-DrbzVNl6.js";/* empty css             */import"./index-CeQDmMxd.js";import{P as Y}from"./PopFormElm-BZp1_Wme.js";import{_ as Z}from"./Switch.vue_vue_type_script_setup_true_lang-C5nzofSO.js";import{D as ee}from"./DeleteRecord-MR4vGqLl.js";/* empty css                                                                    */import{P as te}from"./Pagination-wR9huHyl.js";import{g as oe,a as ae,u as T,d as le,b as se}from"./productActivity-oK4Ax5Ms.js";import{_ as ne}from"./DialogForm.vue_vue_type_script_setup_true_lang-DqYSRv0_.js";const ie={class:"container"},re={class:"lyecs-table-list-warp"},de={class:"list-table-tool lyecs-search-warp"},pe={class:"advanced-search-warp list-table-tool-row"},ce={class:"simple-form-warp"},me={class:"simple-form-field"},ue={class:"form-group"},_e={class:"control-container"},ve={class:"simple-form-field"},fe={class:"form-group"},be={class:"control-container"},ge={class:"list-table-tool-row"},ye={class:"list-table-tool-col"},he={key:0},ke={class:"table-container"},we={style:{position:"relative"}},Ae={class:"empty-warp"},Ce={key:0,class:"empty-bg"},Se={key:0,class:"pagination-con"},Fe=L({__name:"activityTable",props:{promotionType:{type:Number,default:1}},setup(V,{expose:I}){const P=M(),N=V,C=f(),m=f(!0),g=f(0),u=f([]),s=R({page:1,size:P.get("pageSize"),sortField:"",sortOrder:"",keyword:"",promotionType:N.promotionType==3?"3":"1,2"}),h=f([]),d=async()=>{m.value=!0;try{const n=await oe({...s});C.value=n.records,g.value=n.total;const e=await ae();h.value=e.promotionStatus,console.log(h.value)}catch(n){w.error(n.message)}finally{m.value=!1}};j(()=>{d()});const _=()=>{d()},O=({prop:n,order:e})=>{s.sortField=n,s.sortOrder=e=="ascending"?"asc":e=="descending"?"desc":"",d()},U=async n=>{try{const e=await se(n,{ids:u.value});w.success("操作成功"),d()}catch(e){w.error(e.message)}},q=n=>{u.value=n.map(e=>e.promotionId)};return I({loadFilter:d}),(n,e)=>{const S=i("el-button"),x=i("TigInput"),z=i("el-option"),F=i("el-select"),D=i("el-popconfirm"),B=i("el-space"),$=i("el-form"),r=i("el-table-column"),G=i("el-divider"),K=i("el-table"),E=i("a-spin");return c(),b("div",ie,[a("div",re,[a("div",de,[o($,{model:s},{default:l(()=>[a("div",pe,[a("div",ce,[a("div",me,[a("div",ue,[a("div",_e,[o(x,{modelValue:s.keyword,"onUpdate:modelValue":e[0]||(e[0]=t=>s.keyword=t),name:"keyword",placeholder:"输入活动名称",onKeyup:H(_,["enter"]),clearable:"",onClear:_},{append:l(()=>[o(S,{onClick:_},{default:l(()=>e[5]||(e[5]=[a("span",{class:"iconfont icon-chakan1"},null,-1)])),_:1})]),_:1},8,["modelValue"])])])]),a("div",ve,[a("div",fe,[e[6]||(e[6]=a("label",{class:"control-label"},[a("span",null,"活动状态：")],-1)),a("div",be,[o(F,{modelValue:s.isGoing,"onUpdate:modelValue":e[1]||(e[1]=t=>s.isGoing=t),clearable:"",onClear:_,onChange:_},{default:l(()=>[(c(!0),b(J,null,Q(h.value,(t,v)=>(c(),W(z,{value:v,label:t},null,8,["value","label"]))),256))]),_:1},8,["modelValue"])])])])])]),a("div",ge,[a("div",ye,[o(B,null,{default:l(()=>[X(n.$slots,"default"),o(D,{title:"您确认要批量删除所选数据吗？",onConfirm:e[2]||(e[2]=t=>U("del"))},{reference:l(()=>[o(S,{disabled:u.value.length===0},{default:l(()=>e[7]||(e[7]=[y("批量删除")])),_:1},8,["disabled"])]),_:1}),u.value.length>0?(c(),b("span",he,[e[8]||(e[8]=y(" 已选择：")),a("b",null,A(u.value.length),1),e[9]||(e[9]=y(" 项 "))])):k("",!0)]),_:3})])])]),_:3},8,["model"])]),a("div",ke,[o(E,{spinning:m.value},{default:l(()=>[o(K,{data:C.value,"row-key":"promotionId",onSelectionChange:q,total:g.value,onSortChange:O,loading:m.value},{empty:l(()=>[a("div",Ae,[m.value?k("",!0):(c(),b("div",Ce,"暂无数据"))])]),default:l(()=>[o(r,{type:"selection",width:"32"}),o(r,{label:"活动名称",prop:"promotionName",width:150},{default:l(({row:t})=>[a("div",we,[a("div",null,A(t.promotionName||"--"),1)])]),_:1}),o(r,{label:"活动类型",prop:"promotionTypeName",width:"100"}),o(r,{label:"起始日期",prop:"startTime",width:"150",sortable:"custom"}),o(r,{label:"截止日期",prop:"endTime",width:"150",sortable:"custom"}),o(r,{label:"排序",prop:"sortOrder",sortable:"custom"},{default:l(({row:t})=>[o(p(Y),{label:"排序",type:"integer",requestApi:p(T),"org-value":t.sortOrder,"onUpdate:orgValue":v=>t.sortOrder=v,params:{id:t.promotionId,field:"sortOrder"},extra:"默认值为50，数值越小，排序越靠前"},{default:l(()=>[a("div",null,A(t.sortOrder),1)]),_:2},1032,["requestApi","org-value","onUpdate:orgValue","params"])]),_:1}),o(r,{label:"状态",prop:"productStatus"}),o(r,{label:"是否启用",prop:"isAvailable",sortable:"custom"},{default:l(({row:t})=>[o(p(Z),{checked:t.isAvailable,"onUpdate:checked":v=>t.isAvailable=v,requestApi:p(T),params:{id:t.promotionId,field:"isAvailable"}},null,8,["checked","onUpdate:checked","requestApi","params"])]),_:1}),o(r,{label:"操作",fixed:"right"},{default:l(({row:t})=>[o(p(ne),{isDrawer:"",onOkCallback:d,title:"编辑优惠活动",width:"800px",path:"promotion/productActivity/Info",params:{act:"detail",id:t.promotionId,promotionType:t.promotionType}},{default:l(()=>e[10]||(e[10]=[a("a",{class:"btn-link"},"编辑",-1)])),_:2},1032,["params"]),o(G,{direction:"vertical"}),o(p(ee),{onAfterDelete:d,requestApi:p(le),params:{id:t.promotionId}},{default:l(()=>e[11]||(e[11]=[y("删除")])),_:2},1032,["requestApi","params"])]),_:1})]),_:1},8,["data","total","loading"])]),_:1},8,["spinning"]),g.value>0?(c(),b("div",Se,[o(p(te),{page:s.page,"onUpdate:page":e[3]||(e[3]=t=>s.page=t),size:s.size,"onUpdate:size":e[4]||(e[4]=t=>s.size=t),total:g.value,onCallback:d},null,8,["page","size","total"])])):k("",!0)])])])}}});export{Fe as _};
