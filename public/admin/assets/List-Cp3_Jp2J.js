import{d as A,C as H,i as u,K as J,G as Q,q as W,aT as X,c as m,e as s,f as _,b as o,w as a,M as Y,g as v,I as C,r as i,o as r,E as c,D as p,j as I,_ as Z}from"./index-DrbzVNl6.js";/* empty css             */import"./index-CeQDmMxd.js";/* empty css                                                                    */import{P as ee}from"./Pagination-wR9huHyl.js";import{p as T}from"./format-CRgx78oe.js";import{_ as te}from"./Image.vue_vue_type_script_setup_true_lang-BWzCs9jv.js";import{b as se,c as oe}from"./shop-DM8_bN_f.js";import{S as O}from"./StatusDot-eKxl7wC-.js";import{_ as ae}from"./DialogForm.vue_vue_type_script_setup_true_lang-DqYSRv0_.js";const le={class:"container"},ne={class:"content_wrapper"},ie={class:"container"},re={class:"lyecs-table-list-warp"},ce={class:"list-table-tool lyecs-search-warp"},de={class:"advanced-search-warp list-table-tool-row"},ue={class:"simple-form-warp"},pe={class:"simple-form-field"},me={class:"form-group"},_e={class:"control-container"},fe={class:"simple-form-field"},ve={class:"form-group"},ge={key:0},he={class:"simple-form-field"},be={class:"form-group"},ye={class:"control-container"},we={class:"simple-form-field"},ke={class:"table-container"},Se={key:2,style:{color:"red"}},Ce={key:3,style:{color:"green"}},Te={class:"empty-warp"},xe={key:0,class:"empty-bg"},Ve={key:0,class:"pagination-con"},Ie={key:0,class:"selected-action-warp"},Oe={class:"selected-action"},ze=A({__name:"List",setup(Be){const h=H().currentRoute.value.query,z=u([{label:"全部",value:0,isShow:!0},{label:"开业",value:1,isShow:!0},{label:"关店",value:10,isShow:!0}]),B=J(),x=u([]),g=u(!1),b=u(0),y=u([]),L=u(!1),n=Q({page:1,size:B.get("pageSize"),sortField:"",sortOrder:"",keyword:"",status:0}),U=l=>{n.status=l,f()},f=async()=>{g.value=!0;try{const l=await se({...n});x.value=l.records,b.value=l.total}catch(l){C.error(l.message)}finally{g.value=!1}},M=()=>{let l=window.location.href,e=new URL(l);e.search="",window.history.replaceState({},document.title,e.toString())},N=u(),V=u(0);W(()=>{f(),console.log(h),h.id&&X.confirm(`为[${h.companyName||"--"}]立即创建店铺?`,"提示",{closeOnClickModal:!1,showClose:!1,confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>{V.value=Number(h.id),N.value.show()}).catch(()=>{V.value=0,M()})});const w=()=>{f()},F=({prop:l,order:e})=>{n.sortField=l,n.sortOrder=e=="ascending"?"asc":e=="descending"?"desc":"",f()},D=async l=>{try{const e=await oe(l,{ids:y.value});C.success("操作成功"),f()}catch(e){C.error(e.message)}},P=l=>{y.value=l.map(e=>e.shopId)};return(l,e)=>{const k=i("el-button"),$=i("TigInput"),q=i("TigTabs"),S=i("el-option"),E=i("el-select"),d=i("el-table-column"),K=i("el-table"),R=i("a-spin"),j=i("el-popconfirm"),G=i("el-space");return r(),m("div",le,[s("div",ne,[s("div",ie,[s("div",re,[s("div",ce,[s("div",de,[s("div",ue,[s("div",pe,[s("div",me,[s("div",_e,[o($,{modelValue:n.keyword,"onUpdate:modelValue":e[0]||(e[0]=t=>n.keyword=t),name:"username",placeholder:"输入店铺名称",onKeyup:Y(w,["enter"]),clearable:"",onClear:w},{append:a(()=>[o(k,{onClick:w},{default:a(()=>e[6]||(e[6]=[s("span",{class:"iconfont icon-chakan1"},null,-1)])),_:1})]),_:1},8,["modelValue"])])])]),s("div",fe,[s("div",ve,[o(q,{modelValue:n.status,"onUpdate:modelValue":e[1]||(e[1]=t=>n.status=t),tabs:z.value,onOnTabChange:U},null,8,["modelValue","tabs"])])]),L.value?(r(),m("div",ge,[s("div",he,[s("div",be,[e[7]||(e[7]=s("label",{class:"control-label"},[s("span",null,"店铺状态：")],-1)),s("div",ye,[o(E,{modelValue:n.status,"onUpdate:modelValue":e[2]||(e[2]=t=>n.status=t),clearable:""},{default:a(()=>[o(S,{value:0,label:"全部"}),o(S,{value:1,label:"运营中"}),o(S,{value:10,label:"关闭"})]),_:1},8,["modelValue"])])])]),s("div",we,[o(k,{type:"primary",onClick:w},{default:a(()=>e[8]||(e[8]=[c("搜索")])),_:1})])])):_("",!0)])])]),s("div",ke,[o(R,{spinning:g.value},{default:a(()=>[o(K,{data:x.value,loading:g.value,total:b.value,"row-key":"shopId",onSelectionChange:P,onSortChange:F},{empty:a(()=>[s("div",Te,[g.value?_("",!0):(r(),m("div",xe,"暂无数据"))])]),default:a(()=>[o(d,{label:"店铺名称"},{default:a(({row:t})=>[c(p(t.shopTitle||"--"),1)]),_:1}),o(d,{label:"店铺LOGO"},{default:a(({row:t})=>[o(v(te),{src:t.shopLogo,fit:"contain",style:{height:"25px",width:"60px"}},null,8,["src"])]),_:1}),o(d,{label:"店铺状态"},{default:a(({row:t})=>[t.status==10?(r(),I(O,{key:0,color:"red",flicker:!0})):_("",!0),t.status==1?(r(),I(O,{key:1,color:"green",flicker:!0})):_("",!0),t.status===10?(r(),m("span",Se,p(t.statusText),1)):t.status===1?(r(),m("span",Ce,p(t.statusText),1)):_("",!0)]),_:1}),o(d,{label:"店铺资金",sortable:"custom"},{default:a(({row:t})=>[c(p(v(T)(t.shopMoney)||0),1)]),_:1}),o(d,{label:"待结算金额",sortable:"custom"},{default:a(({row:t})=>[c(p(v(T)(t.unSettlementOrder)||0),1)]),_:1}),o(d,{label:"不可用资金",sortable:"custom"},{default:a(({row:t})=>[c(p(v(T)(t.frozenMoney)||0),1)]),_:1}),o(d,{label:"开店时间"},{default:a(({row:t})=>[c(p(t.addTime),1)]),_:1}),o(d,{width:120,fixed:"right",label:"操作"},{default:a(({row:t})=>[o(v(ae),{params:{shopId:t.shopId},showClose:!1,showOnOk:!1,isDrawer:"",path:"shop/financialLog/List",title:"资金日志",width:"800px"},{default:a(()=>e[9]||(e[9]=[s("a",{class:"btn-link"},"查看资金日志",-1)])),_:2},1032,["params"])]),_:1})]),_:1},8,["data","loading","total"])]),_:1},8,["spinning"]),b.value>0?(r(),m("div",Ve,[o(v(ee),{page:n.page,"onUpdate:page":e[3]||(e[3]=t=>n.page=t),size:n.size,"onUpdate:size":e[4]||(e[4]=t=>n.size=t),total:b.value,onCallback:f},null,8,["page","size","total"])])):_("",!0)]),y.value.length>0?(r(),m("div",Ie,[s("div",Oe,[o(G,null,{default:a(()=>[s("span",null,[e[10]||(e[10]=c("已选择：")),s("b",null,p(y.value.length),1),e[11]||(e[11]=c(" 项"))]),o(j,{title:"您确认要批量删除所选数据吗？",onConfirm:e[5]||(e[5]=t=>D("del"))},{reference:a(()=>[o(k,null,{default:a(()=>e[12]||(e[12]=[c("批量删除")])),_:1})]),_:1})]),_:1})])])):_("",!0)])])])])}}}),Ke=Z(ze,[["__scopeId","data-v-2fe56784"]]);export{Ke as default};
