/* empty css             */import"./index-B-GURfkM.js";import{_ as B}from"./Switch.vue_vue_type_script_setup_true_lang-CKSPWIQL.js";import{_ as M}from"./DeleteRecord.vue_vue_type_script_setup_true_lang-BTFcBk5t.js";/* empty css                                                                    */import{P as ne}from"./Pagination-yOfjsBuR.js";import{i as ie}from"./format-DFT-VJzO.js";import{u as de}from"./config-DNllFJyR.js";import{P as T}from"./PopFormElm-DSof3F4x.js";import{d as pe,C as O,dt as ce,i as _,G as E,q as ue,aX as _e,I as F,c as v,e as l,b as a,w as s,f as g,g as r,F as me,r as c,o as p,j as z,E as f,D as b}from"./index-CGYuOau0.js";import{g as S,u as C,d as H,b as ge}from"./category-BQcUsnE8.js";import{u as fe}from"./category-DpIl2IOo.js";import{c as ye}from"./version-CpBOsX2d.js";import{_ as D}from"./DialogForm.vue_vue_type_script_setup_true_lang-Bmm-M6gU.js";import"./config-DU8_t5BN.js";const ve=["href"],he={class:"container"},ke={class:"content_wrapper"},be={class:"lyecs-table-list-warp"},Ce={class:"list-table-tool lyecs-search-warp"},xe={class:"list-table-tool-row"},qe={class:"list-table-tool-col"},Ae={key:2},Ie={class:"table-container"},ze={style:{position:"relative"}},Se=["onClick"],De={key:1},Ue={key:0},Ve={class:"empty-warp"},Ne={key:0,class:"empty-bg"},Te={key:0,class:"pagination-con"},Qe=pe({__name:"List",setup(Fe){const L=fe(),{currentRoute:j}=O();O();const w=ce(),P=de(),G=_(P.icoDefinedCss),R=_([]),x=_(!0),q=_(0),h=_([]),X=_([]),i=E({page:1,size:P.get("page_size"),sort_field:"",sort_order:"",keyword:"",is_show:-1,parent_id:0}),A=_([0]),J=_(),K=_e(),k=E({});ue(()=>{const o=j.value.query;o.id>0&&(i.parent_id=o.id),K.meta.title="",u()});const u=async()=>{x.value=!0;try{const o=await S({...i});R.value=o.filter_result,q.value=o.total,J.value=o.parent_name,o.parent_name?w.setHeaderTitle("类目管理 - "+o.parent_name):w.setHeaderTitle("类目管理")}catch(o){F.error(o.message)}finally{x.value=!1}},Q=async(o,t,n)=>{k[o.category_id]={},k[o.category_id].resolve=n,k[o.category_id].expandCount=0;const y=await S({page:1,parent_id:o.category_id,size:1e3});n(y.filter_result)},W=async(o,t)=>{const n=k[o.category_id];if(n.expandCount++,t&&n.expandCount>1&&!n.prevStatus){const y=await S({page:1,parent_id:o.category_id,size:1e3});n.resolve(y.filter_result)}n.prevStatus=t},I=_(),U=async(o,t)=>{const n=k[t.parentId];if(n){const y=await S({page:1,parent_id:t.parentId,size:1e3});I.value.store.states.lazyTreeNodeMap.value[t.parentId].length>1?I.value.store.states.lazyTreeNodeMap[t.parentId]=[]:I.value.store.states.lazyTreeNodeMap.value[t.parentId]=[],n.resolve(y.filter_result)}else u()},V=()=>{L.clearCategory()},Y=o=>{A.value.push(o),i.parent_id=o,u()},Z=()=>{A.value.pop(),i.parent_id=A.value[A.value.length-1],u()},ee=async o=>{try{const t=await ge(o,{ids:h.value});F.success(t.message),u()}catch(t){F.error(t.message)}},te=o=>{h.value=o.map(t=>t.category_id)};return(o,t)=>{const n=c("el-button"),y=c("router-link"),ae=c("el-popconfirm"),$=c("el-space"),se=c("el-form"),m=c("el-table-column"),oe=c("el-image"),N=c("el-divider"),re=c("el-table"),le=c("a-spin");return p(),v(me,null,[l("link",{href:G.value,rel:"stylesheet"},null,8,ve),l("div",he,[l("div",ke,[l("div",be,[l("div",Ce,[a(se,{model:i,name:"form"},{default:s(()=>[l("div",xe,[l("div",qe,[a($,null,{default:s(()=>[i.parent_id>0?(p(),z(n,{key:0,onClick:Z},{default:s(()=>t[3]||(t[3]=[l("i",{class:"iconfont icon-fanhui",style:{"font-size":"14px","padding-right":"5px"}},null,-1),f(" 返回上一级 ")])),_:1})):g("",!0),a(r(D),{params:{act:"add",parentId:i.parent_id},isDrawer:"",path:"product/category/Info",title:"添加分类",width:"600px",onOkCallback:u},{default:s(()=>[a(n,{type:"primary"},{default:s(()=>t[4]||(t[4]=[f("添加分类")])),_:1})]),_:1},8,["params"]),r(ye)()?(p(),z(y,{key:1,to:{path:"/setting/multilingual/translationContent/list",query:{type:"category"}}},{default:s(()=>[a(n,null,{default:s(()=>t[5]||(t[5]=[f("批量翻译分类名称")])),_:1})]),_:1})):g("",!0),a(ae,{title:"您确认要批量删除所选数据吗？",onConfirm:t[0]||(t[0]=e=>ee("del"))},{reference:s(()=>[a(n,{disabled:h.value.length===0},{default:s(()=>t[6]||(t[6]=[f("批量删除")])),_:1},8,["disabled"])]),_:1}),h.value.length>0?(p(),v("span",Ae,[t[7]||(t[7]=f(" 已选择：")),l("b",null,b(h.value.length),1),t[8]||(t[8]=f(" 项 "))])):g("",!0)]),_:1})])])]),_:1},8,["model"])]),l("div",Ie,[a(le,{spinning:x.value},{default:s(()=>[a(re,{data:R.value,"expand-row-keys":X.value,indent:30,load:Q,total:q.value,"tree-props":{children:"children",hasChildren:"has_children"},lazy:"","row-key":"category_id",onSelectionChange:te,onExpandChange:W,ref_key:"tableRef",ref:I},{empty:s(()=>[l("div",Ve,[x.value?g("",!0):(p(),v("div",Ne,"暂无数据"))])]),default:s(()=>[a(m,{type:"selection",width:"32"}),a(m,{width:200,label:"分类名称"},{default:s(({row:e})=>[a($,{style:{height:"30px"}},{default:s(()=>[l("div",ze,[a(r(T),{"org-value":e.category_name,"onUpdate:orgValue":d=>e.category_name=d,params:{id:e.category_id,field:"category_name"},requestApi:r(C),label:"分类名称",type:"textarea",onCallback:V},{default:s(()=>[e.has_children?(p(),v("a",{key:0,onClick:d=>Y(e.category_id)},b(e.category_name),9,Se)):(p(),v("span",De,b(e.category_name),1))]),_:2},1032,["org-value","onUpdate:orgValue","params","requestApi"])])]),_:2},1024)]),_:1}),a(m,{width:120,label:"分类图片"},{default:s(({row:e})=>[e.category_pic?(p(),v("div",Ue,[a(oe,{src:r(ie)(e.category_pic),fit:"contain",style:{height:"30px",width:"30px"}},null,8,["src"])])):g("",!0)]),_:1}),a(m,{label:"单位"},{default:s(({row:e})=>[a(r(T),{"org-value":e.measure_unit,"onUpdate:orgValue":d=>e.measure_unit=d,params:{id:e.category_id,field:"measure_unit"},requestApi:r(C),label:"单位",type:"input",onCallback:V},{default:s(()=>[l("div",null,b(e.measure_unit||"-"),1)]),_:2},1032,["org-value","onUpdate:orgValue","params","requestApi"])]),_:1}),a(m,{label:"是否热门"},{default:s(({row:e})=>[a(r(B),{checked:e.is_hot,"onUpdate:checked":d=>e.is_hot=d,params:{id:e.category_id,field:"is_hot"},requestApi:r(C)},null,8,["checked","onUpdate:checked","params","requestApi"])]),_:1}),a(m,{key:"is_show",sorter:!0,label:"是否显示"},{default:s(({row:e})=>[a(r(B),{checked:e.is_show,"onUpdate:checked":d=>e.is_show=d,params:{id:e.category_id,field:"is_show"},requestApi:r(C)},null,8,["checked","onUpdate:checked","params","requestApi"])]),_:1}),a(m,{key:"sort_order",sorter:!0,label:"排序"},{default:s(({row:e})=>[a(r(T),{"org-value":e.sort_order,"onUpdate:orgValue":d=>e.sort_order=d,params:{id:e.category_id,field:"sort_order"},requestApi:r(C),label:"排序",type:"input",onCallback:V},{default:s(()=>[l("div",null,b(e.sort_order),1)]),_:2},1032,["org-value","onUpdate:orgValue","params","requestApi"])]),_:1}),a(m,{width:240,fixed:"right",label:"操作"},{default:s(({row:e})=>[a(r(D),{params:{act:"detail",id:e.category_id},data:{parentId:e.parent_id},isDrawer:"",path:"product/category/Info",title:"编辑分类",width:"600px",onOkCallback:U},{default:s(()=>t[9]||(t[9]=[l("a",{class:"btn-link"},"编辑",-1)])),_:2},1032,["params","data"]),a(N,{direction:"vertical"}),a(r(D),{params:{act:"add",parentId:e.category_id},data:{parentId:e.parent_id||e.category_id},isDrawer:"",path:"product/category/Info",title:"添加子分类",width:"600px",onOkCallback:U},{default:s(()=>t[10]||(t[10]=[l("a",{class:"btn-link"},"添加子分类",-1)])),_:2},1032,["params","data"]),a(N,{direction:"vertical"}),a(r(D),{params:{id:e.category_id},isDrawer:"",path:"product/category/Move",title:"商品转移",width:"600px",onOkCallback:u},{default:s(()=>t[11]||(t[11]=[l("a",{class:"btn-link"},"商品转移",-1)])),_:2},1032,["params"]),a(N,{direction:"vertical"}),e.parent_id?(p(),z(r(M),{key:0,params:{id:e.category_id},requestApi:r(H),onAfterDelete:d=>U({},{parentId:e.parent_id})},{default:s(()=>t[12]||(t[12]=[f("删除 ")])),_:2},1032,["params","requestApi","onAfterDelete"])):g("",!0),e.parent_id?g("",!0):(p(),z(r(M),{key:1,params:{id:e.category_id},requestApi:r(H),onAfterDelete:u},{default:s(()=>t[13]||(t[13]=[f("删除")])),_:2},1032,["params","requestApi"]))]),_:1})]),_:1},8,["data","expand-row-keys","total"])]),_:1},8,["spinning"]),q.value>0?(p(),v("div",Te,[a(r(ne),{page:i.page,"onUpdate:page":t[1]||(t[1]=e=>i.page=e),size:i.size,"onUpdate:size":t[2]||(t[2]=e=>i.size=e),total:q.value,onCallback:u},null,8,["page","size","total"])])):g("",!0)])])])])],64)}}});export{Qe as default};
