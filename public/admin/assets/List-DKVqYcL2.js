import{d as M,K as $,i as _,C as j,G,q as H,c as d,e as l,b as o,w as s,f as v,g as C,I as w,r as i,o as u,M as J,F as I,a as x,E as h,D as f}from"./index-DrbzVNl6.js";/* empty css             */import"./index-CeQDmMxd.js";import{D as Q}from"./DeleteRecord-MR4vGqLl.js";/* empty css                                                                    */import{P as W}from"./Pagination-wR9huHyl.js";import{g as X,d as Y,b as Z}from"./feedback-2qMJ5aMQ.js";import{_ as ee}from"./DialogForm.vue_vue_type_script_setup_true_lang-DqYSRv0_.js";const te={class:"container"},le={class:"content_wrapper"},oe={class:"lyecs-table-list-warp"},ae={class:"list-table-tool lyecs-search-warp"},se={class:"advanced-search-warp list-table-tool-row"},ne={class:"simple-form-warp"},ie={class:"simple-form-field"},re={class:"form-group"},de={class:"control-container"},ue={class:"simple-form-field"},ce={class:"form-group"},pe={class:"control-container"},me={class:"simple-form-field"},_e={class:"form-group"},ve={class:"control-container"},fe={class:"simple-form-field"},be={class:"form-group"},ge={class:"control-container"},ye={key:0},he={class:"table-container"},ke={key:0,style:{color:"#999"}},Ce={key:1,style:{color:"#999"}},we={key:2,style:{color:"#999"}},Se={class:"empty-warp"},Ve={key:0,class:"empty-bg"},Ne={key:0,class:"pagination-con"},Be=M({__name:"List",setup(ze){const A=$(),S=_([]),b=_(!0),k=_(0),g=_([]);_(!1);const r=j().currentRoute.value.query,y=_([]),n=G({page:1,size:A.get("pageSize"),sortField:"",sortOrder:"",keyword:"",type:"",status:""}),D=[{label:"建议",value:0},{label:"投诉",value:1},{label:"商品",value:2},{label:"其他",value:3},{label:"店铺投诉",value:4},{label:"订单问题",value:5},{label:"订单咨询",value:6}],T=[{label:"待回复",value:0},{label:"已回复",value:1},{label:"无效",value:2}],c=async()=>{b.value=!0;try{y.value.length>0&&(n.type=y.value.join(","));const a=await X({...n});S.value=a.records,k.value=a.total}catch(a){w.error(a.message)}finally{b.value=!1}};H(()=>{if(r&&r.type){let a;typeof r.type=="string"?a=r.type.split(",").map(Number):Array.isArray(r.type)?a=r.type.map(Number):a=[],console.log(a),y.value=a}r&&r.status&&(n.status=Number(r.status)),c()});const p=()=>{c()},q=({prop:a,order:e})=>{n.sortField=a,n.sortOrder=e=="ascending"?"asc":e=="descending"?"desc":"",c()},U=async a=>{try{const e=await Z(a,{ids:g.value});w.success("操作成功"),await c()}catch(e){w.error(e.message)}},B=a=>{g.value=a.map(e=>e.id)};return(a,e)=>{const V=i("el-button"),O=i("TigInput"),N=i("el-option"),z=i("el-select"),K=i("el-popconfirm"),L=i("el-form"),m=i("el-table-column"),P=i("el-divider"),R=i("el-table"),E=i("a-spin");return u(),d("div",te,[l("div",le,[l("div",oe,[l("div",ae,[o(L,{model:n},{default:s(()=>[l("div",se,[l("div",ne,[l("div",ie,[l("div",re,[l("div",de,[o(O,{modelValue:n.keyword,"onUpdate:modelValue":e[0]||(e[0]=t=>n.keyword=t),name:"keyword",placeholder:"输入留言内容",onKeyup:J(p,["enter"]),clearable:"",onClear:p},{append:s(()=>[o(V,{onClick:p},{default:s(()=>e[6]||(e[6]=[l("span",{class:"iconfont icon-chakan1"},null,-1)])),_:1})]),_:1},8,["modelValue"])])])]),l("div",ue,[l("div",ce,[e[7]||(e[7]=l("label",{class:"control-label"},[l("span",null,"留言类型：")],-1)),l("div",pe,[o(z,{modelValue:y.value,"onUpdate:modelValue":e[1]||(e[1]=t=>y.value=t),multiple:"",clearable:"",placeholder:"请选择",onClear:p,onChange:p},{default:s(()=>[(u(),d(I,null,x(D,t=>o(N,{label:t.label,value:t.value,key:t.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])])])]),l("div",me,[l("div",_e,[e[8]||(e[8]=l("label",{class:"control-label"},[l("span",null,"回复状态：")],-1)),l("div",ve,[o(z,{modelValue:n.status,"onUpdate:modelValue":e[2]||(e[2]=t=>n.status=t),clearable:"",placeholder:"请选择",onClear:p,onChange:p},{default:s(()=>[(u(),d(I,null,x(T,t=>o(N,{label:t.label,value:t.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])])])]),l("div",fe,[l("div",be,[l("div",ge,[o(K,{title:"您确认要批量删除所选数据吗？",onConfirm:e[3]||(e[3]=t=>U("del"))},{reference:s(()=>[o(V,{disabled:g.value.length===0},{default:s(()=>e[9]||(e[9]=[h("批量删除")])),_:1},8,["disabled"])]),_:1}),g.value.length>0?(u(),d("span",ye,[e[10]||(e[10]=h(" 已选择：")),l("b",null,f(g.value.length),1),e[11]||(e[11]=h(" 项 "))])):v("",!0)])])])])])]),_:1},8,["model"])]),l("div",he,[o(E,{spinning:b.value},{default:s(()=>[o(R,{data:S.value,loading:b.value,total:k.value,"row-key":"id",onSelectionChange:B,onSortChange:q},{empty:s(()=>[l("div",Se,[b.value?v("",!0):(u(),d("div",Ve,"暂无数据"))])]),default:s(()=>[o(m,{type:"selection",width:"32"}),o(m,{width:120,label:"会员名称",prop:"username"}),o(m,{label:"类型",prop:"typeName"},{default:s(({row:t})=>{var F;return[l("p",null,f(t.typeName),1),t.orderSn?(u(),d("div",ke,f(t.orderSn),1)):v("",!0),t.shopId&&t.store?(u(),d("div",Ce,f(t.store.storeTitle),1)):v("",!0),t.productId>0?(u(),d("div",we,f(((F=t.product)==null?void 0:F.productName)||"--"),1)):v("",!0)]}),_:1}),o(m,{label:"留言内容",prop:"content"},{default:s(({row:t})=>[h(f(t.content),1)]),_:1}),o(m,{width:160,label:"留言时间",prop:"addTime"}),o(m,{width:80,label:"回复",prop:"statusName"}),o(m,{width:150,fixed:"right",label:"操作"},{default:s(({row:t})=>[o(C(ee),{params:{act:"detail",id:t.id},isDrawer:"",path:"user/feedback/Info",title:"编辑会员留言",width:"560px",onOkCallback:c},{default:s(()=>e[12]||(e[12]=[l("a",{class:"btn-link"},"查看",-1)])),_:2},1032,["params"]),o(P,{direction:"vertical"}),o(C(Q),{params:{id:t.id},requestApi:C(Y),onAfterDelete:c},{default:s(()=>e[13]||(e[13]=[h("删除 ")])),_:2},1032,["params","requestApi"])]),_:1})]),_:1},8,["data","loading","total"])]),_:1},8,["spinning"]),k.value>0?(u(),d("div",Ne,[o(C(W),{page:n.page,"onUpdate:page":e[4]||(e[4]=t=>n.page=t),size:n.size,"onUpdate:size":e[5]||(e[5]=t=>n.size=t),total:k.value,onCallback:c},null,8,["page","size","total"])])):v("",!0)])])])])}}});export{Be as default};
