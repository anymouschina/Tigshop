import{d as M,K as F,i as g,G as O,q as P,c as y,e as t,b as s,w as o,N as R,f,g as m,I as w,r as d,o as u,E as p,D as L,l as U,j as I}from"./index-DrbzVNl6.js";/* empty css             */import"./index-CeQDmMxd.js";import{D as z}from"./DeleteRecord-MR4vGqLl.js";/* empty css                                                                    */import{P as $}from"./Pagination-wR9huHyl.js";import{g as E,r as j,d as G,b as K}from"./messageLog-BYsEFPfI.js";import{_ as H}from"./DialogForm.vue_vue_type_script_setup_true_lang-DqYSRv0_.js";const J={class:"container"},Q={class:"content_wrapper"},W={class:"lyecs-table-list-warp"},X={class:"list-table-tool lyecs-search-warp"},Y={class:"advanced-search-warp list-table-tool-row"},Z={class:"simple-form-warp"},ee={class:"simple-form-field"},te={class:"form-group"},se={class:"control-container"},oe={class:"simple-form-field"},ae={class:"form-group"},le={class:"control-container"},ne={class:"simple-form-field"},ie={class:"form-group"},re={class:"control-container"},de={class:"simple-form-field"},pe={class:"form-group"},ce={class:"control-container"},me={key:0},ue={class:"table-container"},_e={class:"empty-warp"},ge={key:0,class:"empty-bg"},fe={key:0,class:"pagination-con"},Ie=M({__name:"List",setup(ve){const T=F(),k=g([]),_=g(!0),v=g(0),c=g([]);g(!1);const n=O({page:1,size:T.get("pageSize"),sortField:"",sortOrder:"",keyword:""}),i=async()=>{_.value=!0;try{const l=await E({...n});k.value=l.records,v.value=l.total}catch(l){w.error(l.message)}finally{_.value=!1}};P(()=>{i()});const h=()=>{i()},D=({prop:l,order:e})=>{n.sortField=l,n.sortOrder=e=="ascending"?"asc":e=="descending"?"desc":"",i()},C=async l=>{try{const e=await K(l,{ids:c.value});w.success("操作成功"),i()}catch(e){w.error(e.message)}},N=l=>{c.value=l.map(e=>e.messageLogId)};return(l,e)=>{const b=d("el-button"),V=d("TigInput"),S=d("el-popconfirm"),x=d("el-form"),r=d("el-table-column"),A=d("el-divider"),q=d("el-table"),B=d("a-spin");return u(),y("div",J,[t("div",Q,[t("div",W,[t("div",X,[s(x,{model:n,onSubmit:R(h,["prevent"])},{default:o(()=>[t("div",Y,[t("div",Z,[t("div",ee,[t("div",te,[t("div",se,[s(V,{modelValue:n.keyword,"onUpdate:modelValue":e[0]||(e[0]=a=>n.keyword=a),name:"keyword",placeholder:"输入标题",clearable:"",onClear:h},{append:o(()=>[s(b,{onClick:h},{default:o(()=>e[5]||(e[5]=[t("span",{class:"iconfont icon-chakan1"},null,-1)])),_:1})]),_:1},8,["modelValue"])])])]),t("div",oe,[t("div",ae,[t("div",le,[s(m(H),{params:{act:"add"},isDrawer:"",path:"user/messageLog/Info",title:"发送站内信",width:"560px",onOkCallback:i},{default:o(()=>[s(b,{type:"primary"},{default:o(()=>e[6]||(e[6]=[p("发送站内信")])),_:1})]),_:1})])])]),t("div",ne,[t("div",ie,[t("div",re,[s(S,{title:"您确认要批量撤回所选数据吗？",onConfirm:e[1]||(e[1]=a=>C("recall"))},{reference:o(()=>[s(b,{disabled:c.value.length===0},{default:o(()=>e[7]||(e[7]=[p("批量撤回")])),_:1},8,["disabled"])]),_:1})])])]),t("div",de,[t("div",pe,[t("div",ce,[s(S,{title:"您确认要批量删除所选数据吗？",onConfirm:e[2]||(e[2]=a=>C("del"))},{reference:o(()=>[s(b,{disabled:c.value.length===0},{default:o(()=>e[8]||(e[8]=[p("批量删除")])),_:1},8,["disabled"])]),_:1}),c.value.length>0?(u(),y("span",me,[e[9]||(e[9]=p(" 已选择：")),t("b",null,L(c.value.length),1),e[10]||(e[10]=p(" 项 "))])):f("",!0)])])])])])]),_:1},8,["model"])]),t("div",ue,[s(B,{spinning:_.value},{default:o(()=>[s(q,{data:k.value,loading:_.value,total:v.value,"row-key":"messageLogId",onSelectionChange:N,onSortChange:D},{empty:o(()=>[t("div",_e,[_.value?f("",!0):(u(),y("div",ge,"暂无数据"))])]),default:o(()=>[s(r,{type:"selection",width:"32"}),s(r,{label:"标题",prop:"messageTitle"}),s(r,{label:"内容",prop:"messageContent"}),s(r,{label:"链接",prop:"messageLink"}),s(r,{width:100,label:"发送类型",prop:"sendTypeName"}),s(r,{width:100,label:"发送状态",prop:"messageType"},{default:o(({row:a})=>[t("span",{style:U({color:a.messageType===0?"green":"red"})},L(a.statusName),5)]),_:1}),s(r,{width:160,label:"发送日期",prop:"sendTime"}),s(r,{width:100,fixed:"right",label:"操作"},{default:o(({row:a})=>[a.isRecall==0?(u(),I(m(z),{key:0,params:{id:a.messageLogId},title:"确认要撤回该条消息吗？",requestApi:m(j),onAfterDelete:i},{default:o(()=>e[11]||(e[11]=[p("撤回 ")])),_:2},1032,["params","requestApi"])):f("",!0),a.isRecall==0?(u(),I(A,{key:1,direction:"vertical"})):f("",!0),s(m(z),{params:{id:a.messageLogId},requestApi:m(G),onAfterDelete:i},{default:o(()=>e[12]||(e[12]=[p("删除 ")])),_:2},1032,["params","requestApi"])]),_:1})]),_:1},8,["data","loading","total"])]),_:1},8,["spinning"]),v.value>0?(u(),y("div",fe,[s(m($),{page:n.page,"onUpdate:page":e[3]||(e[3]=a=>n.page=a),size:n.size,"onUpdate:size":e[4]||(e[4]=a=>n.size=a),total:v.value,onCallback:i},null,8,["page","size","total"])])):f("",!0)])])])])}}});export{Ie as default};
