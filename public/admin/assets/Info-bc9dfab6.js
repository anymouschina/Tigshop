import{d as j,j as p,E as q,s as O,x as $,r as d,o as y,c as H,e as i,k as C,w as s,b as l,f as S,h as B,H as g,$ as K,a0 as M,K as v}from"./index-7c2d2aef.js";import{a as z,c as G}from"./pcCatFloor-877bdad0.js";import{D as U}from"./DynamicList-d16d6b61.js";import{S as J}from"./SelectBrand-cb32d59a.js";import{_ as Q}from"./SelectCategory.vue_vue_type_script_setup_true_lang-a47fadcd.js";import"./index-6c62cf9b.js";import"./config-9548fa9b.js";import"./SelectTimeInterval.vue_vue_type_style_index_0_scoped_207fe586_lang-b4d9216b.js";/* empty css                                                                    *//* empty css                                                                  *//* empty css                                                                              */import"./region-e0d291a6.js";import"./shopProductCategory-792e0c23.js";/* empty css             */import{S as W}from"./SelectIco-7f1b5693.js";import"./brand-995f2ca4.js";import"./category-7b076a22.js";import"./category-a8bd4d11.js";import"./config-e2aa16d1.js";import"./time-290942a2.js";import"./util-1ee03ed8.js";import"./region-05802f67.js";import"./DialogForm.vue_vue_type_script_setup_true_lang-c57b9a11.js";const X={class:"container"},Y={class:"content_wrapper"},Z={class:"lyecs-form-table"},ee={class:"dynamic-div"},ae=i("span",null,"重命名：",-1),te=i("div",{class:"extra"},"提示：只能设置为一级或二级分类，且必须含有一个一级分类，如果存在二级分类，则必须存在该二级分类上一级分类；",-1),oe=i("div",{class:"extra"},"重命名为空则显示原分类名称，重命名的作用为方便排列",-1),le=i("div",{class:"extra"},"设置规则如下：",-1),se=i("div",{class:"extra"},"1、如果添加的分类为一级分类A、B、C，则抽屉一级会显示：A/B/C三个链接，二级为A、B、C下的所有二级分类",-1),re=i("div",{class:"extra"}," 2、如果添加的分类为一级分类A和A下面的二级分类a1、a2，则，会显示A/a1/a2三个链接，二级为A下的所有二级分类（包含了a1、a2） ",-1),ie=i("div",{class:"extra"},"3、如果重命名为“-”符号，则不会显示",-1),ne={class:"dynamic-div"},de=i("div",{class:"extra"},'请先在Tigshop设置中的"接口设置"中设置"ico图标库地址"',-1),Fe=j({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},isDialog:{type:Boolean,default:!1}},emits:["submitCallback","update:confirmLoading","close"],setup(k,{expose:L,emit:N}){const _=N,u=k,m=p(!0),b=q().currentRoute.value.query,f=p(u.isDialog?u.act:String(b.act)),h=p(u.isDialog?u.id:Number(b.id)),A=f.value==="add"?"create":"update",V=O(),e=p({is_show:1,sort_order:50}),D=async()=>{try{const a=await z(f.value,{id:h.value});Object.assign(e.value,a.item),a.item.category_ids&&a.item.category_names&&a.item.category_ids.length===a.item.category_names.length&&(e.value.category_list=a.item.category_ids.map((t,n)=>{var r;return{category_id:Number(t),category_name:((r=a.item.category_names)==null?void 0:r[n])||""}}),a.item.brand_ids&&a.item.brand_ids.length>0&&(e.value.brand_list=a.item.brand_ids.map((t,n)=>({brand_id:Number(t)}))))}catch(a){v.error(a.message),_("close")}finally{m.value=!1}};$(()=>{f.value==="detail"?D():m.value=!1});const w=async()=>{await V.value.validate();try{_("update:confirmLoading",!0),T(),F();const a=await G(A,{id:h.value,...e.value});_("submitCallback",a),v.success(a.message)}catch(a){v.error(a.message)}finally{_("update:confirmLoading",!1)}};function T(){var a;e.value.category_ids=e.value.category_ids||[],e.value.category_names=e.value.category_names||[],e.value.category_ids.length=0,e.value.category_names.length=0,(a=e.value.category_list)==null||a.forEach(t=>{var n,r;typeof t.category_id=="number"&&typeof t.category_name=="string"&&((n=e.value.category_ids)==null||n.push(t.category_id),(r=e.value.category_names)==null||r.push(t.category_name))})}function F(){var a;e.value.brand_ids=e.value.brand_ids||[],e.value.brand_ids.length=0,(a=e.value.brand_list)==null||a.forEach(t=>{var n;typeof t.brand_id=="number"&&((n=e.value.brand_ids)==null||n.push(t.brand_id))})}return L({onFormSubmit:()=>{w()}}),(a,t)=>{const n=d("el-input"),r=d("el-form-item"),x=d("el-radio"),R=d("el-radio-group"),E=d("el-button"),I=d("el-form"),P=d("a-spin");return y(),H("div",X,[i("div",Y,[i("div",Z,[m.value?B("",!0):(y(),C(I,{key:0,ref_key:"formRef",ref:V,model:e.value,"label-width":"auto"},{default:s(()=>[l(r,{label:"添加分类",prop:"brand_name"},{default:s(()=>[l(U,{modelValue:e.value.category_list,"onUpdate:modelValue":t[0]||(t[0]=o=>e.value.category_list=o),templateList:["category_id","category_name"],templateListType:["number","string"],buttonName:"增加",buttonType:"primary",style:{width:"100%"}},{dynamicSlot:s(({item:o})=>[i("div",ee,[m.value?B("",!0):(y(),C(S(Q),{key:0,category_id:o.category_id,"onUpdate:category_id":c=>o.category_id=c,multiple:!1,style:{width:"100%"}},null,8,["category_id","onUpdate:category_id"])),ae,l(n,{modelValue:o.category_name,"onUpdate:modelValue":c=>o.category_name=c},null,8,["modelValue","onUpdate:modelValue"])])]),_:1},8,["modelValue"]),te,oe,le,se,re,ie]),_:1}),l(r,{label:"热门品牌",prop:"brand_list"},{default:s(()=>[l(U,{modelValue:e.value.brand_list,"onUpdate:modelValue":t[1]||(t[1]=o=>e.value.brand_list=o),templateList:["brand_id"],templateListType:["number"],buttonName:"增加",buttonType:"primary",style:{width:"100%"}},{dynamicSlot:s(({item:o})=>[i("div",ne,[l(S(J),{modelValue:o.brand_id,"onUpdate:modelValue":c=>o.brand_id=c,style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])])]),_:1},8,["modelValue"])]),_:1}),l(r,{label:"ICO编码",prop:"floor_ico_font"},{default:s(()=>[l(W,{modelValue:e.value.floor_ico_font,"onUpdate:modelValue":t[2]||(t[2]=o=>e.value.floor_ico_font=o)},null,8,["modelValue"]),de]),_:1}),l(r,{label:"排序",prop:"sort_order"},{default:s(()=>[l(n,{modelValue:e.value.sort_order,"onUpdate:modelValue":t[3]||(t[3]=o=>e.value.sort_order=o)},null,8,["modelValue"])]),_:1}),l(r,{label:"是否显示",prop:"is_show"},{default:s(()=>[l(R,{modelValue:e.value.is_show,"onUpdate:modelValue":t[4]||(t[4]=o=>e.value.is_show=o)},{default:s(()=>[l(x,{value:1},{default:s(()=>[g("是")]),_:1}),l(x,{value:0},{default:s(()=>[g("否")]),_:1})]),_:1},8,["modelValue"])]),_:1}),K(l(r,{"wrapper-col":{offset:4,span:16}},{default:s(()=>[l(E,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:w},{default:s(()=>[g("提交")]),_:1},512)]),_:1},512),[[M,!u.isDialog]])]),_:1},8,["model"])),l(P,{spinning:m.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}});export{Fe as default};
