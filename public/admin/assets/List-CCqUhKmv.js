import{d as E,i as w,G as L,q as j,c,e,b as s,E as i,w as a,g as n,M as G,f as m,I as q,r as _,o as r,D as v,j as A}from"./index-CGYuOau0.js";/* empty css             */import"./index-B-GURfkM.js";import{P as V}from"./PopFormElm-DSof3F4x.js";import{_ as T}from"./Switch.vue_vue_type_script_setup_true_lang-CKSPWIQL.js";import{_ as H}from"./DeleteRecord.vue_vue_type_script_setup_true_lang-BTFcBk5t.js";/* empty css                                                                    */import{P as J}from"./Pagination-yOfjsBuR.js";import{u as K}from"./config-DNllFJyR.js";import{g as Q,u as h,d as R,b as W}from"./coupon-BDV82enA.js";import"./SelectTimeInterval.vue_vue_type_style_index_0_scoped_207fe586_lang-t3_hMxDC.js";/* empty css                                                                  *//* empty css                                                                              */import{_ as X}from"./SelectShop.vue_vue_type_script_setup_true_lang-BoPU8Xwc.js";import{_ as k}from"./DialogForm.vue_vue_type_script_setup_true_lang-Bmm-M6gU.js";import"./config-DU8_t5BN.js";import"./time-ClyPenjC.js";import"./shop-Daw3OFCx.js";const Y={class:"container"},Z={class:"content_wrapper"},ee={class:"bonus-wrap"},oe={class:"card-wrap"},te={class:"card-wrap__container"},se={class:"item-bg coupon-cards-item"},ae={class:"item-bg coupon-cards-item"},ne={class:"item-bg coupon-cards-item item-bg2"},ie={class:"item-bg coupon-cards-item item-bg2"},le={class:"lyecs-table-list-warp"},de={class:"list-table-tool lyecs-search-warp"},pe={class:"advanced-search-warp list-table-tool-row"},re={class:"simple-form-warp"},ue={key:0,class:"simple-form-field"},_e={class:"form-group"},ce={class:"control-container"},me={class:"simple-form-field"},fe={class:"form-group"},ve={class:"control-container"},ge={class:"list-table-tool-row"},be={class:"list-table-tool-col"},ye={key:0},he={class:"table-container"},ke={style:{position:"relative"}},Ce={key:0,class:"green"},we={key:1,class:"green"},Ve={key:1},Ue={class:"empty-warp"},qe={key:0,class:"empty-bg"},Ae={key:0,class:"pagination-con"},Ke=E({__name:"List",setup(xe){const S=K(),x=w(),b=w(!0),C=w(0),y=w([]),l=L({page:1,size:S.get("page_size"),sort_field:"",sort_order:"",keyword:"",is_show:-1,shop_id:0}),d=async()=>{b.value=!0;try{const p=await Q({...l});x.value=p.filter_result,C.value=p.total}catch(p){q.error(p.message)}finally{b.value=!1}};j(()=>{d()});const U=()=>{d()},D=({prop:p,order:o})=>{l.sort_field=p,l.sort_order=o=="ascending"?"asc":o=="descending"?"desc":"",d()},z=async p=>{try{const o=await W(p,{ids:y.value});q.success(o.message),d()}catch(o){q.error(o.message)}},I=p=>{y.value=p.map(o=>o.coupon_id)};return(p,o)=>{const g=_("el-button"),B=_("el-input"),O=_("el-popconfirm"),P=_("el-space"),$=_("el-form"),f=_("el-table-column"),N=_("el-divider"),F=_("el-table"),M=_("a-spin");return r(),c("div",Y,[e("div",Z,[e("div",ee,[o[13]||(o[13]=e("p",{class:"subtitle"},"按使用场景快速创建",-1)),e("div",oe,[e("div",te,[e("div",se,[o[6]||(o[6]=e("div",null,[e("div",{class:"title"},"满减券"),e("div",{class:"desc"},[e("p",null,[i("例：满100元减20元"),e("br"),i("便于合理控制活动成本")])])],-1)),s(n(k),{isDrawer:"",onOkCallback:d,title:"添加满减券",width:"800px",path:"promotion/coupon/Info",params:{act:"add",coupon_type:1}},{default:a(()=>[s(g,{type:"primary"},{default:a(()=>o[5]||(o[5]=[i("立即新建")])),_:1})]),_:1})]),e("div",ae,[o[8]||(o[8]=e("div",null,[e("div",{class:"title"},"折扣券"),e("div",{class:"desc"},[e("p",null,[i("例：满100元打9折"),e("br"),i("提高店铺销量和客单价")])])],-1)),s(n(k),{isDrawer:"",onOkCallback:d,title:"添加折扣券",width:"800px",path:"promotion/coupon/Info",params:{act:"add",coupon_type:2}},{default:a(()=>[s(g,{type:"primary"},{default:a(()=>o[7]||(o[7]=[i("立即新建")])),_:1})]),_:1})]),e("div",ne,[o[10]||(o[10]=e("div",null,[e("div",{class:"title"},"新人专享券"),e("div",{class:"desc"},[e("p",null,[i("仅店铺新客可领，提高新客"),e("br"),i("首单转化")])])],-1)),s(n(k),{isDrawer:"",onOkCallback:d,title:"添加新人专享券",width:"800px",path:"promotion/coupon/Info",params:{act:"add",is_new_user:1}},{default:a(()=>[s(g,{type:"primary"},{default:a(()=>o[9]||(o[9]=[i("立即新建")])),_:1})]),_:1})]),e("div",ie,[o[12]||(o[12]=e("div",null,[e("div",{class:"title"},"会员专享券"),e("div",{class:"desc"},[e("p",null,[i("限会员可领的优惠券，丰富会"),e("br"),i("员权益，凸显会员身份价值")])])],-1)),s(n(k),{isDrawer:"",onOkCallback:d,title:"添加会员专享券",width:"850px",path:"promotion/coupon/Info",params:{act:"add",is_new_user:2}},{default:a(()=>[s(g,{type:"primary"},{default:a(()=>o[11]||(o[11]=[i("立即新建")])),_:1})]),_:1})])])])]),e("div",le,[e("div",de,[s($,{model:l,onSubmit:G(U,["prevent"])},{default:a(()=>[e("div",pe,[e("div",re,[l.shop_id==-1?(r(),c("div",ue,[e("div",_e,[e("div",ce,[s(n(X),{shop_id:l.shop_id,"onUpdate:shop_id":o[0]||(o[0]=t=>l.shop_id=t)},null,8,["shop_id"])])])])):m("",!0),e("div",me,[e("div",fe,[e("div",ve,[s(B,{modelValue:l.keyword,"onUpdate:modelValue":o[1]||(o[1]=t=>l.keyword=t),name:"keyword",placeholder:"输入优惠券名称",clearable:"",onClear:U},{append:a(()=>[s(g,{onClick:U},{default:a(()=>o[14]||(o[14]=[e("span",{class:"iconfont icon-chakan1"},null,-1)])),_:1})]),_:1},8,["modelValue"])])])])])]),e("div",ge,[e("div",be,[s(P,null,{default:a(()=>[s(O,{title:"您确认要批量删除所选数据吗？",onConfirm:o[2]||(o[2]=t=>z("del"))},{reference:a(()=>[s(g,{disabled:y.value.length===0},{default:a(()=>o[15]||(o[15]=[i("批量删除")])),_:1},8,["disabled"])]),_:1}),y.value.length>0?(r(),c("span",ye,[o[16]||(o[16]=i(" 已选择：")),e("b",null,v(y.value.length),1),o[17]||(o[17]=i(" 项 "))])):m("",!0)]),_:1})])])]),_:1},8,["model"])]),e("div",he,[s(M,{spinning:b.value},{default:a(()=>[s(F,{data:x.value,"row-key":"coupon_id",onSelectionChange:I,total:C.value,onSortChange:D,loading:b.value},{empty:a(()=>[e("div",Ue,[b.value?m("",!0):(r(),c("div",qe,"暂无数据"))])]),default:a(()=>[s(f,{type:"selection",width:"32"}),s(f,{label:"优惠券名称",prop:"coupon_id",width:200},{default:a(({row:t})=>[e("div",ke,[s(n(V),{label:"优惠券名称",type:"textarea",requestApi:n(h),"org-value":t.coupon_name,"onUpdate:orgValue":u=>t.coupon_name=u,params:{id:t.coupon_id,field:"coupon_name"}},{default:a(()=>[e("div",null,v(t.coupon_name),1)]),_:2},1032,["requestApi","org-value","onUpdate:orgValue","params"])])]),_:1}),s(f,{label:"发放类型"},{default:a(({row:t})=>[i(v(t.coupon_type==1?"满减券":"折扣券")+" ",1),t.is_new_user==1?(r(),c("span",Ce,"(新人专享)")):m("",!0),t.limit_user_rank.length?(r(),c("span",we,"(会员专享)")):m("",!0)]),_:1}),s(f,{label:"优惠券金额(折扣)",prop:"coupon_money",sortable:"custom"},{default:a(({row:t})=>[t.coupon_type==1?(r(),A(n(V),{key:0,label:"优惠券金额",type:"input",requestApi:n(h),"org-value":t.coupon_money,"onUpdate:orgValue":u=>t.coupon_money=u,params:{id:t.coupon_id,field:"coupon_money"}},{default:a(()=>[e("div",null,v(t.coupon_money||"0"),1)]),_:2},1032,["requestApi","org-value","onUpdate:orgValue","params"])):m("",!0),t.coupon_type==2?(r(),A(n(V),{key:1,label:"优惠券折扣",type:"input",requestApi:n(h),"org-value":t.coupon_discount,"onUpdate:orgValue":u=>t.coupon_discount=u,params:{id:t.coupon_id,field:"coupon_discount"}},{default:a(()=>[e("div",null,v(t.coupon_discount||"0")+"折",1)]),_:2},1032,["requestApi","org-value","onUpdate:orgValue","params"])):m("",!0)]),_:1}),s(f,{label:"优惠门槛",prop:"min_order_amount",sortable:"custom"},{default:a(({row:t})=>[t.reduce_type==1?(r(),A(n(V),{key:0,label:"优惠门槛",type:"input",requestApi:n(h),"org-value":t.min_order_amount,"onUpdate:orgValue":u=>t.min_order_amount=u,params:{id:t.coupon_id,field:"min_order_amount"}},{default:a(()=>[e("div",null,v(t.min_order_amount||"0")+v(t.coupon_unit==1?"元":"件"),1)]),_:2},1032,["requestApi","org-value","onUpdate:orgValue","params"])):(r(),c("div",Ve,"无门槛券"))]),_:1}),s(f,{label:"首页显示",prop:"is_show",sortable:"custom"},{default:a(({row:t})=>[s(n(T),{checked:t.is_show,"onUpdate:checked":u=>t.is_show=u,requestApi:n(h),params:{id:t.coupon_id,field:"is_show"}},null,8,["checked","onUpdate:checked","requestApi","params"])]),_:1}),s(f,{label:"操作",fixed:"right"},{default:a(({row:t})=>[s(n(k),{isDrawer:"",onOkCallback:d,title:"编辑优惠券",width:"800px",path:"promotion/coupon/Info",params:{act:"detail",id:t.coupon_id}},{default:a(()=>o[18]||(o[18]=[e("a",{class:"btn-link"},"编辑",-1)])),_:2},1032,["params"]),s(N,{direction:"vertical"}),s(n(H),{onAfterDelete:d,requestApi:n(R),params:{id:t.coupon_id}},{default:a(()=>o[19]||(o[19]=[i("删除")])),_:2},1032,["requestApi","params"])]),_:1})]),_:1},8,["data","total","loading"])]),_:1},8,["spinning"]),C.value>0?(r(),c("div",Ae,[s(n(J),{page:l.page,"onUpdate:page":o[3]||(o[3]=t=>l.page=t),size:l.size,"onUpdate:size":o[4]||(o[4]=t=>l.size=t),total:C.value,onCallback:d},null,8,["page","size","total"])])):m("",!0)])])])])}}});export{Ke as default};
