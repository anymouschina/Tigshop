import{d as X,j as U,E as Y,s as Z,x as ee,K as S,r as f,o as b,c as x,e as d,k as L,w as a,b as e,H as _,F as le,a as ae,f as E,G as C,q as te,h as R,$ as ie,a0 as ne,p as oe,i as pe,_ as se}from"./index-7c2d2aef.js";import{a as _e,c as de,e as re}from"./shippingTpl-635f0dc3.js";import"./index-6c62cf9b.js";/* empty css                                                                  */import{_ as ue}from"./Checkbox.vue_vue_type_script_setup_true_lang-97410f87.js";import{u as fe}from"./region-e0d291a6.js";import{_ as me}from"./DialogForm.vue_vue_type_script_setup_true_lang-c57b9a11.js";import"./region-05802f67.js";const g=v=>(oe("data-v-05a54d68"),v=v(),pe(),v),ce={class:"container"},ge={class:"content_wrapper"},he={class:"lyecs-form-table"},be=g(()=>d("div",{class:"extra"},"只能设置一个默认模板",-1)),ve={class:"shipping-method-style"},Ve={class:"flex"},ye={key:0,class:"table-style"},we={class:"title-style"},ke=g(()=>d("span",{class:"title"},"默认运费",-1)),Ue=g(()=>d("span",{class:"title"},"每增加",-1)),Se=g(()=>d("span",{class:"title"},"增加运费",-1)),xe=g(()=>d("span",{class:"title"},"满",-1)),Ce=g(()=>d("span",{class:"title"},"免运费",-1)),qe={class:"ysd"},$e={style:{flex:"1"}},Ie=g(()=>d("a",null,"编辑",-1)),Re=X({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(v,{expose:F,emit:j}){fe().getRegionList();const k=j,V=v,y=U(!0),T=Y().currentRoute.value.query,w=U(V.isDialog?V.act:String(T.act)),D=U(V.isDialog?V.id:Number(T.id)),O=w.value==="add"?"create":"update",N=Z(),o=U({shipping_tpl_info:[],is_default:0,is_free:0,pricing_type:1}),z=async()=>{try{const t=await de(w.value,{id:D.value});t.item.shipping_tpl_info.forEach((i,r)=>{i.is_checked=1,i.default_tpl_info==null&&(i.default_tpl_info=q(i.shipping_type_id,i.shipping_type_name,1),i.area_tpl_info=[],i.is_checked=0)}),Object.assign(o.value,t.item)}catch(t){S.error(t.message),k("close")}finally{y.value=!1}},A=t=>{for(let i=0;i<o.value.shipping_tpl_info.length;i++);},G=(t,i)=>{o.value.shipping_tpl_info&&o.value.shipping_tpl_info[t].area_tpl_info&&o.value.shipping_tpl_info[t].area_tpl_info.splice(i,1)},H=t=>{console.log(t),t.area_tpl_info.push(q(t.shipping_type_id,t.shipping_type_name,0))},K=t=>{o.value.shipping_tpl_info[t.index].area_tpl_info[t.itemIndex].region_data.area_region_names=t.regionNames,o.value.shipping_tpl_info[t.index].area_tpl_info[t.itemIndex].region_data.area_regions=t.regionIds},q=(t,i,r)=>({shipping_tpl_id:0,shipping_type_id:t,is_default:r,start_number:"",start_price:"",add_number:"",add_price:"",free_price:"",region_data:{area_regions:[],area_region_names:[]},shipping_type_name:i});ee(async()=>{await M(),w.value==="detail"?await z():y.value=!1});const M=async()=>{try{const t=await _e();t.shipping_tpl_info.forEach(i=>{i.is_checked=1,i.default_tpl_info==null&&(i.default_tpl_info=q(i.shipping_type_id,i.shipping_type_name,1),i.area_tpl_info=[],i.is_checked=0)}),o.value.shipping_tpl_info=t.shipping_tpl_info}catch(t){S.error(t.message)}finally{y.value=!1}},B=async()=>{await N.value.validate();try{k("update:confirmLoading",!0);const t=await re(O,{id:D.value,...o.value});k("submitCallback",t),S.success(t.message)}catch(t){S.error(t.message)}finally{k("update:confirmLoading",!1)}};return F({onFormSubmit:()=>{B()}}),(t,i)=>{const r=f("el-input"),s=f("el-form-item"),p=f("el-option"),J=f("el-select"),h=f("el-radio"),$=f("el-radio-group"),c=f("el-table-column"),I=f("el-button"),P=f("el-table"),Q=f("el-form"),W=f("a-spin");return b(),x("div",ce,[d("div",ge,[d("div",he,[y.value?R("",!0):(b(),L(Q,{key:0,ref_key:"formRef",ref:N,model:o.value,"label-width":"auto"},{default:a(()=>[e(s,{rules:[{required:!0,message:"分类名称不能为空!"}],label:"模板名称",prop:"shipping_tpl_name"},{default:a(()=>[e(r,{modelValue:o.value.shipping_tpl_name,"onUpdate:modelValue":i[0]||(i[0]=n=>o.value.shipping_tpl_name=n)},null,8,["modelValue"])]),_:1}),e(s,{label:"发货时间",prop:"shipping_time"},{default:a(()=>[e(J,{modelValue:o.value.shipping_time,"onUpdate:modelValue":i[1]||(i[1]=n=>o.value.shipping_time=n),placeholder:"请选择..",style:{width:"100%"}},{default:a(()=>[e(p,{label:"4小时内",value:"4小时内"}),e(p,{label:"8小时内",value:"8小时内"}),e(p,{label:"12小时内",value:"12小时内"}),e(p,{label:"16小时内",value:"16小时内"}),e(p,{label:"20小时内",value:"20小时内"}),e(p,{label:"1天内",value:"1天内"}),e(p,{label:"2天内",value:"2天内"}),e(p,{label:"3天内",value:"3天内"}),e(p,{label:"4天内",value:"4天内"}),e(p,{label:"5天内",value:"5天内"}),e(p,{label:"7天内",value:"7天内"}),e(p,{label:"8天内",value:"8天内"}),e(p,{label:"10天内",value:"10天内"}),e(p,{label:"12天内",value:"12天内"}),e(p,{label:"15天内",value:"15天内"}),e(p,{label:"17天内",value:"17天内"}),e(p,{label:"20天内",value:"20天内"}),e(p,{label:"25天内",value:"25天内"}),e(p,{label:"30天内",value:"30天内"}),e(p,{label:"45天内",value:"45天内"})]),_:1},8,["modelValue"])]),_:1}),e(s,{label:"是否默认",prop:"is_default"},{default:a(()=>[e($,{modelValue:o.value.is_default,"onUpdate:modelValue":i[2]||(i[2]=n=>o.value.is_default=n),style:{width:"100%"}},{default:a(()=>[e(h,{value:1},{default:a(()=>[_("是")]),_:1}),e(h,{value:0},{default:a(()=>[_("否")]),_:1})]),_:1},8,["modelValue"]),be]),_:1}),e(s,{label:"是否包邮",prop:"is_free"},{default:a(()=>[e($,{modelValue:o.value.is_free,"onUpdate:modelValue":i[3]||(i[3]=n=>o.value.is_free=n)},{default:a(()=>[e(h,{value:1},{default:a(()=>[_("是")]),_:1}),e(h,{value:0},{default:a(()=>[_("否")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(s,{label:"计价方式",prop:"pricing_type"},{default:a(()=>[e($,{modelValue:o.value.pricing_type,"onUpdate:modelValue":i[4]||(i[4]=n=>o.value.pricing_type=n),onChange:A},{default:a(()=>[e(h,{value:1,disabled:w.value!="add"},{default:a(()=>[_("按件数")]),_:1},8,["disabled"]),e(h,{value:2,disabled:w.value!="add"},{default:a(()=>[_("按重量")]),_:1},8,["disabled"])]),_:1},8,["modelValue"])]),_:1}),e(s,{label:"运送方式",prop:"shipping_tpl_info"},{default:a(()=>[(b(!0),x(le,null,ae(o.value.shipping_tpl_info,(n,u)=>(b(),x("div",ve,[d("div",Ve,[e(E(ue),{modelValue:n.is_checked,"onUpdate:modelValue":l=>n.is_checked=l},{default:a(()=>[_(C(n.shipping_type_name),1)]),_:2},1032,["modelValue","onUpdate:modelValue"])]),n.is_checked>0?(b(),x("div",ye,[d("div",we,[ke,e(s,{prop:"shipping_tpl_info["+u+"].default_tpl_info.start_number",rules:[{required:!0,message:""}],class:"hn"},{default:a(()=>[e(r,{modelValue:n.default_tpl_info.start_number,"onUpdate:modelValue":l=>n.default_tpl_info.start_number=l,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"]),_("  "+C(o.value.pricing_type==1?"件":"kg")+"内  ",1),e(s,{prop:"shipping_tpl_info["+u+"].default_tpl_info.start_price",rules:[{required:!0,message:""}],class:"hn"},{default:a(()=>[e(r,{modelValue:n.default_tpl_info.start_price,"onUpdate:modelValue":l=>n.default_tpl_info.start_price=l,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"]),_("  元，"),Ue,e(s,{prop:"shipping_tpl_info["+u+"].default_tpl_info.add_number",rules:[{required:!0,message:""}],class:"hn"},{default:a(()=>[e(r,{modelValue:n.default_tpl_info.add_number,"onUpdate:modelValue":l=>n.default_tpl_info.add_number=l,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"]),_("  "+C(o.value.pricing_type==1?"件":"kg")+"，",1),Se,e(s,{prop:"shipping_tpl_info["+u+"].default_tpl_info.add_price",rules:[{required:!0,message:""}],class:"hn"},{default:a(()=>[e(r,{modelValue:n.default_tpl_info.add_price,"onUpdate:modelValue":l=>n.default_tpl_info.add_price=l,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"]),_("  元，"),xe,e(r,{modelValue:n.default_tpl_info.free_price,"onUpdate:modelValue":l=>n.default_tpl_info.free_price=l,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"]),_("  元，"),Ce]),n.area_tpl_info.length>0?(b(),L(P,{key:0,data:n.area_tpl_info,style:{width:"100%","margin-top":"8px"}},{default:a(()=>[e(c,{label:"运送到",prop:"region_data"},{default:a(l=>[d("div",qe,[d("div",$e,[e(s,{prop:"shipping_tpl_info."+u+".area_tpl_info["+l.$index+"].region_data.area_region_names",rules:[{required:!0,message:"未添加地区"}],class:"hn"},{default:a(()=>[d("span",{class:"shipping-region-list",style:te(l.row.region_data.area_region_names.length>0?"":"color: red;")},C(l.row.region_data.area_region_names.length>0?l.row.region_data.area_region_names.join("、"):"请添加地区"),5)]),_:2},1032,["prop"])]),d("div",null,[e(E(me),{params:{index:u,itemIndex:l.$index,ids:l.row.region_data.area_regions,other:n.area_tpl_info},path:"setting/shippingTpl/SelectRegion",title:"编辑地区",width:"900px",onOkCallback:K},{default:a(()=>[Ie]),_:2},1032,["params"])])])]),_:2},1024),e(c,{label:o.value.pricing_type==1?"首件数(件)":"首重量(kg)",width:"90"},{default:a(l=>[e(s,{prop:"shipping_tpl_info."+u+".area_tpl_info["+l.$index+"].start_number",rules:[{required:!0,message:""}],class:"hn"},{default:a(()=>[e(r,{modelValue:l.row.start_number,"onUpdate:modelValue":m=>l.row.start_number=m,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"])]),_:2},1032,["label"]),e(c,{label:"首费(元)",width:"80"},{default:a(l=>[e(s,{prop:"shipping_tpl_info."+u+".area_tpl_info["+l.$index+"].start_price",rules:[{required:!0,message:""}],class:"hn"},{default:a(()=>[e(r,{modelValue:l.row.start_price,"onUpdate:modelValue":m=>l.row.start_price=m,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"])]),_:2},1024),e(c,{label:o.value.pricing_type==1?"续件数(件)":"续重量(kg)",width:"90"},{default:a(l=>[e(s,{prop:"shipping_tpl_info."+u+".area_tpl_info["+l.$index+"].add_number",rules:[{required:!0,message:""}],class:"hn"},{default:a(()=>[e(r,{modelValue:l.row.add_number,"onUpdate:modelValue":m=>l.row.add_number=m,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"])]),_:2},1032,["label"]),e(c,{label:"续费(元)",width:"80"},{default:a(l=>[e(s,{prop:"shipping_tpl_info."+u+".area_tpl_info["+l.$index+"].add_price",rules:[{required:!0,message:""}],class:"hn"},{default:a(()=>[e(r,{modelValue:l.row.add_price,"onUpdate:modelValue":m=>l.row.add_price=m,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"])]),_:2},1024),e(c,{label:"满免(元)",width:"80"},{default:a(l=>[e(s,{prop:"shipping_tpl_info."+u+".area_tpl_info["+l.$index+"].free_price",class:"hn"},{default:a(()=>[e(r,{modelValue:l.row.free_price,"onUpdate:modelValue":m=>l.row.free_price=m,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"])]),_:2},1024),e(c,{label:"操作",width:"60"},{default:a(l=>[e(I,{link:"",type:"primary",onClick:m=>G(u,l.$index)},{default:a(()=>[_("删除")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["data"])):R("",!0),e(I,{link:"",type:"primary",onClick:l=>H(n)},{default:a(()=>[_("增加指定地区运费")]),_:2},1032,["onClick"])])):R("",!0)]))),256))]),_:1}),ie(e(s,{"wrapper-col":{offset:4,span:16}},{default:a(()=>[e(I,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:B},{default:a(()=>[_("提交")]),_:1},512)]),_:1},512),[[ne,!V.isDialog]])]),_:1},8,["model"])),e(W,{spinning:y.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}});const Ae=se(Re,[["__scopeId","data-v-05a54d68"]]);export{Ae as default};
