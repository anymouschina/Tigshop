import{d as B,i as u,C as I,s as R,q as D,I as m,r as l,c as O,o as y,e as N,j,f as L,b as n,w as c,a3 as T,E as q,a4 as E}from"./index-DrbzVNl6.js";import{a as F,j as A,k as M}from"./order-DqMQuu0g.js";const U={class:"container"},$={class:"content_wrapper"},z={class:"lyecs-form-table"},K=B({__name:"EditRemark",props:{id:{type:Number,default:0},act:{type:String,default:""},valueName:{type:String,default:""},form:{type:Object,default:()=>({})},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(r,{expose:w,emit:h}){const s=h,e=r,i=u(!0),p=I().currentRoute.value.query,f=u(e.isDialog?e.act:String(p.act)),d=u(e.isDialog?e.id:Number(p.id));f.value;const v=R(),a=u(e.form);D(()=>{k()});const k=async()=>{try{i.value=!0;const t=await F(f.value,{id:d.value});Object.assign(a.value,t)}catch(t){m.error(t.message),s("close")}finally{i.value=!1}},g=async()=>{await v.value.validate();try{if(s("update:confirmLoading",!0),e.valueName=="addNote"){const t=await A({orderId:d.value,orderSn:a.value.orderSn,shopId:a.value.shopId,description:a.value[e.valueName]});s("submitCallback",t),m.success("操作成功")}if(e.valueName=="adminNote"){const t=await M({id:d.value,adminNote:a.value[e.valueName]});s("submitCallback",t),m.success("操作成功")}}catch(t){m.error(t.message)}finally{s("update:confirmLoading",!1)}};return w({onFormSubmit:()=>{g()}}),(t,o)=>{const S=l("TigInput"),b=l("el-form-item"),C=l("el-button"),x=l("el-form"),V=l("a-spin");return y(),O("div",U,[N("div",$,[N("div",z,[i.value?L("",!0):(y(),j(x,{key:0,ref_key:"formRef",ref:v,model:a.value,"label-width":"auto"},{default:c(()=>[n(b,{label:"备注",prop:r.valueName},{default:c(()=>[n(S,{classType:"tig-form-input",modelValue:a.value[r.valueName],"onUpdate:modelValue":o[0]||(o[0]=_=>a.value[r.valueName]=_),rows:4,placeholder:"请输入备注",type:"textarea","show-word-limit":"",maxlength:200},null,8,["modelValue"])]),_:1},8,["prop"]),T(n(b,{"wrapper-col":{offset:4,span:16}},{default:c(()=>[n(C,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:o[1]||(o[1]=_=>g())},{default:c(()=>o[2]||(o[2]=[q("提交 ")])),_:1},512)]),_:1},512),[[E,!e.isDialog]])]),_:1},8,["model"])),n(V,{spinning:i.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}});export{K as default};
