/* empty css             */import"./index-CeQDmMxd.js";import{d as ae,C as re,bp as se,K as le,i as p,G as B,q as oe,b1 as ne,I as S,c as f,e as l,b as r,w as s,f as _,g as n,F as ie,r as u,o as c,j as q,E as y,D as h,_ as de}from"./index-DrbzVNl6.js";import{D as w}from"./DeleteRecord-MR4vGqLl.js";/* empty css                                                                    */import{P as pe}from"./Pagination-wR9huHyl.js";import{P as D}from"./PopFormElm-BZp1_Wme.js";import{a as A,u as O,d as E,b as ce}from"./articleCategory-J2OKGEPd.js";import{_ as V}from"./DialogForm.vue_vue_type_script_setup_true_lang-DqYSRv0_.js";const ue=["href"],ge={class:"container"},me={class:"content_wrapper"},ye={class:"lyecs-table-list-warp"},fe={class:"list-table-tool lyecs-search-warp"},_e={class:"list-table-tool-row"},ve={class:"list-table-tool-col"},Ce={key:1},Ie={class:"table-container"},be={style:{position:"relative"}},he=["onClick"],ke={key:1},xe={class:"empty-warp"},ze={key:0,class:"empty-bg"},Ae={key:0,class:"pagination-con"},Ne=ae({__name:"List",setup(Se){const{currentRoute:M}=re(),T=se(),F=le(),$=p(F.icoDefinedCss),U=p([]),k=p(!0),x=p(0),v=p([]),L=p([]),i=B({page:1,size:F.get("pageSize"),sortField:"",sortOrder:"",keyword:"",parentId:0}),z=p([0]),j=p(),H=ne();oe(()=>{const a=M.value.query;a.id>0&&(i.parentId=a.id),H.meta.title="",d()});const d=async()=>{k.value=!0;try{const a=await A({...i});U.value=a.records,x.value=a.total,j.value=a.parentName,a.parentName?T.setHeaderTitle("文章分类列表 - "+a.parentName):T.setHeaderTitle("文章分类列表")}catch(a){S.error(a.message)}finally{k.value=!1}},C=B({}),G=async(a,e,o)=>{C[a.articleCategoryId]={},C[a.articleCategoryId].resolve=o,C[a.articleCategoryId].expandCount=0;const g=await A({page:1,parentId:a.articleCategoryId,size:1e3});o(g.records)},K=async(a,e)=>{const o=C[a.articleCategoryId];if(o.expandCount++,e&&o.expandCount>1&&!o.prevStatus){const g=await A({page:1,parentId:a.articleCategoryId,size:1e3});o.resolve(g.records)}o.prevStatus=e},I=p(null),N=async(a,e)=>{const o=C[e.parentId];if(console.log(I.value),o){const g=await A({page:1,parentId:e.parentId,size:1e3});I.value.store.states.lazyTreeNodeMap.value[e.parentId].length>1?I.value.store.states.lazyTreeNodeMap[e.parentId]=[]:I.value.store.states.lazyTreeNodeMap.value[e.parentId]=[],o.resolve(g.records)}else d()},J=a=>{z.value.push(a),i.parentId=a,d()},Q=()=>{z.value.pop(),i.parentId=z.value[z.value.length-1],d()},W=async a=>{try{const e=await ce(a,{ids:v.value});S.success("操作成功"),await d()}catch(e){S.error(e.message)}},X=({prop:a,order:e})=>{i.sortField=a,i.sortOrder=e=="ascending"?"asc":e=="descending"?"desc":"",d()},Y=a=>{v.value=a.map(e=>e.articleCategoryId)};return(a,e)=>{const o=u("el-button"),g=u("el-popconfirm"),R=u("el-space"),Z=u("el-form"),b=u("el-table-column"),P=u("el-divider"),ee=u("el-table"),te=u("a-spin");return c(),f(ie,null,[l("link",{href:$.value,rel:"stylesheet"},null,8,ue),l("div",ge,[l("div",me,[l("div",ye,[l("div",fe,[e[8]||(e[8]=l("div",{class:"list-table-tips"},[l("div",null,"分类编号对应了系统一些内置分类"),l("div",null," 帮助中心：[bzzx]     客服中心：[kfzx]     热门问题：[rmwt]     客服中心：[kfzx]     本站公告：[bzgg]     资讯中心：[zxzx]    卖家中心：[mjzx] ")],-1)),r(Z,{model:i,name:"form"},{default:s(()=>[l("div",_e,[l("div",ve,[r(R,null,{default:s(()=>[i.parentId>0?(c(),q(o,{key:0,onClick:Q},{default:s(()=>e[3]||(e[3]=[l("i",{class:"iconfont icon-fanhui",style:{"font-size":"14px","padding-right":"5px"}},null,-1),y(" 返回上一级 ")])),_:1})):_("",!0),r(n(V),{params:{act:"add",parentId:i.parentId},isDrawer:"",path:"content/articleCategory/Info",title:"添加文章分类",width:"580px",onOkCallback:d},{default:s(()=>[r(o,{type:"primary"},{default:s(()=>e[4]||(e[4]=[y("添加文章分类")])),_:1})]),_:1},8,["params"]),r(g,{title:"您确认要批量删除所选数据吗？",onConfirm:e[0]||(e[0]=t=>W("del"))},{reference:s(()=>[r(o,{disabled:v.value.length===0},{default:s(()=>e[5]||(e[5]=[y("批量删除")])),_:1},8,["disabled"])]),_:1}),v.value.length>0?(c(),f("span",Ce,[e[6]||(e[6]=y(" 已选择：")),l("b",null,h(v.value.length),1),e[7]||(e[7]=y(" 项 "))])):_("",!0)]),_:1})])])]),_:1},8,["model"])]),l("div",Ie,[r(te,{spinning:k.value},{default:s(()=>[r(ee,{onSortChange:X,data:U.value,"expand-row-keys":L.value,indent:30,load:G,total:x.value,"tree-props":{children:"children",hasChildren:"hasChildren"},lazy:"","row-key":"articleCategoryId",onSelectionChange:Y,onExpandChange:K,ref_key:"tableRef",ref:I},{empty:s(()=>[l("div",xe,[k.value?_("",!0):(c(),f("div",ze,"暂无数据"))])]),default:s(()=>[r(b,{type:"selection",width:"32"}),r(b,{width:200,label:"文章分类名称"},{default:s(({row:t})=>[r(R,{style:{height:"30px"}},{default:s(()=>[l("div",be,[r(n(D),{"org-value":t.articleCategoryName,"onUpdate:orgValue":m=>t.articleCategoryName=m,params:{id:t.articleCategoryId,field:"articleCategoryName"},requestApi:n(O),label:"权限名称",type:"textarea"},{default:s(()=>[t.hasChildren?(c(),f("a",{key:0,onClick:m=>J(t.articleCategoryId)},h(t.articleCategoryName),9,he)):(c(),f("span",ke,h(t.articleCategoryName),1))]),_:2},1032,["org-value","onUpdate:orgValue","params","requestApi"])])]),_:2},1024)]),_:1}),r(b,{label:"分类编号"},{default:s(({row:t})=>[r(n(D),{"org-value":t.categorySn,"onUpdate:orgValue":m=>t.categorySn=m,params:{id:t.articleCategoryId,field:"categorySn"},requestApi:n(O),label:"分类编号",type:"textarea"},{default:s(()=>[l("div",null,h(t.categorySn||"-"),1)]),_:2},1032,["org-value","onUpdate:orgValue","params","requestApi"])]),_:1}),r(b,{key:"sortOrder",sortable:"custom",label:"排序"},{default:s(({row:t})=>[r(n(D),{"org-value":t.sortOrder,"onUpdate:orgValue":m=>t.sortOrder=m,params:{id:t.articleCategoryId,field:"sortOrder"},requestApi:n(O),label:"排序",type:"integer"},{default:s(()=>[l("div",null,h(t.sortOrder),1)]),_:2},1032,["org-value","onUpdate:orgValue","params","requestApi"])]),_:1}),r(b,{width:220,fixed:"right",label:"操作"},{default:s(({row:t})=>[r(n(V),{params:{act:"detail",id:t.articleCategoryId,parentId:t.parentId},data:{parentId:t.parentId},isDrawer:"",path:"content/articleCategory/Info",title:"编辑分类",width:"580px",onOkCallback:N},{default:s(()=>e[9]||(e[9]=[l("a",{class:"btn-link"},"编辑",-1)])),_:2},1032,["params","data"]),r(P,{direction:"vertical"}),r(n(V),{params:{act:"add",parentId:t.articleCategoryId},data:{parentId:t.parentId||t.articleCategoryId},isDrawer:"",path:"content/articleCategory/Info",title:"编辑分类",width:"580px",onOkCallback:N},{default:s(()=>e[10]||(e[10]=[l("a",{class:"btn-link"},"添加子分类",-1)])),_:2},1032,["params","data"]),r(P,{direction:"vertical"}),t.parentId?(c(),q(n(w),{key:0,params:{id:t.articleCategoryId},requestApi:n(E),onAfterDelete:m=>N({},{parentId:t.parentId})},{default:s(()=>e[11]||(e[11]=[y("删除")])),_:2},1032,["params","requestApi","onAfterDelete"])):_("",!0),t.parentId?_("",!0):(c(),q(n(w),{key:1,params:{id:t.articleCategoryId},requestApi:n(E),onAfterDelete:d},{default:s(()=>e[12]||(e[12]=[y("删除")])),_:2},1032,["params","requestApi"]))]),_:1})]),_:1},8,["data","expand-row-keys","total"])]),_:1},8,["spinning"]),x.value>0?(c(),f("div",Ae,[r(n(pe),{page:i.page,"onUpdate:page":e[1]||(e[1]=t=>i.page=t),size:i.size,"onUpdate:size":e[2]||(e[2]=t=>i.size=t),total:x.value,onCallback:d},null,8,["page","size","total"])])):_("",!0)])])])])],64)}}}),Be=de(Ne,[["__scopeId","data-v-ca7ce993"]]);export{Be as default};
