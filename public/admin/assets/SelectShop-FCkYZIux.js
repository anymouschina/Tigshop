import{y as j,d as A,i as p,s as G,C as H,dQ as V,q as Q,r as d,c as a,o as s,n as J,e as t,f as r,b as n,E as v,j as W,w as m,D as b,F as X,a as Y,g as $,I as B,K as Z,dT as ee,d$ as te,U as oe,_ as se}from"./index-DrbzVNl6.js";import{u as le}from"./theme-qm3k10fq.js";import{u as ae}from"./menus-Cfe5Mqim.js";import{F as ne}from"./UploadAvatar.vue_vue_type_style_index_0_scoped_9bfcfc35_lang-BDvYUQtN.js";import"./index-CeQDmMxd.js";import"./vuedraggable.umd-DAKh-e3Q.js";const ie="/admin/assets/shop_logo_b-DK_MbwV3.png",re="/admin/assets/shop_logo-0stPotOH.png",ue=()=>j({url:"merchant/shop/myShop",method:"get",noErrorTip:!0}),pe=c=>j({url:"merchant/shop/create",method:"post",data:c}),de={key:0,class:"warp-info"},me={class:"back-btn"},ce={class:"right-item"},fe={key:0,class:"sub-title-name"},ve={key:1,class:"shop-list"},ge={class:"left-item"},he={class:"left-info"},ye={class:"left-title"},_e={key:0},Se={key:2,class:"shop-list shop-list-min-height"},ke=["onClick"],Te={class:"left-item"},be={class:"left-info"},Ie={class:"left-title"},Ce={key:3,class:"shop-list shop-list-min-height"},xe={key:1},we=A({__name:"SelectShop",props:{isIndex:{type:Boolean,default:!1},selectShopFlag:{type:Boolean,default:!1}},emits:["closePopup","update:selectShopFlag"],setup(c,{emit:U}){const N=c,f=p({shopTitle:"",shopLogo:""}),I=p(!1),R=async()=>{await C.value.validate();try{I.value=!0;const o=await pe({...f.value});B.success("创建成功"),y.value=!1,await P()}catch(o){B.error(o.message)}finally{I.value=!1}},u=p(!0),C=G(),y=p(!1),x=U,q=H(),w=async o=>{localStorage.setItem("shopId",String(o)),o===0?localStorage.setItem("adminType","admin"):localStorage.setItem("adminType","shop");const e=V(),g=Z(),k=ee();le(),e.updateUserInfo(),g.updateConfig(),te.success({message:"登录成功",placement:"top",duration:1.5,description:"您好，欢迎回来"}),N.isIndex&&x("closePopup");let h=await ae();k.mainMenu=h,q.push("/"+(h?h[0].routeLink:"404")),localStorage.setItem("lastOpenTime",String(oe().unix())),setTimeout(()=>{location.reload()},500)},{logout:D}=V(),E=()=>{x("update:selectShopFlag",!1),D()},_=p([]),i=p({username:""}),S=p(""),P=async()=>{try{u.value=!0;const o=await ue();o.shop.records&&(_.value=o.shop.records),o.userinfo&&(i.value=o.userinfo)}catch{}finally{u.value=!1}};return Q(()=>{localStorage.getItem("accessToken"),S.value=localStorage.getItem("adminType"),u.value=!1}),(o,e)=>{var F,L,M;const g=d("el-button"),k=d("a-spin"),h=d("el-image"),z=d("el-empty"),K=d("TigInput"),T=d("el-form-item"),O=d("el-form");return s(),a("div",{class:J(["select-shop-warp",{"have-bor":!c.isIndex}])},[y.value?(s(),a("div",xe,[n(O,{"label-width":"70",ref_key:"formRef",ref:C,model:f.value,class:"demo-ruleForm","status-icon":""},{default:m(()=>[n(T,{rules:[{required:!0,message:"店铺名称不能为空!"}],label:"店铺名称",prop:"shopTitle"},{default:m(()=>[n(K,{classType:"tig-form-input",modelValue:f.value.shopTitle,"onUpdate:modelValue":e[3]||(e[3]=l=>f.value.shopTitle=l)},null,8,["modelValue"])]),_:1}),n(T,{label:"店铺logo",prop:"shopLogo"},{default:m(()=>[n($(ne),{photo:f.value.shopLogo,"onUpdate:photo":e[4]||(e[4]=l=>f.value.shopLogo=l)},null,8,["photo"])]),_:1}),n(T,{label:""},{default:m(()=>[n(g,{type:"primary",onClick:e[5]||(e[5]=l=>R())},{default:m(()=>e[15]||(e[15]=[v(" 创建 ")])),_:1}),n(g,{onClick:e[6]||(e[6]=l=>y.value=!1)},{default:m(()=>e[16]||(e[16]=[v("取消")])),_:1})]),_:1})]),_:1},8,["model"])])):(s(),a("div",de,[t("div",me,[c.isIndex?r("",!0):(s(),a("div",{key:0,class:"bark",onClick:e[0]||(e[0]=l=>E())},e[7]||(e[7]=[t("i",{class:"iconfont-admin icon-zuojiantou-copy"},null,-1),v("返回")]))),t("div",ce,[c.isIndex?(s(),W(g,{key:0,onClick:e[1]||(e[1]=l=>y.value=!0),type:"primary"},{default:m(()=>e[8]||(e[8]=[v("创建新店铺")])),_:1})):r("",!0)])]),e[14]||(e[14]=t("div",{class:"title-name"},[t("div",{class:"left-title"},"您可以进入以下管理后台")],-1)),i.value&&((F=i.value)!=null&&F.username)?(s(),a("div",fe,[t("span",null,b((L=i.value)==null?void 0:L.username),1),e[9]||(e[9]=v(" 已绑定了以下店铺，您可以进入以下任一店铺 "))])):r("",!0),n(k,{spinning:u.value,style:{width:"100%","margin-top":"100px",height:"200px"}},null,8,["spinning"]),!u.value&&S.value==="admin"?(s(),a("div",ve,[t("div",{onClick:e[2]||(e[2]=l=>w(0)),class:"shop-item",style:{"border-color":"#ffeac7","background-color":"#fff4e6",color:"#4e4e4e"}},[t("div",ge,[e[11]||(e[11]=t("img",{class:"left-image",src:ie,alt:""},null,-1)),t("div",he,[t("div",ye,[e[10]||(e[10]=v(" 管理后台 ")),i.value&&i.value.username&&i.value.username!==""?(s(),a("span",_e,"（"+b((M=i.value)==null?void 0:M.username)+"）",1)):r("",!0)])])]),e[12]||(e[12]=t("div",{class:"right-item"},[t("span",{class:"iconfont-admin icon-login-youjiantou"})],-1))])])):r("",!0),_.value.length>0?(s(),a("div",Se,[u.value?r("",!0):(s(!0),a(X,{key:0},Y(_.value,l=>(s(),a("div",{onClick:Fe=>w(l.shopId),class:"shop-item"},[t("div",Te,[n(h,{class:"left-image",src:$(re)},null,8,["src"]),t("div",be,[t("div",Ie,b(l.shopTitle),1)])]),e[13]||(e[13]=t("div",{class:"right-item"},[t("span",{class:"iconfont-admin icon-login-youjiantou"})],-1))],8,ke))),256))])):r("",!0),!u.value&&_.value.length==0&&S.value!="admin"?(s(),a("div",Ce,[n(z,{description:"您还没有已绑定的店铺哦～"})])):r("",!0)]))],2)}}}),Ue=se(we,[["__scopeId","data-v-a432837c"]]);export{Ue as S};
