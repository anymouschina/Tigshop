import{d as G,j as p,I as H,x as M,r as i,o as v,c as g,e as t,G as k,b as e,w as s,f as d,h as x,K as C,L as T,H as r}from"./index-7c2d2aef.js";/* empty css             */import"./index-6c62cf9b.js";import{_ as z}from"./Switch.vue_vue_type_script_setup_true_lang-95245cd7.js";import{_ as J}from"./DeleteRecord.vue_vue_type_script_setup_true_lang-ae1bade7.js";/* empty css                                                                    */import{P as Q}from"./Pagination-8eb7b6b1.js";import{u as A}from"./config-9548fa9b.js";import{g as R,u as q,d as W,b as X}from"./pointsExchange-6ebc0d5c.js";import{_ as E}from"./DialogForm.vue_vue_type_script_setup_true_lang-c57b9a11.js";import"./config-e2aa16d1.js";const Y={class:"container"},Z={class:"content_wrapper"},ee={class:"notice-warp"},te={class:"lyecs-table-list-warp"},oe={class:"list-table-tool lyecs-search-warp"},ae={class:"advanced-search-warp list-table-tool-row"},se={class:"simple-form-warp"},le={class:"simple-form-field"},ne={class:"form-group"},ie={class:"control-container"},de=t("span",{class:"iconfont icon-chakan1"},null,-1),ce={class:"simple-form-field"},re={class:"form-group"},_e=t("label",{class:"control-label"},[t("span",null,"是否可兑换：")],-1),pe={class:"control-container"},me={class:"simple-form-field"},ue={class:"form-group"},fe=t("label",{class:"control-label"},[t("span",null,"是否热销：")],-1),he={class:"control-container"},be={class:"simple-form-field"},ve={class:"list-table-tool-row"},ge={class:"list-table-tool-col"},ke={key:0},ye={class:"table-container"},we=t("a",{class:"btn-link"},"编辑",-1),xe=t("a",null,"查看",-1),Ce={class:"empty-warp"},Ve={key:0,class:"empty-bg"},Se={key:0,class:"pagination-con"},Le=G({__name:"List",setup(Ue){const P=A(),B=p(A().domain),V=p(),m=p(!0),f=p(0),u=p([]);p(!1);const l=H({page:1,size:P.get("page_size"),sort_field:"",sort_order:"",keyword:""}),c=async()=>{m.value=!0;try{const n=await R({...l});V.value=n.filter_result,f.value=n.total}catch(n){C.error(n.message)}finally{m.value=!1}};M(()=>{c()});const y=()=>{c()},D=({prop:n,order:a})=>{l.sort_field=n,l.sort_order=a=="ascending"?"asc":a=="descending"?"desc":"",c()},I=async n=>{try{const a=await X(n,{ids:u.value});C.success(a.message),c()}catch(a){C.error(a.message)}},N=n=>{u.value=n.map(a=>a.id)};return(n,a)=>{const h=i("el-button"),$=i("el-input"),b=i("el-option"),S=i("el-select"),K=i("el-popconfirm"),L=i("el-space"),F=i("el-form"),_=i("el-table-column"),U=i("el-divider"),O=i("el-table"),j=i("a-spin");return v(),g("div",Y,[t("div",Z,[t("div",ee,[t("p",null," 积分兑换列表前台地址为："+k(B.value)+"/exchange/list/（支持手机版自动跳转） ",1)]),t("div",te,[t("div",oe,[e(F,{model:l},{default:s(()=>[t("div",ae,[t("div",se,[t("div",le,[t("div",ne,[t("div",ie,[e($,{modelValue:l.keyword,"onUpdate:modelValue":a[0]||(a[0]=o=>l.keyword=o),name:"keyword",placeholder:"输入积分兑换商品名称",onKeyup:T(y,["enter"])},{append:s(()=>[e(h,{onClick:y},{default:s(()=>[de]),_:1})]),_:1},8,["modelValue"])])])]),t("div",ce,[t("div",re,[_e,t("div",pe,[e(S,{modelValue:l.is_enabled,"onUpdate:modelValue":a[1]||(a[1]=o=>l.is_enabled=o),clearable:""},{default:s(()=>[e(b,{value:0,label:"不可兑换"}),e(b,{value:1,label:"可兑换"})]),_:1},8,["modelValue"])])])]),t("div",me,[t("div",ue,[fe,t("div",he,[e(S,{modelValue:l.is_hot,"onUpdate:modelValue":a[2]||(a[2]=o=>l.is_hot=o),clearable:""},{default:s(()=>[e(b,{value:0,label:"不热销"}),e(b,{value:1,label:"热销"})]),_:1},8,["modelValue"])])])]),t("div",be,[e(h,{type:"primary",onClick:y},{default:s(()=>[r("搜索")]),_:1})])])]),t("div",ve,[t("div",ge,[e(L,null,{default:s(()=>[e(d(E),{isDrawer:"",onOkCallback:c,title:"添加积分商品",width:"600px",path:"promotion/pointsExchange/Info",params:{act:"add"}},{default:s(()=>[e(h,{type:"primary"},{default:s(()=>[r("添加积分商品")]),_:1})]),_:1}),e(K,{title:"您确认要批量删除所选数据吗？",onConfirm:a[3]||(a[3]=o=>I("del"))},{reference:s(()=>[e(h,{disabled:u.value.length===0},{default:s(()=>[r("批量删除")]),_:1},8,["disabled"])]),_:1}),u.value.length>0?(v(),g("span",ke,[r(" 已选择："),t("b",null,k(u.value.length),1),r(" 项 ")])):x("",!0)]),_:1})])])]),_:1},8,["model"])]),t("div",ye,[e(j,{spinning:m.value},{default:s(()=>[e(O,{data:V.value,"row-key":"id",onSelectionChange:N,total:f.value,onSortChange:D,loading:m.value},{empty:s(()=>[t("div",Ce,[m.value?x("",!0):(v(),g("div",Ve,"暂无数据"))])]),default:s(()=>[e(_,{type:"selection",width:"32"}),e(_,{label:"积分商品名称",prop:"product_name",sortable:"custom",width:350}),e(_,{label:"使用积分值",prop:"exchange_integral",sortable:"custom"},{default:s(({row:o})=>[r(k(o.exchange_integral),1)]),_:1}),e(_,{label:"减免金额",prop:"points_deducted_amount",sortable:"custom"},{default:s(({row:o})=>[r(k(o.points_deducted_amount),1)]),_:1}),e(_,{label:"是否可兑换",sortable:"custom"},{default:s(({row:o})=>[e(d(z),{checked:o.is_enabled,"onUpdate:checked":w=>o.is_enabled=w,requestApi:d(q),params:{id:o.id,field:"is_enabled"}},null,8,["checked","onUpdate:checked","requestApi","params"])]),_:1}),e(_,{label:"是否热销",sortable:"custom"},{default:s(({row:o})=>[e(d(z),{checked:o.is_hot,"onUpdate:checked":w=>o.is_hot=w,requestApi:d(q),params:{id:o.id,field:"is_hot"}},null,8,["checked","onUpdate:checked","requestApi","params"])]),_:1}),e(_,{label:"操作",fixed:"right",width:150},{default:s(({row:o})=>[e(d(E),{isDrawer:"",onOkCallback:c,title:"编辑积分商品",width:"600px",path:"promotion/pointsExchange/Info",params:{act:"detail",id:o.id}},{default:s(()=>[we]),_:2},1032,["params"]),e(U,{direction:"vertical"}),xe,e(U,{direction:"vertical"}),e(d(J),{onAfterDelete:c,requestApi:d(W),params:{id:o.id}},{default:s(()=>[r("删除")]),_:2},1032,["requestApi","params"])]),_:1})]),_:1},8,["data","total","loading"])]),_:1},8,["spinning"]),f.value>0?(v(),g("div",Se,[e(d(Q),{page:l.page,"onUpdate:page":a[4]||(a[4]=o=>l.page=o),size:l.size,"onUpdate:size":a[5]||(a[5]=o=>l.size=o),total:f.value,onCallback:c},null,8,["page","size","total"])])):x("",!0)])])])])}}});export{Le as default};
