/* empty css             */import{A as h,d as F,j as i,s as S,v as B,x as N,r as s,o as r,c as d,e as f,b as o,w as n,K as v,F as R,a as U,k as q,f as z,H as A,h as E,_ as H}from"./index-7c2d2aef.js";import{_ as I}from"./Editor.vue_vue_type_script_setup_true_lang-4519c339.js";import"./index.esm-0534e563.js";import"./index-6c62cf9b.js";import"./format-4e0206d3.js";import"./config-9548fa9b.js";import"./config-e2aa16d1.js";import"./util-1ee03ed8.js";import"./DialogForm.vue_vue_type_script_setup_true_lang-c57b9a11.js";const K=()=>h({url:"setting/mail_templates/list",method:"get"}),O=b=>h({url:"setting/mail_templates/update",method:"post",data:b}),$={class:"container"},D={class:"content_wrapper"},G={class:"lyecs-form-table"},J={key:0,class:"selected-action-warp"},P={class:"selected-action",style:{"padding-left":"80px"}},Q=F({__name:"MailTemplate",emits:["submitCallback","update:confirmLoading","close"],setup(b,{expose:w,emit:k}){const p=k,x=i(!1),u=i(!0),g=S(),t=i({template_name:"",template_id:0}),m=i([]),V=async()=>{var a;try{const e=await K();m.value=e.filter_result,m.value&&((a=m.value)==null?void 0:a.length)>0&&(t.value.template_id=m.value[0].template_id)}catch(e){v.error(e.message)}finally{u.value=!1}};B(()=>t.value.template_id,a=>{const e=m.value.find(c=>c.template_id==a);e&&Object.assign(t.value,e)}),N(()=>{V()});const y=async()=>{await g.value.validate();try{p("update:confirmLoading",!0);const a=await O({id:t.value.template_id,...t.value});p("submitCallback",a),v.success(a.message)}catch(a){v.error(a.message)}finally{p("update:confirmLoading",!1)}};return w({onFormSubmit:()=>{y()}}),(a,e)=>{const c=s("el-option"),C=s("el-select"),_=s("el-form-item"),T=s("el-input"),L=s("el-form"),M=s("el-button"),j=s("a-spin");return r(),d("div",$,[f("div",D,[f("div",G,[o(j,{spinning:u.value},{default:n(()=>[o(L,{ref_key:"formRef",ref:g,model:t.value,"label-width":"auto"},{default:n(()=>[o(_,{label:"邮件模板",prop:"selTemplate"},{default:n(()=>[o(C,{modelValue:t.value.template_id,"onUpdate:modelValue":e[0]||(e[0]=l=>t.value.template_id=l),style:{width:"100%"}},{default:n(()=>[(r(!0),d(R,null,U(m.value,l=>(r(),q(c,{key:l.template_id,label:l.template_name,value:l.template_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(_,{label:"邮件主题",prop:"template_subject"},{default:n(()=>[o(T,{modelValue:t.value.template_subject,"onUpdate:modelValue":e[1]||(e[1]=l=>t.value.template_subject=l),type:"text"},null,8,["modelValue"])]),_:1}),o(_,{label:"邮件内容",prop:"template_content"},{default:n(()=>[o(z(I),{html:t.value.template_content,"onUpdate:html":e[2]||(e[2]=l=>t.value.template_content=l)},null,8,["html"])]),_:1})]),_:1},8,["model"]),u.value?E("",!0):(r(),d("div",J,[f("div",P,[o(M,{loading:x.value,class:"form-submit-btn",size:"large",type:"primary",onClick:y},{default:n(()=>[A("提 交")]),_:1},8,["loading"])])]))]),_:1},8,["spinning"])])])])}}});const me=H(Q,[["__scopeId","data-v-1d79413e"]]);export{me as default};
