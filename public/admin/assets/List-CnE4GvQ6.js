import{d as K,C as A,i as _,G as Q,q as H,aQ as J,c as r,e as s,f as c,b as a,w as o,L as W,n as w,g as u,I as X,r as p,o as n,E as V,D as f,j as z,bc as Y,_ as Z}from"./index-CGYuOau0.js";/* empty css             */import"./index-B-GURfkM.js";/* empty css                                                                    */import{P as tt}from"./Pagination-yOfjsBuR.js";import{u as et}from"./config-DNllFJyR.js";import{_ as st}from"./Image.vue_vue_type_script_setup_true_lang-D9PqZe9n.js";import{a as at}from"./shop-Daw3OFCx.js";import{S as B}from"./StatusDot-YMdUi2kT.js";import{_ as x}from"./DialogForm.vue_vue_type_script_setup_true_lang-Bmm-M6gU.js";import"./config-DU8_t5BN.js";import"./format-DFT-VJzO.js";const ot={class:"container"},lt={class:"content_wrapper"},nt={class:"container"},it={class:"lyecs-table-list-warp"},rt={class:"list-table-tool lyecs-search-warp"},ct={class:"advanced-search-warp list-table-tool-row"},dt={class:"simple-form-warp"},pt={class:"simple-form-field"},_t={class:"form-group"},ut={class:"control-container"},mt={class:"simple-form-field"},ft={class:"form-group"},ht={class:"tabs flex"},vt={key:0},kt={class:"simple-form-field"},bt={class:"form-group"},gt={class:"control-container"},yt={class:"simple-form-field"},Ct={class:"list-table-tool-row"},wt={class:"list-table-tool-col"},xt={class:"table-container"},St={key:0},Ot={key:0},Vt={key:1},zt={key:0,class:"btn-link green"},Bt={key:1,class:"btn-link grey"},Dt={key:3,style:{color:"red"}},Lt={key:4,style:{color:"green"}},Ut={key:0},$t={key:1},It=["href"],Nt={class:"empty-warp"},Mt={key:0,class:"empty-bg"},Pt={key:0,class:"pagination-con"},qt=K({__name:"List",setup(Et){const v=A().currentRoute.value.query,$=et(),D=_([]),h=_(!1),k=_(0),I=_([]),N=_(!1),l=Q({page:1,size:$.get("page_size"),sort_field:"",sort_order:"",keyword:"",status:0}),b=i=>{l.status=i,d()},d=async()=>{h.value=!0;try{const i=await at({...l});D.value=i.filter_result,k.value=i.total}catch(i){X.error(i.message)}finally{h.value=!1}},M=()=>{S(),d()},S=()=>{let i=window.location.href,e=new URL(i);e.search="",window.history.replaceState({},document.title,e.toString())},L=_(),g=_(0);H(()=>{d(),console.log(v),v.id&&J.confirm(`为[${v.company_name||"--"}]立即创建店铺?`,"提示",{closeOnClickModal:!1,showClose:!1,confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>{g.value=Number(v.id),L.value.show()}).catch(()=>{g.value=0,S()})});const P=()=>{g.value=0,S()},y=()=>{d()},q=({prop:i,order:e})=>{l.sort_field=i,l.sort_order=e=="ascending"?"asc":e=="descending"?"desc":"",d()},E=i=>{I.value=i.map(e=>e.shop_id)};return(i,e)=>{const O=p("el-button"),F=p("el-input"),C=p("el-option"),R=p("el-select"),T=p("el-space"),m=p("el-table-column"),U=p("el-divider"),j=p("el-table"),G=p("a-spin");return n(),r("div",ot,[s("div",lt,[s("div",nt,[s("div",it,[s("div",rt,[s("div",ct,[s("div",dt,[s("div",pt,[s("div",_t,[s("div",ut,[a(F,{modelValue:l.keyword,"onUpdate:modelValue":e[0]||(e[0]=t=>l.keyword=t),name:"keyword",placeholder:"输入店铺名称",onKeyup:W(y,["enter"]),clearable:"",onClear:y},{append:o(()=>[a(O,{onClick:y},{default:o(()=>e[8]||(e[8]=[s("span",{class:"iconfont icon-chakan1"},null,-1)])),_:1})]),_:1},8,["modelValue"])])])]),s("div",mt,[s("div",ft,[s("div",ht,[s("div",{class:w(["item",l.status==0?"active":""]),onClick:e[1]||(e[1]=t=>b(0))},"全部",2),s("div",{class:w(["item",l.status==1?"active":""]),onClick:e[2]||(e[2]=t=>b(1))},"开业",2),s("div",{class:w(["item",l.status==4?"active":""]),onClick:e[3]||(e[3]=t=>b(4))},"暂停运营",2),s("div",{class:w(["item",l.status==10?"active":""]),onClick:e[4]||(e[4]=t=>b(10))},"打烊",2)])])]),N.value?(n(),r("div",vt,[s("div",kt,[s("div",bt,[e[9]||(e[9]=s("label",{class:"control-label"},[s("span",null,"店铺状态：")],-1)),s("div",gt,[a(R,{modelValue:l.status,"onUpdate:modelValue":e[5]||(e[5]=t=>l.status=t),clearable:""},{default:o(()=>[a(C,{value:0,label:"全部"}),a(C,{value:1,label:"运营中"}),a(C,{value:4,label:"暂停运营"}),a(C,{value:10,label:"打烊"})]),_:1},8,["modelValue"])])])]),s("div",yt,[a(O,{type:"primary",onClick:y},{default:o(()=>e[10]||(e[10]=[V("搜索")])),_:1})])])):c("",!0)])]),s("div",Ct,[s("div",wt,[a(T,null,{default:o(()=>[a(u(x),{ref_key:"dialogForm",ref:L,params:{act:"add",id:g.value},isDrawer:"",path:"shop/shop/Add",title:"新增店铺",width:"800px",onCloseCallback:P,onOkCallback:M},{default:o(()=>[a(O,{type:"primary"},{default:o(()=>e[11]||(e[11]=[V("新增店铺")])),_:1})]),_:1},8,["params"])]),_:1})]),e[12]||(e[12]=s("div",{class:"list-table-tool-col"},null,-1))])]),s("div",xt,[a(G,{spinning:h.value},{default:o(()=>[a(j,{data:D.value,loading:h.value,total:k.value,"row-key":"shop_id",onSelectionChange:E,onSortChange:q},{empty:o(()=>[s("div",Nt,[h.value?c("",!0):(n(),r("div",Mt,"暂无数据"))])]),default:o(()=>[a(m,{label:"店铺名称"},{default:o(({row:t})=>[V(f(t.shop_title||"--"),1)]),_:1}),a(m,{label:"店铺LOGO"},{default:o(({row:t})=>[a(u(st),{src:t.shop_logo,fit:"contain",style:{height:"25px",width:"60px"}},null,8,["src"])]),_:1}),a(m,{label:"商户名称",width:200},{default:o(({row:t})=>[t.merchant?(n(),r("div",St,[t.merchant.type==2?(n(),r("span",Ot,f(t.merchant.merchant_data.merchant_name||"--"),1)):c("",!0),t.merchant.type==1?(n(),r("span",Vt,f(t.merchant.corporate_name||"--"),1)):c("",!0),a(u(x),{params:{act:"detail",id:t.merchant.merchant_id},isDrawer:"",path:"adminMerchant/merchant/Info",title:"商户详情",width:"600px",showClose:!1,showOnOk:!1,onOkCallback:d},{default:o(()=>[t.merchant.status==1?(n(),r("a",zt,"(已认证)")):(n(),r("a",Bt,"(未认证)"))]),_:2},1032,["params"])])):c("",!0)]),_:1}),a(m,{label:"店铺状态",sortable:"custom"},{default:o(({row:t})=>[t.status==10?(n(),z(B,{key:0,color:"red",flicker:!0})):c("",!0),t.status==4?(n(),z(B,{key:1,color:"red",flicker:!0})):c("",!0),t.status==1?(n(),z(B,{key:2,color:"green",flicker:!0})):c("",!0),t.status===10||t.status===4?(n(),r("span",Dt,f(t.status_text),1)):t.status===1?(n(),r("span",Lt,f(t.status_text),1)):c("",!0)]),_:1}),a(m,{label:"店铺管理员",align:"center"},{default:o(({row:t})=>[t.merchant&&t.merchant.admin?(n(),r("div",Ut,[s("p",null,f(t.merchant.admin.username||"--"),1)])):(n(),r("div",$t,"--"))]),_:1}),a(m,{width:200,fixed:"right",label:"操作"},{default:o(({row:t})=>[a(u(x),{params:{act:"detail",id:t.shop_id},isDrawer:"",path:"shop/shop/Info",title:"编辑店铺",width:"700px",onOkCallback:d},{default:o(()=>e[13]||(e[13]=[s("a",{class:"btn-link"},"编辑",-1)])),_:2},1032,["params"]),a(U,{direction:"vertical"}),a(u(x),{params:{id:t.shop_id},isDrawer:"",path:"shop/shop/Set",title:"店铺结算设置",width:"500px",onOkCallback:d},{default:o(()=>e[14]||(e[14]=[s("a",{class:"btn-link"},"结算设置",-1)])),_:2},1032,["params"]),a(U,{direction:"vertical"}),s("a",{href:u(Y)("shop",t.shop_id),target:"_blank",class:"btn-link"},"查看店铺",8,It)]),_:1})]),_:1},8,["data","loading","total"])]),_:1},8,["spinning"]),k.value>0?(n(),r("div",Pt,[a(u(tt),{page:l.page,"onUpdate:page":e[6]||(e[6]=t=>l.page=t),size:l.size,"onUpdate:size":e[7]||(e[7]=t=>l.size=t),total:k.value,onCallback:d},null,8,["page","size","total"])])):c("",!0)])])])])])}}}),Yt=Z(qt,[["__scopeId","data-v-e4400fc1"]]);export{Yt as default};
