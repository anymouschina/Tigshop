import{d as j,i as u,C as E,s as I,q as A,r as s,c as G,o as p,e as c,b as t,w as l,j as v,f as O,a0 as T,g as Y,E as b,a1 as $,I as f}from"./index-CGYuOau0.js";import{F as z}from"./UploadAvatar.vue_vue_type_style_index_0_scoped_9bfcfc35_lang-CjXfTDg5.js";import{_ as J}from"./Editor.vue_vue_type_script_setup_true_lang-BBcTD5Hp.js";import{b as P,c as Q}from"./notice-xwbAxRL0.js";import"./index-B-GURfkM.js";import"./vuedraggable.umd-_1km55l4.js";import"./Image.vue_vue_type_script_setup_true_lang-D9PqZe9n.js";import"./format-DFT-VJzO.js";import"./config-DNllFJyR.js";import"./config-DU8_t5BN.js";import"./DialogForm.vue_vue_type_script_setup_true_lang-Bmm-M6gU.js";import"./index.esm-WCz80Rui.js";const W={class:"container"},X={class:"content_wrapper"},Z={class:"lyecs-form-table"},h={class:"lyecs-form-table"},ce=j({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(q,{expose:B,emit:S}){const m=S,i=q,g=u(1),d=u(!0),y=E().currentRoute.value.query,_=u(i.isDialog?i.act:String(y.act)),V=u(i.isDialog?i.id:Number(y.id)),N=_.value==="add"?"create":"update",w=I(),o=u({is_top:0,content:""}),M=async()=>{try{const n=await P(_.value,{id:V.value});Object.assign(o.value,n.item)}catch(n){f.error(n.message),m("close")}finally{d.value=!1}};A(()=>{_.value==="detail"?M():d.value=!1});const k=async()=>{if(await w.value.validate(),o.value.content===""){f.error("正文内容不能为空!");return}try{m("update:confirmLoading",!0);const n=await Q(N,{id:V.value,...o.value});m("submitCallback",n),f.success(n.message)}catch(n){f.error(n.message)}finally{m("update:confirmLoading",!1)}};return B({onFormSubmit:()=>{k()}}),(n,e)=>{const x=s("el-input"),r=s("el-form-item"),D=s("el-date-picker"),C=s("el-radio"),R=s("el-radio-group"),F=s("el-button"),H=s("el-form"),U=s("el-tab-pane"),K=s("el-tabs"),L=s("a-spin");return p(),G("div",W,[c("div",X,[c("div",Z,[t(K,{activeKey:g.value,"onUpdate:activeKey":e[7]||(e[7]=a=>g.value=a),class:"lyecs-tabs","tab-position":"top"},{default:l(()=>[(p(),v(U,{key:1,label:"基础设置"},{default:l(()=>[c("div",h,[d.value?O("",!0):(p(),v(H,{key:0,ref_key:"formRef",ref:w,model:o.value,"label-width":"auto"},{default:l(()=>[t(r,{rules:[{required:!0,message:"页面名称不能为空!"}],label:"页面名称",prop:"title"},{default:l(()=>[t(x,{modelValue:o.value.title,"onUpdate:modelValue":e[0]||(e[0]=a=>o.value.title=a)},null,8,["modelValue"])]),_:1}),t(r,{label:"封面图片",prop:"img",rules:[{required:!0,message:"封面图片不能为空!"}]},{default:l(()=>[t(Y(z),{photo:o.value.img,"onUpdate:photo":e[1]||(e[1]=a=>o.value.img=a)},null,8,["photo"]),e[8]||(e[8]=c("div",{class:"extra"},"请统一上传比例为2:1的图片，宽600px，高450px（高清）",-1))]),_:1}),t(r,{label:"推送时间",prop:"start_time",rules:[{required:!0,message:"推送时间不能为空!"}]},{default:l(()=>[t(D,{modelValue:o.value.start_time,"onUpdate:modelValue":e[2]||(e[2]=a=>o.value.start_time=a),type:"datetime",placeholder:"请选择推送时间",format:"YYYY/MM/DD HH:mm:ss"},null,8,["modelValue"])]),_:1}),t(r,{label:"失效时间",prop:"end_time"},{default:l(()=>[t(D,{modelValue:o.value.end_time,"onUpdate:modelValue":e[3]||(e[3]=a=>o.value.end_time=a),type:"datetime",placeholder:"请选择失效时间",format:"YYYY/MM/DD HH:mm:ss"},null,8,["modelValue"])]),_:1}),t(r,{label:"页面描述",prop:"describe",rules:[{required:!0,message:"页面描述不能为空!"}]},{default:l(()=>[t(x,{modelValue:o.value.describe,"onUpdate:modelValue":e[4]||(e[4]=a=>o.value.describe=a),row:"3",type:"textarea"},null,8,["modelValue"])]),_:1}),t(r,{label:"是否置顶",prop:"is_top"},{default:l(()=>[t(R,{modelValue:o.value.is_top,"onUpdate:modelValue":e[5]||(e[5]=a=>o.value.is_top=a)},{default:l(()=>[t(C,{value:1},{default:l(()=>e[9]||(e[9]=[b("置顶")])),_:1}),t(C,{value:0},{default:l(()=>e[10]||(e[10]=[b("不置顶")])),_:1})]),_:1},8,["modelValue"])]),_:1}),T(t(r,{"wrapper-col":{offset:4,span:16}},{default:l(()=>[t(F,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:k},{default:l(()=>e[11]||(e[11]=[b("提交")])),_:1},512)]),_:1},512),[[$,!i.isDialog]])]),_:1},8,["model"]))])]),_:1})),(p(),v(U,{key:2,label:"正文内容"},{default:l(()=>[t(Y(J),{html:o.value.content,"onUpdate:html":e[6]||(e[6]=a=>o.value.content=a)},null,8,["html"])]),_:1}))]),_:1},8,["activeKey"]),t(L,{spinning:d.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}});export{ce as default};
