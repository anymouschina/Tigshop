import{d as O,i as u,C as z,s as H,G as J,q as K,r as s,c as y,o as d,e as N,j as _,f as B,b as t,w as o,a0 as P,g as Q,E as c,F as I,a as W,a1 as X,aN as Y,I as v,_ as Z}from"./index-CGYuOau0.js";import"./index-B-GURfkM.js";import"./vuedraggable.umd-_1km55l4.js";import"./UploadAvatar.vue_vue_type_style_index_0_scoped_9bfcfc35_lang-CjXfTDg5.js";import{U as $}from"./UploadAvatar-Dqt_Db_h.js";import{i as ee,h as ae,j as te}from"./adminUser-0hufWCm0.js";import le from"./AuthoritySelect-yADIRE1h.js";import"./Image.vue_vue_type_script_setup_true_lang-D9PqZe9n.js";import"./format-DFT-VJzO.js";import"./config-DNllFJyR.js";import"./config-DU8_t5BN.js";import"./DialogForm.vue_vue_type_script_setup_true_lang-Bmm-M6gU.js";import"./authority-PNyDJWKD.js";const oe={class:"container"},re={class:"content_wrapper"},se={class:"lyecs-form-table"},ie=O({__name:"ShopInfo",props:{id:{type:Number,default:0},suppliers_id:{type:Number,default:0},act:{type:String,default:""},type:{type:String,default:""},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(R,{expose:q,emit:A}){const f=A;u(localStorage.getItem("adminType"));const n=R,p=u(!0),V=z().currentRoute.value.query,g=u(n.isDialog?n.act:String(V.act)),w=u(n.isDialog?n.id:Number(V.id)),S=g.value==="add"?"create":"update",U=H(),a=J({user_id:""}),k=u(),D=u({}),b=u(!0),T=async()=>{var r;try{const e=await ee(g.value,{id:w.value});D.value=e.item.user,Object.assign(a,e.item),e.item.auth_list==null&&(a.auth_list=[]),a.mobile=(r=e.item.admin_user)==null?void 0:r.mobile;let m=Y(String(a.avatar));m=="one"?b.value=!0:m=="def"&&(b.value=!1)}catch(e){v.error(e.message),f("close")}finally{p.value=!1}},F=async()=>{try{const r=await ae();k.value=r.Role_list}catch(r){v.error(r.message)}};K(()=>{g.value==="detail"?T():p.value=!1,S!="update"&&n.type==="suppliers"&&(a.role_id=2,a.suppliers_id=n.suppliers_id),F()});const C=async()=>{await U.value.validate();try{f("update:confirmLoading",!0);let r={avatar:""};!a.avatar&&a.def_avatar?r.avatar=a.def_avatar:r.avatar=a.avatar;const e=await te(S,{id:w.value,...a,avatar:r.avatar});f("submitCallback",e),v.success(e.message)}catch(r){v.error(r.message)}finally{f("update:confirmLoading",!1)}};return q({onFormSubmit:()=>{C()}}),(r,e)=>{const m=s("el-input"),i=s("el-form-item"),h=s("el-radio"),L=s("el-radio-group"),x=s("el-option"),j=s("el-select"),E=s("el-button"),G=s("el-form"),M=s("a-spin");return d(),y("div",oe,[N("div",re,[N("div",se,[p.value?B("",!0):(d(),_(G,{key:0,ref_key:"formRef",ref:U,model:a,"label-width":"auto"},{default:o(()=>[t(i,{rules:[{required:!0,message:"员工名称不能为空!"}],label:"员工名称",prop:"username"},{default:o(()=>[t(m,{modelValue:a.username,"onUpdate:modelValue":e[0]||(e[0]=l=>a.username=l)},null,8,["modelValue"])]),_:1}),t(i,{label:"手机号",prop:"mobile",rules:[{required:!0,message:"手机号不能为空!"}]},{default:o(()=>[t(m,{modelValue:a.mobile,"onUpdate:modelValue":e[1]||(e[1]=l=>a.mobile=l)},null,8,["modelValue"])]),_:1}),t(i,{label:"邮箱",prop:"email"},{default:o(()=>[t(m,{modelValue:a.email,"onUpdate:modelValue":e[2]||(e[2]=l=>a.email=l)},null,8,["modelValue"])]),_:1}),t(i,{label:"头像",prop:"avatar"},{default:o(()=>[t(Q($),{avatar:a.avatar,"onUpdate:avatar":e[3]||(e[3]=l=>a.avatar=l),avatarType:b.value,loading:p.value},null,8,["avatar","avatarType","loading"])]),_:1}),t(i,{label:"是否停用",prop:"is_using"},{default:o(()=>[t(L,{style:{width:"100%"},modelValue:a.is_using,"onUpdate:modelValue":e[4]||(e[4]=l=>a.is_using=l)},{default:o(()=>[t(h,{value:1},{default:o(()=>e[7]||(e[7]=[c("是")])),_:1}),t(h,{value:0},{default:o(()=>e[8]||(e[8]=[c("否")])),_:1})]),_:1},8,["modelValue"])]),_:1}),t(i,{label:"员工权限组",prop:"role_id"},{default:o(()=>[a.role_id!=2?(d(),_(j,{key:0,modelValue:a.role_id,"onUpdate:modelValue":e[5]||(e[5]=l=>a.role_id=l),style:{width:"100%"}},{default:o(()=>[t(x,{value:0,label:"自定义权限"}),(d(!0),y(I,null,W(k.value,l=>(d(),_(x,{label:l.role_name,value:l.role_id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])):(d(),y(I,{key:1},[c(" 供应商")],64))]),_:1}),a.role_id===0?(d(),_(i,{key:0,label:"",prop:"auth_list"},{default:o(()=>[t(le,{modelValue:a.auth_list,"onUpdate:modelValue":e[6]||(e[6]=l=>a.auth_list=l)},null,8,["modelValue"])]),_:1})):B("",!0),P(t(i,{"wrapper-col":{offset:4,span:16}},{default:o(()=>[t(E,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:C},{default:o(()=>e[9]||(e[9]=[c("提交")])),_:1},512)]),_:1},512),[[X,!n.isDialog]])]),_:1},8,["model"])),t(M,{spinning:p.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}}),Se=Z(ie,[["__scopeId","data-v-7056093a"]]);export{Se as default};
