import{d as K,j as r,E as O,s as z,x as A,K as d,r as v,o as n,c as g,e as N,k as b,w as u,b as i,F as R,a as U,G as H,f as D,h as J}from"./index-7c2d2aef.js";import{b as P,g as Q,u as T}from"./promoter-617c4eec.js";import"./SelectTimeInterval.vue_vue_type_style_index_0_scoped_207fe586_lang-b4d9216b.js";import"./category-a8bd4d11.js";import"./index-6c62cf9b.js";import"./config-9548fa9b.js";/* empty css                                                                    *//* empty css                                                                  *//* empty css                                                                              */import"./region-e0d291a6.js";import{g as W}from"./user-dc73f8d4.js";import"./shopProductCategory-792e0c23.js";import{a as X,_ as Y}from"./SelectPromoteMode.vue_vue_type_script_setup_true_lang-d1ea7210.js";import"./time-290942a2.js";import"./util-1ee03ed8.js";import"./config-e2aa16d1.js";import"./region-05802f67.js";/* empty css             */import"./subgroup-c0dd43e1.js";import"./promoteMode-9ef4057f.js";const Z={class:"container"},ee={class:"content_wrapper"},ae={class:"lyecs-form-table"},le={key:1},Ve=K({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},isDialog:{type:Boolean,default:!1}},emits:["submitCallback","update:confirmLoading","close"],setup(E,{expose:F,emit:q}){const c=q,p=E,y=r(!0),L=O().currentRoute.value.query,f=r(p.isDialog?p.act:String(L.act)),x=r(p.isDialog?p.id:Number(L.id)),j=f.value==="add"?"create":"update",C=z(),l=r({}),k=r(!1),h=r([]),I=async e=>{try{if(e){k.value=!0;const o=await W({keyword:e});o.filter_result.forEach(a=>{a.value=a.user_id,a.key=a.user_id,a.label=a.username}),h.value=o.filter_result}else h.value=[]}catch(t){d.error(t.message)}finally{k.value=!1}},w=r(),S=r([]),V=r(!1),B=async e=>{try{if(e){V.value=!0;const o=await Q({mobile:e});o.filter_result.forEach(a=>{a.value=a.salesman_id,a.key=a.salesman_id,a.label=a.nickname}),S.value=o.filter_result,o.filter_result.length>0&&(w.value=o.filter_result[0].nickname)}else S.value=[]}catch(t){d.error(t.message)}finally{V.value=!1}};A(()=>{f.value==="detail"?M():y.value=!1});const M=async()=>{try{const e=await P(f.value,{id:x.value});Object.assign(l.value,e.item),l.value.user_id=e.item.base_user_info?e.item.base_user_info.user_id:"",l.value.nickname=e.item.base_user_info?e.item.base_user_info.nickname:"",B(l.value.pid_mobile)}catch(e){d.error(e.message),c("close")}finally{y.value=!1}},$=async()=>{await C.value.validate();try{c("update:confirmLoading",!0);const e=await T(j,{id:x.value,...l.value});c("submitCallback",e),d.success(e.message)}catch(e){d.error(e.message)}finally{c("update:confirmLoading",!1)}};return F({onFormSubmit:()=>{$()}}),(e,t)=>{const o=v("el-option"),a=v("el-select"),_=v("el-form-item"),G=v("el-form");return n(),g("div",Z,[N("div",ee,[N("div",ae,[y.value?J("",!0):(n(),b(G,{key:0,ref_key:"formRef",ref:C,model:l.value,"label-width":"auto"},{default:u(()=>[i(_,{prop:"user_id",label:"绑定账号",rules:[{required:!0,message:"请选择账号",trigger:"change"}]},{default:u(()=>{var s;return[f.value==="add"?(n(),b(a,{key:0,style:{width:"100%"},modelValue:l.value.user_id,"onUpdate:modelValue":t[0]||(t[0]=m=>l.value.user_id=m),filterable:"",remote:"","reserve-keyword":"",placeholder:"可输入手机号查询绑定会员","remote-method":I,loading:k.value},{default:u(()=>[(n(!0),g(R,null,U(h.value,m=>(n(),b(o,{key:m.key,label:m.label+"("+m.mobile+")",value:m.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])):(n(),g("p",le,H(l.value.nickname||((s=l.value.base_user_info)==null?void 0:s.username)||"--"),1))]}),_:1}),i(_,{prop:"level",label:"等级",rules:[{required:!0,message:"请选择分销员等级",trigger:"change"}]},{default:u(()=>[i(D(X),{style:{width:"100%"},level:l.value.level,"onUpdate:level":t[1]||(t[1]=s=>l.value.level=s)},null,8,["level"])]),_:1}),i(_,{prop:"group_id",label:"分组",rules:[{required:!0,message:"请选择分销员分组",trigger:"change"}]},{default:u(()=>[i(D(Y),{style:{width:"100%"},group_id:l.value.group_id,"onUpdate:group_id":t[2]||(t[2]=s=>l.value.group_id=s)},null,8,["group_id"])]),_:1}),i(_,{prop:"nickname",label:"上级分销员"},{default:u(()=>[i(a,{style:{width:"230px"},modelValue:w.value,"onUpdate:modelValue":t[3]||(t[3]=s=>w.value=s),filterable:"",remote:"","reserve-keyword":"",placeholder:"可输入手机号查询上级分销员","remote-method":B,loading:V.value},{default:u(()=>[(n(!0),g(R,null,U(S.value,s=>(n(),b(o,{key:s.key,label:s.label,value:s.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]),_:1})]),_:1},8,["model"]))])])])}}});export{Ve as default};
