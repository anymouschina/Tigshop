import{d as q,i as y,C as P,s as j,q as M,r as i,c as $,o as g,e as n,j as L,f as S,b as l,w as r,a3 as z,g as C,E as v,a4 as G,I as b}from"./index-DrbzVNl6.js";import{a as H,c as J}from"./pcCatFloor-BL1hyY-I.js";import{D as x}from"./DynamicList-Nrk8tyuf.js";import{S as K}from"./SelectBrand-DNAqPzAl.js";import{_ as Q}from"./SelectCategory.vue_vue_type_script_setup_true_lang-DKnpU9uO.js";import"./index-CeQDmMxd.js";import"./SelectTimeInterval.vue_vue_type_style_index_0_scoped_207fe586_lang-MgR9Z6jO.js";/* empty css                                                                    *//* empty css                                                                  *//* empty css                                                                              *//* empty css             */import{S as W}from"./SelectIco-CHo0EoOQ.js";import"./brand-C64i7ZtK.js";import"./category-B3nMG9Bb.js";import"./category-BQLd1cDS.js";import"./time-Bh5UhrfW.js";import"./DialogForm.vue_vue_type_script_setup_true_lang-DqYSRv0_.js";const X={class:"container"},Y={class:"content_wrapper"},Z={class:"lyecs-form-table"},ee={class:"dynamic-div"},ae={class:"dynamic-div"},Ve=q({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},isDialog:{type:Boolean,default:!1}},emits:["submitCallback","update:confirmLoading","close"],setup(B,{expose:U,emit:k}){const c=k,u=B,m=y(!0),I=P().currentRoute.value.query,f=y(u.isDialog?u.act:String(I.act)),V=y(u.isDialog?u.id:Number(I.id)),T=f.value==="add"?"create":"update",N=j(),a=y({isShow:1,sortOrder:50}),F=async()=>{try{const t=await H(f.value,{id:V.value});Object.assign(a.value,t),t.categoryIds&&t.categoryNames&&t.categoryIds.length===t.categoryNames.length&&(a.value.categoryList=t.categoryIds.map((e,d)=>{var s;return{categoryId:Number(e),categoryName:((s=t.categoryNames)==null?void 0:s[d])||""}}),t.brandIds&&t.brandIds.length>0&&(a.value.brandList=t.brandIds.map((e,d)=>({brandId:Number(e)}))))}catch(t){b.error(t.message),c("close")}finally{m.value=!1}};M(()=>{f.value==="detail"?F():m.value=!1});const _=async()=>{await N.value.validate();try{c("update:confirmLoading",!0),A(),D();const t=await J(T,{id:V.value,...a.value});c("submitCallback",t),b.success("操作成功")}catch(t){b.error(t.message)}finally{c("update:confirmLoading",!1)}};function A(){var t;a.value.categoryIds=a.value.categoryIds||[],a.value.categoryNames=a.value.categoryNames||[],a.value.categoryIds.length=0,a.value.categoryNames.length=0,(t=a.value.categoryList)==null||t.forEach(e=>{var d,s;typeof e.categoryId=="number"&&typeof e.categoryName=="string"&&((d=a.value.categoryIds)==null||d.push(e.categoryId),(s=a.value.categoryNames)==null||s.push(e.categoryName))})}function D(){var t;a.value.brandIds=a.value.brandIds||[],a.value.brandIds.length=0,(t=a.value.brandList)==null||t.forEach(e=>{var d;typeof e.brandId=="number"&&((d=a.value.brandIds)==null||d.push(e.brandId))})}return U({onFormSubmit:()=>{_()}}),(t,e)=>{const d=i("TigInput"),s=i("el-form-item"),w=i("el-radio"),O=i("el-radio-group"),R=i("el-button"),E=i("el-form"),h=i("a-spin");return g(),$("div",X,[n("div",Y,[n("div",Z,[m.value?S("",!0):(g(),L(E,{key:0,ref_key:"formRef",ref:N,model:a.value,"label-width":"auto"},{default:r(()=>[l(s,{label:"添加分类",prop:"brandName"},{default:r(()=>[l(x,{modelValue:a.value.categoryList,"onUpdate:modelValue":e[0]||(e[0]=o=>a.value.categoryList=o),templateList:["categoryId","categoryName"],templateListType:["number","string"],buttonName:"增加",buttonType:"primary",style:{width:"100%"}},{dynamicSlot:r(({item:o})=>[n("div",ee,[m.value?S("",!0):(g(),L(C(Q),{key:0,categoryId:o.categoryId,"onUpdate:categoryId":p=>o.categoryId=p,multiple:!1,style:{width:"100%"}},null,8,["categoryId","onUpdate:categoryId"])),e[5]||(e[5]=n("span",null,"重命名：",-1)),l(d,{classType:"tig-form-input",modelValue:o.categoryName,"onUpdate:modelValue":p=>o.categoryName=p},null,8,["modelValue","onUpdate:modelValue"])])]),_:1},8,["modelValue"]),e[6]||(e[6]=n("div",{class:"extra"},"提示：只能设置为一级或二级分类，且必须含有一个一级分类，如果存在二级分类，则必须存在该二级分类上一级分类；",-1)),e[7]||(e[7]=n("div",{class:"extra"},"重命名为空则显示原分类名称，重命名的作用为方便排列",-1)),e[8]||(e[8]=n("div",{class:"extra"},"设置规则如下：",-1)),e[9]||(e[9]=n("div",{class:"extra"},"1、如果添加的分类为一级分类A、B、C，则抽屉一级会显示：A/B/C三个链接，二级为A、B、C下的所有二级分类",-1)),e[10]||(e[10]=n("div",{class:"extra"}," 2、如果添加的分类为一级分类A和A下面的二级分类a1、a2，则，会显示A/a1/a2三个链接，二级为A下的所有二级分类（包含了a1、a2） ",-1)),e[11]||(e[11]=n("div",{class:"extra"},"3、如果重命名为“-”符号，则不会显示",-1))]),_:1}),l(s,{label:"热门品牌",prop:"brandList"},{default:r(()=>[l(x,{modelValue:a.value.brandList,"onUpdate:modelValue":e[1]||(e[1]=o=>a.value.brandList=o),templateList:["brandId"],templateListType:["number"],buttonName:"增加",buttonType:"primary",style:{width:"100%"}},{dynamicSlot:r(({item:o})=>[n("div",ae,[l(C(K),{modelValue:o.brandId,"onUpdate:modelValue":p=>o.brandId=p,style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])])]),_:1},8,["modelValue"])]),_:1}),l(s,{label:"ICO编码",prop:"floorIcoFont"},{default:r(()=>[l(W,{modelValue:a.value.floorIcoFont,"onUpdate:modelValue":e[2]||(e[2]=o=>a.value.floorIcoFont=o)},null,8,["modelValue"]),e[12]||(e[12]=n("div",{class:"extra"},'请先在Tigshop设置中的"接口设置"中设置"ico图标库地址"',-1))]),_:1}),l(s,{label:"排序",prop:"sortOrder"},{default:r(()=>[l(d,{type:"integer",modelValue:a.value.sortOrder,"onUpdate:modelValue":e[3]||(e[3]=o=>a.value.sortOrder=o)},null,8,["modelValue"])]),_:1}),l(s,{label:"是否显示",prop:"isShow"},{default:r(()=>[l(O,{modelValue:a.value.isShow,"onUpdate:modelValue":e[4]||(e[4]=o=>a.value.isShow=o)},{default:r(()=>[l(w,{value:1},{default:r(()=>e[13]||(e[13]=[v("是")])),_:1}),l(w,{value:0},{default:r(()=>e[14]||(e[14]=[v("否")])),_:1})]),_:1},8,["modelValue"])]),_:1}),z(l(s,{"wrapper-col":{offset:4,span:16}},{default:r(()=>[l(R,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:_},{default:r(()=>e[15]||(e[15]=[v("提交")])),_:1},512)]),_:1},512),[[G,!u.isDialog]])]),_:1},8,["model"])),l(h,{spinning:m.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}});export{Ve as default};
