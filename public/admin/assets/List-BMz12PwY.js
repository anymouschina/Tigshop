import{d as $,K as E,i as C,G as L,q as R,c as m,e,b as s,E as n,w as a,g as l,N as j,f as _,I as A,r as c,o as r,D as v,j as S}from"./index-DrbzVNl6.js";/* empty css             */import"./index-CeQDmMxd.js";import{P as U}from"./PopFormElm-BZp1_Wme.js";import{_ as G}from"./Switch.vue_vue_type_script_setup_true_lang-C5nzofSO.js";import{D as K}from"./DeleteRecord-MR4vGqLl.js";/* empty css                                                                    */import{P as H}from"./Pagination-wR9huHyl.js";import{g as J,u as h,d as Q,b as W}from"./coupon-m2CwLlAZ.js";import"./SelectTimeInterval.vue_vue_type_style_index_0_scoped_207fe586_lang-MgR9Z6jO.js";/* empty css                                                                  *//* empty css                                                                              */import{_ as X}from"./SelectShop.vue_vue_type_script_setup_true_lang-FZKjv82Z.js";import{_ as k}from"./DialogForm.vue_vue_type_script_setup_true_lang-DqYSRv0_.js";import"./time-Bh5UhrfW.js";import"./shop-DM8_bN_f.js";const Y={class:"container"},Z={class:"content_wrapper"},ee={class:"bonus-wrap"},oe={class:"card-wrap"},te={class:"card-wrap__container"},se={class:"item-bg coupon-cards-item"},ae={class:"item-bg coupon-cards-item"},le={class:"item-bg coupon-cards-item item-bg2"},ne={class:"item-bg coupon-cards-item item-bg2"},ie={class:"lyecs-table-list-warp"},de={class:"list-table-tool lyecs-search-warp"},pe={class:"advanced-search-warp list-table-tool-row"},re={class:"simple-form-warp"},ue={key:0,class:"simple-form-field"},ce={class:"form-group"},me={class:"control-container"},_e={class:"simple-form-field"},fe={class:"form-group"},ve={class:"control-container"},ge={class:"list-table-tool-row"},be={class:"list-table-tool-col"},ye={key:0},he={class:"table-container"},ke={style:{position:"relative"}},Ie={key:0,class:"green"},Ce={key:1,class:"green"},Ue={key:1},we={class:"empty-warp"},Ae={key:0,class:"empty-bg"},Se={key:0,class:"pagination-con"},Ge=$({__name:"List",setup(Ve){const D=E(),V=C(),b=C(!0),I=C(0),y=C([]),i=L({page:1,size:D.get("pageSize"),sortField:"",sortOrder:"",keyword:"",isShow:-1,shopId:0}),d=async()=>{b.value=!0;try{const p=await J({...i});V.value=p.records,I.value=p.total}catch(p){A.error(p.message)}finally{b.value=!1}};R(()=>{d()});const w=()=>{d()},q=({prop:p,order:o})=>{i.sortField=p,i.sortOrder=o=="ascending"?"asc":o=="descending"?"desc":"",d()},N=async p=>{try{const o=await W(p,{ids:y.value});A.success("操作成功"),d()}catch(o){A.error(o.message)}},O=p=>{y.value=p.map(o=>o.couponId)};return(p,o)=>{const g=c("el-button"),x=c("TigInput"),T=c("el-popconfirm"),z=c("el-space"),M=c("el-form"),f=c("el-table-column"),B=c("el-divider"),F=c("el-table"),P=c("a-spin");return r(),m("div",Y,[e("div",Z,[e("div",ee,[o[13]||(o[13]=e("p",{class:"subtitle"},"按使用场景快速创建",-1)),e("div",oe,[e("div",te,[e("div",se,[o[6]||(o[6]=e("div",null,[e("div",{class:"title"},"满减券"),e("div",{class:"desc"},[e("p",null,[n("例：满100元减20元"),e("br"),n("便于合理控制活动成本")])])],-1)),s(l(k),{isDrawer:"",onOkCallback:d,title:"添加满减券",width:"800px",path:"promotion/coupon/Info",params:{act:"add",couponType:1}},{default:a(()=>[s(g,{type:"primary"},{default:a(()=>o[5]||(o[5]=[n("立即新建")])),_:1})]),_:1})]),e("div",ae,[o[8]||(o[8]=e("div",null,[e("div",{class:"title"},"折扣券"),e("div",{class:"desc"},[e("p",null,[n("例：满100元打9折"),e("br"),n("提高店铺销量和客单价")])])],-1)),s(l(k),{isDrawer:"",onOkCallback:d,title:"添加折扣券",width:"800px",path:"promotion/coupon/Info",params:{act:"add",couponType:2}},{default:a(()=>[s(g,{type:"primary"},{default:a(()=>o[7]||(o[7]=[n("立即新建")])),_:1})]),_:1})]),e("div",le,[o[10]||(o[10]=e("div",null,[e("div",{class:"title"},"新人专享券"),e("div",{class:"desc"},[e("p",null,[n("仅店铺新客可领，提高新客"),e("br"),n("首单转化")])])],-1)),s(l(k),{isDrawer:"",onOkCallback:d,title:"添加新人专享券",width:"800px",path:"promotion/coupon/Info",params:{act:"add",isNewUser:1}},{default:a(()=>[s(g,{type:"primary"},{default:a(()=>o[9]||(o[9]=[n("立即新建")])),_:1})]),_:1})]),e("div",ne,[o[12]||(o[12]=e("div",null,[e("div",{class:"title"},"会员专享券"),e("div",{class:"desc"},[e("p",null,[n("限会员可领的优惠券，丰富会"),e("br"),n("员权益，凸显会员身份价值")])])],-1)),s(l(k),{isDrawer:"",onOkCallback:d,title:"添加会员专享券",width:"850px",path:"promotion/coupon/Info",params:{act:"add",isNewUser:2}},{default:a(()=>[s(g,{type:"primary"},{default:a(()=>o[11]||(o[11]=[n("立即新建")])),_:1})]),_:1})])])])]),e("div",ie,[e("div",de,[s(M,{model:i,onSubmit:j(w,["prevent"])},{default:a(()=>[e("div",pe,[e("div",re,[i.shopId==-1?(r(),m("div",ue,[e("div",ce,[e("div",me,[s(l(X),{shopId:i.shopId,"onUpdate:shopId":o[0]||(o[0]=t=>i.shopId=t)},null,8,["shopId"])])])])):_("",!0),e("div",_e,[e("div",fe,[e("div",ve,[s(x,{modelValue:i.keyword,"onUpdate:modelValue":o[1]||(o[1]=t=>i.keyword=t),name:"keyword",placeholder:"输入优惠券名称",clearable:"",onClear:w},{append:a(()=>[s(g,{onClick:w},{default:a(()=>o[14]||(o[14]=[e("span",{class:"iconfont icon-chakan1"},null,-1)])),_:1})]),_:1},8,["modelValue"])])])])])]),e("div",ge,[e("div",be,[s(z,null,{default:a(()=>[s(T,{title:"您确认要批量删除所选数据吗？",onConfirm:o[2]||(o[2]=t=>N("del"))},{reference:a(()=>[s(g,{disabled:y.value.length===0},{default:a(()=>o[15]||(o[15]=[n("批量删除")])),_:1},8,["disabled"])]),_:1}),y.value.length>0?(r(),m("span",ye,[o[16]||(o[16]=n(" 已选择：")),e("b",null,v(y.value.length),1),o[17]||(o[17]=n(" 项 "))])):_("",!0)]),_:1})])])]),_:1},8,["model"])]),e("div",he,[s(P,{spinning:b.value},{default:a(()=>[s(F,{data:V.value,"row-key":"couponId",onSelectionChange:O,total:I.value,onSortChange:q,loading:b.value},{empty:a(()=>[e("div",we,[b.value?_("",!0):(r(),m("div",Ae,"暂无数据"))])]),default:a(()=>[s(f,{type:"selection",width:"32"}),s(f,{label:"优惠券名称",prop:"couponId",width:200},{default:a(({row:t})=>[e("div",ke,[s(l(U),{label:"优惠券名称",type:"textarea",requestApi:l(h),"org-value":t.couponName,"onUpdate:orgValue":u=>t.couponName=u,params:{id:t.couponId,field:"couponName"}},{default:a(()=>[e("div",null,v(t.couponName),1)]),_:2},1032,["requestApi","org-value","onUpdate:orgValue","params"])])]),_:1}),s(f,{label:"发放类型"},{default:a(({row:t})=>[n(v(t.couponType==1?"满减券":"折扣券")+" ",1),t.isNewUser==1?(r(),m("span",Ie,"(新人专享)")):_("",!0),t.limitUserRank.length?(r(),m("span",Ce,"(会员专享)")):_("",!0)]),_:1}),s(f,{label:"优惠券金额(折扣)",prop:"couponMoney",sortable:"custom"},{default:a(({row:t})=>[t.couponType==1?(r(),S(l(U),{key:0,label:"优惠券金额",type:"decimal",requestApi:l(h),"org-value":t.couponMoney,"onUpdate:orgValue":u=>t.couponMoney=u,params:{id:t.couponId,field:"couponMoney"}},{default:a(()=>[e("div",null,v(t.couponMoney||"0"),1)]),_:2},1032,["requestApi","org-value","onUpdate:orgValue","params"])):_("",!0),t.couponType==2?(r(),S(l(U),{key:1,label:"优惠券折扣",type:"decimal",requestApi:l(h),"org-value":t.couponDiscount,"onUpdate:orgValue":u=>t.couponDiscount=u,params:{id:t.couponId,field:"couponDiscount"}},{default:a(()=>[e("div",null,v(t.couponDiscount||"0")+"折",1)]),_:2},1032,["requestApi","org-value","onUpdate:orgValue","params"])):_("",!0)]),_:1}),s(f,{label:"优惠门槛",prop:"minOrderAmount",sortable:"custom"},{default:a(({row:t})=>[t.reduceType==1?(r(),S(l(U),{key:0,label:"优惠门槛",type:t.couponUnit==1?"decimal":"integer",requestApi:l(h),"org-value":t.minOrderAmount,"onUpdate:orgValue":u=>t.minOrderAmount=u,params:{id:t.couponId,field:"minOrderAmount"}},{default:a(()=>[e("div",null,v(t.minOrderAmount||"0")+v(t.couponUnit==1?"元":"件"),1)]),_:2},1032,["type","requestApi","org-value","onUpdate:orgValue","params"])):(r(),m("div",Ue,"无门槛券"))]),_:1}),s(f,{label:"是否展示",prop:"isShow",sortable:"custom"},{default:a(({row:t})=>[s(l(G),{checked:t.isShow,"onUpdate:checked":u=>t.isShow=u,requestApi:l(h),params:{id:t.couponId,field:"isShow"}},null,8,["checked","onUpdate:checked","requestApi","params"])]),_:1}),s(f,{label:"操作",fixed:"right"},{default:a(({row:t})=>[s(l(k),{isDrawer:"",onOkCallback:d,title:"编辑优惠券",width:"800px",path:"promotion/coupon/Info",params:{act:"detail",id:t.couponId}},{default:a(()=>o[18]||(o[18]=[e("a",{class:"btn-link"},"编辑",-1)])),_:2},1032,["params"]),s(B,{direction:"vertical"}),s(l(K),{onAfterDelete:d,requestApi:l(Q),params:{id:t.couponId}},{default:a(()=>o[19]||(o[19]=[n("删除")])),_:2},1032,["requestApi","params"])]),_:1})]),_:1},8,["data","total","loading"])]),_:1},8,["spinning"]),I.value>0?(r(),m("div",Se,[s(l(H),{page:i.page,"onUpdate:page":o[3]||(o[3]=t=>i.page=t),size:i.size,"onUpdate:size":o[4]||(o[4]=t=>i.size=t),total:I.value,onCallback:d},null,8,["page","size","total"])])):_("",!0)])])])])}}});export{Ge as default};
