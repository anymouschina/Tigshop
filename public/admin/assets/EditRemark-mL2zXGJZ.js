import{d as B,i as u,C as R,s as D,q as O,I as m,r as l,c as j,o as y,e as w,j as L,f as q,b as n,w as c,a0 as E,E as F,a1 as A}from"./index-CGYuOau0.js";import{a as I,j as M,k as T}from"./order-CoX6hLeE.js";const U={class:"container"},$={class:"content_wrapper"},z={class:"lyecs-form-table"},K=B({__name:"EditRemark",props:{id:{type:Number,default:0},act:{type:String,default:""},valueName:{type:String,default:""},form:{type:Object,default:()=>({})},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(r,{expose:N,emit:h}){const s=h,a=r,i=u(!0),p=R().currentRoute.value.query,f=u(a.isDialog?a.act:String(p.act)),d=u(a.isDialog?a.id:Number(p.id));f.value;const v=D(),t=u(a.form);O(()=>{k()});const k=async()=>{try{i.value=!0;const e=await I(f.value,{id:d.value});Object.assign(t.value,e.item)}catch(e){m.error(e.message),s("close")}finally{i.value=!1}},_=async()=>{await v.value.validate();try{if(s("update:confirmLoading",!0),a.valueName=="add_note"){const e=await M({order_id:d.value,order_sn:t.value.order_sn,shop_id:t.value.shop_id,description:t.value[a.valueName]});s("submitCallback",e),m.success(e.message)}if(a.valueName=="admin_note"){const e=await T({id:d.value,admin_note:t.value[a.valueName]});s("submitCallback",e),m.success(e.message)}}catch(e){m.error(e.message)}finally{s("update:confirmLoading",!1)}};return N({onFormSubmit:()=>{_()}}),(e,o)=>{const C=l("el-input"),b=l("el-form-item"),x=l("el-button"),S=l("el-form"),V=l("a-spin");return y(),j("div",U,[w("div",$,[w("div",z,[i.value?q("",!0):(y(),L(S,{key:0,ref_key:"formRef",ref:v,model:t.value,"label-width":"auto"},{default:c(()=>[n(b,{label:"备注",prop:r.valueName},{default:c(()=>[n(C,{modelValue:t.value[r.valueName],"onUpdate:modelValue":o[0]||(o[0]=g=>t.value[r.valueName]=g),rows:4,placeholder:"请输入备注",type:"textarea","show-word-limit":"",maxlength:"200"},null,8,["modelValue"])]),_:1},8,["prop"]),E(n(b,{"wrapper-col":{offset:4,span:16}},{default:c(()=>[n(x,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:o[1]||(o[1]=g=>_())},{default:c(()=>o[2]||(o[2]=[F("提交 ")])),_:1},512)]),_:1},512),[[A,!a.isDialog]])]),_:1},8,["model"])),n(V,{spinning:i.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}});export{K as default};
