import{d as K,i as u,G as O,q as E,c as U,e as l,b as s,w as n,f as _,g as o,I as f,r as p,o as m,E as A,L as j,D as G,j as b,_ as W}from"./index-CGYuOau0.js";/* empty css             */import{M as S}from"./index-B-GURfkM.js";import{_ as v}from"./Switch.vue_vue_type_script_setup_true_lang-CKSPWIQL.js";/* empty css                                                                    */import{P as H}from"./Pagination-yOfjsBuR.js";import{u as J}from"./config-DNllFJyR.js";import{g as Q,u as k,m as R,w as X}from"./messageType-BdToDhus.js";import{P as Y}from"./PopFormElm-DSof3F4x.js";import{_ as Z}from"./DialogForm.vue_vue_type_script_setup_true_lang-Bmm-M6gU.js";import"./config-DU8_t5BN.js";const ee={class:"container"},ae={class:"content_wrapper"},te={class:"lyecs-form-table"},se={class:"table-container"},ne={class:"empty-warp"},le={key:0,class:"empty-bg"},oe={key:0,class:"pagination-con"},ie=K({__name:"List",setup(re){const x=J(),w=u([]),g=u(!0),y=u(0),z=u([]);u(!1);const i=O({page:1,size:x.get("page_size"),sort_field:"",sort_order:"",keyword:"",send_type:1}),V=u(1),M=t=>{console.log(t),i.send_type=t,d()},d=async()=>{g.value=!0;try{const t=await Q({...i});w.value=t.filter_result,y.value=t.total}catch(t){f.error(t.message)}finally{g.value=!1}};E(()=>{d()});const T=async()=>{S.confirm({title:"您确认要生成小程序消息模板吗？",onOk:async()=>{try{const t=await R();f.success(t.message),d()}catch(t){f.error(t.message)}finally{}}})},P=async()=>{S.confirm({title:"您确认要生成公众号模板消息吗？",onOk:async()=>{try{const t=await X();f.success(t.message),d()}catch(t){f.error(t.message)}finally{}}})},h=()=>{d()},B=({prop:t,order:a})=>{i.sort_field=t,i.sort_order=a=="ascending"?"asc":a=="descending"?"desc":"",d()},I=t=>{z.value=t.map(a=>a.message_id)};return(t,a)=>{const q=p("el-tab-pane"),C=p("el-button"),L=p("el-input"),N=p("el-space"),$=p("el-tabs"),c=p("el-table-column"),D=p("el-table"),F=p("a-spin");return m(),U("div",ee,[l("div",ae,[l("div",te,[a[10]||(a[10]=l("div",{class:"notice-warp"},[l("strong",null," 模板行业选择"),l("p",null,"主营行业：根据您的主营行业选择适合的服务类目"),l("p",null,"副营行业：商业服务 -> 软件/建站/技术开发"),l("strong",null," 生成小程序消息模板"),l("p",null,"请先添加服务类目《商业服务->软件/建站/技术开发》，否则模板导入不成功，点击会自动删除原有的小程序模板并生成新的模板！"),l("strong",null," 生成公众号模板消息"),l("p",null,"请先添加服务类目《商业服务->软件/建站/技术开发》，否则模板导入不成功，点击会自动删除原有的公众号模板并生成新的模板！")],-1)),s($,{modelValue:V.value,"onUpdate:modelValue":a[3]||(a[3]=e=>V.value=e),class:"lyecs-tabs","tab-position":"top",onTabChange:M},{default:n(()=>[s(q,{label:"发送给用户",name:1}),s(q,{label:"发送给商家",name:2}),l("div",null,[s(N,null,{default:n(()=>[s(C,{type:"primary",onClick:a[0]||(a[0]=e=>T())},{default:n(()=>a[6]||(a[6]=[A("生成小程序消息模板")])),_:1}),s(C,{type:"warning",onClick:a[1]||(a[1]=e=>P())},{default:n(()=>a[7]||(a[7]=[A("生成公众号模板消息")])),_:1}),s(L,{modelValue:i.keyword,"onUpdate:modelValue":a[2]||(a[2]=e=>i.keyword=e),placeholder:"输入关键字",onKeyup:j(h,["enter"]),clearable:"",onClear:h},{append:n(()=>[s(C,{onClick:h},{default:n(()=>a[8]||(a[8]=[l("span",{class:"iconfont icon-chakan1"},null,-1)])),_:1})]),_:1},8,["modelValue"])]),_:1})])]),_:1},8,["modelValue"]),l("div",se,[s(F,{spinning:g.value},{default:n(()=>[s(D,{data:w.value,loading:g.value,total:y.value,"row-key":"message_id",onSelectionChange:I,onSortChange:B},{empty:n(()=>[l("div",ne,[g.value?_("",!0):(m(),U("div",le,"暂无数据"))])]),default:n(()=>[s(c,{label:"消息类型",prop:"name"},{default:n(({row:e})=>[s(o(Y),{"org-value":e.name,"onUpdate:orgValue":r=>e.name=r,params:{id:e.message_id,field:"name"},requestApi:o(k),label:"消息类型",type:"input"},{default:n(()=>[l("div",null,G(e.name),1)]),_:2},1032,["org-value","onUpdate:orgValue","params","requestApi"])]),_:1}),s(c,{label:"消息描述",prop:"describe"}),s(c,{label:"站内信",width:"100"},{default:n(({row:e})=>[e.is_message>-1?(m(),b(o(v),{key:0,checked:e.is_message,"onUpdate:checked":r=>e.is_message=r,params:{id:e.message_id,field:"is_message"},requestApi:o(k)},null,8,["checked","onUpdate:checked","params","requestApi"])):_("",!0)]),_:1}),s(c,{label:"短信",width:"100"},{default:n(({row:e})=>[e.is_msg>-1?(m(),b(o(v),{key:0,checked:e.is_msg,"onUpdate:checked":r=>e.is_msg=r,params:{id:e.message_id,field:"is_msg"},requestApi:o(k)},null,8,["checked","onUpdate:checked","params","requestApi"])):_("",!0)]),_:1}),s(c,{label:"公众号",width:"100"},{default:n(({row:e})=>[e.is_wechat>-1?(m(),b(o(v),{key:0,checked:e.is_wechat,"onUpdate:checked":r=>e.is_wechat=r,params:{id:e.message_id,field:"is_wechat"},requestApi:o(k)},null,8,["checked","onUpdate:checked","params","requestApi"])):_("",!0)]),_:1}),s(c,{label:"小程序",width:"100"},{default:n(({row:e})=>[e.is_mini_program>-1?(m(),b(o(v),{key:0,checked:e.is_mini_program,"onUpdate:checked":r=>e.is_mini_program=r,params:{id:e.message_id,field:"is_mini_program"},requestApi:o(k)},null,8,["checked","onUpdate:checked","params","requestApi"])):_("",!0)]),_:1}),s(c,{width:100,fixed:"right",label:"操作"},{default:n(({row:e})=>[s(o(Z),{params:{act:"detail",id:e.message_id},isDrawer:"",path:"setting/config/messageType/Info",title:"编辑消息设置",width:"700px",onOkCallback:d},{default:n(()=>a[9]||(a[9]=[l("a",{class:"btn-link"},"编辑",-1)])),_:2},1032,["params"])]),_:1})]),_:1},8,["data","loading","total"])]),_:1},8,["spinning"]),y.value>0?(m(),U("div",oe,[s(o(H),{page:i.page,"onUpdate:page":a[4]||(a[4]=e=>i.page=e),size:i.size,"onUpdate:size":a[5]||(a[5]=e=>i.size=e),total:y.value,onCallback:d},null,8,["page","size","total"])])):_("",!0)])])])])}}}),ve=W(ie,[["__scopeId","data-v-b47e19e6"]]);export{ve as default};
