import{d as Q,i as _,G as W,C as q,q as X,c as m,e as a,j as v,f as p,g as d,w as o,b as s,L as Y,E as b,D as C,I as D,r as c,o as n,aN as I,n as Z,_ as ee}from"./index-CGYuOau0.js";/* empty css             */import"./index-B-GURfkM.js";import{_ as te}from"./DeleteRecord.vue_vue_type_script_setup_true_lang-BTFcBk5t.js";/* empty css                                                                    */import{P as ae}from"./Pagination-yOfjsBuR.js";import{i as se,r as oe}from"./format-DFT-VJzO.js";import{u as le}from"./config-DNllFJyR.js";import{a as ne,c as ie,e as re}from"./adminUser-0hufWCm0.js";import{M as de}from"./MobileCard-CkxM62lR.js";/* empty css                                               */import"./zh-cn-BAb8a1B9.js";import{T as pe}from"./Tag-DHW499gP.js";import{a as ce}from"./version-CpBOsX2d.js";import{_ as L}from"./DialogForm.vue_vue_type_script_setup_true_lang-Bmm-M6gU.js";import"./config-DU8_t5BN.js";const ue={class:"container"},me={class:"content_wrapper"},_e={class:"lyecs-table-list-warp"},ve={class:"list-table-tool lyecs-search-warp"},fe={class:"advanced-search-warp list-table-tool-row"},ye={class:"simple-form-warp"},ge={class:"simple-form-field"},be={class:"form-group"},he={class:"control-container"},ke={key:0,class:"simple-form-field"},Ce={class:"form-group"},Se={class:"control-container"},we={class:"simple-form-field"},ze={class:"form-group"},xe={class:"control-container"},Ve={key:0},De={class:"table-container"},Ue={class:"avatar-username"},Ne={key:0},Ae={key:0},Be={key:1},qe=["onClick"],Ie={class:"empty-warp"},Le={key:0,class:"empty-bg"},Me={key:0,class:"pagination-con"},Pe=Q({__name:"List",props:{id:{type:Number,default:0},act:{type:String,default:""},isDialog:Boolean},setup(M){const P=q(),T=le(),U=_([]),y=_(!0),h=_(0),g=_([]),r=W({page:1,size:T.get("page_size"),sort_field:"",sort_order:"",keyword:"",admin_user_type:"admin"}),i=_("admin"),$=l=>{i.value=l,r.admin_user_type=l,u()},u=async()=>{y.value=!0;try{const l=await ne({...r});U.value=l.filter_result,h.value=l.total}catch(l){D.error(l.message)}finally{y.value=!1}},K=l=>{P.push("/authority/admin_log/list?user_id="+l)},k=M,N=q().currentRoute.value.query,S=_(k.isDialog?k.act:String(N.act)),w=_(k.isDialog?k.id:Number(N.id));X(()=>{S.value&&(r.suppliers_id=w.value),u()});const z=()=>{u()},E=({prop:l,order:e})=>{r.sort_field=l,r.sort_order=e=="ascending"?"asc":e=="descending"?"desc":"",u()},F=async l=>{try{const e=await ie(l,{ids:g.value});D.success(e.message),u()}catch(e){D.error(e.message)}},O=l=>{g.value=l.map(e=>e.admin_id)};return(l,e)=>{const A=c("el-tab-pane"),R=c("el-tabs"),x=c("el-button"),j=c("el-input"),G=c("el-popconfirm"),f=c("el-table-column"),V=c("el-avatar"),B=c("el-divider"),H=c("el-table"),J=c("a-spin");return n(),m("div",ue,[a("div",me,[d(ce)()?(n(),v(R,{key:0,modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=t=>i.value=t),class:"lyecs-tabs","tab-position":"top",onTabChange:$},{default:o(()=>[s(A,{label:"管理员列表",name:"admin"}),s(A,{label:"店铺管理员列表",name:"shop"})]),_:1},8,["modelValue"])):p("",!0),a("div",_e,[a("div",ve,[a("div",fe,[a("div",ye,[a("div",ge,[a("div",be,[a("div",he,[s(j,{modelValue:r.keyword,"onUpdate:modelValue":e[1]||(e[1]=t=>r.keyword=t),name:"keyword",placeholder:i.value=="shop"?"输入员工名称":"输入管理员名称",onKeyup:Y(z,["enter"]),clearable:"",onClear:z},{append:o(()=>[s(x,{onClick:z},{default:o(()=>e[5]||(e[5]=[a("span",{class:"iconfont icon-chakan1"},null,-1)])),_:1})]),_:1},8,["modelValue","placeholder"])])])]),i.value!=="shop"?(n(),m("div",ke,[a("div",Ce,[a("div",Se,[s(d(L),{params:{act:"add",type:S.value?S.value:"",suppliers_id:w.value?w.value:0,admin_type:i.value},isDrawer:"",path:"authority/adminUser/Info",title:"添加管理员",width:"800px",onOkCallback:u},{default:o(()=>[s(x,{type:"primary"},{default:o(()=>e[6]||(e[6]=[b("添加管理员")])),_:1})]),_:1},8,["params"])])])])):p("",!0),a("div",we,[a("div",ze,[a("div",xe,[s(G,{title:"您确认要批量删除所选数据吗？",onConfirm:e[2]||(e[2]=t=>F("del"))},{reference:o(()=>[s(x,{disabled:g.value.length===0},{default:o(()=>e[7]||(e[7]=[b("批量删除")])),_:1},8,["disabled"])]),_:1}),g.value.length>0?(n(),m("span",Ve,[e[8]||(e[8]=b(" 已选择：")),a("b",null,C(g.value.length),1),e[9]||(e[9]=b(" 项 "))])):p("",!0)])])])])])]),a("div",De,[s(J,{spinning:y.value},{default:o(()=>[s(H,{data:U.value,loading:y.value,total:h.value,"row-key":"admin_id",onSelectionChange:O,onSortChange:E},{empty:o(()=>[a("div",Ie,[y.value?p("",!0):(n(),m("div",Le,"暂无数据"))])]),default:o(()=>[s(f,{type:"selection",width:"32"}),s(f,{width:"200",label:i.value=="shop"?"员工名称":"管理员名称",prop:"username"},{default:o(({row:t})=>[a("div",Ue,[d(I)(String(t.avatar))=="one"?(n(),v(V,{key:0,size:30,src:d(se)(t.avatar)},null,8,["src"])):d(I)(String(t.avatar))=="def"?(n(),v(V,{key:1,size:30,src:d(oe)(t.avatar)},null,8,["src"])):(n(),v(V,{key:2,size:30,src:""})),a("div",null,[a("div",null,C(t.username),1),i.value=="shop"&&t.is_admin==1?(n(),m("div",Ne,[s(d(pe),{transparent:!0,text:"店铺管理员"})])):p("",!0)])])]),_:1},8,["label"]),i.value!="shop"?(n(),v(f,{key:0,label:"权限组",prop:"role_name"},{default:o(({row:t})=>[a("span",{class:Z(t.role_name?"green":"gray")},C(t.role_name||"-"),3)]),_:1})):p("",!0),s(f,{label:"邮箱",prop:"email"},{default:o(({row:t})=>[a("span",null,C(t.email||"-"),1)]),_:1}),s(f,{label:"电话",prop:"mobile"},{default:o(({row:t})=>[t.mobile?(n(),m("span",Ae,[s(de,{mobile:t.mobile},null,8,["mobile"])])):(n(),m("span",Be,"--"))]),_:1}),s(f,{width:150,fixed:"right",label:"操作"},{default:o(({row:t})=>[s(d(L),{params:{act:"detail",id:t.admin_id,admin_type:i.value},isDrawer:"",path:"authority/adminUser/Info",title:i.value=="shop"?"编辑员工":"编辑管理员",width:"800px",onOkCallback:u},{default:o(()=>e[10]||(e[10]=[a("a",{class:"btn-link"},"编辑",-1)])),_:2},1032,["params","title"]),a("template",null,[s(B,{direction:"vertical"}),i.value!="shop"?(n(),m("a",{key:0,class:"btn-link",onClick:Te=>K(t.admin_id)},"日志",8,qe)):p("",!0)]),t.admin_id!=1?(n(),v(B,{key:0,direction:"vertical"})):p("",!0),t.admin_id!=1?(n(),v(d(te),{key:1,params:{id:t.admin_id},requestApi:d(re),onAfterDelete:u},{default:o(()=>e[11]||(e[11]=[b("删除 ")])),_:2},1032,["params","requestApi"])):p("",!0)]),_:1})]),_:1},8,["data","loading","total"])]),_:1},8,["spinning"]),h.value>0?(n(),m("div",Me,[s(d(ae),{page:r.page,"onUpdate:page":e[3]||(e[3]=t=>r.page=t),size:r.size,"onUpdate:size":e[4]||(e[4]=t=>r.size=t),total:h.value,onCallback:u},null,8,["page","size","total"])])):p("",!0)])])])])}}}),tt=ee(Pe,[["__scopeId","data-v-ed2053ef"]]);export{tt as default};
