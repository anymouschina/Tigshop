import{d as P,i as N,C as M,s as O,q as z,I as h,r as m,c as V,o as d,e as r,j as k,f as G,b as t,w as a,a3 as H,F as S,a as T,E as C,a4 as J,_ as K}from"./index-DrbzVNl6.js";import{a as Q,c as W}from"./productAttributesTpl-DNP5GILP.js";const X={class:"container"},Y={class:"content_wrapper"},Z={class:"lyecs-form-table"},ee={class:"attr-warp-box"},te=["onClick"],ae={class:"attr-warp-box"},le=["onClick"],oe={class:"attr-warp-box"},se=["onClick"],ne=P({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(U,{expose:L,emit:R}){const v=R,_=U,b=N(!0),$=M().currentRoute.value.query,x=N(_.isDialog?_.act:String($.act)),A=N(_.isDialog?_.id:Number($.id)),q=x.value==="add"?"create":"update",B=O(),l=N({});z(()=>{x.value==="detail"?F():b.value=!1});const F=async()=>{try{const o=await Q(x.value,{id:A.value});Object.assign(l.value,o)}catch(o){h.error(o.message),v("close")}finally{b.value=!1}},y=(o,e)=>{l.value.tplData[o].splice(e,1)},D=o=>{if(l.value.tplData)Array.isArray(l.value.tplData[o])||(l.value.tplData[o]=[]);else{let e={};e[o]=[],l.value.tplData=e}l.value.tplData[o].push({attrName:""})},I=async()=>{await B.value.validate();try{console.log(l.value),v("update:confirmLoading",!0);const o=await W(q,{id:A.value,...l.value});v("submitCallback",o),h.success("操作成功")}catch(o){h.error(o.message)}finally{v("update:confirmLoading",!1)}};return L({onFormSubmit:()=>{I()}}),(o,e)=>{const g=m("TigInput"),p=m("el-form-item"),c=m("el-space"),w=m("el-button"),j=m("el-form"),E=m("a-spin");return d(),V("div",X,[r("div",Y,[r("div",Z,[b.value?G("",!0):(d(),k(j,{key:0,ref_key:"formRef",ref:B,model:l.value,"label-width":"auto"},{default:a(()=>[t(p,{rules:[{required:!0,message:"属性模板名称不能为空!"}],label:"属性模板名称",prop:"tplName"},{default:a(()=>[t(g,{classType:"tig-form-input",modelValue:l.value.tplName,"onUpdate:modelValue":e[0]||(e[0]=s=>l.value.tplName=s)},null,8,["modelValue"])]),_:1}),t(p,{label:"属性名称",prop:"brandLogo"},{default:a(()=>{var s,u;return[r("div",ee,[(d(!0),V(S,null,T((u=(s=l.value)==null?void 0:s.tplData)==null?void 0:u.normal,(n,f)=>(d(),k(c,{class:"attr-row"},{default:a(()=>[t(g,{modelValue:n.attrName,"onUpdate:modelValue":i=>n.attrName=i,placeholder:"",width:"260px"},null,8,["modelValue","onUpdate:modelValue"]),r("div",{class:"iconfont icon-cha1 btn-remove",onClick:i=>y("normal",Number(f))},null,8,te)]),_:2},1024))),256)),t(c,{class:"attr-row"},{default:a(()=>[t(w,{onClick:e[1]||(e[1]=n=>D("normal"))},{default:a(()=>e[5]||(e[5]=[r("i",{class:"btn-ico"},"+",-1),C("增加新属性")])),_:1})]),_:1})])]}),_:1}),t(p,{label:"规格名称"},{default:a(()=>{var s,u;return[r("div",ae,[(d(!0),V(S,null,T((u=(s=l.value)==null?void 0:s.tplData)==null?void 0:u.spe,(n,f)=>(d(),k(c,{class:"attr-row"},{default:a(()=>[t(g,{modelValue:n.attrName,"onUpdate:modelValue":i=>n.attrName=i,placeholder:"",width:"260px"},null,8,["modelValue","onUpdate:modelValue"]),r("div",{class:"iconfont icon-cha1 btn-remove",onClick:i=>y("spe",Number(f))},null,8,le)]),_:2},1024))),256)),t(c,{class:"attr-row"},{default:a(()=>[t(w,{onClick:e[2]||(e[2]=n=>D("spe"))},{default:a(()=>e[6]||(e[6]=[r("i",{class:"btn-ico"},"+",-1),C("增加新规格")])),_:1})]),_:1})])]}),_:1}),t(p,{label:"附加规格"},{default:a(()=>{var s,u;return[r("div",oe,[(d(!0),V(S,null,T((u=(s=l.value)==null?void 0:s.tplData)==null?void 0:u.extra,(n,f)=>(d(),k(c,{class:"attr-row"},{default:a(()=>[t(g,{modelValue:n.attrName,"onUpdate:modelValue":i=>n.attrName=i,placeholder:"",width:"260px"},null,8,["modelValue","onUpdate:modelValue"]),r("div",{class:"iconfont icon-cha1 btn-remove",onClick:i=>y("extra",Number(f))},null,8,se)]),_:2},1024))),256)),t(c,{class:"attr-row"},{default:a(()=>[t(w,{onClick:e[3]||(e[3]=n=>D("extra"))},{default:a(()=>e[7]||(e[7]=[r("i",{class:"btn-ico"},"+",-1),C("增加附加规格")])),_:1})]),_:1})])]}),_:1}),H(t(p,{"wrapper-col":{offset:4,span:16}},{default:a(()=>[t(w,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:e[4]||(e[4]=s=>I())},{default:a(()=>e[8]||(e[8]=[C("提交 ")])),_:1},512)]),_:1},512),[[J,!U.isDialog]])]),_:1},8,["model"])),t(E,{spinning:b.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}}),de=K(ne,[["__scopeId","data-v-dfac447c"]]);export{de as default};
