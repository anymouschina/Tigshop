import{d as B,K as O,i as _,G as T,q as $,r as c,c as h,o as b,e as o,b as a,w as s,M as K,g as n,E as f,f as x,D as v,I,_ as L}from"./index-DrbzVNl6.js";/* empty css             */import"./index-CeQDmMxd.js";import{P as y}from"./PopFormElm-BZp1_Wme.js";import{_ as E}from"./Switch.vue_vue_type_script_setup_true_lang-C5nzofSO.js";import{D as M}from"./DeleteRecord-MR4vGqLl.js";/* empty css                                                                    */import{P as j}from"./Pagination-wR9huHyl.js";import{_ as H}from"./Image.vue_vue_type_script_setup_true_lang-BWzCs9jv.js";import{b as g,d as J,g as Q,c as W}from"./userRank-Cwfy5SLP.js";import{_ as V}from"./DialogForm.vue_vue_type_script_setup_true_lang-DqYSRv0_.js";import"./format-CRgx78oe.js";const X={class:"container"},Y={class:"content_wrapper"},Z={class:"lyecs-table-list-warp"},ee={class:"list-table-tool lyecs-search-warp"},te={class:"advanced-search-warp list-table-tool-row"},ae={class:"simple-form-warp"},oe={class:"simple-form-field"},se={class:"form-group"},ne={class:"control-container"},le={class:"simple-form-field"},ie={class:"form-group"},re={class:"control-container"},de={class:"simple-form-field"},pe={class:"form-group"},ce={class:"control-container"},ue={key:0},me={class:"table-container"},_e={style:{position:"relative"}},fe={class:"empty-warp"},ve={key:0,class:"empty-bg"},ge={key:0,class:"pagination-con"},ke=B({__name:"List",setup(he){const q=O(),P=_([]),u=_(!0),k=_(0),m=_([]);_(!1);const i=T({page:1,size:q.get("pageSize"),sortField:"",sortOrder:"",keyword:""}),p=async()=>{u.value=!0;try{const l=await Q({...i});P.value=l.records,k.value=l.total}catch(l){I.error(l.message)}finally{u.value=!1}};$(()=>{p()});const U=()=>{p()},A=({prop:l,order:t})=>{i.sortField=l,i.sortOrder=t=="ascending"?"asc":t=="descending"?"desc":"",p()},C=async l=>{try{const t=await W(l,{ids:m.value});I.success("操作成功"),await p()}catch(t){I.error(t.message)}},N=l=>{m.value=l.map(t=>t.rankId)};return(l,t)=>{const w=c("el-button"),S=c("TigInput"),G=c("el-popconfirm"),z=c("el-form"),r=c("el-table-column"),D=c("el-divider"),R=c("el-table"),F=c("a-spin");return b(),h("div",X,[o("div",Y,[o("div",Z,[o("div",ee,[t[9]||(t[9]=o("div",{class:"notice-warp"},[o("p",null,"提示：特殊会员组不会随会员等级积分的变化而变化。")],-1)),a(z,{model:i},{default:s(()=>[o("div",te,[o("div",ae,[o("div",oe,[o("div",se,[o("div",ne,[a(S,{modelValue:i.keyword,"onUpdate:modelValue":t[0]||(t[0]=e=>i.keyword=e),name:"keyword",placeholder:"输入等级名称",onKeyup:K(U,["enter"])},{append:s(()=>[a(w,{onClick:U},{default:s(()=>t[4]||(t[4]=[o("span",{class:"iconfont icon-chakan1"},null,-1)])),_:1})]),_:1},8,["modelValue"])])])]),o("div",le,[o("div",ie,[o("div",re,[a(n(V),{params:{act:"add"},isDrawer:"",path:"user/userRank/Info",title:"添加会员等级",width:"600px",onOkCallback:p},{default:s(()=>[a(w,{type:"primary"},{default:s(()=>t[5]||(t[5]=[f("添加会员等级")])),_:1})]),_:1})])])]),o("div",de,[o("div",pe,[o("div",ce,[a(G,{title:"您确认要批量删除所选数据吗？",onConfirm:t[1]||(t[1]=e=>C("del"))},{reference:s(()=>[a(w,{disabled:m.value.length===0},{default:s(()=>t[6]||(t[6]=[f("批量删除")])),_:1},8,["disabled"])]),_:1}),m.value.length>0?(b(),h("span",ue,[t[7]||(t[7]=f(" 已选择：")),o("b",null,v(m.value.length),1),t[8]||(t[8]=f(" 项 "))])):x("",!0)])])])])])]),_:1},8,["model"])]),o("div",me,[a(F,{spinning:u.value},{default:s(()=>[a(R,{data:P.value,loading:u.value,total:k.value,"row-key":"rankId",onSelectionChange:N,onSortChange:A},{empty:s(()=>[o("div",fe,[u.value?x("",!0):(b(),h("div",ve,"暂无数据"))])]),default:s(()=>[a(r,{type:"selection",width:"32"}),a(r,{width:200,label:"等级名称",prop:"rankName"},{default:s(({row:e})=>[o("div",_e,[a(n(y),{"org-value":e.rankName,"onUpdate:orgValue":d=>e.rankName=d,max:10,params:{id:e.rankId,field:"rankName"},requestApi:n(g),label:"等级名称",type:"textarea"},{default:s(()=>[o("div",null,v(e.rankName),1)]),_:2},1032,["org-value","onUpdate:orgValue","params","requestApi"])])]),_:1}),a(r,{label:"等级标志"},{default:s(({row:e})=>[a(n(H),{src:e.rankIco,fit:"contain",style:{height:"25px",width:"60px"}},null,8,["src"])]),_:1}),a(r,{label:"积分下限"},{default:s(({row:e})=>[a(n(y),{"org-value":e.minGrowthPoints,"onUpdate:orgValue":d=>e.minGrowthPoints=d,params:{id:e.rankId,field:"minGrowthPoints"},requestApi:n(g),label:"积分下限",type:"input"},{default:s(()=>[o("div",null,v(e.minGrowthPoints||"0"),1)]),_:2},1032,["org-value","onUpdate:orgValue","params","requestApi"])]),_:1}),a(r,{label:"积分上限"},{default:s(({row:e})=>[a(n(y),{"org-value":e.maxGrowthPoints,"onUpdate:orgValue":d=>e.maxGrowthPoints=d,params:{id:e.rankId,field:"maxGrowthPoints"},requestApi:n(g),label:"积分上限",type:"input"},{default:s(()=>[o("div",null,v(e.maxGrowthPoints||"-"),1)]),_:2},1032,["org-value","onUpdate:orgValue","params","requestApi"])]),_:1}),a(r,{label:"折扣(%)"},{default:s(({row:e})=>[a(n(y),{"org-value":e.discount,"onUpdate:orgValue":d=>e.discount=d,minNum:1,maxNum:100,params:{id:e.rankId,field:"discount"},requestApi:n(g),label:"折扣(%)",type:"input"},{default:s(()=>[o("div",null,v(e.discount||"0"),1)]),_:2},1032,["org-value","onUpdate:orgValue","params","requestApi"])]),_:1}),a(r,{label:"等级类型",prop:"rankTypeName"}),a(r,{label:"显示价格",prop:"showPrice"},{default:s(({row:e})=>[a(n(E),{checked:e.showPrice,"onUpdate:checked":d=>e.showPrice=d,params:{id:e.rankId,field:"showPrice"},requestApi:n(g)},null,8,["checked","onUpdate:checked","params","requestApi"])]),_:1}),a(r,{width:150,fixed:"right",label:"操作"},{default:s(({row:e})=>[a(n(V),{params:{act:"detail",id:e.rankId},isDrawer:"",path:"user/userRank/Info",title:"编辑会员等级",width:"600px",onOkCallback:p},{default:s(()=>t[10]||(t[10]=[o("a",{class:"btn-link"},"编辑",-1)])),_:2},1032,["params"]),a(D,{direction:"vertical"}),a(n(M),{params:{id:e.rankId},requestApi:n(J),onAfterDelete:p},{default:s(()=>t[11]||(t[11]=[f("删除 ")])),_:2},1032,["params","requestApi"])]),_:1})]),_:1},8,["data","loading","total"])]),_:1},8,["spinning"]),k.value>0?(b(),h("div",ge,[a(n(j),{page:i.page,"onUpdate:page":t[2]||(t[2]=e=>i.page=e),size:i.size,"onUpdate:size":t[3]||(t[3]=e=>i.size=e),total:k.value,onCallback:p},null,8,["page","size","total"])])):x("",!0)])])])])}}}),Se=L(ke,[["__scopeId","data-v-1353afa5"]]);export{Se as default};
