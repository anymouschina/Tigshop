import{y as N,d as G,i as p,s as H,C as K,dC as $,q as J,r as d,c as a,o,n as Q,e as t,f as r,b as n,E as v,j as W,w as m,D as C,F as X,a as Y,g as B,I as j,dF as Z,dN as ee,R as te,_ as se}from"./index-CGYuOau0.js";import{u as oe}from"./config-DNllFJyR.js";import{u as le}from"./theme-pPmOEjl9.js";import{u as ae}from"./menus-twiYEIYr.js";import{F as ne}from"./UploadAvatar.vue_vue_type_style_index_0_scoped_9bfcfc35_lang-CjXfTDg5.js";const ie="/admin/assets/shop_logo_b-DK_MbwV3.png",re="/admin/assets/shop_logo-0stPotOH.png",ue=()=>N({url:"merchant/shop/my_shop",method:"get",noErrorTip:!0}),pe=c=>N({url:"merchant/shop/create",method:"post",data:c}),de={key:0,class:"warp-info"},me={class:"back-btn"},ce={class:"right-item"},fe={key:0,class:"sub-title-name"},ve={key:1,class:"shop-list"},ge={class:"left-item"},_e={class:"left-info"},he={class:"left-title"},ye={key:0},Se={key:2,class:"shop-list shop-list-min-height"},ke=["onClick"],be={class:"left-item"},Ce={class:"left-info"},Ie={class:"left-title"},xe={key:3,class:"shop-list shop-list-min-height"},we={key:1},Fe=G({__name:"SelectShop",props:{isIndex:{type:Boolean,default:!1},selectShopFlag:{type:Boolean,default:!1}},emits:["closePopup","update:selectShopFlag"],setup(c,{emit:R}){const L=c,f=p({shop_title:"",shop_logo:""}),I=p(!1),U=async()=>{await x.value.validate();try{I.value=!0;const s=await pe({...f.value});j.success(s.message),h.value=!1,await P()}catch(s){j.error(s.message)}finally{I.value=!1}},u=p(!0),x=H(),h=p(!1),w=R,q=K(),F=async s=>{localStorage.setItem("shopId",String(s)),s===0?localStorage.setItem("adminType","admin"):localStorage.setItem("adminType","shop");const e=$(),g=oe(),k=Z();le(),e.updateUserInfo(),g.updateConfig(),ee.success({message:"登录成功",placement:"top",duration:1.5,description:"您好，欢迎回来"}),L.isIndex&&w("closePopup");let _=await ae();k.mainMenu=_,q.push("/"+(_?_[0].route_link:"")),localStorage.setItem("lastOpenTime",String(te().unix()))},{logout:D}=$(),E=()=>{w("update:selectShopFlag",!1),D()},y=p([]),i=p({}),S=p(""),P=async()=>{try{u.value=!0;const s=await ue();s.filter_result&&(y.value=s.filter_result),s.userinfo&&(i.value=s.userinfo)}catch{}finally{u.value=!1}};return J(()=>{localStorage.getItem("accessToken"),S.value=localStorage.getItem("adminType"),u.value=!1}),(s,e)=>{var T,M,V;const g=d("el-button"),k=d("a-spin"),_=d("el-image"),z=d("el-empty"),O=d("el-input"),b=d("el-form-item"),A=d("el-form");return o(),a("div",{class:Q(["select-shop-warp",{"have-bor":!c.isIndex}])},[h.value?(o(),a("div",we,[n(A,{"label-width":"70",ref_key:"formRef",ref:x,model:f.value,class:"demo-ruleForm","status-icon":""},{default:m(()=>[n(b,{rules:[{required:!0,message:"店铺名称不能为空!"}],label:"店铺名称",prop:"shop_title"},{default:m(()=>[n(O,{modelValue:f.value.shop_title,"onUpdate:modelValue":e[3]||(e[3]=l=>f.value.shop_title=l)},null,8,["modelValue"])]),_:1}),n(b,{label:"店铺logo",prop:"shop_logo"},{default:m(()=>[n(B(ne),{photo:f.value.shop_logo,"onUpdate:photo":e[4]||(e[4]=l=>f.value.shop_logo=l)},null,8,["photo"])]),_:1}),n(b,{label:""},{default:m(()=>[n(g,{type:"primary",onClick:e[5]||(e[5]=l=>U())},{default:m(()=>e[15]||(e[15]=[v(" 创建 ")])),_:1}),n(g,{onClick:e[6]||(e[6]=l=>h.value=!1)},{default:m(()=>e[16]||(e[16]=[v("取消")])),_:1})]),_:1})]),_:1},8,["model"])])):(o(),a("div",de,[t("div",me,[c.isIndex?r("",!0):(o(),a("div",{key:0,class:"bark",onClick:e[0]||(e[0]=l=>E())},e[7]||(e[7]=[t("i",{class:"iconfont-admin icon-zuojiantou-copy"},null,-1),v("返回")]))),t("div",ce,[c.isIndex?(o(),W(g,{key:0,onClick:e[1]||(e[1]=l=>h.value=!0),type:"primary"},{default:m(()=>e[8]||(e[8]=[v("创建新店铺")])),_:1})):r("",!0)])]),e[14]||(e[14]=t("div",{class:"title-name"},[t("div",{class:"left-title"},"您可以进入以下管理后台")],-1)),i.value!==""&&((T=i.value)!=null&&T.username)?(o(),a("div",fe,[t("span",null,C((M=i.value)==null?void 0:M.username),1),e[9]||(e[9]=v(" 已绑定了以下店铺，您可以进入以下任一店铺 "))])):r("",!0),n(k,{spinning:u.value,style:{width:"100%","margin-top":"100px",height:"200px"}},null,8,["spinning"]),!u.value&&S.value==="admin"?(o(),a("div",ve,[t("div",{onClick:e[2]||(e[2]=l=>F(0)),class:"shop-item",style:{"border-color":"#ffeac7","background-color":"#fff4e6",color:"#4e4e4e"}},[t("div",ge,[e[11]||(e[11]=t("img",{class:"left-image",src:ie,alt:""},null,-1)),t("div",_e,[t("div",he,[e[10]||(e[10]=v(" 管理后台 ")),i.value&&i.value.username&&i.value.username!==""?(o(),a("span",ye,"（"+C((V=i.value)==null?void 0:V.username)+"）",1)):r("",!0)])])]),e[12]||(e[12]=t("div",{class:"right-item"},[t("span",{class:"iconfont-admin icon-login-youjiantou"})],-1))])])):r("",!0),y.value.length>0?(o(),a("div",Se,[u.value?r("",!0):(o(!0),a(X,{key:0},Y(y.value,l=>(o(),a("div",{onClick:Te=>F(l.shop_id),class:"shop-item"},[t("div",be,[n(_,{class:"left-image",src:B(re)},null,8,["src"]),t("div",Ce,[t("div",Ie,C(l.shop_title),1)])]),e[13]||(e[13]=t("div",{class:"right-item"},[t("span",{class:"iconfont-admin icon-login-youjiantou"})],-1))],8,ke))),256))])):r("",!0),!u.value&&y.value.length==0&&S.value!="admin"?(o(),a("div",xe,[n(z,{description:"您还没有已绑定的店铺哦～"})])):r("",!0)]))],2)}}}),Ne=se(Fe,[["__scopeId","data-v-2c1d5a73"]]);export{Ne as S};
