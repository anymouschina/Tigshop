import{d as D,i as m,C as U,s as F,q as I,I as _,r as n,c as O,o as V,e as L,j as z,f as M,w as r,b as o,E as $}from"./index-CGYuOau0.js";import{g as A}from"./languagesList-4F0M2hMq.js";import{c as G,a as H,u as J}from"./translationContent-C0Nq8agy.js";const K={class:"container"},P={class:"content_wrapper"},Q={class:"lyecs-form-table"},ee=D({__name:"Info",props:{id:{type:Number,default:0},data_type:{type:Number,default:0},act:{type:String,default:""},translation_name:{type:String,default:""},isDialog:{type:Boolean,default:!1}},emits:["submitCallback","update:confirmLoading","close"],setup(x,{expose:k,emit:C}){const i=C,s=x,p=m(!0),y=U().currentRoute.value.query,f=m(s.isDialog?s.act:String(y.act)),g=m(s.isDialog?s.id:Number(y.id)),E=f.value==="add"?"create":"update",v=F(),l=m({translation_name:s.translation_name,data_type:s.data_type,items:[]});I(()=>{f.value==="detail"?N():(p.value=!1,b())});const N=async()=>{try{const a=await G(f.value,{id:g.value});Object.assign(l.value,a.item),b()}catch(a){_.error(a.message),i("close")}finally{p.value=!1}},u=m([]),b=async()=>{try{const a=await A({is_enabled:1,size:-1});a.filter_result.forEach(e=>{e.translation_value=""}),Object.assign(u.value,a.filter_result),f.value==="detail"&&l.value.items.length>0&&l.value.items.forEach(e=>{u.value.forEach(t=>{e.locale_id===t.id&&(t.translation_value=e.translation_value)})})}catch(a){_.error(a.message),i("close")}finally{p.value=!1}},S=async a=>{await v.value.validate();try{u.value.forEach(async e=>{let t={code:e.locale_code,text:a};const c=await H(t);e.translation_value=c.translation.Translation})}catch(e){_.error(e.message)}},T=a=>{let e=[];return a.forEach(t=>{let c={locale_id:t.id,translation_value:t.translation_value};e.push(c)}),e},B=async()=>{await v.value.validate();try{i("update:confirmLoading",!0);const a=await J(E,{id:g.value,...l.value,items:T(u.value)});i("submitCallback",a),_.success(a.message)}catch(a){_.error(a.message)}finally{i("update:confirmLoading",!1)}};return k({onFormSubmit:()=>{B()}}),(a,e)=>{const t=n("el-input"),c=n("el-button"),h=n("el-form-item"),w=n("el-table-column"),R=n("el-table"),j=n("el-form");return V(),O("div",K,[L("div",P,[L("div",Q,[p.value?M("",!0):(V(),z(j,{key:0,ref_key:"formRef",ref:v,model:l.value,"label-width":"auto"},{default:r(()=>[o(h,{prop:"translation_name",label:"翻译原文：",rules:[{required:!0,message:"翻译原文不能为空!"}]},{default:r(()=>[o(t,{type:"text",maxlength:"60",modelValue:l.value.translation_name,"onUpdate:modelValue":e[0]||(e[0]=d=>l.value.translation_name=d),style:{width:"300px"},class:"mr10"},null,8,["modelValue"]),o(c,{type:"primary",onClick:e[1]||(e[1]=d=>S(l.value.translation_name))},{default:r(()=>e[2]||(e[2]=[$("一键生成翻译")])),_:1})]),_:1}),o(h,{prop:"language",label:"翻译列表："},{default:r(()=>[o(R,{data:u.value,style:{width:"100%"}},{default:r(()=>[o(w,{prop:"language",label:"语言",width:"180"}),o(w,{prop:"translation_value",label:"翻译内容"},{default:r(({row:d})=>[o(t,{type:"text",modelValue:d.translation_value,"onUpdate:modelValue":q=>d.translation_value=q},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1},8,["model"]))])])])}}});export{ee as default};
