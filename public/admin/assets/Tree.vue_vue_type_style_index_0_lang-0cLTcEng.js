import{d as G,K as L,i as g,G as q,q as j,r as c,c as k,o as w,e as o,b as s,w as n,M as H,E as h,g as i,f as I,D as A,I as z}from"./index-DrbzVNl6.js";/* empty css             */import"./index-CeQDmMxd.js";import{P as J}from"./PopFormElm-BZp1_Wme.js";import{_ as O}from"./Switch.vue_vue_type_script_setup_true_lang-C5nzofSO.js";import{D as Q}from"./DeleteRecord-MR4vGqLl.js";/* empty css                                                                    */import{P as W}from"./Pagination-wR9huHyl.js";import{u as N,d as X,g as C,b as Y}from"./pcNavigation-YlzjlM0Y.js";import{_ as T}from"./DialogForm.vue_vue_type_script_setup_true_lang-DqYSRv0_.js";const Z={class:"container"},ee={class:"lyecs-table-list-warp"},te={class:"list-table-tool lyecs-search-warp"},ae={class:"advanced-search-warp list-table-tool-row"},se={class:"simple-form-warp"},oe={class:"simple-form-field"},ne={class:"form-group"},le={class:"control-container"},ie={class:"simple-form-field"},re={class:"form-group"},de={class:"control-container"},pe={class:"simple-form-field"},ce={class:"form-group"},ue={class:"control-container"},me={key:0},_e={class:"table-container"},fe={class:"empty-warp"},ve={key:0,class:"empty-bg"},ge={key:0,class:"pagination-con"},qe=G({__name:"Tree",setup(he){const U=L(),x=g([]),u=g(!0),y=g(0),m=g([]),r=q({page:1,size:U.get("pageSize"),sortField:"",sortOrder:"",keyword:"",type:2,parentId:0}),_=q({}),d=async()=>{u.value=!0;try{const t=await C({...r});x.value=t.records,y.value=t.total}catch(t){z.error(t.message)}finally{u.value=!1}},V=async(t,e,l)=>{_[t.id]={},_[t.id].resolve=l,_[t.id].expandCount=0;const f=await C({page:1,parentId:t.id,type:2,size:1e3});l(f.records)},D=async(t,e)=>{const l=_[t.id];if(l.expandCount++,e&&l.expandCount>1&&!l.prevStatus){const f=await C({page:1,parentId:t.id,type:2,size:1e3});l.resolve(f.records)}l.prevStatus=e},b=g(),P=async t=>{const e=_[t.parentId];if(e){const l=await C({page:1,parentId:t.parentId,type:2,size:1e3});b.value.store.states.lazyTreeNodeMap.value[t.parentId].length>1?b.value.store.states.lazyTreeNodeMap[t.parentId]=[]:b.value.store.states.lazyTreeNodeMap.value[t.parentId]=[],e.resolve(l.records)}else d()};j(()=>{d()});const B=({prop:t,order:e})=>{r.sortField=t,r.sortOrder=e=="ascending"?"asc":e=="descending"?"desc":"",d()},S=()=>{d()},F=async t=>{try{const e=await Y(t,{ids:m.value});z.success("操作成功"),d()}catch(e){z.error(e.message)}},M=t=>{m.value=t.map(e=>e.id)};return(t,e)=>{const l=c("el-button"),f=c("TigInput"),E=c("el-popconfirm"),p=c("el-table-column"),R=c("el-divider"),K=c("el-table"),$=c("a-spin");return w(),k("div",Z,[o("div",ee,[o("div",te,[o("div",ae,[o("div",se,[o("div",oe,[o("div",ne,[o("div",le,[s(f,{modelValue:r.keyword,"onUpdate:modelValue":e[0]||(e[0]=a=>r.keyword=a),name:"keyword",placeholder:"输入导航栏名称",onKeyup:H(S,["enter"]),clearable:"",onClear:S},{append:n(()=>[s(l,{onClick:S},{default:n(()=>e[4]||(e[4]=[o("span",{class:"iconfont icon-chakan1"},null,-1)])),_:1})]),_:1},8,["modelValue"])])])]),o("div",ie,[o("div",re,[o("div",de,[s(i(T),{params:{act:"add",type:2},title:"添加顶部小导航",isDrawer:"",path:"decorate/pcNavigation/Info",width:"560px",onOkCallback:d},{default:n(()=>[s(l,{type:"primary"},{default:n(()=>e[5]||(e[5]=[h("添加顶部小导航")])),_:1})]),_:1})])])]),o("div",pe,[o("div",ce,[o("div",ue,[s(E,{title:"您确认要批量删除所选数据吗？",onConfirm:e[1]||(e[1]=a=>F("del"))},{reference:n(()=>[s(l,{disabled:m.value.length===0},{default:n(()=>e[6]||(e[6]=[h("批量删除")])),_:1},8,["disabled"])]),_:1}),m.value.length>0?(w(),k("span",me,[e[7]||(e[7]=h(" 已选择：")),o("b",null,A(m.value.length),1),e[8]||(e[8]=h(" 项 "))])):I("",!0)])])])])])]),o("div",_e,[s($,{spinning:u.value},{default:n(()=>[s(K,{data:x.value,indent:30,load:V,"tree-props":{children:"children",hasChildren:"hasChildren"},lazy:"",loading:u.value,total:y.value,"row-key":"id",onSelectionChange:M,onExpandChange:D,onSortChange:B,ref_key:"tableRef",ref:b},{empty:n(()=>[o("div",fe,[u.value?I("",!0):(w(),k("div",ve,"暂无数据"))])]),default:n(()=>[s(p,{type:"selection",width:"32"}),s(p,{width:200,label:"名称",prop:"title"}),s(p,{width:100,label:"位置",prop:"typeName"}),s(p,{label:"是否显示",prop:"isShow"},{default:n(({row:a})=>[s(i(O),{checked:a.isShow,"onUpdate:checked":v=>a.isShow=v,params:{id:a.id,field:"isShow"},requestApi:i(N)},null,8,["checked","onUpdate:checked","params","requestApi"])]),_:1}),s(p,{label:"是否新窗口"},{default:n(({row:a})=>[s(i(O),{checked:a.isBlank,"onUpdate:checked":v=>a.isBlank=v,params:{id:a.id,field:"isBlank"},requestApi:i(N)},null,8,["checked","onUpdate:checked","params","requestApi"])]),_:1}),s(p,{label:"排序",prop:"sortOrder",sortable:"custom"},{default:n(({row:a})=>[s(i(J),{"org-value":a.sortOrder,"onUpdate:orgValue":v=>a.sortOrder=v,params:{id:a.id,field:"sortOrder"},requestApi:i(N),extra:"默认值为50，数值越小，排序越靠前",label:"排序",type:"integer"},{default:n(()=>[o("div",null,A(a.sortOrder),1)]),_:2},1032,["org-value","onUpdate:orgValue","params","requestApi"])]),_:1}),s(p,{width:150,fixed:"right",label:"操作"},{default:n(({row:a})=>[s(i(T),{params:{act:"detail",type:2,id:a.id},title:"编辑商城顶部小导航栏",isDrawer:"",path:"decorate/pcNavigation/Info",width:"560px",onOkCallback:P},{default:n(()=>e[9]||(e[9]=[o("a",{class:"btn-link"},"编辑",-1)])),_:2},1032,["params"]),s(R,{direction:"vertical"}),s(i(Q),{params:{id:a.id},requestApi:i(X),onAfterDelete:d},{default:n(()=>e[10]||(e[10]=[h("删除 ")])),_:2},1032,["params","requestApi"])]),_:1})]),_:1},8,["data","loading","total"])]),_:1},8,["spinning"]),y.value>0?(w(),k("div",ge,[s(i(W),{page:r.page,"onUpdate:page":e[2]||(e[2]=a=>r.page=a),size:r.size,"onUpdate:size":e[3]||(e[3]=a=>r.size=a),total:y.value,onCallback:d},null,8,["page","size","total"])])):I("",!0)])])])}}});export{qe as _};
