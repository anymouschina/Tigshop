import{d as Y,i as C,C as Z,s as ee,q as le,I as S,r as f,c as w,o as b,e as u,j as L,f as x,b as l,w as a,a0 as ae,E as d,g as q,bh as te,F as ie,a as ne,D as $,l as oe,a1 as pe,_ as se}from"./index-CGYuOau0.js";import{a as re,c as de,e as ue}from"./shippingTpl-CX3c57UO.js";import"./index-B-GURfkM.js";/* empty css                                                                  */import{_ as _e}from"./Checkbox.vue_vue_type_script_setup_true_lang-CnkYJctL.js";import{u as fe}from"./region-DycKrsYv.js";import{_ as F}from"./DialogForm.vue_vue_type_script_setup_true_lang-Bmm-M6gU.js";import"./region-dYomvalu.js";const me={class:"container"},ge={class:"content_wrapper"},ce={class:"lyecs-form-table"},be={key:0},he={class:"shipping-method-style"},ve={class:"flex"},Ve={key:0,class:"table-style"},ye={class:"title-style"},we={class:"ysd"},ke={style:{flex:"1"}},Ue=Y({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(j,{expose:O,emit:z}){fe().getRegionList();const k=z,v=j,V=C(!0),D=Z().currentRoute.value.query,y=C(v.isDialog?v.act:String(D.act)),N=C(v.isDialog?v.id:Number(D.id)),A=y.value==="add"?"create":"update",I=ee(),o=C({shipping_tpl_info:[],is_default:0,is_free:0,pricing_type:1}),g=(i,e,s)=>{e?e.length>0&&Number(e)<=0?s(new Error("需大于0")):s():s(new Error("请输入"))},M=async()=>{try{const i=await de(y.value,{id:N.value});i.item.shipping_tpl_info.map((e,s)=>{e.is_checked=1,e.default_tpl_info==null&&(e.default_tpl_info=T(e.shipping_type_id,e.shipping_type_name,1),e.area_tpl_info=[],e.is_checked=0)}),Object.assign(o.value,i.item)}catch(i){S.error(i.message),k("close")}finally{V.value=!1}},G=i=>{for(let e=0;e<o.value.shipping_tpl_info.length;e++);},H=(i,e)=>{o.value.shipping_tpl_info&&o.value.shipping_tpl_info[i].area_tpl_info&&o.value.shipping_tpl_info[i].area_tpl_info.splice(e,1)},J=i=>{i.area_tpl_info.push(T(i.shipping_type_id,i.shipping_type_name,0))},K=i=>{o.value.shipping_tpl_info[i.index].area_tpl_info[i.itemIndex].region_data.area_region_names=i.regionNames,o.value.shipping_tpl_info[i.index].area_tpl_info[i.itemIndex].region_data.area_regions=i.regionIds},T=(i,e,s)=>({shipping_tpl_id:0,shipping_type_id:i,is_default:s,start_number:"",start_price:"",add_number:"",add_price:"",free_price:"",region_data:{area_regions:[],area_region_names:[]},shipping_type_name:e});le(async()=>{await B(),y.value==="detail"?await M():V.value=!1});const B=async()=>{try{const i=await re();console.log(i),i.shipping_tpl_info.forEach(e=>{e.is_checked=1,e.default_tpl_info==null&&(e.default_tpl_info=T(e.shipping_type_id,e.shipping_type_name,1),e.area_tpl_info=[],e.is_checked=0)}),o.value.shipping_tpl_info=i.shipping_tpl_info}catch(i){S.error(i.message)}finally{V.value=!1}},E=async()=>{await I.value.validate();try{k("update:confirmLoading",!0);const i=await ue(A,{id:N.value,...o.value});k("submitCallback",i),S.success(i.message)}catch(i){S.error(i.message)}finally{k("update:confirmLoading",!1)}};return O({onFormSubmit:()=>{E()}}),(i,e)=>{const s=f("el-input"),r=f("el-form-item"),p=f("el-option"),P=f("el-select"),h=f("el-radio"),R=f("el-radio-group"),U=f("el-button"),c=f("el-table-column"),Q=f("el-table"),W=f("el-form"),X=f("a-spin");return b(),w("div",me,[u("div",ge,[u("div",ce,[V.value?x("",!0):(b(),L(W,{key:0,ref_key:"formRef",ref:I,model:o.value,"label-width":"auto"},{default:a(()=>[l(r,{rules:[{required:!0,message:"模板名称不能为空!"}],label:"模板名称",prop:"shipping_tpl_name"},{default:a(()=>[l(s,{modelValue:o.value.shipping_tpl_name,"onUpdate:modelValue":e[0]||(e[0]=n=>o.value.shipping_tpl_name=n)},null,8,["modelValue"])]),_:1}),l(r,{label:"发货时间",prop:"shipping_time"},{default:a(()=>[l(P,{modelValue:o.value.shipping_time,"onUpdate:modelValue":e[1]||(e[1]=n=>o.value.shipping_time=n),placeholder:"请选择..",style:{width:"100%"}},{default:a(()=>[l(p,{label:"4小时内",value:"4小时内"}),l(p,{label:"8小时内",value:"8小时内"}),l(p,{label:"12小时内",value:"12小时内"}),l(p,{label:"16小时内",value:"16小时内"}),l(p,{label:"20小时内",value:"20小时内"}),l(p,{label:"1天内",value:"1天内"}),l(p,{label:"2天内",value:"2天内"}),l(p,{label:"3天内",value:"3天内"}),l(p,{label:"4天内",value:"4天内"}),l(p,{label:"5天内",value:"5天内"}),l(p,{label:"7天内",value:"7天内"}),l(p,{label:"8天内",value:"8天内"}),l(p,{label:"10天内",value:"10天内"}),l(p,{label:"12天内",value:"12天内"}),l(p,{label:"15天内",value:"15天内"}),l(p,{label:"17天内",value:"17天内"}),l(p,{label:"20天内",value:"20天内"}),l(p,{label:"25天内",value:"25天内"}),l(p,{label:"30天内",value:"30天内"}),l(p,{label:"45天内",value:"45天内"})]),_:1},8,["modelValue"])]),_:1}),l(r,{label:"是否默认",prop:"is_default"},{default:a(()=>[l(R,{modelValue:o.value.is_default,"onUpdate:modelValue":e[2]||(e[2]=n=>o.value.is_default=n),style:{width:"100%"}},{default:a(()=>[l(h,{value:1},{default:a(()=>e[5]||(e[5]=[d("是")])),_:1}),l(h,{value:0},{default:a(()=>e[6]||(e[6]=[d("否")])),_:1})]),_:1},8,["modelValue"]),e[7]||(e[7]=u("div",{class:"extra"},"只能设置一个默认模板",-1))]),_:1}),l(r,{label:"是否包邮",prop:"is_free"},{default:a(()=>[l(R,{modelValue:o.value.is_free,"onUpdate:modelValue":e[3]||(e[3]=n=>o.value.is_free=n)},{default:a(()=>[l(h,{value:1},{default:a(()=>e[8]||(e[8]=[d("是")])),_:1}),l(h,{value:0},{default:a(()=>e[9]||(e[9]=[d("否")])),_:1})]),_:1},8,["modelValue"])]),_:1}),l(r,{label:"计价方式",prop:"pricing_type"},{default:a(()=>[l(R,{modelValue:o.value.pricing_type,"onUpdate:modelValue":e[4]||(e[4]=n=>o.value.pricing_type=n),onChange:G},{default:a(()=>[l(h,{value:1,disabled:y.value!="add"},{default:a(()=>e[10]||(e[10]=[d("按件数")])),_:1},8,["disabled"]),l(h,{value:2,disabled:y.value!="add"},{default:a(()=>e[11]||(e[11]=[d("按重量")])),_:1},8,["disabled"])]),_:1},8,["modelValue"])]),_:1}),l(r,{label:"运送方式",prop:"shipping_tpl_info",rules:[{required:!0,message:"运送方式不能为空!"}]},{default:a(()=>[o.value.shipping_tpl_info.length==0?(b(),w("div",be,[l(q(F),{params:{act:"add"},isDrawer:"",path:"setting/shippingType/Info",title:"添加配送类型",width:"600px",onOkCallback:B},{default:a(()=>[l(U,{icon:q(te),type:"primary"},{default:a(()=>e[12]||(e[12]=[d(" 添加配送类型")])),_:1},8,["icon"])]),_:1})])):x("",!0),(b(!0),w(ie,null,ne(o.value.shipping_tpl_info,(n,_)=>(b(),w("div",he,[u("div",ve,[l(q(_e),{modelValue:n.is_checked,"onUpdate:modelValue":t=>n.is_checked=t},{default:a(()=>[d($(n.shipping_type_name),1)]),_:2},1032,["modelValue","onUpdate:modelValue"])]),n.is_checked>0?(b(),w("div",Ve,[u("div",ye,[e[13]||(e[13]=u("span",{class:"title"},"默认运费",-1)),l(r,{prop:"shipping_tpl_info["+_+"].default_tpl_info.start_number",rules:[{required:!0,validator:g}],class:"hn"},{default:a(()=>[l(s,{modelValue:n.default_tpl_info.start_number,"onUpdate:modelValue":t=>n.default_tpl_info.start_number=t,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"]),d("  "+$(o.value.pricing_type==1?"件":"kg")+"内  ",1),l(r,{prop:"shipping_tpl_info["+_+"].default_tpl_info.start_price",rules:[{required:!0,validator:g}],class:"hn"},{default:a(()=>[l(s,{modelValue:n.default_tpl_info.start_price,"onUpdate:modelValue":t=>n.default_tpl_info.start_price=t,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"]),e[14]||(e[14]=d("  元，")),e[15]||(e[15]=u("span",{class:"title"},"每增加",-1)),l(r,{prop:"shipping_tpl_info["+_+"].default_tpl_info.add_number",rules:[{required:!0,validator:g}],class:"hn"},{default:a(()=>[l(s,{modelValue:n.default_tpl_info.add_number,"onUpdate:modelValue":t=>n.default_tpl_info.add_number=t,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"]),d("  "+$(o.value.pricing_type==1?"件":"kg")+"，",1),e[16]||(e[16]=u("span",{class:"title"},"增加运费",-1)),l(r,{prop:"shipping_tpl_info["+_+"].default_tpl_info.add_price",rules:[{required:!0,validator:g}],class:"hn"},{default:a(()=>[l(s,{modelValue:n.default_tpl_info.add_price,"onUpdate:modelValue":t=>n.default_tpl_info.add_price=t,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"]),e[17]||(e[17]=d("  元，")),e[18]||(e[18]=u("span",{class:"title"},"满",-1)),l(s,{modelValue:n.default_tpl_info.free_price,"onUpdate:modelValue":t=>n.default_tpl_info.free_price=t,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"]),e[19]||(e[19]=d("  元，")),e[20]||(e[20]=u("span",{class:"title"},"免运费",-1))]),n.area_tpl_info.length>0?(b(),L(Q,{key:0,data:n.area_tpl_info,style:{width:"100%","margin-top":"8px"}},{default:a(()=>[l(c,{label:"运送到",prop:"region_data"},{default:a(t=>[u("div",we,[u("div",ke,[l(r,{prop:"shipping_tpl_info."+_+".area_tpl_info["+t.$index+"].region_data.area_region_names",rules:[{required:!0,message:"未添加地区"}],class:"hn"},{default:a(()=>[u("span",{class:"shipping-region-list",style:oe(t.row.region_data.area_region_names.length>0?"":"color: red;")},$(t.row.region_data.area_region_names.length>0?t.row.region_data.area_region_names.join("、"):"请添加地区"),5)]),_:2},1032,["prop"])]),u("div",null,[l(q(F),{params:{index:_,itemIndex:t.$index,ids:t.row.region_data.area_regions,other:n.area_tpl_info},path:"setting/shippingTpl/SelectRegion",title:"编辑地区",width:"900px",onOkCallback:K},{default:a(()=>e[21]||(e[21]=[u("a",null,"编辑",-1)])),_:2},1032,["params"])])])]),_:2},1024),l(c,{label:o.value.pricing_type==1?"首件数(件)":"首重量(kg)",width:"90"},{default:a(t=>[l(r,{prop:"shipping_tpl_info."+_+".area_tpl_info["+t.$index+"].start_number",rules:[{required:!0,validator:g}],class:"hn"},{default:a(()=>[l(s,{modelValue:t.row.start_number,"onUpdate:modelValue":m=>t.row.start_number=m,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])]),_:2},1032,["label"]),l(c,{label:"首费(元)",width:"80"},{default:a(t=>[l(r,{prop:"shipping_tpl_info."+_+".area_tpl_info["+t.$index+"].start_price",rules:[{required:!0,validator:g}],class:"hn"},{default:a(()=>[l(s,{modelValue:t.row.start_price,"onUpdate:modelValue":m=>t.row.start_price=m,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])]),_:2},1024),l(c,{label:o.value.pricing_type==1?"续件数(件)":"续重量(kg)",width:"90"},{default:a(t=>[l(r,{prop:"shipping_tpl_info."+_+".area_tpl_info["+t.$index+"].add_number",rules:[{required:!0,validator:g}],class:"hn"},{default:a(()=>[l(s,{modelValue:t.row.add_number,"onUpdate:modelValue":m=>t.row.add_number=m,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])]),_:2},1032,["label"]),l(c,{label:"续费(元)",width:"80"},{default:a(t=>[l(r,{prop:"shipping_tpl_info."+_+".area_tpl_info["+t.$index+"].add_price",rules:[{required:!0,validator:g}],class:"hn"},{default:a(()=>[l(s,{modelValue:t.row.add_price,"onUpdate:modelValue":m=>t.row.add_price=m,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])]),_:2},1024),l(c,{label:"满免(元)",width:"80"},{default:a(t=>[l(r,{prop:"shipping_tpl_info."+_+".area_tpl_info["+t.$index+"].free_price",class:"hn"},{default:a(()=>[l(s,{modelValue:t.row.free_price,"onUpdate:modelValue":m=>t.row.free_price=m,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"])]),_:2},1024),l(c,{label:"操作",width:"60"},{default:a(t=>[l(U,{link:"",type:"primary",onClick:m=>H(_,t.$index)},{default:a(()=>e[22]||(e[22]=[d("删除")])),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["data"])):x("",!0),l(U,{link:"",type:"primary",onClick:t=>J(n)},{default:a(()=>e[23]||(e[23]=[d("增加指定地区运费")])),_:2},1032,["onClick"])])):x("",!0)]))),256))]),_:1}),ae(l(r,{"wrapper-col":{offset:4,span:16}},{default:a(()=>[l(U,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:E},{default:a(()=>e[24]||(e[24]=[d("提交")])),_:1},512)]),_:1},512),[[pe,!v.isDialog]])]),_:1},8,["model"])),l(X,{spinning:V.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}}),Be=se(Ue,[["__scopeId","data-v-d134e3cc"]]);export{Be as default};
