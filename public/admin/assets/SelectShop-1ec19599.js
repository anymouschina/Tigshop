import{A as U,d as K,j as p,s as O,E as Q,dk as L,x as Z,r as m,o,c as n,b as a,w as c,e,H as f,h as u,k as J,G as C,F as W,a as X,f as N,Z as Y,n as ee,K as R,dm as te,du as se,Q as oe,p as ae,i as le,_ as ne}from"./index-7c2d2aef.js";import{u as ie}from"./config-9548fa9b.js";import{u as re}from"./theme-cc18c5b2.js";import{u as ce}from"./menus-a5eaec1a.js";import{F as ue}from"./UploadAvatar.vue_vue_type_style_index_0_scoped_9bfcfc35_lang-9b6073fb.js";import{a as de,i as pe}from"./version-f7bce787.js";const me="/admin/assets/shop_logo_b-5aa2db1f.png",_e="/admin/assets/shop_logo-efa4e41f.png",fe=()=>U({url:"merchant/shop/my_shop",method:"get",noErrorTip:!0}),he=i=>U({url:"merchant/shop/create",method:"post",data:i}),g=i=>(ae("data-v-9a41a100"),i=i(),le(),i),ve={key:0,class:"warp-info"},ge={class:"back-btn"},ye=g(()=>e("i",{class:"iconfont-admin icon-zuojiantou-copy"},null,-1)),Se={class:"right-item"},ke=g(()=>e("div",{class:"title-name"},[e("div",{class:"left-title"},"您可以进入以下管理后台")],-1)),Ie={key:0,class:"sub-title-name"},be={key:1,class:"shop-list"},xe={class:"left-item"},Ce=g(()=>e("img",{class:"left-image",src:me,alt:""},null,-1)),we={class:"left-info"},Te={class:"left-title"},Fe={key:0},Me=g(()=>e("div",{class:"right-item"},[e("span",{class:"iconfont-admin icon-login-youjiantou"})],-1)),Ve={key:2,class:"shop-list shop-list-min-height"},Be=["onClick"],$e={class:"left-item"},je={class:"left-info"},Le={class:"left-title"},Ne=g(()=>e("div",{class:"right-item"},[e("span",{class:"iconfont-admin icon-login-youjiantou"})],-1)),Re={key:3,class:"shop-list shop-list-min-height"},Ue={key:1},Ee=K({__name:"SelectShop",props:{isIndex:{type:Boolean,default:!1},selectShopFlag:{type:Boolean,default:!1}},emits:["closePopup","update:selectShopFlag"],setup(i,{emit:E}){const P=i,_=p({shop_title:"",shop_logo:""}),w=p(!1),q=async()=>{await T.value.validate();try{w.value=!0;const s=await he({..._.value});R.success(s.message),y.value=!1,await V()}catch(s){R.error(s.message)}finally{w.value=!1}},d=p(!0),T=O(),y=p(!1),F=E,z=Q(),M=async s=>{localStorage.setItem("shopId",String(s)),s===0?localStorage.setItem("adminType","admin"):localStorage.setItem("adminType","shop");const t=L(),h=ie(),I=te(),b=re();t.updateUserInfo(),h.updateConfig(),pe()&&b.getThemeInfo(),se.success({message:"登录成功",placement:"top",duration:1.5,description:"您好，欢迎回来"}),P.isIndex&&F("closePopup");let v=await ce();I.mainMenu=v,z.push("/"+(v?v[0].route_link:"")),localStorage.setItem("lastOpenTime",String(oe().unix()))},{logout:A}=L(),G=()=>{F("update:selectShopFlag",!1),A()},S=p([]),r=p({}),k=p(""),V=async()=>{try{d.value=!0;const s=await fe();s.filter_result&&(S.value=s.filter_result),s.userinfo&&(r.value=s.userinfo)}catch{}finally{d.value=!1}};return Z(()=>{const s=localStorage.getItem("accessToken");k.value=localStorage.getItem("adminType"),s&&de()?V():d.value=!1}),(s,t)=>{const h=m("el-button"),I=m("a-spin"),b=m("el-image"),v=m("el-empty"),D=m("el-input"),x=m("el-form-item"),H=m("el-form");return o(),n("div",{class:ee(["select-shop-warp",{"have-bor":!i.isIndex}])},[a(Y,{mode:"out-in",name:"slide-fade"},{default:c(()=>{var B,$,j;return[y.value?(o(),n("div",Ue,[a(H,{"label-width":"70",ref_key:"formRef",ref:T,model:_.value,class:"demo-ruleForm","status-icon":""},{default:c(()=>[a(x,{rules:[{required:!0,message:"店铺名称不能为空!"}],label:"店铺名称",prop:"shop_title"},{default:c(()=>[a(D,{modelValue:_.value.shop_title,"onUpdate:modelValue":t[3]||(t[3]=l=>_.value.shop_title=l)},null,8,["modelValue"])]),_:1}),a(x,{label:"店铺logo",prop:"shop_logo"},{default:c(()=>[a(N(ue),{photo:_.value.shop_logo,"onUpdate:photo":t[4]||(t[4]=l=>_.value.shop_logo=l)},null,8,["photo"])]),_:1}),a(x,{label:""},{default:c(()=>[a(h,{type:"primary",onClick:t[5]||(t[5]=l=>q())},{default:c(()=>[f(" 创建 ")]),_:1}),a(h,{onClick:t[6]||(t[6]=l=>y.value=!1)},{default:c(()=>[f("取消")]),_:1})]),_:1})]),_:1},8,["model"])])):(o(),n("div",ve,[e("div",ge,[i.isIndex?u("",!0):(o(),n("div",{key:0,class:"bark",onClick:t[0]||(t[0]=l=>G())},[ye,f("返回")])),e("div",Se,[i.isIndex?(o(),J(h,{key:0,onClick:t[1]||(t[1]=l=>y.value=!0),type:"primary"},{default:c(()=>[f("创建新店铺")]),_:1})):u("",!0)])]),ke,r.value!==""&&((B=r.value)!=null&&B.username)?(o(),n("div",Ie,[e("span",null,C(($=r.value)==null?void 0:$.username),1),f(" 已绑定了以下店铺，您可以进入以下任一店铺 ")])):u("",!0),a(I,{spinning:d.value,style:{width:"100%","margin-top":"100px",height:"200px"}},null,8,["spinning"]),!d.value&&k.value==="admin"?(o(),n("div",be,[e("div",{onClick:t[2]||(t[2]=l=>M(0)),class:"shop-item",style:{"border-color":"#ffeac7","background-color":"#fff4e6",color:"#4e4e4e"}},[e("div",xe,[Ce,e("div",we,[e("div",Te,[f("管理后台 "),r.value&&r.value.username&&r.value.username!==""?(o(),n("span",Fe,"（"+C((j=r.value)==null?void 0:j.username)+"）",1)):u("",!0)])])]),Me])])):u("",!0),S.value.length>0?(o(),n("div",Ve,[d.value?u("",!0):(o(!0),n(W,{key:0},X(S.value,l=>(o(),n("div",{onClick:Pe=>M(l.shop_id),class:"shop-item"},[e("div",$e,[a(b,{class:"left-image",src:N(_e)},null,8,["src"]),e("div",je,[e("div",Le,C(l.shop_title),1)])]),Ne],8,Be))),256))])):u("",!0),!d.value&&S.value.length==0&&k.value!="admin"?(o(),n("div",Re,[a(v,{description:"您还没有已绑定的店铺哦～"})])):u("",!0)]))]}),_:1})],2)}}});const Ke=ne(Ee,[["__scopeId","data-v-9a41a100"]]);export{Ke as S};
