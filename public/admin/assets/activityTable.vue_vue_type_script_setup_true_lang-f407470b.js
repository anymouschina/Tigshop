import{d as E,j as f,I as G,x as H,r as i,o as p,c as v,e as o,b as t,w as s,f as c,h as y,K as k,L as O,F as J,a as Q,k as R,aM as W,H as g,G as w}from"./index-7c2d2aef.js";/* empty css             */import"./index-6c62cf9b.js";import{P as X}from"./PopFormElm-61cd9b7d.js";import{_ as Y}from"./Switch.vue_vue_type_script_setup_true_lang-95245cd7.js";import{_ as Z}from"./DeleteRecord.vue_vue_type_script_setup_true_lang-ae1bade7.js";/* empty css                                                                    */import{P as ee}from"./Pagination-8eb7b6b1.js";import{u as te}from"./config-9548fa9b.js";import{g as oe,a as ae,u as S,d as se,b as le}from"./productActivity-05219334.js";import{_ as ne}from"./DialogForm.vue_vue_type_script_setup_true_lang-c57b9a11.js";const ie={class:"container"},re={class:"lyecs-table-list-warp"},de={class:"list-table-tool lyecs-search-warp"},ce={class:"advanced-search-warp list-table-tool-row"},pe={class:"simple-form-warp"},_e={class:"simple-form-field"},me={class:"form-group"},ue={class:"control-container"},fe=o("span",{class:"iconfont icon-chakan1"},null,-1),ve={class:"simple-form-field"},be={class:"form-group"},ge=o("label",{class:"control-label"},[o("span",null,"活动状态：")],-1),he={class:"control-container"},ye={class:"list-table-tool-row"},ke={class:"list-table-tool-col"},we={key:0},Ce={class:"table-container"},Ae={style:{position:"relative"}},Ve=o("a",{class:"btn-link"},"编辑",-1),Se={class:"empty-warp"},Pe={key:0,class:"empty-bg"},xe={key:0,class:"pagination-con"},Me=E({__name:"activityTable",props:{promotion_type:{type:Number,default:1}},setup(P,{expose:x}){const U=te(),z=P,C=f(),_=f(!0),b=f(0),m=f([]),l=G({page:1,size:U.get("page_size"),sort_field:"",sort_order:"",keyword:"",promotion_type:z.promotion_type==3?[3]:[1,2]}),h=f([]),d=async()=>{_.value=!0;try{const n=await oe({...l});C.value=n.filter_result,b.value=n.total;const a=await ae();h.value=a.promotion_status,console.log(h.value)}catch(n){k.error(n.message)}finally{_.value=!1}};H(()=>{d()});const A=()=>{d()},q=({prop:n,order:a})=>{l.sort_field=n,l.sort_order=a=="ascending"?"asc":a=="descending"?"desc":"",d()},B=async n=>{try{const a=await le(n,{ids:m.value});k.success(a.message),d()}catch(a){k.error(a.message)}},F=n=>{m.value=n.map(a=>a.promotion_id)};return x({loadFilter:d}),(n,a)=>{const V=i("el-button"),N=i("el-input"),$=i("el-option"),D=i("el-select"),I=i("el-popconfirm"),K=i("el-space"),L=i("el-form"),r=i("el-table-column"),M=i("el-divider"),T=i("el-table"),j=i("a-spin");return p(),v("div",ie,[o("div",re,[o("div",de,[t(L,{model:l},{default:s(()=>[o("div",ce,[o("div",pe,[o("div",_e,[o("div",me,[o("div",ue,[t(N,{modelValue:l.keyword,"onUpdate:modelValue":a[0]||(a[0]=e=>l.keyword=e),name:"keyword",placeholder:"输入活动名称",onKeyup:O(A,["enter"])},{append:s(()=>[t(V,{onClick:A},{default:s(()=>[fe]),_:1})]),_:1},8,["modelValue"])])])]),o("div",ve,[o("div",be,[ge,o("div",he,[t(D,{modelValue:l.is_going,"onUpdate:modelValue":a[1]||(a[1]=e=>l.is_going=e),clearable:""},{default:s(()=>[(p(!0),v(J,null,Q(h.value,(e,u)=>(p(),R($,{value:u,label:e},null,8,["value","label"]))),256))]),_:1},8,["modelValue"])])])])])]),o("div",ye,[o("div",ke,[t(K,null,{default:s(()=>[W(n.$slots,"default"),t(I,{title:"您确认要批量删除所选数据吗？",onConfirm:a[2]||(a[2]=e=>B("del"))},{reference:s(()=>[t(V,{disabled:m.value.length===0},{default:s(()=>[g("批量删除")]),_:1},8,["disabled"])]),_:1}),m.value.length>0?(p(),v("span",we,[g(" 已选择："),o("b",null,w(m.value.length),1),g(" 项 ")])):y("",!0)]),_:3})])])]),_:3},8,["model"])]),o("div",Ce,[t(j,{spinning:_.value},{default:s(()=>[t(T,{data:C.value,"row-key":"promotion_id",onSelectionChange:F,total:b.value,onSortChange:q,loading:_.value},{empty:s(()=>[o("div",Se,[_.value?y("",!0):(p(),v("div",Pe,"暂无数据"))])]),default:s(()=>[t(r,{type:"selection",width:"32"}),t(r,{label:"活动名称",prop:"promotion_name",width:150},{default:s(({row:e})=>[o("div",Ae,[o("div",null,w(e.promotion_name||"--"),1)])]),_:1}),t(r,{label:"活动类型",prop:"promotion_type_name",width:"100"}),t(r,{label:"起始日期",prop:"start_time",width:"150",sortable:"custom"}),t(r,{label:"截止日期",prop:"end_time",width:"150",sortable:"custom"}),t(r,{label:"排序",prop:"sort_order",sortable:"custom"},{default:s(({row:e})=>[t(c(X),{label:"排序",type:"input",requestApi:c(S),"org-value":e.sort_order,"onUpdate:orgValue":u=>e.sort_order=u,params:{id:e.promotion_id,field:"sort_order"},extra:"默认值为50，数值越小，排序越靠前"},{default:s(()=>[o("div",null,w(e.sort_order),1)]),_:2},1032,["requestApi","org-value","onUpdate:orgValue","params"])]),_:1}),t(r,{label:"状态",prop:"product_status"}),t(r,{label:"是否启用",prop:"is_available",sortable:"custom"},{default:s(({row:e})=>[t(c(Y),{checked:e.is_available,"onUpdate:checked":u=>e.is_available=u,requestApi:c(S),params:{id:e.promotion_id,field:"is_available"}},null,8,["checked","onUpdate:checked","requestApi","params"])]),_:1}),t(r,{label:"操作",fixed:"right"},{default:s(({row:e})=>[t(c(ne),{isDrawer:"",onOkCallback:d,title:"编辑优惠活动",width:"800px",path:"promotion/productActivity/Info",params:{act:"detail",id:e.promotion_id,promotion_type:e.promotion_type}},{default:s(()=>[Ve]),_:2},1032,["params"]),t(M,{direction:"vertical"}),t(c(Z),{onAfterDelete:d,requestApi:c(se),params:{id:e.promotion_id}},{default:s(()=>[g("删除")]),_:2},1032,["requestApi","params"])]),_:1})]),_:1},8,["data","total","loading"])]),_:1},8,["spinning"]),b.value>0?(p(),v("div",xe,[t(c(ee),{page:l.page,"onUpdate:page":a[3]||(a[3]=e=>l.page=e),size:l.size,"onUpdate:size":a[4]||(a[4]=e=>l.size=e),total:b.value,onCallback:d},null,8,["page","size","total"])])):y("",!0)])])])}}});export{Me as _};
