import{d as I,i as s,C as j,s as $,aa as w,q as M,r as c,j as _,f as k,o as d,w as l,a0 as O,b as u,c as P,F as T,a as X,E as z,D as G,a1 as H,I as v}from"./index-CGYuOau0.js";import{a as J,b as K,u as Q}from"./account-Cbx-_Ezp.js";const Z=I({__name:"Info",props:{act:{type:String,default:""},id:{type:Number,default:0},type:{type:Number,default:1},page:{type:Number,default:1},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(x,{expose:N,emit:q}){const g=q,i=x,m=s(!0),h=j().currentRoute.value.query,y=s(i.isDialog?i.act:String(h.act)),C=s(i.isDialog?i.id:Number(h.id)),S=y.value==="add"?"create":"update",p=$(),e=s({account_type:1}),b=w(()=>{switch(e.value.account_type){case 1:return"银行卡";case 2:return"支付宝";case 3:return"微信";default:return""}}),D=async()=>{await p.value.resetFields()};w(()=>[{required:!0,message:"请输入身份证号",trigger:"blur"},{validator:(a,t,r)=>{/^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}([0-9]|X)$/.test(t)?r():r(new Error("请输入正确的身份证号码"))},trigger:"blur"}]);const R=w(()=>[{required:!0,message:"请输入"+b.value+"号!",trigger:"blur"},{validator:(a,t,r)=>{!/^\d{6,}$/.test(t)&&e.value.account_type===1?r(new Error("请输入正确的银行卡号")):r()},trigger:"blur"}]),F=async()=>{await p.value.validate();try{g("update:confirmLoading",!0);const a=await Q(S,{id:C.value,...e.value});await p.value.resetFields(),v.success(a.message),e.value.account_type=1,g("submitCallback",a)}catch(a){v.error(a.message)}finally{g("update:confirmLoading",!1)}},U=()=>{F()},A=async()=>{try{m.value=!0;const a=await J(y.value,{id:C.value});Object.assign(e.value,a.item)}catch(a){v.error(a.message)}finally{m.value=!1}},E=s([]),B=async()=>{try{const a=await K();E.value=a.account_type_list}catch(a){v.error(a.message)}};return M(()=>{y.value==="detail"?A():m.value=!1,B()}),N({onFormSubmit:U}),(a,t)=>{const r=c("el-radio-button"),V=c("el-radio-group"),n=c("el-form-item"),f=c("el-input"),L=c("el-form");return m.value?k("",!0):(d(),_(L,{key:0,ref_key:"formRef",ref:p,model:e.value,class:"form-body","label-suffix":"：","label-width":"auto"},{default:l(()=>[O(u(n,{rules:[{required:!0,message:"请选择卡类型!"}],label:"卡类型"},{default:l(()=>[u(V,{modelValue:e.value.account_type,"onUpdate:modelValue":t[0]||(t[0]=o=>e.value.account_type=o),onChange:D},{default:l(()=>[(d(!0),P(T,null,X(E.value,o=>(d(),_(r,{value:o.account_type},{default:l(()=>[z(G(o.account_type_text),1)]),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"])]),_:1},512),[[H,x.page]]),u(n,{rules:[{required:!0,message:"请输入真实姓名!"}],label:"真实姓名",prop:"account_name"},{default:l(()=>[u(f,{modelValue:e.value.account_name,"onUpdate:modelValue":t[1]||(t[1]=o=>e.value.account_name=o),placeholder:"请输入真实姓名"},null,8,["modelValue"])]),_:1}),u(n,{label:b.value+"号",rules:R.value,prop:"account_no"},{default:l(()=>[u(f,{modelValue:e.value.account_no,"onUpdate:modelValue":t[2]||(t[2]=o=>e.value.account_no=o),placeholder:"请输入"+b.value},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),e.value.account_type===1?(d(),_(n,{key:0,label:"分行名称",prop:"account_no"},{default:l(()=>[u(f,{modelValue:e.value.bank_branch,"onUpdate:modelValue":t[3]||(t[3]=o=>e.value.bank_branch=o),placeholder:"请输入分行名称"},null,8,["modelValue"])]),_:1})):k("",!0),e.value.account_type===1?(d(),_(n,{key:1,label:"银行卡详情",prop:"bank_name"},{default:l(()=>[u(f,{modelValue:e.value.bank_name,"onUpdate:modelValue":t[4]||(t[4]=o=>e.value.bank_name=o),rows:4,placeholder:"请选择银行卡账号",type:"textarea"},null,8,["modelValue"])]),_:1})):k("",!0)]),_:1},8,["model"]))}}});export{Z as default};
