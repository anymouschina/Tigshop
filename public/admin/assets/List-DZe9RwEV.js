import{d as J,K as W,i as _,G as X,C as A,q as Y,c as m,e as a,j as v,f as c,g as d,w as o,b as s,M as Z,E as b,D as C,I as D,r as p,o as n,aQ as B,n as ee,_ as te}from"./index-DrbzVNl6.js";/* empty css             */import"./index-CeQDmMxd.js";import{D as ae}from"./DeleteRecord-MR4vGqLl.js";/* empty css                                                                    */import{P as se}from"./Pagination-wR9huHyl.js";import{i as oe,r as le}from"./format-CRgx78oe.js";import{a as ne,c as ie,e as re}from"./adminUser-CTRuV4iV.js";import{M as de}from"./MobileCard-BSBggTtf.js";import"./Verify.vue_vue_type_style_index_0_lang-B5aTvMR3.js";import"./zh-cn-W45FenWv.js";import{T as ce}from"./Tag-GwM_ruJO.js";import{a as pe}from"./version-CL9k3sYf.js";import{_ as q}from"./DialogForm.vue_vue_type_script_setup_true_lang-DqYSRv0_.js";const ue={class:"container"},me={class:"content_wrapper"},_e={class:"lyecs-table-list-warp"},ve={class:"list-table-tool lyecs-search-warp"},fe={class:"advanced-search-warp list-table-tool-row"},ge={class:"simple-form-warp"},ye={class:"simple-form-field"},be={class:"form-group"},he={class:"control-container"},ke={key:0,class:"simple-form-field"},Ce={class:"form-group"},Ie={class:"control-container"},Se={class:"simple-form-field"},we={class:"form-group"},ze={class:"control-container"},xe={key:0},De={class:"table-container"},Te={class:"avatar-username"},Ue={key:0},Ve={key:0},Ne={key:1},Ae=["onClick"],Be={class:"empty-warp"},qe={key:0,class:"empty-bg"},Me={key:0,class:"pagination-con"},Fe=J({__name:"List",props:{id:{type:Number,default:0},act:{type:String,default:""},isDialog:Boolean},setup(M){const F=A(),K=W(),T=_([]),g=_(!0),h=_(0),y=_([]),r=X({page:1,size:K.get("pageSize"),sortField:"",sortOrder:"",keyword:"",adminUserType:"admin"}),i=_("admin"),O=l=>{i.value=l,r.adminUserType=l,u()},u=async()=>{g.value=!0;try{const l=await ne({...r});T.value=l.records,h.value=l.total}catch(l){D.error(l.message)}finally{g.value=!1}},P=l=>{F.push("/authority/admin_log/list?userId="+l)},k=M,U=A().currentRoute.value.query,I=_(k.isDialog?k.act:String(U.act)),S=_(k.isDialog?k.id:Number(U.id)||"");Y(()=>{I.value&&(r.suppliersId=S.value),u()});const w=()=>{u()},L=({prop:l,order:e})=>{r.sortField=l,r.sortOrder=e=="ascending"?"asc":e=="descending"?"desc":"",u()},R=async l=>{try{const e=await ie(l,{ids:y.value});D.success("操作成功"),u()}catch(e){D.error(e.message)}},$=l=>{y.value=l.map(e=>e.adminId)};return(l,e)=>{const V=p("el-tab-pane"),E=p("el-tabs"),z=p("el-button"),j=p("TigInput"),G=p("el-popconfirm"),f=p("el-table-column"),x=p("el-avatar"),N=p("el-divider"),Q=p("el-table"),H=p("a-spin");return n(),m("div",ue,[a("div",me,[d(pe)()?(n(),v(E,{key:0,modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=t=>i.value=t),class:"lyecs-tabs","tab-position":"top",onTabChange:O},{default:o(()=>[s(V,{label:"管理员列表",name:"admin"}),s(V,{label:"店铺管理员列表",name:"shop"})]),_:1},8,["modelValue"])):c("",!0),a("div",_e,[a("div",ve,[a("div",fe,[a("div",ge,[a("div",ye,[a("div",be,[a("div",he,[s(j,{modelValue:r.keyword,"onUpdate:modelValue":e[1]||(e[1]=t=>r.keyword=t),name:"keyword",placeholder:i.value=="shop"?"输入员工名称":"输入管理员名称",onKeyup:Z(w,["enter"]),clearable:"",onClear:w},{append:o(()=>[s(z,{onClick:w},{default:o(()=>e[5]||(e[5]=[a("span",{class:"iconfont icon-chakan1"},null,-1)])),_:1})]),_:1},8,["modelValue","placeholder"])])])]),i.value!=="shop"?(n(),m("div",ke,[a("div",Ce,[a("div",Ie,[s(d(q),{params:{act:"add",type:I.value?I.value:"",suppliersId:S.value?S.value:0,adminType:i.value},isDrawer:"",path:"authority/adminUser/Info",title:"添加管理员",width:"800px",onOkCallback:u},{default:o(()=>[s(z,{type:"primary"},{default:o(()=>e[6]||(e[6]=[b("添加管理员")])),_:1})]),_:1},8,["params"])])])])):c("",!0),a("div",Se,[a("div",we,[a("div",ze,[s(G,{title:"您确认要批量删除所选数据吗？",onConfirm:e[2]||(e[2]=t=>R("del"))},{reference:o(()=>[s(z,{disabled:y.value.length===0},{default:o(()=>e[7]||(e[7]=[b("批量删除")])),_:1},8,["disabled"])]),_:1}),y.value.length>0?(n(),m("span",xe,[e[8]||(e[8]=b(" 已选择：")),a("b",null,C(y.value.length),1),e[9]||(e[9]=b(" 项 "))])):c("",!0)])])])])])]),a("div",De,[s(H,{spinning:g.value},{default:o(()=>[s(Q,{data:T.value,loading:g.value,total:h.value,"row-key":"adminId",onSelectionChange:$,onSortChange:L},{empty:o(()=>[a("div",Be,[g.value?c("",!0):(n(),m("div",qe,"暂无数据"))])]),default:o(()=>[s(f,{type:"selection",width:"32"}),s(f,{width:"200",label:i.value=="shop"?"员工名称":"管理员名称",prop:"username"},{default:o(({row:t})=>[a("div",Te,[d(B)(String(t.avatar))=="one"?(n(),v(x,{key:0,size:30,src:d(oe)(t.avatar)},null,8,["src"])):d(B)(String(t.avatar))=="def"?(n(),v(x,{key:1,size:30,src:d(le)(t.avatar)},null,8,["src"])):(n(),v(x,{key:2,size:30,src:""})),a("div",null,[a("div",null,C(t.username),1),i.value=="shop"&&t.isAdmin==1?(n(),m("div",Ue,[s(d(ce),{transparent:!0,text:"店铺管理员"})])):c("",!0)])])]),_:1},8,["label"]),i.value!="shop"?(n(),v(f,{key:0,label:"权限组",prop:"roleName"},{default:o(({row:t})=>[a("span",{class:ee(t.roleName?"green":"gray")},C(t.roleName||"-"),3)]),_:1})):c("",!0),s(f,{label:"邮箱",prop:"email"},{default:o(({row:t})=>[a("span",null,C(t.email||"-"),1)]),_:1}),s(f,{label:"电话",prop:"mobile"},{default:o(({row:t})=>[t.mobile?(n(),m("span",Ve,[s(de,{mobile:t.mobile},null,8,["mobile"])])):(n(),m("span",Ne,"--"))]),_:1}),s(f,{width:150,fixed:"right",label:"操作"},{default:o(({row:t})=>[s(d(q),{params:{act:"detail",id:t.adminId,adminType:i.value},isDrawer:"",path:"authority/adminUser/Info",title:i.value=="shop"?"编辑员工":"编辑管理员",width:"800px",onOkCallback:u},{default:o(()=>e[10]||(e[10]=[a("a",{class:"btn-link"},"编辑",-1)])),_:2},1032,["params","title"]),a("template",null,[s(N,{direction:"vertical"}),i.value!="shop"?(n(),m("a",{key:0,class:"btn-link",onClick:Ke=>P(t.adminId)},"日志",8,Ae)):c("",!0)]),t.adminId!=1?(n(),v(N,{key:0,direction:"vertical"})):c("",!0),t.adminId!=1?(n(),v(d(ae),{key:1,params:{id:t.adminId},requestApi:d(re),onAfterDelete:u},{default:o(()=>e[11]||(e[11]=[b("删除 ")])),_:2},1032,["params","requestApi"])):c("",!0)]),_:1})]),_:1},8,["data","loading","total"])]),_:1},8,["spinning"]),h.value>0?(n(),m("div",Me,[s(d(se),{page:r.page,"onUpdate:page":e[3]||(e[3]=t=>r.page=t),size:r.size,"onUpdate:size":e[4]||(e[4]=t=>r.size=t),total:h.value,onCallback:u},null,8,["page","size","total"])])):c("",!0)])])])])}}}),Ze=te(Fe,[["__scopeId","data-v-e444e72d"]]);export{Ze as default};
