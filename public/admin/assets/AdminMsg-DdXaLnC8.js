import{a as $}from"./version-CL9k3sYf.js";import{d as j,dQ as D,K as q,i as u,G,q as K,r as I,c as a,o as s,b as C,w as T,e as o,F as x,a as z,f as d,g as N,n as S,D as g,j as Q,E as H,I as J,_ as O}from"./index-DrbzVNl6.js";/* empty css                                                                    */import{P as W}from"./Pagination-wR9huHyl.js";import X from"./Collapse-B7FxhG78.js";import{a as Y,b as Z,c as ee}from"./adminMsg-DO0gQXrn.js";import"./Image.vue_vue_type_script_setup_true_lang-BWzCs9jv.js";import"./format-CRgx78oe.js";import"./order-DqMQuu0g.js";import"./DetailBtn.vue_vue_type_script_setup_true_lang-DaLWXrN7.js";import"./index-CeQDmMxd.js";import"./DialogForm.vue_vue_type_script_setup_true_lang-DqYSRv0_.js";import"./aftersales-0KSvwj7B.js";const te="/admin/assets/empty-bg-CEmUzxL0.png",se={class:"message_center"},ae={class:"tab_box tab_box1"},ne=["onClick"],oe={key:0,class:"num"},le=["onClick"],ue={key:0,class:"num"},ie={class:"tab_box tab_box2"},ce=["onClick"],re={key:0,class:"num"},de={class:"list_box"},pe={style:{"min-height":"200px"}},ge={key:0,class:"item"},ve={key:1,class:"table-empty"},me={key:0,class:"pagination-con"},_e={class:"btn"},fe=j({__name:"AdminMsg",emits:["callback","update:confirmLoading","close"],setup(ye,{emit:w}){const B=D(),A=w,R=q(),p=u([]),h=u([]),i=u(0),m=u(0),_=u(!0),f=u(!0),l=G({page:1,size:R.get("pageSize"),msgType:11}),c=u([]),b=u(0),v=async()=>{f.value=!0;try{const t=await Y({...l}),n=await Z();c.value=t.records,p.value=n,h.value=k(p.value[i.value].child),b.value=t.total,_.value=!1}catch(t){J.error(t.message)}finally{f.value=!1}},U=()=>{A("close")};K(()=>{v()});const V=async()=>{await ee(),A("callback",!1),v()},L=t=>{i.value=t,m.value=0,c.value.length=0,l.msgType=k(p.value[i.value].child)[0].msgType,v()},E=t=>{l.page=1,m.value=t,c.value.length=0,l.msgType=k(p.value[i.value].child)[t].msgType,v()},F=()=>{p.value[i.value].unreadCount-=1,h.value[m.value].unreadCount-=1,B.messageCount-=1},k=t=>{if(typeof t=="object"){var n=[];for(let y in t)n.push(t[y]);return n}else return t};return(t,n)=>{const y=I("a-spin"),P=I("el-button");return s(),a("div",null,[C(y,{spinning:_.value},{default:T(()=>[o("div",se,[o("div",ae,[(s(!0),a(x,null,z(p.value,(e,r)=>(s(),a("div",null,[e.catId==4&&N($)()?(s(),a("div",{key:0,class:S(["tab",i.value==r?"current":""]),onClick:M=>L(r)},[o("p",null,g(e.catName),1),e.unreadCount>0?(s(),a("p",oe,g(e.unreadCount),1)):d("",!0)],10,ne)):e.catId!=4?(s(),a("div",{key:1,class:S(["tab",i.value==r?"current":""]),onClick:M=>L(r)},[o("p",null,g(e.catName),1),e.unreadCount>0?(s(),a("p",ue,g(e.unreadCount),1)):d("",!0)],10,le)):d("",!0)]))),256))]),o("div",ie,[(s(!0),a(x,null,z(h.value,(e,r)=>(s(),a("div",{class:S(["tab",m.value==r?"current":""]),onClick:M=>E(r)},[o("p",null,g(e.name),1),e.unreadCount>0?(s(),a("p",re,g(e.unreadCount),1)):d("",!0)],10,ce))),256))]),o("div",de,[C(y,{spinning:f.value&&!_.value,style:{width:"100%"}},{default:T(()=>[o("div",pe,[c.value.length>0?(s(),a("div",ge,[(s(!0),a(x,null,z(c.value,e=>(s(),Q(X,{item:e,msgType:e.msgType,key:e.msgType,onSetReadedCallback:F,onClose:U},null,8,["item","msgType"]))),128))])):d("",!0),c.value.length===0&&!f.value&&!_.value?(s(),a("div",ve,n[2]||(n[2]=[o("img",{src:te,alt:""},null,-1),o("p",null,"当前暂无消息哟",-1)]))):d("",!0)])]),_:1},8,["spinning"]),c.value.length>0&&b.value>0?(s(),a("div",me,[C(N(W),{page:l.page,"onUpdate:page":n[0]||(n[0]=e=>l.page=e),size:l.size,"onUpdate:size":n[1]||(n[1]=e=>l.size=e),background:!1,total:b.value,onCallback:v},null,8,["page","size","total"])])):d("",!0)]),o("div",_e,[C(P,{onClick:V},{default:T(()=>n[3]||(n[3]=[H("全部已读")])),_:1})])])]),_:1},8,["spinning"])])}}}),we=O(fe,[["__scopeId","data-v-51f82f65"]]);export{we as default};
