import{d as q,j as f,I as O,x as j,r as i,o as v,c as h,e as t,b as e,w as s,f as p,h as y,K as w,L as E,H as m,G as S}from"./index-7c2d2aef.js";/* empty css             */import"./index-6c62cf9b.js";import{_ as F}from"./DeleteRecord.vue_vue_type_script_setup_true_lang-ae1bade7.js";/* empty css                                                                    */import{P as G}from"./Pagination-8eb7b6b1.js";import{u as H}from"./config-9548fa9b.js";import{g as M,d as T,b as J}from"./limitdiscount-c53bb0de.js";import{_ as V}from"./DialogForm.vue_vue_type_script_setup_true_lang-c57b9a11.js";import"./config-e2aa16d1.js";const Q={class:"container"},R={class:"content_wrapper"},W={class:"lyecs-table-list-warp"},X={class:"list-table-tool lyecs-search-warp"},Y={class:"advanced-search-warp list-table-tool-row"},Z={class:"simple-form-warp"},ee={class:"simple-form-field"},te={class:"form-group"},oe={class:"control-container"},se=t("span",{class:"iconfont icon-chakan1"},null,-1),ae={class:"simple-form-field"},le={class:"form-group"},ne=t("label",{class:"control-label"},[t("span",null,"活动状态：")],-1),ie={class:"control-container"},ce={class:"list-table-tool-row"},re={class:"list-table-tool-col"},de={key:0},_e={class:"table-container"},pe={style:{position:"relative"}},me=t("a",{class:"btn-link"},"编辑",-1),ue={class:"empty-warp"},fe={key:0,class:"empty-bg"},ve={key:0,class:"pagination-con"},Le=q({__name:"List",setup(he){const x=H(),k=f(),d=f(!0),u=f(0),_=f([]),l=O({page:1,size:x.get("page_size"),sort_field:"",sort_order:"",keyword:""}),c=async()=>{d.value=!0;try{const n=await M({...l});k.value=n.filter_result,u.value=n.total}catch(n){w.error(n.message)}finally{d.value=!1}};j(()=>{c()});const C=()=>{c()},z=({prop:n,order:o})=>{l.sort_field=n,l.sort_order=o=="ascending"?"asc":o=="descending"?"desc":"",c()},L=async n=>{try{const o=await J(n,{ids:_.value});w.success(o.message),c()}catch(o){w.error(o.message)}},A=n=>{_.value=n.map(o=>o.promotion_id)};return(n,o)=>{const b=i("el-button"),B=i("el-input"),g=i("el-option"),D=i("el-select"),I=i("el-popconfirm"),N=i("el-space"),U=i("el-form"),r=i("el-table-column"),K=i("el-divider"),P=i("el-table"),$=i("a-spin");return v(),h("div",Q,[t("div",R,[t("div",W,[t("div",X,[e(U,{model:l,name:"form"},{default:s(()=>[t("div",Y,[t("div",Z,[t("div",ee,[t("div",te,[t("div",oe,[e(B,{modelValue:l.keyword,"onUpdate:modelValue":o[0]||(o[0]=a=>l.keyword=a),name:"keyword",placeholder:"输入活动名称",onKeyup:E(C,["enter"])},{append:s(()=>[e(b,{onClick:C},{default:s(()=>[se]),_:1})]),_:1},8,["modelValue"])])])]),t("div",ae,[t("div",le,[ne,t("div",ie,[e(D,{modelValue:l.active_state,"onUpdate:modelValue":o[1]||(o[1]=a=>l.active_state=a),placeholder:"请选择活动状态",clearable:""},{default:s(()=>[e(g,{label:"活动进行中",value:1}),e(g,{label:"活动已结束",value:2}),e(g,{label:"活动未开始",value:3})]),_:1},8,["modelValue"])])])])])]),t("div",ce,[t("div",re,[e(N,null,{default:s(()=>[e(p(V),{params:{act:"add"},isDrawer:"",path:"promotion/productActivity/limitdiscount/Info",title:"新增限时折扣活动",width:"900px",onOkCallback:c},{default:s(()=>[e(b,{type:"primary"},{default:s(()=>[m("新增限时折扣活动")]),_:1})]),_:1}),e(I,{title:"您确认要批量删除所选数据吗？",onConfirm:o[2]||(o[2]=a=>L("del"))},{reference:s(()=>[e(b,{disabled:_.value.length===0},{default:s(()=>[m("批量删除")]),_:1},8,["disabled"])]),_:1}),_.value.length>0?(v(),h("span",de,[m(" 已选择："),t("b",null,S(_.value.length),1),m(" 项 ")])):y("",!0)]),_:1})])])]),_:1},8,["model"])]),t("div",_e,[e($,{spinning:d.value},{default:s(()=>[e(P,{data:k.value,"row-key":"coupon_id",onSelectionChange:A,total:u.value,onSortChange:z,loading:d.value},{empty:s(()=>[t("div",ue,[d.value?y("",!0):(v(),h("div",fe,"暂无数据"))])]),default:s(()=>[e(r,{type:"selection",width:"32"}),e(r,{label:"活动名称",prop:"promotion_name",width:150},{default:s(({row:a})=>[t("div",pe,[t("div",null,S(a.promotion_name||"--"),1)])]),_:1}),e(r,{label:"起始日期",prop:"start_time",sortable:"custom"}),e(r,{label:"截止日期",prop:"end_time",sortable:"custom"}),e(r,{label:"状态",prop:"status_name"}),e(r,{label:"操作",fixed:"right"},{default:s(({row:a})=>[e(p(V),{isDrawer:"",onOkCallback:c,title:"编辑限时折扣",width:"900px",path:"promotion/productActivity/limitdiscount/Info",params:{act:"detail",id:a.discount_id}},{default:s(()=>[me]),_:2},1032,["params"]),e(K,{direction:"vertical"}),e(p(F),{onAfterDelete:c,requestApi:p(T),params:{discount_id:a.discount_id}},{default:s(()=>[m("删除")]),_:2},1032,["requestApi","params"])]),_:1})]),_:1},8,["data","total","loading"])]),_:1},8,["spinning"]),u.value>0?(v(),h("div",ve,[e(p(G),{page:l.page,"onUpdate:page":o[3]||(o[3]=a=>l.page=a),size:l.size,"onUpdate:size":o[4]||(o[4]=a=>l.size=a),total:u.value,onCallback:c},null,8,["page","size","total"])])):y("",!0)])])])])}}});export{Le as default};
