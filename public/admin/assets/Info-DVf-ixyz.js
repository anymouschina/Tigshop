import{d as K,i as u,C as L,s as j,q as E,r as s,c as A,o as p,e as c,b as t,w as l,j as _,f as G,a3 as O,g as U,E as b,a4 as $,I as f}from"./index-DrbzVNl6.js";import{F as z}from"./UploadAvatar.vue_vue_type_style_index_0_scoped_9bfcfc35_lang-BDvYUQtN.js";import"./index-CeQDmMxd.js";import"./vuedraggable.umd-DAKh-e3Q.js";import{_ as J}from"./Editor.vue_vue_type_script_setup_true_lang-DYKF5akI.js";import{b as P,c as Q}from"./notice-DcabRvyV.js";import"./Image.vue_vue_type_script_setup_true_lang-BWzCs9jv.js";import"./format-CRgx78oe.js";import"./DialogForm.vue_vue_type_script_setup_true_lang-DqYSRv0_.js";import"./index.esm-bNAKkq0_.js";const W={class:"container"},X={class:"content_wrapper"},Z={class:"lyecs-form-table"},h={class:"lyecs-form-table"},de=K({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(Y,{expose:q,emit:B}){const m=B,i=Y,g=u(1),d=u(!0),y=L().currentRoute.value.query,v=u(i.isDialog?i.act:String(y.act)),V=u(i.isDialog?i.id:Number(y.id)),S=v.value==="add"?"create":"update",T=j(),o=u({isTop:0,content:""}),N=async()=>{try{const n=await P(v.value,{id:V.value});Object.assign(o.value,n)}catch(n){f.error(n.message),m("close")}finally{d.value=!1}};E(()=>{v.value==="detail"?N():d.value=!1});const w=async()=>{if(await T.value.validate(),o.value.content===""){f.error("正文内容不能为空!");return}try{m("update:confirmLoading",!0);const n=await Q(S,{id:V.value,...o.value});m("submitCallback",n),f.success("操作成功")}catch(n){f.error(n.message)}finally{m("update:confirmLoading",!1)}};return q({onFormSubmit:()=>{w()}}),(n,e)=>{const k=s("TigInput"),r=s("el-form-item"),x=s("el-date-picker"),D=s("el-radio"),M=s("el-radio-group"),R=s("el-button"),F=s("el-form"),C=s("el-tab-pane"),H=s("el-tabs"),I=s("a-spin");return p(),A("div",W,[c("div",X,[c("div",Z,[t(H,{activeKey:g.value,"onUpdate:activeKey":e[7]||(e[7]=a=>g.value=a),class:"lyecs-tabs","tab-position":"top"},{default:l(()=>[(p(),_(C,{key:1,label:"基础设置"},{default:l(()=>[c("div",h,[d.value?G("",!0):(p(),_(F,{key:0,ref_key:"formRef",ref:T,model:o.value,"label-width":"auto"},{default:l(()=>[t(r,{rules:[{required:!0,message:"页面名称不能为空!"}],label:"页面名称",prop:"title"},{default:l(()=>[t(k,{classType:"tig-form-input",modelValue:o.value.title,"onUpdate:modelValue":e[0]||(e[0]=a=>o.value.title=a)},null,8,["modelValue"])]),_:1}),t(r,{label:"封面图片",prop:"img",rules:[{required:!0,message:"封面图片不能为空!"}]},{default:l(()=>[t(U(z),{photo:o.value.img,"onUpdate:photo":e[1]||(e[1]=a=>o.value.img=a)},null,8,["photo"]),e[8]||(e[8]=c("div",{class:"extra"},"请统一上传比例为2:1的图片，宽600px，高450px（高清）",-1))]),_:1}),t(r,{label:"推送时间",prop:"startTime",rules:[{required:!0,message:"推送时间不能为空!"}]},{default:l(()=>[t(x,{modelValue:o.value.startTime,"onUpdate:modelValue":e[2]||(e[2]=a=>o.value.startTime=a),type:"datetime",placeholder:"请选择推送时间",format:"YYYY/MM/DD HH:mm:ss"},null,8,["modelValue"])]),_:1}),t(r,{label:"失效时间",prop:"endTime"},{default:l(()=>[t(x,{modelValue:o.value.endTime,"onUpdate:modelValue":e[3]||(e[3]=a=>o.value.endTime=a),type:"datetime",placeholder:"请选择失效时间",format:"YYYY/MM/DD HH:mm:ss"},null,8,["modelValue"])]),_:1}),t(r,{label:"页面描述",prop:"describe",rules:[{required:!0,message:"页面描述不能为空!"}]},{default:l(()=>[t(k,{classType:"tig-form-input",modelValue:o.value.describe,"onUpdate:modelValue":e[4]||(e[4]=a=>o.value.describe=a),row:3,type:"textarea"},null,8,["modelValue"])]),_:1}),t(r,{label:"是否置顶",prop:"isTop"},{default:l(()=>[t(M,{modelValue:o.value.isTop,"onUpdate:modelValue":e[5]||(e[5]=a=>o.value.isTop=a)},{default:l(()=>[t(D,{value:1},{default:l(()=>e[9]||(e[9]=[b("置顶")])),_:1}),t(D,{value:0},{default:l(()=>e[10]||(e[10]=[b("不置顶")])),_:1})]),_:1},8,["modelValue"])]),_:1}),O(t(r,{"wrapper-col":{offset:4,span:16}},{default:l(()=>[t(R,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:w},{default:l(()=>e[11]||(e[11]=[b("提交")])),_:1},512)]),_:1},512),[[$,!i.isDialog]])]),_:1},8,["model"]))])]),_:1})),(p(),_(C,{key:2,label:"正文内容"},{default:l(()=>[t(U(J),{html:o.value.content,"onUpdate:html":e[6]||(e[6]=a=>o.value.content=a)},null,8,["html"])]),_:1}))]),_:1},8,["activeKey"]),t(I,{spinning:d.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}});export{de as default};
