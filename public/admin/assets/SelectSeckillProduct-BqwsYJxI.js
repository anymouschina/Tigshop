import"./index-B-GURfkM.js";import{i as O}from"./format-DFT-VJzO.js";import{d as j}from"./product-CxWf3yyB.js";import{_ as q}from"./DialogForm.vue_vue_type_script_setup_true_lang-Bmm-M6gU.js";import{d as T,u as b,i as f,q as W,p as z,r as $,c as n,o as u,b as c,f as C,w as p,j as M,g as U,E as k,e as d,aW as G,F as w,a as B,D as m,I as H,_ as J}from"./index-CGYuOau0.js";import"./config-DNllFJyR.js";import"./config-DU8_t5BN.js";const K={class:"lyecs-product-select-group"},Q={key:0,class:"lyecs-product-selected-con"},R={class:"product-selected-list"},X={class:"product-selected-list-tr"},Y={class:"col col2 product-info"},Z={style:{display:"flex"}},ee=["src"],le={style:{"line-height":"2"}},te={class:"col col1"},se={class:"extra"},oe={class:"col col1"},ae={class:"extra"},ue={class:"col col3"},de={class:"batch"},ie={key:1,class:"setting"},ce={key:3,class:"setting"},re=T({__name:"SelectSeckillProduct",props:{productId:{default:()=>0},productIdModifiers:{},verify:{default:()=>!1},verifyModifiers:{},productList:{default:()=>[]},productListModifiers:{}},emits:["update:productId","update:verify","update:productList"],setup(V){const x=b(V,"productId");b(V,"verify");const L=b(V,"productList"),i=f([]),S=f(!1),N=f(!0);W(()=>{});const v=f(!0),_=f(!0),g=f(""),h=f(),I=a=>{a===1?(i.value.forEach(e=>{e.seconds_seckill&&(e.seckill_price=g.value)}),g.value="",v.value=!v.value):(i.value.forEach(e=>{e.seconds_seckill&&(e.seckill_stock=h.value)}),h.value=void 0,_.value=!_.value)},D=a=>{x.value=a[0],A()},F=()=>{i.value=[]},E=a=>{i.value[a].seconds_seckill=i.value[a].seconds_seckill?0:1},A=async()=>{var a;S.value=!0;try{const e=await j("detail",{id:x.value});console.log(e.item.product_list);let t=e.item;if(t.product_list.length==0){let s={};s.seconds_seckill=1,s.tip_value="已参加",s.seckill_price="",s.seckill_stock="",s.pic_thumb=t.pic_thumb,s.product_name=t.product_name,s.sku_price=t.product_price,s.sku_stock=t.product_stock,i.value.push(s)}else(a=t.product_list)==null||a.forEach(s=>{let o={};o.seconds_seckill=1,o.tip_value="已参加",o.seckill_price="",o.seckill_stock="",o.pic_thumb=t.pic_thumb,o.product_name=t.product_name,o.sku_price=s.sku_price,o.sku_stock=s.sku_stock,o.sku_id=s.sku_id,o.sku_data=s.sku_data,i.value.push(o)})}catch(e){H.error(e.message)}finally{S.value=!1}};return z(()=>i.value,a=>{console.log(a);let e=[];a.length>0&&(a[0].sku_id&&a.forEach(t=>{let s={};t.seconds_seckill&&(s.sku_id=t.sku_id,s.seckill_price=t.seckill_price,s.seckill_stock=t.seckill_stock,e.push(s))}),L.value=e)},{deep:!0,immediate:!0}),(a,e)=>{var P;const t=$("el-button"),s=$("el-space"),o=$("el-input");return u(),n("div",K,[c(s,null,{default:p(()=>{var l;return[c(U(q),{params:{selected_ids:L.value,isMultiple:!1},isDrawer:"",path:"product/product/src/SelectProduct",title:"选择商品",width:"600px",onOkCallback:D},{default:p(()=>{var y;return[c(t,{disabled:((y=i.value)==null?void 0:y.length)>0,type:"primary"},{default:p(()=>e[8]||(e[8]=[k("选择商品")])),_:1},8,["disabled"])]}),_:1},8,["params"]),((l=i.value)==null?void 0:l.length)>0?(u(),M(t,{key:0,onClick:F},{default:p(()=>e[9]||(e[9]=[k("清空")])),_:1})):C("",!0)]}),_:1}),((P=i.value)==null?void 0:P.length)>0&&N.value?(u(),n("div",Q,[d("div",R,[e[11]||(e[11]=G('<div class="product-selected-list-tr product-selected-list-th" data-v-105571ec><div class="col col2" data-v-105571ec>商品信息</div><div class="col col1" data-v-105571ec>秒杀价</div><div class="col col1" data-v-105571ec>秒杀库存</div><div class="col col3" data-v-105571ec>操作</div></div>',1)),(u(!0),n(w,null,B(i.value,(l,y)=>(u(),n("div",X,[d("div",Y,[d("div",Z,[d("img",{src:U(O)(l.pic_thumb),height:"50",width:"50"},null,8,ee),d("span",le,m(l.product_name),1)]),d("ul",null,[(u(!0),n(w,null,B(l.sku_data,r=>(u(),n("li",null,m(r.name)+"："+m(r.value),1))),256))])]),d("div",te,[c(o,{modelValue:l.seckill_price,"onUpdate:modelValue":r=>l.seckill_price=r},null,8,["modelValue","onUpdate:modelValue"]),d("div",se,"价格(元)："+m(l.sku_price),1)]),d("div",oe,[c(o,{modelValue:l.seckill_stock,"onUpdate:modelValue":r=>l.seckill_stock=r},null,8,["modelValue","onUpdate:modelValue"]),d("div",ae,"现有库存："+m(l.sku_stock),1)]),d("div",ue,[l.seconds_seckill?(u(),M(t,{key:0,type:l.tip_value=="取消参加"?"danger":"primary",link:"",onClick:r=>E(y),onMouseout:r=>l.tip_value="已参加",onMouseover:r=>l.tip_value="取消参加"},{default:p(()=>[k(m(l.tip_value),1)]),_:2},1032,["type","onClick","onMouseout","onMouseover"])):(u(),M(t,{key:1,link:"",type:"primary",onClick:r=>E(y)},{default:p(()=>e[10]||(e[10]=[k("参加秒杀")])),_:2},1032,["onClick"]))])]))),256))]),d("div",de,[e[16]||(e[16]=d("span",null,"批量设置：",-1)),_.value&&v.value?(u(),n("div",{key:0,onClick:e[0]||(e[0]=l=>v.value=!v.value)},"秒杀价格")):v.value?C("",!0):(u(),n("div",ie,[c(o,{modelValue:g.value,"onUpdate:modelValue":e[1]||(e[1]=l=>g.value=l),placeholder:"请输入秒杀价格"},null,8,["modelValue"]),c(t,{link:"",type:"primary",onClick:e[2]||(e[2]=l=>I(1))},{default:p(()=>e[12]||(e[12]=[k("保存")])),_:1}),c(t,{link:"",type:"primary",onClick:e[3]||(e[3]=l=>v.value=!v.value)},{default:p(()=>e[13]||(e[13]=[k("取消")])),_:1})])),_.value&&v.value?(u(),n("div",{key:2,onClick:e[4]||(e[4]=l=>_.value=!_.value)},"秒杀库存")):_.value?C("",!0):(u(),n("div",ce,[c(o,{modelValue:h.value,"onUpdate:modelValue":e[5]||(e[5]=l=>h.value=l),placeholder:"请输入秒杀库存"},null,8,["modelValue"]),c(t,{link:"",type:"primary",onClick:e[6]||(e[6]=l=>I(2))},{default:p(()=>e[14]||(e[14]=[k("保存")])),_:1}),c(t,{link:"",type:"primary",onClick:e[7]||(e[7]=l=>_.value=!_.value)},{default:p(()=>e[15]||(e[15]=[k("取消")])),_:1})]))])])):C("",!0)])}}}),ye=J(re,[["__scopeId","data-v-105571ec"]]);export{ye as default};
