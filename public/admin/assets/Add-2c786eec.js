import{d as K,j as u,E as z,s as J,x as P,r as l,o as r,c as Q,e as x,k as n,w as a,b as o,f as q,H as i,h as c,G as b,$ as W,a0 as X,K as k}from"./index-7c2d2aef.js";import"./index-6c62cf9b.js";import{F as Y}from"./UploadAvatar.vue_vue_type_style_index_0_scoped_9bfcfc35_lang-9b6073fb.js";import{g as Z}from"./merchant-1c622968.js";import{d as ee,u as te}from"./shop-b8a8699a.js";import{_ as ae}from"./DialogForm.vue_vue_type_script_setup_true_lang-c57b9a11.js";import"./vuedraggable.umd-75ad0f8f.js";import"./Image.vue_vue_type_script_setup_true_lang-36bd437b.js";import"./format-4e0206d3.js";import"./config-9548fa9b.js";import"./config-e2aa16d1.js";import"./util-1ee03ed8.js";const oe={class:"container"},se={class:"content_wrapper"},le={class:"lyecs-form-table"},re={class:"ssdw"},ne=x("div",{class:"extra"},"请统一上传比例为2:1的图片，宽200px，高100px（高清）",-1),ke=K({__name:"Add",props:{id:{type:Number,default:0},act:{type:String,default:""},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(R,{expose:G,emit:T}){const m=T,p=R,d=u(!1),S=z().currentRoute.value.query,w=u(p.isDialog?p.act:String(S.act)),_=u(p.isDialog?p.id:Number(S.id)),D=w.value==="add"?"create":"update",C=J(),L=u(!1),s=u({merchant_id:Number(S.id)}),E=async()=>{try{const t=await ee(w.value,{shop_id:_.value});Object.assign(s.value,t.item)}catch(t){k.error(t.message),m("close")}finally{d.value=!1}},j=async()=>{try{const t=await Z({merchant_id:_.value});s.value.merchant_id=_.value,f.value=t.filter_result}catch(t){k.error(t.message),m("close")}finally{d.value=!1}},f=u([]),A=async t=>{f.value=t.merchant,s.value.merchant_id=t.merchant_id};P(()=>{D==="update"&&E(),f.value=[],s.value.merchant_id=0,_.value!=0&&(L.value=!0,j())});const N=async()=>{await C.value.validate();try{m("update:confirmLoading",!0);const t=await te(D,{id:_.value,...s.value});m("submitCallback",t),k.success(t.message)}catch(t){k.error(t.message)}finally{m("update:confirmLoading",!1)}};return G({onFormSubmit:()=>{N()}}),(t,y)=>{const I=l("el-input"),g=l("el-form-item"),V=l("el-button"),B=l("Tag"),h=l("el-table-column"),F=l("StatusDot"),U=l("el-table"),$=l("el-form"),H=l("a-spin");return r(),Q("div",oe,[x("div",se,[x("div",le,[d.value?c("",!0):(r(),n($,{key:0,ref_key:"formRef",ref:C,model:s.value,"label-width":"auto"},{default:a(()=>[o(g,{label:"店铺名称",prop:"shop_title",rules:[{required:!0,message:"店铺名称不能为空!"}]},{default:a(()=>[o(I,{modelValue:s.value.shop_title,"onUpdate:modelValue":y[0]||(y[0]=e=>s.value.shop_title=e)},null,8,["modelValue"])]),_:1}),o(g,{label:"所属商户",prop:"merchant_id",rules:[{required:!0,message:"请选择所属商户!"}]},{default:a(()=>[L.value?c("",!0):(r(),n(q(ae),{key:0,params:{isMultiple:!1,selected_ids:[s.value.merchant_id]},isDrawer:"",path:"adminMerchant/merchant/src/SelectMerchant",title:"选择商户",width:"900px",onOkCallback:A},{default:a(()=>[o(V,{type:"primary"},{default:a(()=>[i("选择商户")]),_:1})]),_:1},8,["params"])),f.value.length>0?(r(),n(U,{key:1,data:f.value,"row-key":"merchant_id",class:"mt10"},{default:a(()=>[o(h,{label:"商户所属单位"},{default:a(({row:e})=>[x("div",re,[e.type==1?(r(),n(B,{key:0,transparent:!0,text:"个人"})):(r(),n(B,{key:1,color:"#409EFF",transparent:!1,text:"企业"})),i(" "+b(e.type==1?""+e.corporate_name:""+e.company_name),1)])]),_:1}),o(h,{label:"商户所属会员(ID)"},{default:a(({row:e})=>{var v,M,O;return[i(b((v=e.user)==null?void 0:v.username)+b((M=e.user)!=null&&M.user_id?"("+((O=e.user)==null?void 0:O.user_id)+")":""),1)]}),_:1}),o(h,{label:"商户类型",prop:"type_text",sortable:"custom"}),o(h,{label:"管理员",sortable:"custom"},{default:a(({row:e})=>{var v;return[i(b(((v=e.admin)==null?void 0:v.username)||"--"),1)]}),_:1}),o(h,{label:"认证状态",prop:"status_text",sortable:"custom"},{default:a(({row:e})=>[e.status==1?(r(),n(F,{key:0,color:"#52c41a",flicker:!0})):c("",!0),e.status==2?(r(),n(F,{key:1,color:"#f5222d",flicker:!1})):c("",!0),i(" "+b(e.status_text),1)]),_:1})]),_:1},8,["data"])):c("",!0)]),_:1}),o(g,{label:"店铺LOGO",prop:"shop_logo",rules:[{required:!0,message:"请上传店铺LOGO!"}]},{default:a(()=>[d.value?c("",!0):(r(),n(q(Y),{key:0,photo:s.value.shop_logo,"onUpdate:photo":y[1]||(y[1]=e=>s.value.shop_logo=e)},null,8,["photo"])),ne]),_:1}),W(o(g,{"wrapper-col":{offset:4,span:16}},{default:a(()=>[o(V,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:N},{default:a(()=>[i("提交")]),_:1},512)]),_:1},512),[[X,!p.isDialog]])]),_:1},8,["model"])),o(H,{spinning:d.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}});export{ke as default};
