import{d as D,i as m,C as j,s as U,q as F,I as _,r,c as z,o as w,e as V,j as I,f as M,w as i,b as s,E as O}from"./index-CGYuOau0.js";import{g as $}from"./languagesList-4F0M2hMq.js";import{a as A}from"./translationContent-C0Nq8agy.js";import{g as G,f as H}from"./currencyManagement-Ctv3q6kF.js";const J={class:"container"},K={class:"content_wrapper"},P={class:"lyecs-form-table"},ee=D({__name:"BusinessDialog",props:{id:{type:Number,default:0},data_type:{type:Number,default:0},act:{type:String,default:""},translation_name:{type:String,default:""},isDialog:{type:Boolean,default:!1}},emits:["submitCallback","update:confirmLoading","close"],setup(C,{expose:L,emit:x}){const u=x,o=C,p=m(!0),g=j().currentRoute.value.query,f=m(o.isDialog?o.act:String(g.act)),k=m(o.isDialog?o.id:Number(g.id));f.value;const v=U(),l=m({translation_name:o.translation_name,data_type:o.data_type,items:[]});F(()=>{f.value==="detail"?E():(p.value=!1,y())});const E=async()=>{try{const a=await G({data_type:o.data_type,data_id:o.id});l.value.items=a.item,y()}catch(a){_.error(a.message),u("close")}finally{p.value=!1}},n=m([]),y=async()=>{try{const a=await $({is_enabled:1,size:-1});a.filter_result.forEach(e=>{e.translation_value=""}),Object.assign(n.value,a.filter_result),f.value==="detail"&&l.value.items.length>0&&(console.log(l.value),console.log(n.value),l.value.items.forEach(e=>{n.value.forEach(t=>{e.locale_id===t.id&&(t.translation_value=e.translation_value)})})),console.log(n.value)}catch(a){_.error(a.message),u("close")}finally{p.value=!1}},N=async a=>{await v.value.validate();try{n.value.forEach(async e=>{let t={code:e.locale_code,text:a};const c=await A(t);e.translation_value=c.translation.Translation})}catch(e){_.error(e.message)}},S=a=>{let e=[];return a.forEach(t=>{let c={locale_id:t.id,translation_value:t.translation_value};e.push(c)}),e},B=async()=>{await v.value.validate();try{u("update:confirmLoading",!0);const a=await H({data_id:k.value,...l.value,items:S(n.value)});u("submitCallback",a),_.success(a.message)}catch(a){_.error(a.message)}finally{u("update:confirmLoading",!1)}};return L({onFormSubmit:()=>{B()}}),(a,e)=>{const t=r("el-input"),c=r("el-button"),b=r("el-form-item"),h=r("el-table-column"),T=r("el-table"),R=r("el-form");return w(),z("div",J,[V("div",K,[V("div",P,[p.value?M("",!0):(w(),I(R,{key:0,ref_key:"formRef",ref:v,model:l.value,"label-width":"auto"},{default:i(()=>[s(b,{prop:"translation_name",label:"翻译原文：",rules:[{required:!0,message:"翻译原文不能为空!"}]},{default:i(()=>[s(t,{type:"text",maxlength:"60",modelValue:l.value.translation_name,"onUpdate:modelValue":e[0]||(e[0]=d=>l.value.translation_name=d),style:{width:"300px"},class:"mr10"},null,8,["modelValue"]),s(c,{type:"primary",onClick:e[1]||(e[1]=d=>N(l.value.translation_name))},{default:i(()=>e[2]||(e[2]=[O("一键生成翻译")])),_:1})]),_:1}),s(b,{prop:"language",label:"翻译列表："},{default:i(()=>[s(T,{data:n.value,style:{width:"100%"}},{default:i(()=>[s(h,{prop:"language",label:"语言",width:"180"}),s(h,{prop:"translation_value",label:"翻译内容"},{default:i(({row:d})=>[s(t,{type:"text",modelValue:d.translation_value,"onUpdate:modelValue":q=>d.translation_value=q},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1},8,["model"]))])])])}}});export{ee as default};
