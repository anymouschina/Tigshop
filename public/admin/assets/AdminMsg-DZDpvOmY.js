import{a as j}from"./version-CpBOsX2d.js";import{u as D}from"./config-DNllFJyR.js";import{d as q,dC as G,i as u,G as T,q as H,r as B,c as a,o as s,b,w as x,e as o,F as z,a as L,f as d,g as I,n as S,D as p,j as J,E as K,I as O,_ as Q}from"./index-CGYuOau0.js";/* empty css                                                                    */import{P as W}from"./Pagination-yOfjsBuR.js";import X from"./Collapse-ByP8vNnR.js";import{a as Y,b as Z}from"./adminMsg-B0ORefAQ.js";import"./config-DU8_t5BN.js";import"./Image.vue_vue_type_script_setup_true_lang-D9PqZe9n.js";import"./format-DFT-VJzO.js";import"./order-CoX6hLeE.js";import"./DetailBtn.vue_vue_type_script_setup_true_lang-ME5KrZMt.js";import"./index-B-GURfkM.js";import"./DialogForm.vue_vue_type_script_setup_true_lang-Bmm-M6gU.js";import"./aftersales-C37am-lV.js";const ee="/admin/assets/empty-bg-CEmUzxL0.png",te={class:"message_center"},se={class:"tab_box tab_box1"},ae=["onClick"],ne={key:0,class:"num"},oe=["onClick"],le={key:0,class:"num"},ue={class:"tab_box tab_box2"},ie=["onClick"],ce={key:0,class:"num"},re={class:"list_box"},de={style:{"min-height":"200px"}},_e={key:0,class:"item"},pe={key:1,class:"table-empty"},me={key:0,class:"pagination-con"},ve={class:"btn"},ge=q({__name:"AdminMsg",emits:["callback","update:confirmLoading","close"],setup(fe,{emit:N}){const R=G(),A=N,U=D(),_=u([]),h=u([]),i=u(0),v=u(0),g=u(!0),f=u(!0),l=T({page:1,size:U.get("page_size"),msg_type:11}),c=u([]),k=u(0),m=async()=>{f.value=!0;try{const t=await Y({...l});c.value=t.filter_result,_.value=t.msg_type_arr,h.value=C(_.value[i.value].child),k.value=t.total,g.value=!1}catch(t){O.error(t.message)}finally{f.value=!1}},V=()=>{A("close")};H(()=>{m()});const E=async()=>{await Z(),A("callback",!1),m()},M=t=>{i.value=t,v.value=0,c.value.length=0,l.msg_type=C(_.value[i.value].child)[0].msg_type,m()},F=t=>{l.page=1,v.value=t,c.value.length=0,l.msg_type=C(_.value[i.value].child)[t].msg_type,m()},P=()=>{_.value[i.value].unread_count-=1,h.value[v.value].unread_count-=1,R.messageCount-=1},C=t=>{if(typeof t=="object"){var n=[];for(let y in t)n.push(t[y]);return n}else return t};return(t,n)=>{const y=B("a-spin"),$=B("el-button");return s(),a("div",null,[b(y,{spinning:g.value},{default:x(()=>[o("div",te,[o("div",se,[(s(!0),a(z,null,L(_.value,(e,r)=>(s(),a("div",null,[e.cat_id==4&&I(j)()?(s(),a("div",{key:0,class:S(["tab",i.value==r?"current":""]),onClick:w=>M(r)},[o("p",null,p(e.cat_name),1),e.unread_count>0?(s(),a("p",ne,p(e.unread_count),1)):d("",!0)],10,ae)):e.cat_id!=4?(s(),a("div",{key:1,class:S(["tab",i.value==r?"current":""]),onClick:w=>M(r)},[o("p",null,p(e.cat_name),1),e.unread_count>0?(s(),a("p",le,p(e.unread_count),1)):d("",!0)],10,oe)):d("",!0)]))),256))]),o("div",ue,[(s(!0),a(z,null,L(h.value,(e,r)=>(s(),a("div",{class:S(["tab",v.value==r?"current":""]),onClick:w=>F(r)},[o("p",null,p(e.name),1),e.unread_count>0?(s(),a("p",ce,p(e.unread_count),1)):d("",!0)],10,ie))),256))]),o("div",re,[b(y,{spinning:f.value&&!g.value,style:{width:"100%"}},{default:x(()=>[o("div",de,[c.value.length>0?(s(),a("div",_e,[(s(!0),a(z,null,L(c.value,e=>(s(),J(X,{item:e,msg_type:e.msg_type,key:e.msg_type,onSetReadedCallback:P,onClose:V},null,8,["item","msg_type"]))),128))])):d("",!0),c.value.length===0&&!f.value&&!g.value?(s(),a("div",pe,n[2]||(n[2]=[o("img",{src:ee,alt:""},null,-1),o("p",null,"当前暂无消息哟",-1)]))):d("",!0)])]),_:1},8,["spinning"]),c.value.length>0&&k.value>0?(s(),a("div",me,[b(I(W),{page:l.page,"onUpdate:page":n[0]||(n[0]=e=>l.page=e),size:l.size,"onUpdate:size":n[1]||(n[1]=e=>l.size=e),background:!1,total:k.value,onCallback:m},null,8,["page","size","total"])])):d("",!0)]),o("div",ve,[b($,{onClick:E},{default:x(()=>n[3]||(n[3]=[K("全部已读")])),_:1})])])]),_:1},8,["spinning"])])}}}),Re=Q(ge,[["__scopeId","data-v-babab82d"]]);export{Re as default};
