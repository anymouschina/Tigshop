import{d as F,i as u,C as L,s as M,p as h,q as E,r as s,c as j,o as V,e as v,b as t,j as A,f as G,w as r,a3 as P,g as S,E as _,a4 as $,I as c}from"./index-DrbzVNl6.js";import{F as z}from"./UploadAvatar.vue_vue_type_style_index_0_scoped_9bfcfc35_lang-BDvYUQtN.js";import"./index-CeQDmMxd.js";import"./vuedraggable.umd-DAKh-e3Q.js";import{a as H,b as J}from"./material-CEolRWRb.js";import{_ as K}from"./selectCategory.vue_vue_type_script_setup_true_lang-B-kT_0F7.js";import"./SelectTimeInterval.vue_vue_type_style_index_0_scoped_207fe586_lang-MgR9Z6jO.js";import{S as O}from"./SelectProduct-BHvR_Ddk.js";/* empty css                                                                    *//* empty css                                                                              *//* empty css             */import"./Image.vue_vue_type_script_setup_true_lang-BWzCs9jv.js";import"./format-CRgx78oe.js";import"./DialogForm.vue_vue_type_script_setup_true_lang-DqYSRv0_.js";import"./category-CCI4VFuO.js";import"./time-Bh5UhrfW.js";import"./product-DEi2MlvQ.js";import"./Pagination-wR9huHyl.js";import"./SelectSku--IXQGnUO.js";/* empty css                                                                  */const Q={class:"container"},W={class:"content_wrapper"},X={class:"lyecs-form-table"},Y={class:"lyecs-form-table"},Ie=F({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(k,{expose:C,emit:T}){const p=T,n=k,d=u(!0),g=L().currentRoute.value.query,f=u(n.isDialog?n.act:String(g.act)),y=u(n.isDialog?n.id:Number(g.id)),q=f.value==="add"?"create":"update",b=M(),m=u([]);h(m.value,o=>{console.log(o),a.value.productId=o[0]},{deep:!0});const a=u({isTop:0,content:""}),x=async()=>{try{const o=await H(f.value,{id:y.value});o.productId&&o.productId!=="null"&&(m.value=[Number(o.productId)]),a.value=o}catch(o){c.error(o.message),p("close")}finally{d.value=!1}};E(()=>{f.value==="detail"?x():d.value=!1});const I=async()=>{if(await b.value.validate(),a.value.productId){c.error("请选择商品!");return}try{p("update:confirmLoading",!0);const o=await J(q,{id:y.value,...a.value});p("submitCallback",o),c.success("操作成功")}catch(o){c.error(o.message)}finally{p("update:confirmLoading",!1)}};return C({onFormSubmit:()=>{I()}}),(o,e)=>{const i=s("el-form-item"),B=s("TigInput"),w=s("el-radio"),N=s("el-radio-group"),D=s("el-button"),R=s("el-form"),U=s("a-spin");return V(),j("div",Q,[v("div",W,[v("div",X,[v("div",Y,[d.value?G("",!0):(V(),A(R,{key:0,ref_key:"formRef",ref:b,model:a.value,"label-width":"auto"},{default:r(()=>[t(i,{label:"素材图片",prop:"pics",rules:[{required:!0,message:"素材图片不能为空!"}]},{default:r(()=>[t(S(z),{photos:a.value.pics,"onUpdate:photos":e[0]||(e[0]=l=>a.value.pics=l),isMultiple:""},null,8,["photos"])]),_:1}),t(i,{label:"素材分类",prop:"categoryId",rules:[{required:!0,message:"请选择素材分类!"}]},{default:r(()=>[t(K,{categoryId:a.value.categoryId,"onUpdate:categoryId":e[1]||(e[1]=l=>a.value.categoryId=l)},null,8,["categoryId"])]),_:1}),t(i,{rules:[{required:!0,message:"素材内容不能为空!"}],label:"素材内容",prop:"content"},{default:r(()=>[t(B,{classType:"tig-form-input",modelValue:a.value.content,"onUpdate:modelValue":e[2]||(e[2]=l=>a.value.content=l),rows:5,type:"textarea"},null,8,["modelValue"])]),_:1}),t(i,{label:"选择商品",prop:"productId",rules:[{required:!0,message:"请选择商品!"}]},{default:r(()=>[t(S(O),{isMultiple:!1,ids:m.value,"onUpdate:ids":e[3]||(e[3]=l=>m.value=l)},null,8,["ids"])]),_:1}),t(i,{label:"是否置顶",prop:"isTop"},{default:r(()=>[t(N,{modelValue:a.value.isTop,"onUpdate:modelValue":e[4]||(e[4]=l=>a.value.isTop=l)},{default:r(()=>[t(w,{value:1},{default:r(()=>e[5]||(e[5]=[_("置顶")])),_:1}),t(w,{value:0},{default:r(()=>e[6]||(e[6]=[_("不置顶")])),_:1})]),_:1},8,["modelValue"])]),_:1}),P(t(i,{"wrapper-col":{offset:4,span:16}},{default:r(()=>[t(D,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:I},{default:r(()=>e[7]||(e[7]=[_("提交")])),_:1},512)]),_:1},512),[[$,!n.isDialog]])]),_:1},8,["model"]))]),t(U,{spinning:d.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}});export{Ie as default};
