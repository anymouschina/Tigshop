import{d as j,i as d,C as E,s as F,q as I,r as n,c as M,o as V,e as R,j as O,f as T,b as o,w as l,a0 as z,E as _,a1 as A,I as c}from"./index-CGYuOau0.js";import{c as G,a as H,e as J}from"./region-dYomvalu.js";import{u as K}from"./region-DycKrsYv.js";const P={class:"container"},Q={class:"content_wrapper"},W={class:"lyecs-form-table"},ee=j({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},isDialog:Boolean,region_id:{type:Number,default:0}},emits:["submitCallback","update:confirmLoading","close"],setup(h,{expose:k,emit:C}){const S=K(),i=C,s=h,u=d(!0),f=E().currentRoute.value.query,p=d(s.isDialog?s.act:String(f.act)),g=d(s.isDialog?s.id:Number(f.id)),N=p.value==="add"?"create":"update",v=F(),t=d({is_hot:0}),x=async()=>{try{const e=await G(p.value,{id:g.value});Object.assign(t.value,e.item)}catch(e){c.error(e.message),i("close")}finally{u.value=!1}},B=async()=>{try{const e=await H({region_id:s.region_id});e.filter_result&&e.filter_result.length>0?(t.value.parent_id=e.filter_result[0].region_id,t.value.parent_name=e.filter_result[0].region_name):(t.value.parent_id=0,t.value.parent_name="顶级地区")}catch(e){c.error(e.message)}};I(()=>{p.value==="detail"?x():u.value=!1,B()});const b=async()=>{await v.value.validate();try{i("update:confirmLoading",!0);const e=await J(N,{id:g.value,...t.value});S.clearRegion(),i("submitCallback",e),c.success(e.message)}catch(e){c.error(e.message)}finally{i("update:confirmLoading",!1)}};return k({onFormSubmit:()=>{b()}}),(e,a)=>{const y=n("el-input"),m=n("el-form-item"),w=n("el-radio"),D=n("el-radio-group"),L=n("el-button"),q=n("el-form"),U=n("a-spin");return V(),M("div",P,[R("div",Q,[R("div",W,[u.value?T("",!0):(V(),O(q,{key:0,ref_key:"formRef",ref:v,model:t.value,"label-width":"auto"},{default:l(()=>[o(m,{rules:[{required:!0,message:"地区名称不能为空!"}],label:"地区名称",prop:"region_name"},{default:l(()=>[o(y,{modelValue:t.value.region_name,"onUpdate:modelValue":a[0]||(a[0]=r=>t.value.region_name=r)},null,8,["modelValue"])]),_:1}),o(m,{label:"上级地区",prop:"parent_name"},{default:l(()=>[o(y,{disabled:"",modelValue:t.value.parent_name,"onUpdate:modelValue":a[1]||(a[1]=r=>t.value.parent_name=r)},null,8,["modelValue"])]),_:1}),o(m,{label:"是否热门",prop:"is_hot"},{default:l(()=>[o(D,{modelValue:t.value.is_hot,"onUpdate:modelValue":a[2]||(a[2]=r=>t.value.is_hot=r),style:{width:"100%"}},{default:l(()=>[o(w,{value:1},{default:l(()=>a[3]||(a[3]=[_("是")])),_:1}),o(w,{value:0},{default:l(()=>a[4]||(a[4]=[_("否")])),_:1})]),_:1},8,["modelValue"])]),_:1}),z(o(m,{"wrapper-col":{offset:4,span:16}},{default:l(()=>[o(L,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:b},{default:l(()=>a[5]||(a[5]=[_("提交")])),_:1},512)]),_:1},512),[[A,!s.isDialog]])]),_:1},8,["model"])),o(U,{spinning:u.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}});export{ee as default};
