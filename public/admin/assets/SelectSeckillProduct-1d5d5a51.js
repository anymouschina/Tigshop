import"./index-6c62cf9b.js";import{i as O}from"./format-4e0206d3.js";import{d as j}from"./product-689c7c1e.js";import{_ as G}from"./DialogForm.vue_vue_type_script_setup_true_lang-c57b9a11.js";import{d as H,u as S,j as f,x as K,v as T,r as b,o as a,c as n,b as i,w as p,f as w,H as k,k as x,h as V,e as d,F as B,a as E,G as y,aU as q,K as z,p as J,i as Q,_ as R}from"./index-7c2d2aef.js";import"./config-9548fa9b.js";import"./config-e2aa16d1.js";import"./util-1ee03ed8.js";const W=m=>(J("data-v-105571ec"),m=m(),Q(),m),X={class:"lyecs-product-select-group"},Y={key:0,class:"lyecs-product-selected-con"},Z={class:"product-selected-list"},ee=q('<div class="product-selected-list-tr product-selected-list-th" data-v-105571ec><div class="col col2" data-v-105571ec>商品信息</div><div class="col col1" data-v-105571ec>秒杀价</div><div class="col col1" data-v-105571ec>秒杀库存</div><div class="col col3" data-v-105571ec>操作</div></div>',1),le={class:"product-selected-list-tr"},te={class:"col col2 product-info"},se={style:{display:"flex"}},oe=["src"],ce={style:{"line-height":"2"}},ae={class:"col col1"},de={class:"extra"},ue={class:"col col1"},ie={class:"extra"},re={class:"col col3"},ne={class:"batch"},pe=W(()=>d("span",null,"批量设置：",-1)),_e={key:1,class:"setting"},ve={key:3,class:"setting"},ke=H({__name:"SelectSeckillProduct",props:{productId:{default:()=>0},productIdModifiers:{},verify:{default:()=>!1},verifyModifiers:{},productList:{default:()=>[]},productListModifiers:{}},emits:["update:productId","update:verify","update:productList"],setup(m){const $=S(m,"productId");S(m,"verify");const M=S(m,"productList"),u=f([]),I=f(!1),N=f(!0);K(()=>{});const _=f(!0),v=f(!0),g=f(""),C=f(),L=c=>{c===1?(u.value.forEach(e=>{e.seconds_seckill&&(e.seckill_price=g.value)}),g.value="",_.value=!_.value):(u.value.forEach(e=>{e.seconds_seckill&&(e.seckill_stock=C.value)}),C.value=void 0,v.value=!v.value)},F=c=>{$.value=c[0],D()},A=()=>{u.value=[]},P=c=>{u.value[c].seconds_seckill=u.value[c].seconds_seckill?0:1},D=async()=>{var c;I.value=!0;try{const e=await j("detail",{id:$.value});console.log(e.item.product_list);let t=e.item;if(t.product_list.length==0){let s={};s.seconds_seckill=1,s.tip_value="已参加",s.seckill_price="",s.seckill_stock="",s.pic_thumb=t.pic_thumb,s.product_name=t.product_name,s.sku_price=t.product_price,s.sku_stock=t.product_stock,u.value.push(s)}else(c=t.product_list)==null||c.forEach(s=>{let o={};o.seconds_seckill=1,o.tip_value="已参加",o.seckill_price="",o.seckill_stock="",o.pic_thumb=t.pic_thumb,o.product_name=t.product_name,o.sku_price=s.sku_price,o.sku_stock=s.sku_stock,o.sku_id=s.sku_id,o.sku_data=s.sku_data,u.value.push(o)})}catch(e){z.error(e.message)}finally{I.value=!1}};return T(()=>u.value,c=>{console.log(c);let e=[];c.length>0&&(c[0].sku_id&&c.forEach(t=>{let s={};t.seconds_seckill&&(s.sku_id=t.sku_id,s.seckill_price=t.seckill_price,s.seckill_stock=t.seckill_stock,e.push(s))}),M.value=e)},{deep:!0,immediate:!0}),(c,e)=>{var U;const t=b("el-button"),s=b("el-space"),o=b("el-input");return a(),n("div",X,[i(s,null,{default:p(()=>{var l;return[i(w(G),{params:{selected_ids:M.value,isMultiple:!1},isDrawer:"",path:"product/product/src/SelectProduct",title:"选择商品",width:"600px",onOkCallback:F},{default:p(()=>{var h;return[i(t,{disabled:((h=u.value)==null?void 0:h.length)>0,type:"primary"},{default:p(()=>[k("选择商品")]),_:1},8,["disabled"])]}),_:1},8,["params"]),((l=u.value)==null?void 0:l.length)>0?(a(),x(t,{key:0,onClick:A},{default:p(()=>[k("清空")]),_:1})):V("",!0)]}),_:1}),((U=u.value)==null?void 0:U.length)>0&&N.value?(a(),n("div",Y,[d("div",Z,[ee,(a(!0),n(B,null,E(u.value,(l,h)=>(a(),n("div",le,[d("div",te,[d("div",se,[d("img",{src:w(O)(l.pic_thumb),height:"50",width:"50"},null,8,oe),d("span",ce,y(l.product_name),1)]),d("ul",null,[(a(!0),n(B,null,E(l.sku_data,r=>(a(),n("li",null,y(r.name)+"："+y(r.value),1))),256))])]),d("div",ae,[i(o,{modelValue:l.seckill_price,"onUpdate:modelValue":r=>l.seckill_price=r},null,8,["modelValue","onUpdate:modelValue"]),d("div",de,"价格(元)："+y(l.sku_price),1)]),d("div",ue,[i(o,{modelValue:l.seckill_stock,"onUpdate:modelValue":r=>l.seckill_stock=r},null,8,["modelValue","onUpdate:modelValue"]),d("div",ie,"现有库存："+y(l.sku_stock),1)]),d("div",re,[l.seconds_seckill?(a(),x(t,{key:0,type:l.tip_value=="取消参加"?"danger":"primary",link:"",onClick:r=>P(h),onMouseout:r=>l.tip_value="已参加",onMouseover:r=>l.tip_value="取消参加"},{default:p(()=>[k(y(l.tip_value),1)]),_:2},1032,["type","onClick","onMouseout","onMouseover"])):(a(),x(t,{key:1,link:"",type:"primary",onClick:r=>P(h)},{default:p(()=>[k("参加秒杀")]),_:2},1032,["onClick"]))])]))),256))]),d("div",ne,[pe,v.value&&_.value?(a(),n("div",{key:0,onClick:e[0]||(e[0]=l=>_.value=!_.value)},"秒杀价格")):_.value?V("",!0):(a(),n("div",_e,[i(o,{modelValue:g.value,"onUpdate:modelValue":e[1]||(e[1]=l=>g.value=l),placeholder:"请输入秒杀价格"},null,8,["modelValue"]),i(t,{link:"",type:"primary",onClick:e[2]||(e[2]=l=>L(1))},{default:p(()=>[k("保存")]),_:1}),i(t,{link:"",type:"primary",onClick:e[3]||(e[3]=l=>_.value=!_.value)},{default:p(()=>[k("取消")]),_:1})])),v.value&&_.value?(a(),n("div",{key:2,onClick:e[4]||(e[4]=l=>v.value=!v.value)},"秒杀库存")):v.value?V("",!0):(a(),n("div",ve,[i(o,{modelValue:C.value,"onUpdate:modelValue":e[5]||(e[5]=l=>C.value=l),placeholder:"请输入秒杀库存"},null,8,["modelValue"]),i(t,{link:"",type:"primary",onClick:e[6]||(e[6]=l=>L(2))},{default:p(()=>[k("保存")]),_:1}),i(t,{link:"",type:"primary",onClick:e[7]||(e[7]=l=>v.value=!v.value)},{default:p(()=>[k("取消")]),_:1})]))])])):V("",!0)])}}});const be=R(ke,[["__scopeId","data-v-105571ec"]]);export{be as default};
