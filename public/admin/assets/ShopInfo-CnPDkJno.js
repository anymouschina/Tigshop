import{d as O,i as u,C as Q,s as z,G as H,q as J,r as s,c as y,o as d,e as L,j as c,f as x,b as t,w as l,a3 as K,g as P,E as v,F as N,a as W,a4 as X,aQ as Y,I as _,_ as Z}from"./index-DrbzVNl6.js";import"./index-CeQDmMxd.js";import"./vuedraggable.umd-DAKh-e3Q.js";import"./UploadAvatar.vue_vue_type_style_index_0_scoped_9bfcfc35_lang-BDvYUQtN.js";import{U as $}from"./UploadAvatar-BpP27mBH.js";import{i as ee,h as ae,j as te}from"./adminUser-CTRuV4iV.js";import oe from"./AuthoritySelect-C_HT6Og3.js";import"./Image.vue_vue_type_script_setup_true_lang-BWzCs9jv.js";import"./format-CRgx78oe.js";import"./DialogForm.vue_vue_type_script_setup_true_lang-DqYSRv0_.js";import"./authority-C-nKXejU.js";const le={class:"container"},re={class:"content_wrapper"},se={class:"lyecs-form-table"},ne=O({__name:"ShopInfo",props:{id:{type:Number,default:0},suppliersId:{type:Number,default:0},act:{type:String,default:""},type:{type:String,default:""},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(A,{expose:T,emit:B}){const f=B;u(localStorage.getItem("adminType"));const i=A,p=u(!0),V=Q().currentRoute.value.query,g=u(i.isDialog?i.act:String(V.act)),I=u(i.isDialog?i.id:Number(V.id)),w=g.value==="add"?"create":"update",U=z(),a=H({userId:""}),S=u(),q=u({}),b=u(!0),D=async()=>{var r;try{const e=await ee(g.value,{id:I.value});q.value=e.user,Object.assign(a,e),e.authList==null&&(a.authList=[]),a.mobile=(r=e.adminUser)==null?void 0:r.mobile;let m=Y(String(a.avatar));m=="one"?b.value=!0:m=="def"&&(b.value=!1)}catch(e){_.error(e.message),f("close")}finally{p.value=!1}},R=async()=>{try{const r=await ae();S.value=r}catch(r){_.error(r.message)}};J(()=>{g.value==="detail"?D():p.value=!1,w!="update"&&i.type==="suppliers"&&(a.roleId=2,a.suppliersId=i.suppliersId),R()});const h=async()=>{await U.value.validate();try{f("update:confirmLoading",!0);let r={avatar:""};!a.avatar&&a.defAvatar?r.avatar=a.defAvatar:r.avatar=a.avatar;const e=await te(w,{id:I.value,...a,avatar:r.avatar});f("submitCallback",e),_.success("操作成功")}catch(r){_.error(r.message)}finally{f("update:confirmLoading",!1)}};return T({onFormSubmit:()=>{h()}}),(r,e)=>{const m=s("TigInput"),n=s("el-form-item"),k=s("el-radio"),F=s("el-radio-group"),C=s("el-option"),j=s("el-select"),E=s("el-button"),G=s("el-form"),M=s("a-spin");return d(),y("div",le,[L("div",re,[L("div",se,[p.value?x("",!0):(d(),c(G,{key:0,ref_key:"formRef",ref:U,model:a,"label-width":"auto"},{default:l(()=>[t(n,{rules:[{required:!0,message:"员工名称不能为空!"}],label:"员工名称",prop:"username"},{default:l(()=>[t(m,{width:"100%",modelValue:a.username,"onUpdate:modelValue":e[0]||(e[0]=o=>a.username=o)},null,8,["modelValue"])]),_:1}),t(n,{label:"手机号",prop:"mobile",rules:[{required:!0,message:"手机号不能为空!"}]},{default:l(()=>[t(m,{width:"100%",modelValue:a.mobile,"onUpdate:modelValue":e[1]||(e[1]=o=>a.mobile=o)},null,8,["modelValue"])]),_:1}),t(n,{label:"邮箱",prop:"email"},{default:l(()=>[t(m,{width:"100%",modelValue:a.email,"onUpdate:modelValue":e[2]||(e[2]=o=>a.email=o)},null,8,["modelValue"])]),_:1}),t(n,{label:"头像",prop:"avatar"},{default:l(()=>[t(P($),{avatar:a.avatar,"onUpdate:avatar":e[3]||(e[3]=o=>a.avatar=o),avatarType:b.value,loading:p.value},null,8,["avatar","avatarType","loading"])]),_:1}),t(n,{label:"是否停用",prop:"isUsing"},{default:l(()=>[t(F,{style:{width:"100%"},modelValue:a.isUsing,"onUpdate:modelValue":e[4]||(e[4]=o=>a.isUsing=o)},{default:l(()=>[t(k,{value:1},{default:l(()=>e[7]||(e[7]=[v("是")])),_:1}),t(k,{value:0},{default:l(()=>e[8]||(e[8]=[v("否")])),_:1})]),_:1},8,["modelValue"])]),_:1}),t(n,{label:"员工权限组",prop:"roleId"},{default:l(()=>[a.roleId!=2?(d(),c(j,{key:0,modelValue:a.roleId,"onUpdate:modelValue":e[5]||(e[5]=o=>a.roleId=o),style:{width:"100%"}},{default:l(()=>[t(C,{value:0,label:"自定义权限"}),(d(!0),y(N,null,W(S.value,o=>(d(),c(C,{label:o.roleName,value:o.roleId},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])):(d(),y(N,{key:1},[v(" 供应商")],64))]),_:1}),a.roleId===0?(d(),c(n,{key:0,label:"",prop:"authList"},{default:l(()=>[t(oe,{modelValue:a.authList,"onUpdate:modelValue":e[6]||(e[6]=o=>a.authList=o)},null,8,["modelValue"])]),_:1})):x("",!0),K(t(n,{"wrapper-col":{offset:4,span:16}},{default:l(()=>[t(E,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:h},{default:l(()=>e[9]||(e[9]=[v("提交")])),_:1},512)]),_:1},512),[[X,!i.isDialog]])]),_:1},8,["model"])),t(M,{spinning:p.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}}),Ve=Z(ne,[["__scopeId","data-v-d9c35280"]]);export{Ve as default};
