import{d as Z,i as p,G as P,q as ee,c as f,e as s,b as t,f as y,L as te,w as l,g as w,K as Y,I as U,r as d,o as c,E as n,D as _,bd as oe,_ as le}from"./index-CGYuOau0.js";/* empty css             */import"./SelectTimeInterval.vue_vue_type_style_index_0_scoped_207fe586_lang-t3_hMxDC.js";import"./index-B-GURfkM.js";import{p as q}from"./format-DFT-VJzO.js";import{u as se}from"./config-DNllFJyR.js";/* empty css                                                                    */import{P as ae}from"./Pagination-yOfjsBuR.js";/* empty css                                                                  *//* empty css                                                                              */import{S as ne}from"./SelectTimeInterval-BYQIPzkk.js";import{f as v}from"./time-ClyPenjC.js";import{a as re,b as de}from"./performanceSettlement-D1K7yV2-.js";import{r as ie}from"./export-Bb89fUlC.js";import{_ as _e}from"./DialogForm.vue_vue_type_script_setup_true_lang-Bmm-M6gU.js";import"./config-DU8_t5BN.js";const me={class:"container"},ue={class:"content_wrapper"},pe={class:"lyecs-table-list-warp"},fe={class:"list-table-tool lyecs-search-warp"},ce={class:"advanced-search-warp list-table-tool-row"},ve={class:"simple-form-warp"},ge={class:"simple-form-field mr10"},be={class:"form-group"},ye={class:"control-container"},we={class:"simple-form-field"},xe={class:"form-group"},Ye={class:"control-container flex flex-align-center"},De={class:"simple-form-field"},Ve={class:"form-group"},ke={class:"mr10"},Ce={class:"simple-form-field"},Me={class:"form-group"},he={key:0,class:"simple-form-field"},Se={class:"form-group"},Ue={class:"control-container"},ze={class:"simple-form-field"},Ie={style:{"padding-top":"30px"}},Ee={class:"extra"},$e={key:0},Oe={key:1},Le={class:"dialog-footer"},Ne={class:"table-container"},Pe={class:"flex flex-align-center"},qe={class:"empty-warp"},Be={key:0,class:"empty-bg"},Ke={key:0,class:"pagination-con"},Te={key:0,class:"selected-action-warp"},Fe={class:"selected-action"},Ge=Z({__name:"List",setup(We){const z=se(),I=p([]),D=p(!0),V=p(0);p(0);const h=p([]),a=P({page:1,size:z.pageSize,sort_field:"",sort_order:"",order_sn:"",order_time_start:"",order_time_end:"",time_type:1}),k=p(!1),g=P({range:0,is_export:1}),B=()=>{a.order_time_start===""&&a.order_time_end===""?U.error("请选择时间范围"):k.value=!0},K=async()=>{try{const r=await de({...a,...g});ie(r,"分销员业绩结算表")}catch(r){U.error(r.message)}},S=p(-1),E=r=>{if(r===-1){S.value=r;return}a.order_time_start=v(new Date,"YYYY-MM-DD"),r===0&&(a.order_time_end=v(new Date,"YYYY-MM-DD")),r===1&&(a.order_time_start=v(Y(1,"sub"),"YYYY-MM-DD"),a.order_time_end=v(Y(1,"sub"),"YYYY-MM-DD")),r===2&&(a.order_time_end=v(Y(7,"add"),"YYYY-MM-DD")),r===3&&(a.order_time_end=v(Y(30,"add"),"YYYY-MM-DD")),r===4&&(a.order_time_end=v(Y(180,"add"),"YYYY-MM-DD")),b()},T=(r,e)=>{let M="--",m=1;return r.commission_data&&(m=r.commission_type,M=`${m==3?"":"比例"}${e}${m==3?z.get("amount_unit"):"%"}（按实付金额计算）`),M},b=async()=>{D.value=!0;try{const r=await re({...a});I.value=r.filter_result,V.value=r.total}catch(r){U.error(r.message)}finally{D.value=!1}};ee(()=>{b()});const C=()=>{b()},F=({prop:r,order:e})=>{a.sort_field=r,a.sort_order=e=="ascending"?"asc":e=="descending"?"desc":"",b()},G=r=>{h.value=r.map(e=>e.product_id)};return(r,e)=>{const M=d("el-input"),m=d("el-option"),$=d("el-select"),x=d("el-radio-button"),O=d("el-radio-group"),u=d("el-button"),L=d("el-radio"),W=d("el-form-item"),j=d("el-form"),A=d("el-dialog"),i=d("el-table-column"),H=d("el-icon"),J=d("el-tooltip"),Q=d("el-table"),R=d("a-spin"),X=d("el-space");return c(),f("div",me,[s("div",ue,[s("div",pe,[s("div",fe,[s("div",ce,[s("div",ve,[s("div",ge,[s("div",be,[e[12]||(e[12]=s("label",{class:"control-label"},[s("span",null,"订单编号：")],-1)),s("div",ye,[t(M,{modelValue:a.order_sn,"onUpdate:modelValue":e[0]||(e[0]=o=>a.order_sn=o),name:"order_sn",placeholder:"请输入订单编号",onKeyup:te(C,["enter"]),clearable:"",onClear:C},null,8,["modelValue"])])])]),s("div",we,[s("div",xe,[e[13]||(e[13]=s("label",{class:"control-label"},[s("span",null,"筛选时间：")],-1)),s("div",Ye,[t($,{modelValue:a.time_type,"onUpdate:modelValue":e[1]||(e[1]=o=>a.time_type=o),placeholder:"请选择时间",style:{width:"100px","margin-right":"10px"}},{default:l(()=>[t(m,{label:"下单时间",value:1}),t(m,{label:"退款时间",value:2})]),_:1},8,["modelValue"])])])]),s("div",De,[s("div",Ve,[s("div",ke,[t(w(ne),{type:"date","start-date":a.order_time_start,"onUpdate:startDate":e[2]||(e[2]=o=>a.order_time_start=o),"end-date":a.order_time_end,"onUpdate:endDate":e[3]||(e[3]=o=>a.order_time_end=o),onCallback:e[4]||(e[4]=o=>E(-1))},null,8,["start-date","end-date"])])])]),s("div",Ce,[s("div",Me,[t(O,{class:"itemWidth mr10",modelValue:S.value,"onUpdate:modelValue":e[5]||(e[5]=o=>S.value=o),onChange:E},{default:l(()=>[t(x,{value:0},{default:l(()=>e[14]||(e[14]=[n("今天")])),_:1}),t(x,{value:1},{default:l(()=>e[15]||(e[15]=[n("昨天")])),_:1}),t(x,{value:2},{default:l(()=>e[16]||(e[16]=[n("近7天")])),_:1}),t(x,{value:3},{default:l(()=>e[17]||(e[17]=[n("近30天")])),_:1}),t(x,{value:4},{default:l(()=>e[18]||(e[18]=[n("近半年")])),_:1})]),_:1},8,["modelValue"])])]),a.time_type===1?(c(),f("div",he,[s("div",Se,[e[19]||(e[19]=s("label",{class:"control-label"},[s("span",null,"结算状态：")],-1)),s("div",Ue,[t($,{modelValue:a.status,"onUpdate:modelValue":e[6]||(e[6]=o=>a.status=o),placeholder:"请选择",style:{width:"200px","margin-right":"10px"},onChange:C,clearable:""},{default:l(()=>[t(m,{label:"未结算",value:0}),t(m,{label:"已结算",value:1})]),_:1},8,["modelValue"])])])])):y("",!0),s("div",ze,[t(u,{type:"primary",onClick:C},{default:l(()=>e[20]||(e[20]=[n("搜索")])),_:1}),t(u,{onClick:B},{default:l(()=>e[21]||(e[21]=[n("导出")])),_:1})])])])]),t(A,{modelValue:k.value,"onUpdate:modelValue":e[9]||(e[9]=o=>k.value=o),title:"导出数据",width:"500",top:"30vh","append-to-body":"",style:{zIndex:2e3}},{footer:l(()=>[s("div",Le,[t(u,{onClick:e[8]||(e[8]=o=>k.value=!1)},{default:l(()=>e[24]||(e[24]=[n("取消")])),_:1}),t(u,{type:"primary",onClick:K},{default:l(()=>e[25]||(e[25]=[n(" 导出 ")])),_:1})])]),default:l(()=>[s("div",Ie,[t(j,{model:g,"label-width":"100px"},{default:l(()=>[t(W,{label:"导出维度："},{default:l(()=>[s("div",null,[t(O,{modelValue:g.range,"onUpdate:modelValue":e[7]||(e[7]=o=>g.range=o)},{default:l(()=>[t(L,{value:0},{default:l(()=>e[22]||(e[22]=[n("商品维度")])),_:1}),t(L,{value:1},{default:l(()=>e[23]||(e[23]=[n("订单维度")])),_:1})]),_:1},8,["modelValue"]),s("div",Ee,[g.range==0?(c(),f("div",$e,"以商品维度导出，每个商品展示一行")):y("",!0),g.range==1?(c(),f("div",Oe,"以订单维度导出，每个订单展示一行")):y("",!0)])])]),_:1})]),_:1},8,["model"])])]),_:1},8,["modelValue"]),s("div",Ne,[t(R,{spinning:D.value},{default:l(()=>[t(Q,{data:I.value,total:V.value,"row-key":"product_id",onSelectionChange:G,onSortChange:F},{empty:l(()=>[s("div",qe,[D.value?y("",!0):(c(),f("div",Be,"暂无数据"))])]),default:l(()=>[t(i,{type:"selection",width:"32",fixed:"left"}),t(i,{label:"订单号",prop:"order_id",width:180,fixed:"left"},{default:l(({row:o})=>[t(w(_e),{params:{act:"detail",id:o.order_user_info.order_id},showClose:!1,showOnOk:!1,title:"订单详情 "+o.order_user_info.order_sn,isDrawer:"",path:"order/order/Info",width:"880px",onCallback:b},{default:l(()=>[t(u,{link:"",type:"primary"},{default:l(()=>[n(_(o.order_user_info.order_sn),1)]),_:2},1024)]),_:2},1032,["params","title"])]),_:1}),t(i,{prop:"order_amount",width:100},{header:l(()=>[s("div",Pe,[e[27]||(e[27]=s("p",null,"成交金额",-1)),t(J,{placement:"bottom-start",effect:"light"},{content:l(()=>e[26]||(e[26]=[n(" 不计运费、税费和附加费 ")])),default:l(()=>[t(H,{size:"16",color:"#c8c9cc",style:{"margin-left":"5px"}},{default:l(()=>[t(w(oe))]),_:1})]),_:1})])]),default:l(({row:o})=>[n(_(w(q)(o.userOrderItem.total_product_money)),1)]),_:1}),t(i,{label:"分销员",width:140},{default:l(({row:o})=>[n(_(o.salesman.base_user_info.nickname||o.salesman.base_user_info.username),1)]),_:1}),t(i,{label:"客户",width:140},{default:l(({row:o})=>[n(_(o.order_user_info.user.nickname),1)]),_:1}),t(i,{label:"收益类型",width:140},{default:l(({row:o})=>e[28]||(e[28]=[n(" 商品佣金 ")])),_:1}),t(i,{label:"收益组成",width:240},{default:l(({row:o})=>[n(_(T(o.salesman_product_data,o.profit_composition)),1)]),_:1}),t(i,{label:"所属分组",width:240},{default:l(({row:o})=>[n(_(o.salesman.group_info.group_name),1)]),_:1}),t(i,{label:"收益",width:240},{default:l(({row:o})=>[n(_(w(q)(o.amount)),1)]),_:1}),t(i,{label:"结算方式",width:140},{default:l(({row:o})=>{var N;return[n(_(((N=o.salesman_settlement_data)==null?void 0:N.settlement_type)==1?"系统结算":"人工结算"),1)]}),_:1}),t(i,{label:"结算状态",width:140,fixed:"right"},{default:l(({row:o})=>[n(_(o.status_text),1)]),_:1}),t(i,{label:"退款时间",width:150,fixed:"right"},{default:l(({row:o})=>[n(_(o.refund_time||"--"),1)]),_:1})]),_:1},8,["data","total"])]),_:1},8,["spinning"]),V.value>0?(c(),f("div",Ke,[t(w(ae),{page:a.page,"onUpdate:page":e[10]||(e[10]=o=>a.page=o),size:a.size,"onUpdate:size":e[11]||(e[11]=o=>a.size=o),total:V.value,onCallback:b},null,8,["page","size","total"])])):y("",!0)]),h.value.length>0?(c(),f("div",Te,[s("div",Fe,[t(X,null,{default:l(()=>[s("span",null,[e[29]||(e[29]=n("已选择：")),s("b",null,_(h.value.length),1),e[30]||(e[30]=n(" 项"))]),t(u,null,{default:l(()=>e[31]||(e[31]=[n("设置等级")])),_:1}),t(u,null,{default:l(()=>e[32]||(e[32]=[n("分组")])),_:1}),t(u,null,{default:l(()=>e[33]||(e[33]=[n("清退")])),_:1})]),_:1})])])):y("",!0)])])])}}}),dt=le(Ge,[["__scopeId","data-v-20b6daec"]]);export{dt as default};
