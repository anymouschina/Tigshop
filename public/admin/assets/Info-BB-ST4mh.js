import{d as U,i as s,C as A,s as j,ad as V,q as $,r as c,j as g,f as N,o as d,w as l,a3 as M,b as u,c as O,F as P,a as X,E as z,D as G,a4 as H,I as v}from"./index-DrbzVNl6.js";import{a as J,b as K,u as Q}from"./account-DXyJfgJz.js";const Z=U({__name:"Info",props:{act:{type:String,default:""},id:{type:Number,default:0},type:{type:Number,default:1},page:{type:Number,default:1},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(w,{expose:C,emit:E}){const y=E,i=w,p=s(!0),k=A().currentRoute.value.query,b=s(i.isDialog?i.act:String(k.act)),h=s(i.isDialog?i.id:Number(k.id)),q=b.value==="add"?"create":"update",m=j(),e=s({accountType:1}),_=V(()=>{switch(e.value.accountType){case 1:return"银行卡";case 2:return"支付宝";case 3:return"微信";default:return""}}),B=async()=>{await m.value.resetFields()};V(()=>[{required:!0,message:"请输入身份证号",trigger:"blur"},{validator:(a,t,r)=>{/^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}([0-9]|X)$/.test(t)?r():r(new Error("请输入正确的身份证号码"))},trigger:"blur"}]);const S=V(()=>[{required:!0,message:"请输入"+_.value+"号!",trigger:"blur"},{validator:(a,t,r)=>{!/^\d{6,}$/.test(t)&&e.value.accountType===1?r(new Error("请输入正确的银行卡号")):r()},trigger:"blur"}]),D=async()=>{await m.value.validate();try{y("update:confirmLoading",!0);const a=await Q(q,{id:h.value,...e.value});await m.value.resetFields(),v.success("操作成功"),e.value.accountType=1,y("submitCallback",a)}catch(a){v.error(a.message)}finally{y("update:confirmLoading",!1)}},R=()=>{D()},F=async()=>{try{p.value=!0;const a=await J(b.value,{id:h.value});Object.assign(e.value,a)}catch(a){v.error(a.message)}finally{p.value=!1}},x=s([]),I=async()=>{try{const a=await K();x.value=a}catch(a){v.error(a.message)}};return $(()=>{b.value==="detail"?F():p.value=!1,I()}),C({onFormSubmit:R}),(a,t)=>{const r=c("el-radio-button"),T=c("el-radio-group"),n=c("el-form-item"),f=c("TigInput"),L=c("el-form");return p.value?N("",!0):(d(),g(L,{key:0,ref_key:"formRef",ref:m,model:e.value,class:"form-body","label-suffix":"：","label-width":"auto"},{default:l(()=>[M(u(n,{rules:[{required:!0,message:"请选择卡类型!"}],label:"卡类型"},{default:l(()=>[u(T,{modelValue:e.value.accountType,"onUpdate:modelValue":t[0]||(t[0]=o=>e.value.accountType=o),onChange:B},{default:l(()=>[(d(!0),O(P,null,X(x.value,o=>(d(),g(r,{value:o.accountType},{default:l(()=>[z(G(o.accountTypeText),1)]),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"])]),_:1},512),[[H,w.page]]),u(n,{rules:[{required:!0,message:"请输入真实姓名!"}],label:"真实姓名",prop:"accountName"},{default:l(()=>[u(f,{classType:"tig-form-input",modelValue:e.value.accountName,"onUpdate:modelValue":t[1]||(t[1]=o=>e.value.accountName=o),placeholder:"请输入真实姓名"},null,8,["modelValue"])]),_:1}),u(n,{label:_.value+"号",rules:S.value,prop:"accountNo"},{default:l(()=>[u(f,{classType:"tig-form-input",modelValue:e.value.accountNo,"onUpdate:modelValue":t[2]||(t[2]=o=>e.value.accountNo=o),placeholder:"请输入"+_.value},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),e.value.accountType===1?(d(),g(n,{key:0,label:"分行名称",prop:"bankBranch"},{default:l(()=>[u(f,{classType:"tig-form-input",modelValue:e.value.bankBranch,"onUpdate:modelValue":t[3]||(t[3]=o=>e.value.bankBranch=o),placeholder:"请输入分行名称"},null,8,["modelValue"])]),_:1})):N("",!0),e.value.accountType===1?(d(),g(n,{key:1,label:"银行卡详情",prop:"bankName"},{default:l(()=>[u(f,{classType:"tig-form-input",modelValue:e.value.bankName,"onUpdate:modelValue":t[4]||(t[4]=o=>e.value.bankName=o),rows:4,placeholder:"请选择银行卡账号",type:"textarea"},null,8,["modelValue"])]),_:1})):N("",!0)]),_:1},8,["model"]))}}});export{Z as default};
