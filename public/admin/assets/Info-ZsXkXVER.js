import{d as E,s as W,i as f,C as K,G as P,q as Y,r as s,c as N,o as L,e as n,b as t,w as a,g as x,bm as Z,E as v,D as C,f as $,I as y,_ as z}from"./index-DrbzVNl6.js";import{a as A,u as H}from"./levelManage-DT5C8CXF.js";import{F as J}from"./UploadAvatar.vue_vue_type_style_index_0_scoped_9bfcfc35_lang-BDvYUQtN.js";import"./index-CeQDmMxd.js";import"./vuedraggable.umd-DAKh-e3Q.js";import"./Image.vue_vue_type_script_setup_true_lang-BWzCs9jv.js";import"./format-CRgx78oe.js";import"./DialogForm.vue_vue_type_script_setup_true_lang-DqYSRv0_.js";const ee={class:"container"},te={class:"content_wrapper"},ae={class:"lyecs-form-table"},oe={class:"flex mb10"},le={class:"flex"},se={class:"level_txt"},ne={class:"flex flex-align-center"},ie={key:0},re=E({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(U,{expose:B,emit:V}){const d=V,p=U,c=W(),m=f(!0),b=K().currentRoute.value.query,_=f(p.isDialog?p.act:String(b.act)),D=f(p.isDialog?p.id:Number(b.id)),I=_.value==="add"?"create":"update",S={2:"铂金会员",3:"黑金会员",4:"钻石会员",5:"至尊会员"},e=f({data:[{rankLevel:1,rankName:"黄金会员",rankLogo:"https://oss.tigshop.com/img/gallery/202501/1735803176Yh9mCaE2r9ebXK3bGm.png"}]}),k=P({rankName:[{required:!0,message:"请输入",trigger:"blur"}]}),T=async()=>{try{m.value=!0;const o=await A(_.value);e.value.data=o.userRankList}catch(o){y.error(o.message),d("close")}finally{m.value=!1}},R=["https://oss.tigshop.com/img/gallery/202501/1737524324ro1DJxNm3aQowZKnPU.png","https://oss.tigshop.com/img/gallery/202501/1737524324ZUrDWMFqTPMBTCOlhg.png","https://oss.tigshop.com/img/gallery/202501/1737524324ptLNB2WynLJBBwSHHj.png","https://oss.tigshop.com/img/gallery/202501/1737524324hhmoz188M0ejyXEBhT.png","https://oss.tigshop.com/img/gallery/202501/1737524324O1BXVeurAyDMj9QG8f.png","https://oss.tigshop.com/img/gallery/202501/1737524324T7eKXTpMiCeVQOyFb6.png","https://oss.tigshop.com/img/gallery/202501/1737524324bUufpiVaGcaUad1CWd.png","https://oss.tigshop.com/img/gallery/202501/1737524324NhZbUn45wj1eSaIbjY.png","https://oss.tigshop.com/img/gallery/202501/1737524324bv68MBsoQXa2rLUO9i.png","https://oss.tigshop.com/img/gallery/202501/1737524324urqONY3QDjaTqW7d56.png"],q=async()=>{if(await c.value.validate(),e.value.data.length<=10){let o={rankLevel:e.value.data.length+1,rankName:S[e.value.data.length+1],rankLogo:R[e.value.data.length]};e.value.data.push(o),await c.value.validate()}},M=o=>{e.value.data.splice(o,1)};Y(()=>{_.value==="detail"?T():m.value=!1});const j=async()=>{await c.value.validate();try{d("update:confirmLoading",!0);const o=await H(I,{id:D.value,...e.value});d("submitCallback",o),y.success("操作成功")}catch(o){y.error(o.message)}finally{d("update:confirmLoading",!1)}};return B({onFormSubmit:()=>{j()}}),(o,i)=>{const w=s("el-button"),h=s("el-form-item"),u=s("el-table-column"),F=s("el-image"),G=s("el-tooltip"),O=s("TigInput"),Q=s("el-table"),X=s("el-form");return L(),N("div",ee,[n("div",te,[n("div",ae,[i[2]||(i[2]=n("div",{class:"title"},"等级方案",-1)),t(X,{ref_key:"formRef",ref:c,rules:k,model:e.value,"label-width":"auto"},{default:a(()=>[t(h,{prop:"data",style:{"margin-bottom":"0"}},{default:a(()=>[n("div",oe,[n("div",le,[t(w,{type:"primary",icon:x(Z),link:"",onClick:q,disabled:e.value.data.length>=10},{default:a(()=>[v(C(e.value.data.length>=10?"多添加10级":`添加等级(${e.value.data.length}/10)`),1)]),_:1},8,["icon","disabled"])])])]),_:1}),t(h,{prop:"data"},{default:a(()=>[t(Q,{data:e.value.data,loading:m.value,"row-key":"userId"},{default:a(()=>[t(u,{width:120,label:"等级",prop:"level"},{default:a(({row:l,$index:r})=>[n("div",se,"vip"+C(l.rankLevel),1)]),_:1}),t(u,{width:130,label:"会员图标",prop:"rankLogo",align:"center"},{default:a(({row:l,$index:r})=>[t(G,{effect:"light",placement:"bottom","show-after":150},{content:a(()=>i[0]||(i[0]=[v(" 点击修改 ")])),default:a(()=>[n("div",null,[t(x(J),{photo:l.rankLogo,"onUpdate:photo":g=>l.rankLogo=g,type:2},{default:a(()=>[t(F,{style:{height:"20px"},src:l.rankLogo},null,8,["src"])]),_:2},1032,["photo","onUpdate:photo"])])]),_:2},1024)]),_:1}),t(u,{width:300,label:"会员名称*",prop:"rankName"},{default:a(({row:l,$index:r})=>[t(h,{prop:"data."+r+".rankName",rules:k.rankName},{default:a(()=>[n("div",ne,[t(O,{modelValue:l.rankName,"onUpdate:modelValue":g=>l.rankName=g,width:"100px"},null,8,["modelValue","onUpdate:modelValue"])])]),_:2},1032,["prop","rules"])]),_:1}),t(u,{fixed:"right",width:80,label:"操作",class:"setBtn"},{default:a(({row:l,$index:r})=>[r===e.value.data.length-1&&e.value.data.length>1?(L(),N("div",ie,[t(w,{type:"primary",link:"",size:"mini",onClick:g=>M(r)},{default:a(()=>i[1]||(i[1]=[v("删除")])),_:2},1032,["onClick"])])):$("",!0)]),_:1})]),_:1},8,["data","loading"])]),_:1})]),_:1},8,["rules","model"])])])])}}}),ve=z(re,[["__scopeId","data-v-88e9b87f"]]);export{ve as default};
