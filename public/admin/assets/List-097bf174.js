import{d as X,j as m,I as Y,E as L,x as Z,r as d,o as n,c as u,e as t,f as c,k as v,w as o,h as p,b as a,K as I,L as ee,H as b,G as S,n as te,p as ae,i as se,_ as oe}from"./index-7c2d2aef.js";/* empty css             */import"./index-6c62cf9b.js";import{_ as le}from"./DeleteRecord.vue_vue_type_script_setup_true_lang-ae1bade7.js";/* empty css                                                                    */import{P as ne}from"./Pagination-8eb7b6b1.js";import{i as ie,r as re}from"./format-4e0206d3.js";import{u as de}from"./config-9548fa9b.js";import{a as ce,c as pe,e as _e}from"./adminUser-fb41eb63.js";import{e as q}from"./util-1ee03ed8.js";import{M as me}from"./MobileCard-6c6c2c27.js";/* empty css                                               */import"./zh-cn-8c8b9709.js";import{T as ue}from"./Tag-e65e7405.js";import{a as ve}from"./version-f7bce787.js";import{_ as K}from"./DialogForm.vue_vue_type_script_setup_true_lang-c57b9a11.js";import"./config-e2aa16d1.js";const M=h=>(ae("data-v-61357b7e"),h=h(),se(),h),fe={class:"container"},he={class:"content_wrapper"},ge={class:"lyecs-table-list-warp"},ye={class:"list-table-tool lyecs-search-warp"},be={class:"advanced-search-warp list-table-tool-row"},ke={class:"simple-form-warp"},Ce={class:"simple-form-field"},Se={class:"form-group"},we={class:"control-container"},xe=M(()=>t("span",{class:"iconfont icon-chakan1"},null,-1)),ze={key:0,class:"simple-form-field"},Ve={class:"form-group"},Ie={class:"control-container"},Ue={class:"simple-form-field"},De={class:"form-group"},Ae={class:"control-container"},Be={key:0},Ne={class:"table-container"},Le={class:"avatar-username"},qe={key:0},Ke=M(()=>t("a",{class:"btn-link"},"编辑",-1)),Me=["onClick"],Pe={class:"empty-warp"},Te={key:0,class:"empty-bg"},$e={key:0,class:"pagination-con"},Ee=X({__name:"List",props:{id:{type:Number,default:0},act:{type:String,default:""},isDialog:Boolean},setup(h){const P=L(),T=de(),U=m([]),g=m(!0),k=m(0),y=m([]),i=Y({page:1,size:T.get("page_size"),sort_field:"",sort_order:"",keyword:"",admin_user_type:"admin"}),r=m("admin"),$=l=>{r.value=l,i.admin_user_type=l,_()},_=async()=>{g.value=!0;try{const l=await ce({...i});U.value=l.filter_result,k.value=l.total}catch(l){I.error(l.message)}finally{g.value=!1}},E=l=>{P.push("/authority/admin_log/list?user_id="+l)},C=h,D=L().currentRoute.value.query,w=m(C.isDialog?C.act:String(D.act)),x=m(C.isDialog?C.id:Number(D.id));Z(()=>{w.value&&(i.suppliers_id=x.value),_()});const A=()=>{_()},F=({prop:l,order:s})=>{i.sort_field=l,i.sort_order=s=="ascending"?"asc":s=="descending"?"desc":"",_()},O=async l=>{try{const s=await _e(l,{ids:y.value});I.success(s.message),_()}catch(s){I.error(s.message)}},R=l=>{y.value=l.map(s=>s.admin_id)};return(l,s)=>{const B=d("el-tab-pane"),j=d("el-tabs"),z=d("el-button"),G=d("el-input"),H=d("el-popconfirm"),J=d("el-form"),f=d("el-table-column"),V=d("el-avatar"),N=d("el-divider"),Q=d("el-table"),W=d("a-spin");return n(),u("div",fe,[t("div",he,[c(ve)()?(n(),v(j,{key:0,modelValue:r.value,"onUpdate:modelValue":s[0]||(s[0]=e=>r.value=e),class:"lyecs-tabs","tab-position":"top",onTabChange:$},{default:o(()=>[a(B,{label:"管理员列表",name:"admin"}),a(B,{label:"店铺管理员列表",name:"shop"})]),_:1},8,["modelValue"])):p("",!0),t("div",ge,[t("div",ye,[a(J,{model:i},{default:o(()=>[t("div",be,[t("div",ke,[t("div",Ce,[t("div",Se,[t("div",we,[a(G,{modelValue:i.keyword,"onUpdate:modelValue":s[1]||(s[1]=e=>i.keyword=e),name:"keyword",placeholder:r.value=="shop"?"输入员工名称":"输入管理员名称",onKeyup:ee(A,["enter"])},{append:o(()=>[a(z,{onClick:A},{default:o(()=>[xe]),_:1})]),_:1},8,["modelValue","placeholder"])])])]),r.value!=="shop"?(n(),u("div",ze,[t("div",Ve,[t("div",Ie,[a(c(K),{params:{act:"add",type:w.value?w.value:"",suppliers_id:x.value?x.value:0,admin_type:r.value},isDrawer:"",path:"authority/adminUser/Info",title:"添加管理员",width:"800px",onOkCallback:_},{default:o(()=>[a(z,{type:"primary"},{default:o(()=>[b("添加管理员")]),_:1})]),_:1},8,["params"])])])])):p("",!0),t("div",Ue,[t("div",De,[t("div",Ae,[a(H,{title:"您确认要批量删除所选数据吗？",onConfirm:s[2]||(s[2]=e=>O("del"))},{reference:o(()=>[a(z,{disabled:y.value.length===0},{default:o(()=>[b("批量删除")]),_:1},8,["disabled"])]),_:1}),y.value.length>0?(n(),u("span",Be,[b(" 已选择："),t("b",null,S(y.value.length),1),b(" 项 ")])):p("",!0)])])])])])]),_:1},8,["model"])]),t("div",Ne,[a(W,{spinning:g.value},{default:o(()=>[a(Q,{data:U.value,loading:g.value,total:k.value,"row-key":"admin_id",onSelectionChange:R,onSortChange:F},{empty:o(()=>[t("div",Pe,[g.value?p("",!0):(n(),u("div",Te,"暂无数据"))])]),default:o(()=>[a(f,{type:"selection",width:"32"}),a(f,{width:"200",label:r.value=="shop"?"员工名称":"管理员名称",prop:"username"},{default:o(({row:e})=>[t("div",Le,[c(q)(String(e.avatar))=="one"?(n(),v(V,{key:0,size:30,src:c(ie)(e.avatar)},null,8,["src"])):c(q)(String(e.avatar))=="def"?(n(),v(V,{key:1,size:30,src:c(re)(e.avatar)},null,8,["src"])):(n(),v(V,{key:2,size:30,src:""})),t("div",null,[t("div",null,S(e.username),1),r.value=="shop"&&e.is_admin==1?(n(),u("div",qe,[a(c(ue),{transparent:!0,text:"店铺管理员"})])):p("",!0)])])]),_:1},8,["label"]),r.value!="shop"?(n(),v(f,{key:0,label:"权限组",prop:"role_name"},{default:o(({row:e})=>[t("span",{class:te(e.role_name?"green":"gray")},S(e.role_name||"-"),3)]),_:1})):p("",!0),a(f,{label:"邮箱",prop:"email"},{default:o(({row:e})=>[t("span",null,S(e.email||"-"),1)]),_:1}),a(f,{label:"电话",prop:"mobile"},{default:o(({row:e})=>[t("span",null,[a(me,{mobile:e.mobile},null,8,["mobile"])])]),_:1}),a(f,{width:150,fixed:"right",label:"操作"},{default:o(({row:e})=>[a(c(K),{params:{act:"detail",id:e.admin_id,admin_type:r.value},isDrawer:"",path:"authority/adminUser/Info",title:r.value=="shop"?"编辑员工":"编辑管理员",width:"800px",onOkCallback:_},{default:o(()=>[Ke]),_:2},1032,["params","title"]),t("template",null,[a(N,{direction:"vertical"}),r.value!="shop"?(n(),u("a",{key:0,class:"btn-link",onClick:Fe=>E(e.admin_id)},"日志",8,Me)):p("",!0)]),e.admin_id!=1?(n(),v(N,{key:0,direction:"vertical"})):p("",!0),e.admin_id!=1?(n(),v(c(le),{key:1,params:{id:e.admin_id},requestApi:c(pe),onAfterDelete:_},{default:o(()=>[b("删除 ")]),_:2},1032,["params","requestApi"])):p("",!0)]),_:1})]),_:1},8,["data","loading","total"])]),_:1},8,["spinning"]),k.value>0?(n(),u("div",$e,[a(c(ne),{page:i.page,"onUpdate:page":s[3]||(s[3]=e=>i.page=e),size:i.size,"onUpdate:size":s[4]||(s[4]=e=>i.size=e),total:k.value,onCallback:_},null,8,["page","size","total"])])):p("",!0)])])])])}}});const nt=oe(Ee,[["__scopeId","data-v-61357b7e"]]);export{nt as default};
