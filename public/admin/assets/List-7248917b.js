import{u as N}from"./config-9548fa9b.js";import{p as B}from"./format-4e0206d3.js";import{A as D,d as P,j as f,I as T,x as q,r as l,o as g,c as v,e as i,b as e,w as n,f as b,h as x,K as C,H as y,G as F,p as R,i as j,_ as A}from"./index-7c2d2aef.js";import"./SelectTimeInterval.vue_vue_type_style_index_0_scoped_207fe586_lang-b4d9216b.js";import"./category-a8bd4d11.js";import"./index-6c62cf9b.js";/* empty css                                                                    */import{P as G}from"./Pagination-8eb7b6b1.js";/* empty css                                                                  *//* empty css                                                                              */import"./region-e0d291a6.js";import{S as H}from"./SelectTimeInterval-7da287f8.js";import"./shopProductCategory-792e0c23.js";/* empty css             */import{g as K}from"./util-1ee03ed8.js";import{f as h}from"./time-290942a2.js";import{r as X}from"./export-59d12e73.js";import"./config-e2aa16d1.js";import"./region-05802f67.js";const J=r=>D({url:"panel/statistics_user/user_consumption_ranking",method:"get",params:r}),O=r=>D({url:"panel/statistics_user/user_consumption_ranking",method:"get",responseType:"arraybuffer",params:r}),Q=r=>(R("data-v-789a7b28"),r=r(),j(),r),W={class:"container"},Z={class:"content_wrapper"},$=Q(()=>i("div",{class:"notice-warp"},"提示：查询的时间间隔上限默认为一月，如果数据量过大导至查询时间过久或者超时报错，请尝试缩小查询的时间间隔！",-1)),ee={class:"filtrate-menu"},te={class:"empty-warp"},oe={key:0,class:"empty-bg"},ae={key:0,class:"pagination-con"},se=P({__name:"List",setup(r){const S=N(),p=f(!1),k=f(),d=f(0),t=T({page:1,size:S.pageSize,keyword:"",start_time:h(K(30,"sub"),"YYYY-MM-DD"),end_time:h(new Date,"YYYY-MM-DD")}),m=async()=>{p.value=!0;try{const o=await J(t);o.errcode===0&&(k.value=o.filter_result,d.value=o.total)}catch(o){C.error(o.message),console.error(o)}p.value=!1},Y=()=>{m()},c=f(!1),z=async()=>{c.value=!0;try{const o=await O({...t,is_export:"1"});c.value=!1,X(o,"消费排行导出")}catch(o){C.error(o.message)}finally{c.value=!1}},U=({prop:o,order:a})=>{console.log(o,a),t.sort_field=o,t.sort_order=a=="ascending"?"asc":a=="descending"?"desc":"",m()},V=()=>{m()};return q(()=>{m()}),(o,a)=>{const _=l("el-form-item"),E=l("el-input"),w=l("el-button"),I=l("el-form"),u=l("el-table-column"),M=l("el-table"),L=l("a-spin");return g(),v("div",W,[i("div",Z,[$,e(I,{model:t},{default:n(()=>[i("div",ee,[e(_,{class:"mr-10"},{default:n(()=>[e(b(H),{type:"date","start-date":t.start_time,"onUpdate:startDate":a[0]||(a[0]=s=>t.start_time=s),"end-date":t.end_time,"onUpdate:endDate":a[1]||(a[1]=s=>t.end_time=s)},null,8,["start-date","end-date"])]),_:1}),e(_,{class:"mr-10"},{default:n(()=>[e(E,{modelValue:t.keyword,"onUpdate:modelValue":a[2]||(a[2]=s=>t.keyword=s),placeholder:"输入会员名称或者手机号"},null,8,["modelValue"])]),_:1}),e(_,{class:"mr-10"},{default:n(()=>[e(w,{plain:"",onClick:Y},{default:n(()=>[y("搜索")]),_:1})]),_:1}),e(_,{class:"mr-10"},{default:n(()=>[e(w,{plain:"",onClick:z,loading:c.value},{default:n(()=>[y("导出EXCEL")]),_:1},8,["loading"])]),_:1})])]),_:1},8,["model"]),i("div",null,[e(L,{spinning:p.value},{default:n(()=>[e(M,{data:k.value,total:d.value,"row-key":"product_id",onSortChange:U},{empty:n(()=>[i("div",te,[p.value?x("",!0):(g(),v("div",oe,"暂无数据"))])]),default:n(()=>[e(u,{label:"会员名称",prop:"username"}),e(u,{label:"手机号",prop:"mobile"}),e(u,{label:"订单数",prop:"order_num",sortable:"custom"}),e(u,{label:"消费总额",prop:"order_amount",sortable:"custom"},{default:n(({row:s})=>[y(F(b(B)(s.order_amount)),1)]),_:1})]),_:1},8,["data","total"])]),_:1},8,["spinning"]),d.value>0?(g(),v("div",ae,[e(b(G),{page:t.page,"onUpdate:page":a[3]||(a[3]=s=>t.page=s),size:t.size,"onUpdate:size":a[4]||(a[4]=s=>t.size=s),total:d.value,onCallback:V},null,8,["page","size","total"])])):x("",!0)])])])}}});const he=A(se,[["__scopeId","data-v-789a7b28"]]);export{he as default};
