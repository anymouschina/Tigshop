import{b as e,e as l,f as a}from"./CdIa5lAL.js";import{cn as t,bd as r,a2 as i,bc as s,K as o,M as n,bm as u,r as d,s as v,N as c,e as p,P as f,Q as m,a7 as h,g as b,bt as g,c as y,o as w,a4 as S,v as F,i as W,bb as j,O as I,y as q,S as $,X as k,R as B,b as M,F as O,U as P,a8 as E,co as x,bG as A,cp as L,a as V,w as _,m as R,h as C,av as z,p as N,d as T,t as G,cq as K,cr as Q,ad as U,ac as X}from"./vO8z_6wc.js";import{c as D}from"./VsleDggW.js";import{d as H,t as J}from"./D_Dr4eZ1.js";import{a as Y}from"./CKVP4sCQ.js";function Z(e){return t(e,4)}const ee=o({size:{type:String,values:u},disabled:Boolean}),le=o({...ee,model:Object,rules:{type:n(Object)},labelPosition:{type:String,values:["left","right","top"],default:"right"},requireAsteriskPosition:{type:String,values:["left","right"],default:"left"},labelWidth:{type:[String,Number],default:""},labelSuffix:{type:String,default:""},inline:Boolean,inlineMessage:Boolean,statusIcon:Boolean,showMessage:{type:Boolean,default:!0},validateOnRuleChange:{type:Boolean,default:!0},hideRequiredAsterisk:Boolean,scrollToError:Boolean,scrollIntoViewOptions:{type:[Object,Boolean]}}),ae={validate:(e,l,a)=>(r(e)||i(e))&&s(l)&&i(a)};function te(){const e=d([]),l=v((()=>{if(!e.value.length)return"0";const l=Math.max(...e.value);return l?`${l}px`:""}));function a(a){const t=e.value.indexOf(a);return-1===t&&l.value,t}return{autoLabelWidth:l,registerLabelWidth:function(l,t){if(l&&t){const r=a(t);e.value.splice(r,1,l)}else l&&e.value.push(l)},deregisterLabelWidth:function(l){const t=a(l);t>-1&&e.value.splice(t,1)}}}const re=(e,l)=>{const a=D(l);return a.length>0?e.filter((e=>e.prop&&a.includes(e.prop))):e},ie=p({name:"ElForm"});var se=c(p({...ie,props:le,emits:ae,setup(a,{expose:t,emit:r}){const i=a,s=[],o=e(),n=f("form"),u=v((()=>{const{labelPosition:e,inline:l}=i;return[n.b(),n.m(o.value||"default"),{[n.m(`label-${e}`)]:e,[n.m("inline")]:l}]})),d=(e=[])=>{i.model&&re(s,e).forEach((e=>e.resetField()))},c=(e=[])=>{re(s,e).forEach((e=>e.clearValidate()))},p=v((()=>!!i.model)),I=async e=>$(void 0,e),q=async(e=[])=>{if(!p.value)return!1;const l=(e=>{if(0===s.length)return[];const l=re(s,e);return l.length?l:[]})(e);if(0===l.length)return!0;let a={};for(const r of l)try{await r.validate(""),"error"===r.validateState&&r.resetField()}catch(t){a={...a,...t}}return 0===Object.keys(a).length||Promise.reject(a)},$=async(e=[],l)=>{const a=!j(l);try{const a=await q(e);return!0===a&&await(null==l?void 0:l(a)),a}catch(t){if(t instanceof Error)throw t;const e=t;return i.scrollToError&&k(Object.keys(e)[0]),await(null==l?void 0:l(!1,e)),a&&Promise.reject(e)}},k=e=>{var l;const a=re(s,e)[0];a&&(null==(l=a.$el)||l.scrollIntoView(i.scrollIntoViewOptions))};return m((()=>i.rules),(()=>{i.validateOnRuleChange&&I().catch((e=>H()))}),{deep:!0,flush:"post"}),h(l,b({...g(i),emit:r,resetFields:d,clearValidate:c,validateField:$,getField:e=>s.find((l=>l.prop===e)),addField:e=>{s.push(e)},removeField:e=>{e.prop&&s.splice(s.indexOf(e),1)},...te()})),t({validate:I,validateField:$,resetFields:d,clearValidate:c,scrollToField:k,fields:s}),(e,l)=>(w(),y("form",{class:F(W(u))},[S(e.$slots,"default")],2))}}),[["__file","form.vue"]]);const oe=o({label:String,labelWidth:{type:[String,Number],default:""},labelPosition:{type:String,values:["left","right","top",""],default:""},prop:{type:n([String,Array])},required:{type:Boolean,default:void 0},rules:{type:n([Object,Array])},error:String,validateStatus:{type:String,values:["","error","validating","success"]},for:String,inlineMessage:{type:[String,Boolean],default:""},showMessage:{type:Boolean,default:!0},size:{type:String,values:u}}),ne="ElLabelWrap";var ue=p({name:ne,props:{isAutoWidth:Boolean,updateAll:Boolean},setup(e,{slots:t}){const r=I(l,void 0),i=I(a);i||J(ne,"usage: <el-form-item><label-wrap /></el-form-item>");const s=f("form"),o=d(),n=d(0),u=(l="update")=>{P((()=>{t.default&&e.isAutoWidth&&("update"===l?n.value=(()=>{var e;if(null==(e=o.value)?void 0:e.firstElementChild){const e=window.getComputedStyle(o.value.firstElementChild).width;return Math.ceil(Number.parseFloat(e))}return 0})():"remove"===l&&(null==r||r.deregisterLabelWidth(n.value)))}))},c=()=>u("update");return q((()=>{c()})),$((()=>{u("remove")})),k((()=>c())),m(n,((l,a)=>{e.updateAll&&(null==r||r.registerLabelWidth(l,a))})),B(v((()=>{var e,l;return null!=(l=null==(e=o.value)?void 0:e.firstElementChild)?l:null})),c),()=>{var l,a;if(!t)return null;const{isAutoWidth:u}=e;if(u){const e=null==r?void 0:r.autoLabelWidth,a={};if((null==i?void 0:i.hasLabel)&&e&&"auto"!==e){const l=Math.max(0,Number.parseInt(e,10)-n.value),t=i.labelPosition||r.labelPosition;l&&(a["left"===t?"marginRight":"marginLeft"]=`${l}px`)}return M("div",{ref:o,class:[s.be("item","label-wrap")],style:a},[null==(l=t.default)?void 0:l.call(t)])}return M(O,{ref:o},[null==(a=t.default)?void 0:a.call(t)])}}});const de=p({name:"ElFormItem"});var ve=c(p({...de,props:oe,setup(t,{expose:o}){const n=t,u=E(),c=I(l,void 0),p=I(a,void 0),k=e(void 0,{formItem:!1}),B=f("form-item"),O=Y().value,U=d([]),X=d(""),H=x(X,100),J=d(""),ee=d();let le,ae=!1;const te=v((()=>n.labelPosition||(null==c?void 0:c.labelPosition))),re=v((()=>{if("top"===te.value)return{};const e=A(n.labelWidth||(null==c?void 0:c.labelWidth)||"");return e?{width:e}:{}})),ie=v((()=>{if("top"===te.value||(null==c?void 0:c.inline))return{};if(!n.label&&!n.labelWidth&&fe)return{};const e=A(n.labelWidth||(null==c?void 0:c.labelWidth)||"");return n.label||u.label?{}:{marginLeft:e}})),se=v((()=>[B.b(),B.m(k.value),B.is("error","error"===X.value),B.is("validating","validating"===X.value),B.is("success","success"===X.value),B.is("required",ge.value||n.required),B.is("no-asterisk",null==c?void 0:c.hideRequiredAsterisk),"right"===(null==c?void 0:c.requireAsteriskPosition)?"asterisk-right":"asterisk-left",{[B.m("feedback")]:null==c?void 0:c.statusIcon,[B.m(`label-${te.value}`)]:te.value}])),oe=v((()=>s(n.inlineMessage)?n.inlineMessage:(null==c?void 0:c.inlineMessage)||!1)),ne=v((()=>[B.e("error"),{[B.em("error","inline")]:oe.value}])),de=v((()=>n.prop?i(n.prop)?n.prop:n.prop.join("."):"")),ve=v((()=>!(!n.label&&!u.label))),ce=v((()=>n.for||(1===U.value.length?U.value[0]:void 0))),pe=v((()=>!ce.value&&ve.value)),fe=!!p,me=v((()=>{const e=null==c?void 0:c.model;if(e&&n.prop)return L(e,n.prop).value})),he=v((()=>{const{required:e}=n,l=[];n.rules&&l.push(...D(n.rules));const a=null==c?void 0:c.rules;if(a&&n.prop){const e=L(a,n.prop).value;e&&l.push(...D(e))}if(void 0!==e){const a=l.map(((e,l)=>[e,l])).filter((([e])=>Object.keys(e).includes("required")));if(a.length>0)for(const[t,r]of a)t.required!==e&&(l[r]={...t,required:e});else l.push({required:e})}return l})),be=v((()=>he.value.length>0)),ge=v((()=>he.value.some((e=>e.required)))),ye=v((()=>{var e;return"error"===H.value&&n.showMessage&&(null==(e=null==c?void 0:c.showMessage)||e)})),we=v((()=>`${n.label||""}${(null==c?void 0:c.labelSuffix)||""}`)),Se=e=>{X.value=e},Fe=async e=>{const l=de.value;return new Q({[l]:e}).validate({[l]:me.value},{firstFields:!0}).then((()=>(Se("success"),null==c||c.emit("validate",n.prop,!0,""),!0))).catch((e=>((e=>{var l,a;const{errors:t,fields:r}=e;t&&r||console.error(e),Se("error"),J.value=t?null!=(a=null==(l=null==t?void 0:t[0])?void 0:l.message)?a:`${n.prop} is required`:"",null==c||c.emit("validate",n.prop,!1,J.value)})(e),Promise.reject(e))))},We=async(e,l)=>{if(ae||!n.prop)return!1;const a=j(l);if(!be.value)return null==l||l(!1),!1;const t=(e=>he.value.filter((l=>!l.trigger||!e||(r(l.trigger)?l.trigger.includes(e):l.trigger===e))).map((({trigger:e,...l})=>l)))(e);return 0===t.length?(null==l||l(!0),!0):(Se("validating"),Fe(t).then((()=>(null==l||l(!0),!0))).catch((e=>{const{fields:t}=e;return null==l||l(!1,t),!a&&Promise.reject(t)})))},je=()=>{Se(""),J.value="",ae=!1},Ie=async()=>{const e=null==c?void 0:c.model;if(!e||!n.prop)return;const l=L(e,n.prop);ae=!0,l.value=Z(le),await P(),je(),ae=!1};m((()=>n.error),(e=>{J.value=e||"",Se(e?"error":"")}),{immediate:!0}),m((()=>n.validateStatus),(e=>Se(e||"")));const qe=b({...g(n),$el:ee,size:k,validateState:X,labelId:O,inputIds:U,isGroup:pe,hasLabel:ve,fieldValue:me,addInputId:e=>{U.value.includes(e)||U.value.push(e)},removeInputId:e=>{U.value=U.value.filter((l=>l!==e))},resetField:Ie,clearValidate:je,validate:We});return h(a,qe),q((()=>{n.prop&&(null==c||c.addField(qe),le=Z(me.value))})),$((()=>{null==c||c.removeField(qe)})),o({size:k,validateMessage:J,validateState:X,validate:We,clearValidate:je,resetField:Ie}),(e,l)=>{var a;return w(),y("div",{ref_key:"formItemRef",ref:ee,class:F(W(se)),role:W(pe)?"group":void 0,"aria-labelledby":W(pe)?W(O):void 0},[M(W(ue),{"is-auto-width":"auto"===W(re).width,"update-all":"auto"===(null==(a=W(c))?void 0:a.labelWidth)},{default:_((()=>[W(ve)?(w(),R(z(W(ce)?"label":"div"),{key:0,id:W(O),for:W(ce),class:F(W(B).e("label")),style:N(W(re))},{default:_((()=>[S(e.$slots,"label",{label:W(we)},(()=>[T(G(W(we)),1)]))])),_:3},8,["id","for","class","style"])):C("v-if",!0)])),_:3},8,["is-auto-width","update-all"]),V("div",{class:F(W(B).e("content")),style:N(W(ie))},[S(e.$slots,"default"),M(K,{name:`${W(B).namespace.value}-zoom-in-top`},{default:_((()=>[W(ye)?S(e.$slots,"error",{key:0,error:J.value},(()=>[V("div",{class:F(W(ne))},G(J.value),3)])):C("v-if",!0)])),_:3},8,["name"])],6)],10,["role","aria-labelledby"])}}}),[["__file","form-item.vue"]]);const ce=U(se,{FormItem:ve}),pe=X(ve);export{pe as E,ce as a};
