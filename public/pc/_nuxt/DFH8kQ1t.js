import{b as e}from"./Bx_3tXOW.js";import{_ as l}from"./DIcT5qlW.js";import{_ as a}from"./CFmHvMYA.js";import{_ as t}from"./BoBe_m7P.js";import{e as r,z as s,r as u,s as o,aj as d,y as i,n as m,Q as n,I as p,g as c,c as v,o as f,b as y,a as b,aa as j,t as h,F as _,l as g,w as V,E as x,i as $,j as w,h as I,q as A,m as U,d as q,ae as E,_ as R}from"./vO8z_6wc.js";import{_ as k}from"./DRy-t1KR.js";import{_ as N}from"./4BWvF7DS.js";import{E as S}from"./DNdIQqcH.js";import{a as T,E as F}from"./6_reTNGa.js";import{E as z,a as L}from"./DKvZ9Rd6.js";import{E as Q,a as M}from"./123WnbAt.js";import{E as D}from"./duVALuQ5.js";import{E as O}from"./OZUBBuO3.js";import{_ as C}from"./B6kpiin_.js";import{v as J}from"./CxvT33_f.js";/* empty css        */import"./C_yTnQv7.js";import{g as K,a as P,u as W}from"./D32K3uiA.js";import{U as X}from"./CyA81kDU.js";import"./B3kMr2Om.js";import"./BG07ctRk.js";import"./Ctuj9lAE.js";import"./ExFuuhw5.js";import"./C0xcqOw0.js";import"./pBde3eXe.js";import"./YLitFIRx.js";import"./C8tVKSc2.js";import"./D_Dr4eZ1.js";import"./CKVP4sCQ.js";import"./DEtxbcwL.js";import"./CdIa5lAL.js";import"./BwRzfsZt.js";import"./B0NTQXpH.js";import"./DqoL2U0I.js";import"./VsleDggW.js";import"./B0jPhJeY.js";import"./y2YKyhRU.js";import"./DgmxjSXK.js";import"./D0li9aqr.js";import"./B9ErrXst.js";const Y={class:"container flex"},Z={class:"menu"},B={class:"info-row"},G={class:"title-or-tabs"},H={class:"tag-and-input"},ee={class:"tig-tabs"},le={key:0,class:"log-return-content"},ae={class:"info-card"},te={class:"table-header"},re={class:"header-cell"},se={class:"header-cell",style:{width:"90px"}},ue={class:"header-cell",style:{width:"90px"}},oe={class:"header-cell",style:{width:"90px"}},de={class:"header-cell",style:{width:"90px"}},ie={class:"header-cell",style:{width:"90px"}},me={class:"text-ellipsis"},ne={class:"name"},pe={class:"value"},ce={key:0},ve={class:"file-card"},fe={key:1,class:"log-return-content"},ye=R(r({__name:"Info",setup(r){const{t:R}=s(),ye=u([]),be=u([]),je=u([]),he=u({items:[],pics:[],refundAmount:0,refundAmountMax:0});o((()=>{let e=Ae.currentRoute.value.query.itemId,l=Ae.currentRoute.value.query.orderId;return l&&e?"one":!e&&l?"all":void 0}));const _e=u(!0);i((async()=>{await ge(),await Ve()}));const ge=async()=>{var e,l;try{let a={itemId:Ae.currentRoute.value.query.itemId?Ae.currentRoute.value.query.itemId:void 0,orderId:Ae.currentRoute.value.query.orderId?Ae.currentRoute.value.query.orderId:void 0};he.value.orderId=Number(a.orderId);const t=await K({...a});he.value.orderStatus=t.order.orderStatus,ye.value=t.list,ye.value.forEach((e=>{e.number=0}));let r=0;t.list.forEach(((e,l)=>{r+=Number(e.canApplyQuantity*e.price)})),xe.value=null==(e=null==t?void 0:t.order)?void 0:e.productAmount,$e.value=null==(l=null==t?void 0:t.order)?void 0:l.totalAmount,r=r/Number(xe.value)*Number($e.value),he.value.refundAmountMax=r.toFixed(2)}catch(a){m.error(a.message)}finally{_e.value=!1}},Ve=async()=>{try{const e=await P();if(be.value=e.aftersaleReason,je.value=e.aftersaleType,1==he.value.orderStatus)for(let l in je.value)je.value[l]===R("退货/退款")&&delete je.value[l]}catch(e){m.error(e.message)}finally{_e.value=!1}},xe=u(),$e=u();n((()=>ye.value),(e=>{let l=0;e.forEach(((e,a)=>{l+=Number(e.number*e.price)})),he.value.refundAmount=l}),{deep:!0,immediate:!0});const we=p(),Ie=async()=>{try{await we.value.validate(),he.value.orderItemId=he.value.itemId,ye.value.forEach((e=>{he.value.items.push({orderItemId:e.itemId,number:e.number})}));await W({...he.value});m.success("提交成功"),await we.value.resetFields(),E("/member/return/log")}catch(e){e.message&&m.error(e.message)}finally{_e.value=!1}},Ae=d(),Ue=c([{value:"退/换货申请",url:"/member/return/list",size:0},{value:"申请记录",url:"/member/return/log",size:0}]);return(r,s)=>{const u=e,o=l,d=a,i=t,m=x,n=k,p=N,c=S,E=F,R=T,K=z,P=M,W=Q,ge=D,Ve=O,xe=L,$e=C,Ae=J;return f(),v(_,null,[y(u),y(o,{title:"退/换货申请"}),b("div",Y,[b("div",Z,[y(d)]),b("div",B,[b("div",G,[b("div",H,[b("div",ee,[y(i,{menuList:Ue},null,8,["menuList"])])])]),_e.value?j((f(),v("div",fe,null,512)),[[Ae,_e.value]]):(f(),v("div",le,[b("div",ae,[b("table",null,[b("thead",te,[b("tr",null,[b("th",re,h(r.$t("商品名称")),1),b("th",se,h(r.$t("商品价格")),1),b("th",ue,h(r.$t("购买数量")),1),b("th",oe,h(r.$t("小计")),1),b("th",de,h(r.$t("可退换数量")),1),b("th",ie,h(r.$t("退/换数量")),1)])]),b("tbody",null,[(f(!0),v(_,null,g(ye.value,(e=>(f(),v("tr",null,[b("td",null,[y(n,{title:e.productName,to:$(A)({path:"product",id:e.itemId,sn:e.productSn}),class:"nuxt",target:"_blank"},{default:V((()=>[y(m,{src:("imageFormat"in r?r.imageFormat:$(w))(e.picThumb),class:"pro_pic",loading:"lazy",style:{transition:"opacity 0.2s linear"}},null,8,["src"]),b("div",me,[b("ul",null,[b("li",null,h(r.$t("货号"))+"："+h(e.productSn),1),b("li",null,h(e.productName),1),b("li",null,[(f(!0),v(_,null,g(e.skuData,((l,a)=>{var t;return f(),v(_,null,[b("span",ne,h(l.name)+"：",1),b("span",pe,h(l.value),1),a<(null==(t=e.skuData)?void 0:t.length)-1?(f(),v("span",ce,"；")):I("",!0)],64)})),256))])])])])),_:2},1032,["title","to"])]),b("td",null,[y(p,{modelValue:e.price,"onUpdate:modelValue":l=>e.price=l,fontStyle:{color:"var(--price)"},showText:!1},null,8,["modelValue","onUpdate:modelValue"])]),b("td",null,h(e.quantity),1),b("td",null,[y(p,{modelValue:e.subtotal,"onUpdate:modelValue":l=>e.subtotal=l,fontStyle:{color:"var(--price)"},showText:!1},null,8,["modelValue","onUpdate:modelValue"])]),b("td",null,h(e.canApplyQuantity),1),b("td",null,[y(c,{modelValue:e.number,"onUpdate:modelValue":l=>e.number=l,modelModifiers:{number:!0},max:e.canApplyQuantity,min:0,clearable:"",placeholder:r.$t("请输入数量")},null,8,["modelValue","onUpdate:modelValue","max","placeholder"])])])))),256))])])]),b("div",ve,[y(xe,{ref_key:"formRef",ref:we,"label-width":"auto",model:he.value,class:"form-body","label-suffix":"："},{default:V((()=>[y(K,{rules:[{required:!0,message:r.$t("请选择服务类型")}],label:r.$t("服务类型"),prop:"aftersaleType"},{default:V((()=>[y(R,{modelValue:he.value.aftersaleType,"onUpdate:modelValue":s[0]||(s[0]=e=>he.value.aftersaleType=e)},{default:V((()=>{return[(f(!0),v(_,null,g((e=je.value?je.value:{},e?Object.entries(e).map((([e,l])=>({id:Number(e),name:String(l)}))):[]),(e=>(f(),U(E,{value:e.id},{default:V((()=>[q(h(e.name),1)])),_:2},1032,["value"])))),256))];var e})),_:1},8,["modelValue"])])),_:1},8,["rules","label"]),y(K,{rules:[{required:!0,message:r.$t("请选择售后原因")}],label:r.$t("售后原因"),prop:"aftersaleReason"},{default:V((()=>[y(W,{modelValue:he.value.aftersaleReason,"onUpdate:modelValue":s[1]||(s[1]=e=>he.value.aftersaleReason=e),placeholder:r.$t("请选择"),style:{width:"500px"}},{default:V((()=>[(f(!0),v(_,null,g(be.value,((e,l)=>(f(),U(P,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue","placeholder"])])),_:1},8,["rules","label"]),y(K,{label:r.$t("预计退款金额"),prop:"refundAmount"},{default:V((()=>[y(ge,{disabled:"",modelValue:he.value.refundAmount,"onUpdate:modelValue":s[2]||(s[2]=e=>he.value.refundAmount=e),clearable:"",placeholder:r.$t("请输入申请金额")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),y(K,{rules:[{required:!0,message:r.$t("问题描述不能为空")}],label:r.$t("问题描述"),prop:"description"},{default:V((()=>[y(ge,{modelValue:he.value.description,"onUpdate:modelValue":s[3]||(s[3]=e=>he.value.description=e),row:4,clearable:"",placeholder:r.$t("请输入问题描述"),type:"textarea"},null,8,["modelValue","placeholder"])])),_:1},8,["rules","label"]),y(K,{label:r.$t("上传文件")},{default:V((()=>[y(X,{uploadList:he.value.pics,"onUpdate:uploadList":s[4]||(s[4]=e=>he.value.pics=e),fileTypes:["gif","jpeg","png","word","excel","txt","zip","ppt","pdf"],limit:5},null,8,["uploadList"])])),_:1},8,["label"]),y(K,{label:""},{default:V((()=>[y(Ve,{type:"primary",onClick:Ie},{default:V((()=>[q(h(r.$t("提交")),1)])),_:1})])),_:1})])),_:1},8,["model"])])]))])]),y($e)],64)}}}),[["__scopeId","data-v-505dc3c4"]]);export{ye as default};
