import{E as e}from"./ClnUiH43.js";import{_ as o}from"./Dev7PMii.js";import{E as a,a as r}from"./Di7_rRxo.js";import{E as s}from"./CK-rvtuG.js";import{e as l,cc as t,cb as i,f as d,z as m,r as u,I as p,g as n,m as c,o as v,w as b,h as _,b as f,a as w,t as g,c as j,i as y,d as E,cd as $,_ as V}from"./BLNaUqdG.js";import{_ as h}from"./C2YhyD2L.js";import{s as q,b as T}from"./Dy66ZC1y.js";import{M as k}from"./DNPatwbc.js";import"./BucM0pco.js";import"./rSOsbbvW.js";import"./BWAJcOoD.js";import"./losdC6Ud.js";import"./BwRzfsZt.js";import"./CxZS6lgh.js";import"./D_Dr4eZ1.js";import"./BX08AvzU.js";import"./C8QNSlsX.js";import"./DSXY0Md2.js";import"./DgmxjSXK.js";const x={class:"label"},C={class:"area-code-input"},U={key:0,class:"area-code-select"},A={class:"label"},S=V(l({__name:"StepOne",props:{step:{},stepModifiers:{}},emits:t(["success"],["update:step"]),setup(l,{emit:t}){const V=i(l,"step"),S=t,Z=d(),{t:z}=m(),M=u(!1),F=u("86"),I=p(),O=(e,o,a)=>{B.value.tigTips[e]=o?{type:"valid",message:a}:{type:"error",message:a}},Q=e=>{B.value.tigTips[e]={type:"info",message:R[e]}},R=n({mobile:z("请填写手机号码"),mail:z("请填写邮箱地址"),code:z("请输入验证码"),password:z("6-20个大小写英文字母、符号或数字的组合")}),W=n({mobile:[{validator:(e,o,a)=>{const r=Z.is_open_mobile_area_code?/^(\+?[1-9]\d{1,14})$/:/^(?:\+?86)?1[3-9]\d{9}$/;return o?r.test(o)?void a():a(new Error(z("格式错误，请输入正确的手机号码"))):a(new Error(z("手机号不能为空")))},trigger:"blur",required:!0}],mail:[{validator:(e,o,a)=>o?/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(o)?void a():a(new Error(z("格式错误，请输入正确的邮箱地址"))):a(new Error(z("邮箱不能为空"))),trigger:"blur",required:!0}],code:[{validator:(e,o,a)=>o?6!=o.length?a(new Error(z("请输入6位验证码"))):void a():a(new Error(z("验证码不能为空"))),trigger:"blur",required:!0}],password:[{validator:(e,o,a)=>o?o.length>20||o.length<6?a(new Error(z("密码应为6-20位字符"))):/\s/.test(o)?a(new Error(z("密码中不允许有空格"))):/^\d+$/.test(o)?a(new Error(z("密码不能全为数字"))):/^(?=.*[\d\W]).+$/.test(o)?/^(?=.*[a-zA-Z0-9]).+$/.test(o)?/^(?!([a-zA-Z0-9])\1*$).+$/.test(o)?void a():a(new Error(z("密码不能全为相同字符或数字"))):a(new Error(z("密码不能全为符号"))):a(new Error(z("密码不能全为字母"))):a(new Error(z("密码不能为空"))),trigger:"blur",required:!0}]}),Y=u(!1),B=u({tigTips:{},mobile:"",code:""}),D=async()=>{await I.value.validate();try{Y.value=!0;const e=await T({mobile:Z.is_open_mobile_area_code?F.value+B.value.mobile:B.value.mobile,code:B.value.code});S("success",e.item),V.value=2}catch(e){$.error(e.message),B.value.code="",B.value.tigTips={}}finally{Y.value=!1}},G=e=>{$.error(e)};return(l,t)=>{const i=e,d=o,m=a,u=s,p=r;return v(),c(p,{ref_key:"formRef",ref:I,"hide-required-asterisk":!0,model:B.value,rules:y(W),"show-message":!1,class:"form-body","label-width":"auto",onValidate:O},{default:b((()=>["mobile"!==B.value.regist_type&&B.value.regist_type?_("",!0):(v(),c(m,{key:0,prop:"mobile"},{default:b((()=>[w("div",x,g(l.$t("手机号")),1),w("div",C,[f(i,{modelValue:B.value.mobile,"onUpdate:modelValue":t[1]||(t[1]=e=>B.value.mobile=e),class:"input-border-style",onFocus:t[2]||(t[2]=e=>Q("mobile"))},{prefix:b((()=>[y(Z).is_open_mobile_area_code?(v(),j("div",U,[f(h,{modelValue:F.value,"onUpdate:modelValue":t[0]||(t[0]=e=>F.value=e)},null,8,["modelValue"])])):_("",!0)])),_:1},8,["modelValue"])]),f(d,{info:B.value.tigTips.mobile},null,8,["info"])])),_:1})),f(m,{prop:"code"},{default:b((()=>[w("div",A,g(l.$t("验证码")),1),f(i,{modelValue:B.value.code,"onUpdate:modelValue":t[4]||(t[4]=e=>B.value.code=e),class:"input-border-style",onFocus:t[5]||(t[5]=e=>Q("code"))},{suffix:b((()=>[f(y(k),{class:"mobile-code-text",event:"forget_password",mobile:y(Z).is_open_mobile_area_code?F.value+B.value.mobile:B.value.mobile,mobileCodeSended:M.value,"onUpdate:mobileCodeSended":t[3]||(t[3]=e=>M.value=e),requestApi:y(q),onMobileErrorCallback:G},null,8,["mobile","mobileCodeSended","requestApi"])])),_:1},8,["modelValue"]),f(d,{info:B.value.tigTips.code},null,8,["info"])])),_:1}),f(m,{label:"",prop:"first_word"},{default:b((()=>[f(u,{loading:Y.value,type:"primary",class:"submit-button",style:{width:"330px"},onClick:D},{default:b((()=>[E(g(l.$t("下 一 步")),1)])),_:1},8,["loading"])])),_:1})])),_:1},8,["model","rules"])}}}),[["__scopeId","data-v-08022f46"]]);export{S as default};
