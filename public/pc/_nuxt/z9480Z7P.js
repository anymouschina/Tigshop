import{_ as e}from"./9TMjRzGO.js";import{E as t}from"./CK-rvtuG.js";import{_ as a}from"./DGSQZaL6.js";import{E as l}from"./CttV6g0d.js";import{_ as s}from"./CScYj7Fy.js";import{e as i,f as o,z as c,r as d,y as n,C as u,c as r,o as m,b as v,h as p,m as _,a as f,t as h,w as k,d as y,F as g,l as b,i as V,ah as x,v as j,q as $,j as w,E as U,k as T,n as C,ai as E,ae as q,_ as F}from"./BLNaUqdG.js";import{_ as O}from"./CdUPjuAS.js";import{_ as L}from"./zM3V5R1F.js";import"./C8qdh5cF.js";import z from"./Dy5vXTrb.js";import B from"./BdfwJFyF.js";import S from"./DotsVPN4.js";import{g as W,u as H,r as M,c as R,a as Y}from"./Bp2G0jMz.js";import{E as Z}from"./DjYrY2s1.js";import"./DSwxsogY.js";import"./C8QNSlsX.js";import"./BWAJcOoD.js";import"./losdC6Ud.js";import"./BwRzfsZt.js";import"./D_Dr4eZ1.js";import"./D-E-9YUO.js";import"./DlIXSNl1.js";import"./DmeNR82d.js";import"./BucM0pco.js";import"./rSOsbbvW.js";import"./DgmxjSXK.js";import"./BX08AvzU.js";import"./CxZS6lgh.js";import"./DIIF5iVx.js";/* empty css        */import"./DxiXPFL-.js";import"./BynQilW0.js";import"./CTzMDe2j.js";import"./DqAohYkb.js";const I={style:{"background-color":"#f2f3f5"}},J={key:0,class:"container"},P={class:"no_goods clearfix"},Q={class:"left main"},X={class:"strong"},A={key:1,class:"container"},D={class:"cart-tit"},G={class:"cart-head"},K={class:"product-list-cart flex"},N={class:"item col-1 center"},ee={class:"item col-1",style:{"justify-content":"left"}},te={class:"item col-3",style:{"justify-content":"left"}},ae={class:"item col-2 center"},le={class:"item col-2 center"},se={class:"item col-2 center"},ie={class:"item col-2 center"},oe={class:"cart_table"},ce={class:"cart_store_title flex"},de={class:"item col-1 center"},ne={class:"item col-3 flex align-center"},ue={key:0,class:"tag"},re={key:1,class:"tit"},me={class:"cart_list_wrap"},ve={class:"product-item flex"},pe={class:"item col-1 center flex align-center justify-center"},_e={class:"item col-4 flex"},fe={class:"pic"},he=["href"],ke=["src"],ye={key:1},ge=["src"],be={key:2,class:"disabled"},Ve={key:0},xe={class:"name pt5"},je=["href"],$e={key:1},we={class:"info"},Ue={key:2,class:"extraskudata"},Te={class:"title"},Ce={class:"content"},Ee={class:"content-text"},qe={class:"num"},Fe={key:3,class:"promotion-box"},Oe={key:0,class:"promotion"},Le={class:"ticket-content"},ze={key:1,class:"promotion"},Be={class:"ticket-type"},Se={class:"ticket-content"},We={class:"item col-2 center"},He={class:"price pt5 center-price"},Me={class:"item col-2 center"},Re={class:"pt5 flex justify-center"},Ye={class:"item col-2 center"},Ze={class:"money pt5"},Ie={class:"item col-2 center"},Je=["onClick"],Pe={key:0,class:"gift-box"},Qe={class:"gift-title"},Xe={class:"gift-content"},Ae={class:"gift-content-item"},De={class:"gift-item-left"},Ge={class:"gift-item-right"},Ke={class:"gift-item-name"},Ne={key:0,class:"sku-card"},et={class:"gift-item-num"},tt={class:"pay_tools_inner flex justify-between align-center container"},at={class:"pay_tools_l flex align-center"},lt={class:"item col-1 center"},st={class:"pay_txt_row flex"},it=["innerHTML"],ot={class:"pay_tools_r flex align-center"},ct={class:"pay_tools_total_box"},dt={class:"flex align-center justify-end"},nt={class:"r_prod_view"},ut={class:"font-color"},rt={class:"r_price_total"},mt={class:"tit"},vt={class:"discounts-btn-box"},pt={class:"discounts-btn"},_t={class:"discount"},ft={class:"discount-title"},ht={class:"title-text"},kt={class:"discount-content"},yt={class:"discount-item-box"},gt={class:"item-label"},bt={class:"item-value"},Vt={key:0,class:"discount-item-box"},xt={class:"item-label"},jt={class:"item-value"},$t={class:"discount-item-box"},wt={class:"item-label"},Ut={class:"item-value discounts-value",style:{color:"var(--general)"}},Tt={key:0,class:"sub-item-box"},Ct={class:"sub-item-label"},Et={class:"sub-item-value discounts-value"},qt={key:1,class:"discount-detail"},Ft={class:"sub-item-label"},Ot={class:"sub-item-value discounts-value"},Lt={class:"discount-item-box"},zt={class:"item-label"},Bt={class:"item-value"},St={class:"discount-desc"},Wt={key:3},Ht=F(i({__name:"index",setup(i){const F=o(),{t:Ht}=c(),Mt=d(!0),Rt=d([]),Yt=d({}),Zt=d(!1),It=d();n((()=>{Pt()}));const Jt=e=>0==e.product_status||0==e.stock||1==e.is_disabled,Pt=async()=>{try{It.value=Z.service({lock:!1,text:Ht("请求加载中"),customClass:"tig-normal-loading"});const e=await W();Rt.value=e.cart_list,Yt.value=e.total,console.log("total",Yt.value),Kt()}catch(e){}finally{Mt.value=!1,It.value.close(),Zt.value=!0}},Qt=async()=>{try{const e=[];Rt.value.forEach((t=>{t.carts.forEach((t=>{e.push({cart_id:t.cart_id,is_checked:t.is_checked&&!1===t.is_disabled?1:0})}))}));await Y({data:e});Pt()}catch(e){}},Xt=()=>{let e=0;Rt.value.forEach((t=>{t.carts.forEach((t=>{1==t.is_checked&&(e+=1)}))})),0!=e?E.confirm({title:Ht("确认要删除指定的商品吗"),cancelText:Ht("取消"),okText:Ht("确定"),maskClosable:!0,centered:!0,onOk:async()=>{try{const e=[];Rt.value.forEach((t=>{t.carts.forEach((t=>{t.is_checked&&e.push(t.cart_id)}))}));await M(e);await Pt()}catch(e){}}}):C.error(Ht("您还未选中任何商品"))},At=()=>{E.confirm({title:Ht("确认要清空购物车吗？"),cancelText:Ht("取消"),okText:Ht("确定"),maskClosable:!0,centered:!0,onOk:async()=>{try{await R();await Pt()}catch(e){}}})},Dt=()=>{Rt.value.forEach((e=>{e.carts.forEach((e=>{e.is_checked=1==Gt.value&&!1===e.is_disabled}))})),Kt(),Qt()},Gt=d(!1),Kt=()=>{Rt.value.forEach((e=>{const t=e.carts.filter((e=>!e.is_disabled));e.is_checked=t.every((e=>!0===e.is_checked&&!e.is_disabled))})),Gt.value=Rt.value.every((e=>!0===e.is_checked))},Nt=d(null),ea=d(!1),ta=()=>{const e=window.scrollY,t=window.innerHeight,a=Nt.value;if(a){const l=a.getBoundingClientRect().top+e;ea.value=!(e+t-60>l)}},aa={1:"秒杀价",2:"券",3:"满减",4:"折扣",5:"满赠",6:"限时折扣"},la=e=>{const t=[],a=e.filter((e=>2===e.type)),l=e.filter((e=>2!==e.type));return l.length>0&&t.push(l[0]),a.length>0&&t.push(a[0]),t},sa=d(!1);n((()=>{window.addEventListener("scroll",ta),ta()})),u((()=>{window.removeEventListener("scroll",ta)}));return(i,o)=>{const c=e,d=t,n=a,u=l,W=s,R=U,Y=O,Z=L;return m(),r("div",I,[v(c,{title:"购物车"}),v(z,{step:1}),Mt.value||0!==Rt.value.length?p("",!0):(m(),r("div",J,[f("div",P,[o[13]||(o[13]=f("div",{class:"left icon"},null,-1)),f("div",Q,[f("div",X,h(i.$t("您的购物车中暂时没有商品"))+"！",1),v(n,{to:"/"},{default:k((()=>[v(d,{type:"primary",size:"large",title:i.$t("马上挑选商品")},{default:k((()=>[y(h(i.$t("去逛逛")),1)])),_:1},8,["title"])])),_:1})])])])),!Mt.value&&Rt.value.length>0?(m(),r("div",A,[f("p",D,h(i.$t("你好，欢迎来到您的购物车")),1),f("div",null,[f("div",G,[f("div",K,[f("div",N,[v(u,{modelValue:Gt.value,"onUpdate:modelValue":o[0]||(o[0]=e=>Gt.value=e),onChange:Dt},null,8,["modelValue"])]),f("div",ee,h(i.$t("全选")),1),f("div",te,h(i.$t("商品信息")),1),f("div",ae,h(i.$t("单价")),1),f("div",le,h(i.$t("数量")),1),f("div",se,h(i.$t("小计")),1),f("div",ie,h(i.$t("操作")),1)])]),Rt.value?(m(!0),r(g,{key:0},b(Rt.value,((e,t)=>(m(),r("div",oe,[f("div",ce,[f("div",de,[v(u,{modelValue:e.is_checked,"onUpdate:modelValue":t=>e.is_checked=t,onChange:t=>(e=>{e.carts.forEach((t=>{t.is_checked=1==e.is_checked})),Kt(),Qt()})(e)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),f("div",ne,[0==e.shop_id?(m(),r("div",ue,h(i.$t("自营")),1)):V(x)()?(m(),r("div",re,h(e.shop_title),1)):p("",!0)])]),f("div",me,[(m(!0),r(g,null,b(e.carts,(e=>(m(),r("div",{class:j(["product-list-cart",Jt(e)?"disabled-item":""])},[f("div",ve,[f("div",pe,[v(u,{modelValue:e.is_checked,"onUpdate:modelValue":t=>e.is_checked=t,onChange:o[1]||(o[1]=e=>{Qt()}),disabled:Jt(e)},null,8,["modelValue","onUpdate:modelValue","disabled"])]),f("div",_e,[f("div",fe,[0!=e.stock&&0!=e.product_status?(m(),r("a",{key:0,target:"_blank",href:V($)({path:"product",id:e.product_id,sn:e.product_sn})},[f("img",{src:("imageFormat"in i?i.imageFormat:V(w))(e.pic_thumb),alt:""},null,8,ke)],8,he)):(m(),r("div",ye,[f("img",{src:("imageFormat"in i?i.imageFormat:V(w))(e.pic_thumb),alt:""},null,8,ge)])),0!=e.stock&&0!=e.product_status||1!=e.is_disabled?p("",!0):(m(),r("div",be,[0==e.stock||0==e.product_status?(m(),r("div",Ve,h(0==e.product_status?i.$t("已下架"):i.$t("已售罄")),1)):p("",!0)]))]),f("div",xe,[0!=e.stock&&0!=e.product_status?(m(),r("a",{key:0,target:"_blank",href:V($)({path:"product",id:e.product_id,sn:e.product_sn})},h(e.product_name),9,je)):(m(),r("p",$e,h(e.product_name),1)),f("div",we,[(m(!0),r(g,null,b(e.sku_data,((e,t)=>(m(),r("span",null,h(0!==t?" , ":"")+h(e.name)+":"+h(e.value),1)))),256))]),e.extra_sku_data&&e.extra_sku_data.length?(m(),r("div",Ue,[(m(!0),r(g,null,b(e.extra_sku_data,(t=>(m(),r("div",{key:t,class:"extraskudata-item"},[f("div",Te,h(t.attr_name),1),o[14]||(o[14]=f("div",{class:"line-box"},[f("div",{class:"line"})],-1)),f("div",Ce,[f("span",Ee,h(t.attr_value),1),v(W,{modelValue:t.attr_price,"onUpdate:modelValue":e=>t.attr_price=e,showText:!1},null,8,["modelValue","onUpdate:modelValue"]),f("span",qe,"x"+h(e.quantity),1)])])))),128))])):p("",!0),e.activity_info?(m(),r("div",Fe,[(m(!0),r(g,null,b(la(e.activity_info),(e=>(m(),r("div",{class:"promotion-box-item",key:e.promotion_id},[2!=e.type?(m(),r("div",Oe,[f("div",Le,h(i.$t(aa[e.type])),1)])):p("",!0),2==e.type?(m(),r("div",ze,[f("div",Be,[y(h(i.$t("券")),1),o[15]||(o[15]=f("span",{class:"ticket-line"},null,-1))]),f("div",Se,h(e.data.promotion_desc),1)])):p("",!0)])))),128))])):p("",!0)])]),f("div",We,[f("div",He,[v(W,{modelValue:e.price,"onUpdate:modelValue":t=>e.price=t,showText:!1},null,8,["modelValue","onUpdate:modelValue"])])]),f("div",Me,[f("div",Re,[v(B,{modelValue:e.quantity,"onUpdate:modelValue":t=>e.quantity=t,onChange:t=>(async e=>{try{await H(e.cart_id,{quantity:e.quantity}),await Pt()}catch(t){C.error(t.message),e.quantity=t.quantity}})(e),disabled:Jt(e)},null,8,["modelValue","onUpdate:modelValue","onChange","disabled"])])]),f("div",Ye,[f("div",Ze,[v(W,{modelValue:e.subtotal,"onUpdate:modelValue":t=>e.subtotal=t,showText:!1},null,8,["modelValue","onUpdate:modelValue"])])]),f("div",Ie,[f("div",null,[f("a",{onClick:t=>{return a=e.cart_id,void E.confirm({title:Ht("确认要删除该商品吗"),cancelText:Ht("取消"),okText:Ht("确定"),maskClosable:!0,centered:!0,onOk:async()=>{try{await M([a]),Pt()}catch(e){}}});var a},style:{cursor:"pointer"}},o[16]||(o[16]=[f("i",{class:"iconfont-pc icon-shanchu"},null,-1)]),8,Je)])])]),o[17]||(o[17]=f("div",{class:"cart-line"},null,-1))],2)))),256))]),e.gift.length>0?(m(),r("div",Pe,[f("div",Qe,h(i.$t("赠品")),1),f("div",Xe,[(m(!0),r(g,null,b(e.gift,(e=>(m(),_(n,{key:e.gift_id,target:"_blank",to:V($)({path:"product",id:e.product_id,sn:e.product_sn})},{default:k((()=>[f("div",Ae,[f("div",De,[v(R,{class:"gift-img",lazy:"",src:("imageFormat"in i?i.imageFormat:V(w))(e.pic_thumb)},null,8,["src"])]),f("div",Ge,[f("div",Ke,h(e.product_name),1),e.sku_data.length>0?(m(),r("div",Ne,[(m(!0),r(g,null,b(e.sku_data,((e,t)=>(m(),r("div",{key:t,class:"sku-item"},h(e.value),1)))),128))])):p("",!0),f("div",et,"x"+h(e.num),1)])])])),_:2},1032,["to"])))),128))])])):p("",!0)])))),256)):p("",!0),f("div",{class:"checkOutBar",id:"price-total",ref_key:"checkOutBarRef",ref:Nt},[f("div",{class:j({pay_tools_bar:!0,tools_bar_bottom:ea.value})},[f("div",tt,[f("div",at,[f("div",lt,[v(u,{modelValue:Gt.value,"onUpdate:modelValue":o[2]||(o[2]=e=>Gt.value=e),onChange:Dt},null,8,["modelValue"])]),f("div",st,[y(h(i.$t("全选"))+" ",1),f("div",null,[f("span",{innerHTML:V(T)()?i.$t("共<span class='font-color'>{0}</span>件",[Yt.value.total_count]):`共<span class='font-color'>${Yt.value.total_count}</span>件`},null,8,it)]),f("div",null,[f("a",{onClick:Xt},h(i.$t("删除勾选商品")),1)]),f("div",null,[f("a",{onClick:At},h(i.$t("清空购物车")),1)])])]),f("div",ot,[f("div",ct,[f("div",dt,[f("p",nt,[y(h(i.$t("已选商品"))+" ",1),f("span",ut,h(Yt.value.checked_count),1),y(" "+h(i.$t("件")),1)]),f("div",rt,[f("span",mt,h(i.$t("合计"))+"：",1),v(W,{modelValue:Yt.value.discount_after,"onUpdate:modelValue":o[3]||(o[3]=e=>Yt.value.discount_after=e),showText:!1},null,8,["modelValue"])])]),f("div",vt,[f("div",null,[y(h(i.$t("共优惠"))+"：",1),v(W,{modelValue:Yt.value.discounts,"onUpdate:modelValue":o[4]||(o[4]=e=>Yt.value.discounts=e),showText:!1},null,8,["modelValue"])]),v(Y,{modelValue:sa.value,"onUpdate:modelValue":o[11]||(o[11]=e=>sa.value=e)},{reference:k((()=>[f("div",pt,[y(h(i.$t("优惠明细"))+" ",1),f("span",{class:j(["iconfont-pc icon-shangjiantou",{"icon-active":sa.value}])},null,2)])])),default:k((()=>[f("div",_t,[f("div",ft,[f("div",ht,h(i.$t("优惠明细")),1)]),f("div",kt,[f("div",yt,[f("div",gt,h(i.$t("商品总额")),1),f("div",bt,[v(W,{showText:!1,modelValue:Yt.value.product_amount,"onUpdate:modelValue":o[5]||(o[5]=e=>Yt.value.product_amount=e),fontStyle:{fontWeight:"bold"}},null,8,["modelValue"])])]),Yt.value.service_fee&&Yt.value.service_fee>0?(m(),r("div",Vt,[f("div",xt,h(i.$t("附加费用")),1),f("div",jt,[v(W,{modelValue:Yt.value.service_fee,"onUpdate:modelValue":o[6]||(o[6]=e=>Yt.value.service_fee=e),fontStyle:{fontWeight:"bold"},showText:!1},null,8,["modelValue"])])])):p("",!0),f("div",$t,[f("div",wt,h(i.$t("共优惠")),1),f("div",Ut,[o[18]||(o[18]=y(" - ")),v(W,{modelValue:Yt.value.discounts,"onUpdate:modelValue":o[7]||(o[7]=e=>Yt.value.discounts=e),showText:!1},null,8,["modelValue"])]),Yt.value.discount_discount_amount>0?(m(),r("div",Tt,[f("div",Ct,h(i.$t("其他优惠")),1),f("div",Et,[o[19]||(o[19]=y(" - ")),v(W,{modelValue:Yt.value.discount_discount_amount,"onUpdate:modelValue":o[8]||(o[8]=e=>Yt.value.discount_discount_amount=e),showText:!1},null,8,["modelValue"])])])):p("",!0)]),Yt.value.discount_coupon_amount>0?(m(),r("div",qt,[f("div",Ft,h(i.$t("优惠券")),1),f("div",Ot,[o[20]||(o[20]=y(" - ")),v(W,{modelValue:Yt.value.discount_coupon_amount,"onUpdate:modelValue":o[9]||(o[9]=e=>Yt.value.discount_coupon_amount=e),showText:!1},null,8,["modelValue"])])])):p("",!0),f("div",Lt,[f("div",zt,h(i.$t("合计")),1),f("div",Bt,[v(W,{modelValue:Yt.value.discount_after,"onUpdate:modelValue":o[10]||(o[10]=e=>Yt.value.discount_after=e),fontStyle:{fontWeight:"bold"},showText:!1},null,8,["modelValue"])])]),f("div",St,h(i.$t("以上优惠不包含运费，实际优惠金额请以确认订单页为准")),1)])])])),_:1},8,["modelValue"])])]),f("div",{onClick:o[12]||(o[12]=e=>Yt.value.checked_count&&(()=>{if(1===F.close_order)return C.error(Ht("商城已关闭下单"));q("/order/check/")})()),class:j("checkout_btn hand-pointer "+(0==Yt.value.checked_count?"disabled":""))},h(i.$t("去结算")),3)])])],2)],512)])])):p("",!0),Zt.value?(m(),_(S,{key:2,onOnBuy:Pt})):p("",!0),Mt.value?(m(),r("div",Wt,o[21]||(o[21]=[f("div",null,[f("div",{style:{height:"300px",width:"100%"}})],-1)]))):p("",!0),v(Z)])}}}),[["__scopeId","data-v-dcaefc4b"]]);export{Ht as default};
