import{_ as s}from"./DIcT5qlW.js";import{_ as a}from"./nl8XxKER.js";import{_ as t}from"./4BWvF7DS.js";import{e as o,G as e,s as i,r as l,z as r,y as c,n,ae as m,S as d,c as p,o as u,b as v,a as j,t as f,d as w,i as y,E as h,_ as g}from"./vO8z_6wc.js";import{_ as $}from"./B6kpiin_.js";import{E as _}from"./pBde3eXe.js";import"./OZUBBuO3.js";import"./duVALuQ5.js";import"./YLitFIRx.js";import{Q as b}from"./CrMBAJkk.js";import{e as k,f as C,d as I}from"./B2EP4DEK.js";import{s as S}from"./DSXY0Md2.js";import"./DEtxbcwL.js";import"./DRy-t1KR.js";import"./Ctuj9lAE.js";import"./BG07ctRk.js";import"./y2YKyhRU.js";import"./CKVP4sCQ.js";import"./DqoL2U0I.js";import"./CdIa5lAL.js";import"./BwRzfsZt.js";import"./B0jPhJeY.js";import"./D_Dr4eZ1.js";import"./C8tVKSc2.js";const x={class:"wechat-com"},U={class:"wechat container"},V={class:"message"},z={class:"message"},B={class:"payment"},E={class:"title"},L={class:"image-div"},M={class:"left-image"},O={key:0,class:"ewm"},q={key:1,class:"ewm-empty"},D={class:"pw-box-ft"},G=g(o({__name:"wechat",setup(o){const g=e(),G=i((()=>g.query.id)),J=l(!0);l({});const P=l(""),Q=l({amount:0});(async()=>{try{const s=await C({orderId:G.value});Q.value=s.order}catch(s){n.error(s.message)}})();const{t:R}=r(),T=l(0);let W=null;c((()=>{(async()=>{J.value=!0;try{const s=await I({id:G.value,type:"wechat"});await A(null==s?void 0:s.payInfo.codeUrl)}catch(s){n.error(s.message)}finally{J.value=!1}})(),W=S((()=>{Z(),T.value++,50===T.value&&(clearInterval(W),n.error(R("支付已超时，您可以刷新页面重新支付")))}),2e3)}));const Z=()=>{k({id:G.value}).then((s=>{1==s.payStatus&&(clearInterval(W),_.confirm(R("充值成功"),R("提示"),{confirmButtonText:R("查看充值详情"),showClose:!1,showCancelButton:!1,closeOnClickModal:!1,type:"success"}).then((()=>{m("/member/account/log")})).catch((()=>{})))}))},A=async s=>{const a=s;P.value=await b.toDataURL(a,{margin:1,width:500,height:500})},F=()=>{window.close()},H=()=>{window.location.reload()};return d((()=>{clearInterval(W)})),(o,e)=>{const i=s,l=a,r=t,c=h,n=$;return u(),p("div",null,[v(i,{title:"微信支付"}),v(l,{showLogin:!1}),j("div",x,[j("div",U,[j("div",V,f(o.$t("订单提交成功，请尽快付款")),1),j("div",z,[w(f(o.$t("应付金额"))+"： ",1),v(r,{modelValue:y(Q).amount,"onUpdate:modelValue":e[0]||(e[0]=s=>y(Q).amount=s),fontStyle:{color:"var(--price)",fontSize:"18px"}},null,8,["modelValue"])]),j("div",B,[j("div",E,f(o.$t("微信支付")),1),j("div",L,[j("div",M,[j("div",null,[w(f(o.$t("如果二维码已过期"))+"，",1),j("span",{onClick:H,class:"font-color",style:{cursor:"pointer"}},f(o.$t("刷新")),1),w(f(o.$t("重新获取二维码"))+"。 ",1)]),y(T)<=50?(u(),p("div",O,[v(c,{class:"image",src:y(P)},null,8,["src"])])):(u(),p("div",q,[w(f(o.$t("已超时"))+"，",1),j("a",{class:"font-color",onClick:H},f(o.$t("点击刷新")),1)])),j("div",D,[j("div",null,f(o.$t("请使用微信扫一扫")),1),j("div",null,f(o.$t("扫描二维码支付")),1)])]),e[1]||(e[1]=j("div",{class:"right-image"},[j("div",{class:"image"})],-1))]),j("div",{onClick:F,class:"button-title"},"< "+f(o.$t("选择其他支付方式")),1)])])]),v(n,{bg:"white",mt30:!1,type:1})])}}}),[["__scopeId","data-v-205cd0bf"]]);export{G as default};
