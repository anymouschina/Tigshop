import{_ as a}from"./9TMjRzGO.js";import{_ as s}from"./BlxdsvOv.js";import{_ as t}from"./CScYj7Fy.js";import{e,G as o,r as i,z as l,y as r,n as c,ae as n,S as m,c as d,o as p,b as u,a as v,t as y,i as f,d as j,h as w,E as h,_ as $}from"./BLNaUqdG.js";import{_ as g}from"./zM3V5R1F.js";import{E as _}from"./C8IqyEYy.js";import"./CK-rvtuG.js";import"./ClnUiH43.js";import"./CQcoTD7x.js";import{Q as k}from"./CtheyMuC.js";import{w as b,z as C}from"./DjqjJCjM.js";import{e as x,f as I,d as S}from"./fH7NBuZy.js";import{s as V}from"./DSXY0Md2.js";import"./DSwxsogY.js";import"./DGSQZaL6.js";import"./D-E-9YUO.js";import"./DlIXSNl1.js";import"./DxiXPFL-.js";import"./losdC6Ud.js";import"./C8QNSlsX.js";import"./BWAJcOoD.js";import"./BwRzfsZt.js";import"./CxZS6lgh.js";import"./D_Dr4eZ1.js";import"./D5ZJ33IS.js";const q={class:"wechat-com"},z={class:"wechat container"},B={class:"message"},E={class:"message"},L={class:"payment"},M={key:0,class:"title"},O={key:1,class:"title"},P={class:"image-div"},U={class:"left-image"},Y={key:0,class:"ewm"},D={key:1,class:"ewm-empty"},G={class:"pw-box-ft"},J={key:0},Q={key:1},R={key:2},T={class:"right-image"},W={key:0,class:"image"},Z={key:1,class:"image"},A=$(e({__name:"yabanpay",setup(e){const $=o(),A=i($.query.id),F=i($.query.type),H=i(!0);i({});const K=i(""),N=i({}),{t:X}=l();(async()=>{try{const a=await I({order_id:A.value});N.value=a.order}catch(a){c.error(a.message),n("/member/account/detail")}})();const aa=i(0);let sa=null;r((()=>{(async()=>{H.value=!0;try{const a=await S({id:A.value,type:"yabanpay_"+F.value});ea(null==a?void 0:a.pay_info.code_url)}catch(a){c.error(a.message)}finally{H.value=!1}})(),sa=V((()=>{ta(),aa.value++,50===aa.value&&(clearInterval(sa),c.error(X("支付已超时，您可以刷新页面重新支付")))}),2e3)}));const ta=()=>{x({id:A.value}).then((a=>{1==a.pay_status&&(clearInterval(sa),_.confirm(X("订单支付成功"),X("提示"),{confirmButtonText:X("查看订单"),showClose:!1,showCancelButton:!1,closeOnClickModal:!1,type:"success"}).then((()=>{n("/member/account/detail")})).catch((()=>{})))}))},ea=async a=>{const s=a;K.value=await k.toDataURL(s,{margin:1,width:500,height:500})},oa=()=>{window.close()},ia=()=>{window.location.reload()};return m((()=>{clearInterval(sa)})),(e,o)=>{const i=a,l=s,r=t,c=h,n=g;return p(),d("div",null,[u(i,{title:"YaBandPay"}),u(l,{showLogin:!1}),v("div",q,[v("div",z,[v("div",B,y(e.$t("订单提交成功，请尽快付款"))+"！"+y(e.$t("订单号"))+"："+y(f(N).order_sn),1),v("div",E,[j(y(e.$t("应付金额"))+"： ",1),u(r,{modelValue:f(N).amount,"onUpdate:modelValue":o[0]||(o[0]=a=>f(N).amount=a),fontStyle:{color:"var(--price)",fontSize:"18px"}},null,8,["modelValue"])]),v("div",L,["wechat"==f(F)?(p(),d("div",M,y(e.$t("微信支付")),1)):w("",!0),"alipay"==f(F)?(p(),d("div",O,y(e.$t("支付宝支付")),1)):w("",!0),v("div",P,[v("div",U,[v("div",null,[j(y(e.$t("如果二维码已过期"))+"，"+y(e.$t("请")),1),v("span",{onClick:ia,class:"font-color",style:{cursor:"pointer"}},y(e.$t("刷新")),1),j(y(e.$t("页面重新获取二维码"))+"。 ",1)]),f(aa)<=50?(p(),d("div",Y,[u(c,{class:"image",src:f(K)},null,8,["src"])])):(p(),d("div",D,[j(y(e.$t("已超时"))+"，",1),v("a",{class:"font-color",onClick:ia},y(e.$t("点击刷新")),1)])),v("div",G,["wechat"==f(F)?(p(),d("div",J,y(e.$t("请使用微信扫一扫")),1)):w("",!0),"alipay"==f(F)?(p(),d("div",Q,y(e.$t("请使用支付宝扫一扫")),1)):w("",!0),"yunshanfu"==f(F)?(p(),d("div",R,y(e.$t("请使用云闪付扫一扫")),1)):w("",!0),v("div",null,y(e.$t("扫描二维码支付")),1)])]),v("div",T,["wechat"==f(F)?(p(),d("div",W,[u(c,{src:f(b)},null,8,["src"])])):w("",!0),"alipay"==f(F)?(p(),d("div",Z,[u(c,{src:f(C)},null,8,["src"])])):w("",!0)])]),v("div",{onClick:oa,class:"button-title"},"< "+y(e.$t("选择其他支付方式")),1)])])]),u(n,{bg:"white",mt30:!1,type:1})])}}}),[["__scopeId","data-v-1589f18c"]]);export{A as default};
