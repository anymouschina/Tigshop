import{_ as a}from"./DIcT5qlW.js";import{_ as s}from"./nl8XxKER.js";import{_ as t}from"./4BWvF7DS.js";import{e,G as o,r,z as i,y as l,n as c,ae as n,S as m,c as d,o as p,b as u,a as v,t as y,i as j,d as f,h,E as w,_ as $}from"./vO8z_6wc.js";import{_ as g}from"./B6kpiin_.js";import{E as k}from"./pBde3eXe.js";import"./OZUBBuO3.js";import"./duVALuQ5.js";import"./YLitFIRx.js";import{Q as _}from"./CrMBAJkk.js";import{w as b,z as S}from"./ChzKcsu9.js";import{e as C,f as I,d as x}from"./B2EP4DEK.js";import{s as z}from"./DSXY0Md2.js";import"./DEtxbcwL.js";import"./DRy-t1KR.js";import"./Ctuj9lAE.js";import"./BG07ctRk.js";import"./y2YKyhRU.js";import"./CKVP4sCQ.js";import"./DqoL2U0I.js";import"./CdIa5lAL.js";import"./BwRzfsZt.js";import"./B0jPhJeY.js";import"./D_Dr4eZ1.js";import"./C8tVKSc2.js";const B={class:"wechat-com"},U={class:"wechat container"},V={class:"message"},q={class:"message"},E={class:"payment"},L={key:0,class:"title"},M={key:1,class:"title"},O={class:"image-div"},P={class:"left-image"},W={key:0,class:"ewm"},D={key:1,class:"ewm-empty"},G={class:"pw-box-ft"},J={key:0},Q={key:1},R={key:2},T={class:"right-image"},Y={key:0,class:"image"},Z={key:1,class:"image"},A=$(e({__name:"yabanpay",setup(e){const $=o(),A=r($.query.id),F=r($.query.type),H=r(!0);r({});const K=r(""),N=r({orderSn:"",amount:0}),{t:X}=i();(async()=>{try{const a=await I({orderId:A.value});N.value=a.order}catch(a){c.error(a.message),n("/member/account/detail")}})();const aa=r(0);let sa=null;l((()=>{(async()=>{H.value=!0;try{const a=await x({id:A.value,type:"yabanpay_"+F.value});ea(null==a?void 0:a.payInfo.codeUrl)}catch(a){c.error(a.message)}finally{H.value=!1}})(),sa=z((()=>{ta(),aa.value++,50===aa.value&&(clearInterval(sa),c.error(X("支付已超时，您可以刷新页面重新支付")))}),2e3)}));const ta=()=>{C({id:A.value}).then((a=>{1==a.payStatus&&(clearInterval(sa),k.confirm(X("订单支付成功"),X("提示"),{confirmButtonText:X("查看订单"),showClose:!1,showCancelButton:!1,closeOnClickModal:!1,type:"success"}).then((()=>{n("/member/account/detail")})).catch((()=>{})))}))},ea=async a=>{const s=a;K.value=await _.toDataURL(s,{margin:1,width:500,height:500})},oa=()=>{window.close()},ra=()=>{window.location.reload()};return m((()=>{clearInterval(sa)})),(e,o)=>{const r=a,i=s,l=t,c=w,n=g;return p(),d("div",null,[u(r,{title:"YaBandPay"}),u(i,{showLogin:!1}),v("div",B,[v("div",U,[v("div",V,y(e.$t("订单提交成功，请尽快付款"))+"！"+y(e.$t("订单号"))+"："+y(j(N).orderSn),1),v("div",q,[f(y(e.$t("应付金额"))+"： ",1),u(l,{modelValue:j(N).amount,"onUpdate:modelValue":o[0]||(o[0]=a=>j(N).amount=a),fontStyle:{color:"var(--price)",fontSize:"18px"}},null,8,["modelValue"])]),v("div",E,["wechat"==j(F)?(p(),d("div",L,y(e.$t("微信支付")),1)):h("",!0),"alipay"==j(F)?(p(),d("div",M,y(e.$t("支付宝支付")),1)):h("",!0),v("div",O,[v("div",P,[v("div",null,[f(y(e.$t("如果二维码已过期"))+"，"+y(e.$t("请")),1),v("span",{onClick:ra,class:"font-color",style:{cursor:"pointer"}},y(e.$t("刷新")),1),f(y(e.$t("页面重新获取二维码"))+"。 ",1)]),j(aa)<=50?(p(),d("div",W,[u(c,{class:"image",src:j(K)},null,8,["src"])])):(p(),d("div",D,[f(y(e.$t("已超时"))+"，",1),v("a",{class:"font-color",onClick:ra},y(e.$t("点击刷新")),1)])),v("div",G,["wechat"==j(F)?(p(),d("div",J,y(e.$t("请使用微信扫一扫")),1)):h("",!0),"alipay"==j(F)?(p(),d("div",Q,y(e.$t("请使用支付宝扫一扫")),1)):h("",!0),"yunshanfu"==j(F)?(p(),d("div",R,y(e.$t("请使用云闪付扫一扫")),1)):h("",!0),v("div",null,y(e.$t("扫描二维码支付")),1)])]),v("div",T,["wechat"==j(F)?(p(),d("div",Y,[u(c,{src:j(b)},null,8,["src"])])):h("",!0),"alipay"==j(F)?(p(),d("div",Z,[u(c,{src:j(S)},null,8,["src"])])):h("",!0)])]),v("div",{onClick:oa,class:"button-title"},"< "+y(e.$t("选择其他支付方式")),1)])])]),u(n,{bg:"white",mt30:!1,type:1})])}}}),[["__scopeId","data-v-7b6a630d"]]);export{A as default};
