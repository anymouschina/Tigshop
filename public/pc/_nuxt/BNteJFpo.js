import{_ as de}from"./uNNarvbF.js";import{E as re}from"./XomGKeK5.js";import{_ as _e}from"./CzQrJ5jx.js";import{E as ue}from"./yqEFMWm8.js";import{_ as me}from"./CPg1UVcC.js";import{f as ve,r as y,Y as he,H as R,Z as fe,o as l,c as i,b as r,a as e,t as a,w as T,d as p,i as u,F as C,l as $,n as F,j as g,$ as pe,h as W,a0 as q,m as Y,a1 as ke,a2 as ye,z as H,x as P,p as ge,e as Ve,y as be,_ as Ce}from"./DvlzeZYf.js";import{_ as $e}from"./CljOOE4N.js";import{_ as we}from"./BCw_XNK7.js";import{v as Z,L as G}from"./C_PfpWcu.js";import xe from"./B0ec3DT7.js";import Ue from"./Bpo1lTp-.js";import Te from"./BQu-AzCg.js";import{g as Ee,r as J,c as Le,u as Fe,a as Be}from"./6IjmK16v.js";import"./DrjGOYyT.js";import"./B9SirqjL.js";import"./BxwJi-A4.js";import"./CvS5MqkS.js";import"./BB_Ol6Sd.js";import"./Cq9Fpw4b.js";import"./ctHFjQ9z.js";import"./DXZCNwre.js";import"./D5p5RYpQ.js";import"./DGzzo1G8.js";import"./DldgdBu3.js";import"./DCTLXrZ8.js";import"./De9iyrrl.js";import"./C3hftOhu.js";import"./CFi7q_x0.js";/* empty css        */import"./eXzid_I5.js";import"./D0iLGPIx.js";import"./CZXUHXp1.js";import"./s4PshrD2.js";const Oe={install(V){V.directive("loading",Z),V.config.globalProperties.$loading=G},directive:Z,service:G},x=V=>(ge("data-v-c87d5b4d"),V=V(),Ve(),V),Se={style:{"background-color":"#f2f3f5"}},je={key:0,class:"container"},De={class:"no_goods clearfix"},qe=x(()=>e("div",{class:"left icon"},null,-1)),He={class:"left main"},Pe={class:"strong"},Me={key:1,class:"container"},Ne={class:"cart-tit"},Ae={class:"cart-head"},ze={class:"product-list-cart flex"},Ie={class:"item col-1 center"},Re={class:"item col-1",style:{"justify-content":"left"}},We={class:"item col-3",style:{"justify-content":"left"}},Ye={class:"item col-2 center"},Ze={class:"item col-2 center"},Ge={class:"item col-2 center"},Je={class:"item col-2 center"},Ke={class:"cart_table"},Qe={class:"cart_store_title flex"},Xe={class:"item col-1 center"},et={class:"item col-3 flex align-center"},tt={key:0,class:"tag"},st={key:1,class:"tit"},ot={class:"cart_list_wrap"},at={class:"product-item flex"},lt={class:"item col-1 center flex align-center justify-center"},it={class:"item col-4 flex"},nt={class:"pic"},ct=["href"],dt=["src"],rt={key:1},_t=["src"],ut={key:2,class:"disabled"},mt={key:0},vt={class:"name pt5"},ht=["href"],ft={key:1},pt={class:"info"},kt={key:2,class:"extraskudata"},yt={class:"title"},gt=x(()=>e("div",{class:"line-box"},[e("div",{class:"line"})],-1)),Vt={class:"content"},bt={class:"content-text"},Ct={class:"num"},$t={key:3,class:"promotion-box"},wt={key:0,class:"promotion"},xt={class:"ticket-content"},Ut={key:1,class:"promotion"},Tt={class:"ticket-type"},Et=x(()=>e("span",{class:"ticket-line"},null,-1)),Lt={class:"ticket-content"},Ft={class:"item col-2 center"},Bt={class:"price pt5 center-price"},Ot={class:"item col-2 center"},St={class:"pt5 flex justify-center"},jt={class:"item col-2 center"},Dt={class:"money pt5"},qt={class:"item col-2 center"},Ht=["onClick"],Pt=x(()=>e("i",{class:"iconfont-pc icon-shanchu"},null,-1)),Mt=[Pt],Nt=x(()=>e("div",{class:"cart-line"},null,-1)),At={key:0,class:"gift-box"},zt={class:"gift-title"},It={class:"gift-content"},Rt={class:"gift-content-item"},Wt={class:"gift-item-left"},Yt={class:"gift-item-right"},Zt={class:"gift-item-name"},Gt={key:0,class:"sku-card"},Jt={class:"gift-item-num"},Kt={class:"pay_tools_inner flex justify-between align-center container"},Qt={class:"pay_tools_l flex align-center"},Xt={class:"item col-1 center"},es={class:"pay_txt_row flex"},ts=["innerHTML"],ss={class:"pay_tools_r flex align-center"},os={class:"pay_tools_total_box"},as={class:"flex align-center justify-end"},ls={class:"r_prod_view"},is={class:"font-color"},ns={class:"r_price_total"},cs={class:"tit"},ds={class:"discounts-btn-box"},rs={class:"discounts-btn"},_s={class:"discount"},us={class:"discount-title"},ms={class:"title-text"},vs={class:"discount-content"},hs={class:"discount-item-box"},fs={class:"item-label"},ps={class:"item-value"},ks={key:0,class:"discount-item-box"},ys={class:"item-label"},gs={class:"item-value"},Vs={class:"discount-item-box"},bs={class:"item-label"},Cs={class:"item-value discounts-value",style:{color:"var(--general)"}},$s={key:0,class:"sub-item-box"},ws={class:"sub-item-label"},xs={class:"sub-item-value discounts-value"},Us={key:1,class:"discount-detail"},Ts={class:"sub-item-label"},Es={class:"sub-item-value discounts-value"},Ls={class:"discount-item-box"},Fs={class:"item-label"},Bs={class:"item-value"},Os={class:"discount-desc"},Ss={key:3},js=x(()=>e("div",null,[e("div",{style:{height:"300px",width:"100%"}})],-1)),Ds=[js],qs=ve({__name:"index",setup(V){const E=y(!0),v=y([]),c=y({}),M=y(!1),N=y(),{t:h}=he();R(()=>{b()});const B=t=>t.product_status==0||t.stock==0||t.is_disabled==!0,b=async()=>{try{N.value=Oe.service({lock:!1,text:h("请求加载中"),customClass:"tig-normal-loading"});const t=await Ee();v.value=t.cart_list,c.value=t.total,console.log("total",c.value),S()}catch{}finally{E.value=!1,N.value.close(),M.value=!0}},O=async()=>{try{const t=[];v.value.forEach(_=>{_.carts.forEach(m=>{t.push({cart_id:m.cart_id,is_checked:m.is_checked&&m.is_disabled===!1?1:0})})});const s=await Fe({data:t});b()}catch{}finally{}},K=async t=>{try{const s=await Be(t.cart_id,{quantity:t.quantity});await b()}catch(s){Y.error(s.message),t.quantity=s.quantity}finally{}},Q=t=>{q.confirm({title:h("确认要删除该商品吗"),cancelText:h("取消"),okText:h("确定"),maskClosable:!0,centered:!0,onOk:async()=>{try{const s=await J([t]);b()}catch{}finally{}}})},X=()=>{let t=0;v.value.forEach(s=>{s.carts.forEach(_=>{_.is_checked==!0&&(t+=1)})}),t!=0?q.confirm({title:h("确认要删除指定的商品吗"),cancelText:h("取消"),okText:h("确定"),maskClosable:!0,centered:!0,onOk:async()=>{try{const s=[];v.value.forEach(m=>{m.carts.forEach(k=>{k.is_checked&&s.push(k.cart_id)})});const _=await J(s);await b()}catch{}finally{}}}):Y.error(h("您还未选中任何商品"))},ee=()=>{q.confirm({title:h("确认要清空购物车吗？"),cancelText:h("取消"),okText:h("确定"),maskClosable:!0,centered:!0,onOk:async()=>{try{const t=await Le();await b()}catch{}finally{}}})},te=()=>{O()},A=()=>{v.value.forEach(t=>{t.carts.forEach(s=>{s.is_checked=w.value==!0&&s.is_disabled===!1})}),S(),O()},se=t=>{t.carts.forEach(s=>{s.is_checked=t.is_checked==!0}),S(),O()},w=y(!1),S=()=>{v.value.forEach(t=>{const s=t.carts.filter(_=>!_.is_disabled);t.is_checked=s.every(_=>_.is_checked===!0&&!_.is_disabled)}),w.value=v.value.every(t=>t.is_checked===!0)},z=y(null),I=y(!1),j=()=>{const t=window.scrollY,s=window.innerHeight,_=z.value;if(_){const m=_.getBoundingClientRect().top+t;I.value=!(t+s-60>m)}},oe={1:"秒杀价",2:"券",3:"满减",4:"折扣",5:"满赠",6:"限时折扣"},ae=t=>{const s=[],_=t.filter(k=>k.type===2),m=t.filter(k=>k.type!==2);return m.length>0&&s.push(m[0]),_.length>0&&s.push(_[0]),s},D=y(!1);R(()=>{window.addEventListener("scroll",j),j()}),fe(()=>{window.removeEventListener("scroll",j)});const le=()=>{ke("/order/check/")};return(t,s)=>{const _=de,m=re,k=_e,L=ue,f=me,ie=be,ne=$e,ce=we;return l(),i("div",Se,[r(_,{title:"购物车"}),r(xe,{step:1}),!E.value&&v.value.length===0?(l(),i("div",je,[e("div",De,[qe,e("div",He,[e("div",Pe,a(t.$t("您的购物车中暂时没有商品"))+"！",1),r(k,{to:"/"},{default:T(()=>[r(m,{type:"primary",size:"large",title:t.$t("马上挑选商品")},{default:T(()=>[p(a(t.$t("去逛逛")),1)]),_:1},8,["title"])]),_:1})])])])):u("",!0),!E.value&&v.value.length>0?(l(),i("div",Me,[e("p",Ne,a(t.$t("你好，欢迎来到您的购物车")),1),e("div",null,[e("div",Ae,[e("div",ze,[e("div",Ie,[r(L,{modelValue:w.value,"onUpdate:modelValue":s[0]||(s[0]=n=>w.value=n),onChange:A},null,8,["modelValue"])]),e("div",Re,a(t.$t("全选")),1),e("div",We,a(t.$t("商品信息")),1),e("div",Ye,a(t.$t("单价")),1),e("div",Ze,a(t.$t("数量")),1),e("div",Ge,a(t.$t("小计")),1),e("div",Je,a(t.$t("操作")),1)])]),v.value?(l(!0),i(C,{key:0},$(v.value,(n,Hs)=>(l(),i("div",Ke,[e("div",Qe,[e("div",Xe,[r(L,{modelValue:n.is_checked,"onUpdate:modelValue":o=>n.is_checked=o,onChange:o=>se(n)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),e("div",et,[n.shop_id==0?(l(),i("div",tt,a(t.$t("自营")),1)):g(ye)()?(l(),i("div",st,a(n.shop_title),1)):u("",!0)])]),e("div",ot,[(l(!0),i(C,null,$(n.carts,o=>(l(),i("div",{class:F(["product-list-cart",B(o)?"disabled-item":""])},[e("div",at,[e("div",lt,[r(L,{modelValue:o.is_checked,"onUpdate:modelValue":d=>o.is_checked=d,onChange:s[1]||(s[1]=d=>te()),disabled:B(o)},null,8,["modelValue","onUpdate:modelValue","disabled"])]),e("div",it,[e("div",nt,[o.stock!=0&&o.product_status!=0?(l(),i("a",{key:0,target:"_blank",href:g(H)({path:"product",id:o.product_id,sn:o.product_sn})},[e("img",{src:("imageFormat"in t?t.imageFormat:g(P))(o.pic_thumb),alt:""},null,8,dt)],8,ct)):(l(),i("div",rt,[e("img",{src:("imageFormat"in t?t.imageFormat:g(P))(o.pic_thumb),alt:""},null,8,_t)])),(o.stock==0||o.product_status==0)&&o.is_disabled==!0?(l(),i("div",ut,[o.stock==0||o.product_status==0?(l(),i("div",mt,a(o.product_status==0?t.$t("已下架"):t.$t("已售罄")),1)):u("",!0)])):u("",!0)]),e("div",vt,[o.stock!=0&&o.product_status!=0?(l(),i("a",{key:0,target:"_blank",href:g(H)({path:"product",id:o.product_id,sn:o.product_sn})},a(o.product_name),9,ht)):(l(),i("p",ft,a(o.product_name),1)),e("div",pt,[(l(!0),i(C,null,$(o.sku_data,(d,U)=>(l(),i("span",null,a(U!==0?" , ":"")+a(d.name)+":"+a(d.value),1))),256))]),o.extra_sku_data&&o.extra_sku_data.length?(l(),i("div",kt,[(l(!0),i(C,null,$(o.extra_sku_data,d=>(l(),i("div",{key:d,class:"extraskudata-item"},[e("div",yt,a(d.attr_name),1),gt,e("div",Vt,[e("span",bt,a(d.attr_value),1),r(f,{modelValue:d.attr_price,"onUpdate:modelValue":U=>d.attr_price=U,showText:!1},null,8,["modelValue","onUpdate:modelValue"]),e("span",Ct,"x"+a(o.quantity),1)])]))),128))])):u("",!0),o.activity_info?(l(),i("div",$t,[(l(!0),i(C,null,$(ae(o.activity_info),d=>(l(),i("div",{class:"promotion-box-item",key:d.promotion_id},[d.type!=2?(l(),i("div",wt,[e("div",xt,a(t.$t(oe[d.type])),1)])):u("",!0),d.type==2?(l(),i("div",Ut,[e("div",Tt,[p(a(t.$t("券")),1),Et]),e("div",Lt,a(d.data.promotion_desc),1)])):u("",!0)]))),128))])):u("",!0)])]),e("div",Ft,[e("div",Bt,[r(f,{modelValue:o.price,"onUpdate:modelValue":d=>o.price=d,showText:!1},null,8,["modelValue","onUpdate:modelValue"])])]),e("div",Ot,[e("div",St,[r(Ue,{modelValue:o.quantity,"onUpdate:modelValue":d=>o.quantity=d,onChange:d=>K(o),disabled:B(o)},null,8,["modelValue","onUpdate:modelValue","onChange","disabled"])])]),e("div",jt,[e("div",Dt,[r(f,{modelValue:o.subtotal,"onUpdate:modelValue":d=>o.subtotal=d,showText:!1},null,8,["modelValue","onUpdate:modelValue"])])]),e("div",qt,[e("div",null,[e("a",{onClick:d=>Q(o.cart_id),style:{cursor:"pointer"}},Mt,8,Ht)])])]),Nt],2))),256))]),n.gift.length>0?(l(),i("div",At,[e("div",zt,a(t.$t("赠品")),1),e("div",It,[(l(!0),i(C,null,$(n.gift,o=>(l(),W(k,{key:o.gift_id,target:"_blank",to:g(H)({path:"product",id:o.product_id,sn:o.product_sn})},{default:T(()=>[e("div",Rt,[e("div",Wt,[r(ie,{class:"gift-img",lazy:"",src:("imageFormat"in t?t.imageFormat:g(P))(o.pic_thumb)},null,8,["src"])]),e("div",Yt,[e("div",Zt,a(o.product_name),1),o.sku_data.length>0?(l(),i("div",Gt,[(l(!0),i(C,null,$(o.sku_data,(d,U)=>(l(),i("div",{key:U,class:"sku-item"},a(d.value),1))),128))])):u("",!0),e("div",Jt,"x"+a(o.num),1)])])]),_:2},1032,["to"]))),128))])])):u("",!0)]))),256)):u("",!0),e("div",{class:"checkOutBar",id:"price-total",ref_key:"checkOutBarRef",ref:z},[e("div",{class:F({pay_tools_bar:!0,tools_bar_bottom:I.value})},[e("div",Kt,[e("div",Qt,[e("div",Xt,[r(L,{modelValue:w.value,"onUpdate:modelValue":s[2]||(s[2]=n=>w.value=n),onChange:A},null,8,["modelValue"])]),e("div",es,[p(a(t.$t("全选"))+" ",1),e("div",null,[e("span",{innerHTML:g(pe)()?t.$t("共<span class='font-color'>{0}</span>件",[c.value.total_count]):`共<span class='font-color'>${c.value.total_count}</span>件`},null,8,ts)]),e("div",null,[e("a",{onClick:X},a(t.$t("删除勾选商品")),1)]),e("div",null,[e("a",{onClick:ee},a(t.$t("清空购物车")),1)])])]),e("div",ss,[e("div",os,[e("div",as,[e("p",ls,[p(a(t.$t("已选商品"))+" ",1),e("span",is,a(c.value.checked_count),1),p(" "+a(t.$t("件")),1)]),e("div",ns,[e("span",cs,a(t.$t("合计"))+"：",1),r(f,{modelValue:c.value.discount_after,"onUpdate:modelValue":s[3]||(s[3]=n=>c.value.discount_after=n),showText:!1},null,8,["modelValue"])])]),e("div",ds,[e("div",null,[p(a(t.$t("共优惠"))+"：",1),r(f,{modelValue:c.value.discounts,"onUpdate:modelValue":s[4]||(s[4]=n=>c.value.discounts=n),showText:!1},null,8,["modelValue"])]),r(ne,{modelValue:D.value,"onUpdate:modelValue":s[11]||(s[11]=n=>D.value=n)},{reference:T(()=>[e("div",rs,[p(a(t.$t("优惠明细"))+" ",1),e("span",{class:F(["iconfont-pc icon-shangjiantou",{"icon-active":D.value}])},null,2)])]),default:T(()=>[e("div",_s,[e("div",us,[e("div",ms,a(t.$t("优惠明细")),1)]),e("div",vs,[e("div",hs,[e("div",fs,a(t.$t("商品总额")),1),e("div",ps,[r(f,{showText:!1,modelValue:c.value.product_amount,"onUpdate:modelValue":s[5]||(s[5]=n=>c.value.product_amount=n),fontStyle:{fontWeight:"bold"}},null,8,["modelValue"])])]),c.value.service_fee&&c.value.service_fee>0?(l(),i("div",ks,[e("div",ys,a(t.$t("附加费用")),1),e("div",gs,[r(f,{modelValue:c.value.service_fee,"onUpdate:modelValue":s[6]||(s[6]=n=>c.value.service_fee=n),fontStyle:{fontWeight:"bold"},showText:!1},null,8,["modelValue"])])])):u("",!0),e("div",Vs,[e("div",bs,a(t.$t("共优惠")),1),e("div",Cs,[p(" - "),r(f,{modelValue:c.value.discounts,"onUpdate:modelValue":s[7]||(s[7]=n=>c.value.discounts=n),showText:!1},null,8,["modelValue"])]),c.value.discount_discount_amount>0?(l(),i("div",$s,[e("div",ws,a(t.$t("其他优惠")),1),e("div",xs,[p(" - "),r(f,{modelValue:c.value.discount_discount_amount,"onUpdate:modelValue":s[8]||(s[8]=n=>c.value.discount_discount_amount=n),showText:!1},null,8,["modelValue"])])])):u("",!0)]),c.value.discount_coupon_amount>0?(l(),i("div",Us,[e("div",Ts,a(t.$t("优惠券")),1),e("div",Es,[p(" - "),r(f,{modelValue:c.value.discount_coupon_amount,"onUpdate:modelValue":s[9]||(s[9]=n=>c.value.discount_coupon_amount=n),showText:!1},null,8,["modelValue"])])])):u("",!0),e("div",Ls,[e("div",Fs,a(t.$t("合计")),1),e("div",Bs,[r(f,{modelValue:c.value.discount_after,"onUpdate:modelValue":s[10]||(s[10]=n=>c.value.discount_after=n),fontStyle:{fontWeight:"bold"},showText:!1},null,8,["modelValue"])])]),e("div",Os,a(t.$t("以上优惠不包含运费，实际优惠金额请以确认订单页为准")),1)])])]),_:1},8,["modelValue"])])]),e("div",{onClick:s[12]||(s[12]=n=>c.value.checked_count&&le()),class:F("checkout_btn hand-pointer "+(c.value.checked_count==0?"disabled":""))},a(t.$t("去结算")),3)])])],2)],512)])])):u("",!0),M.value?(l(),W(Te,{key:2,onOnBuy:b})):u("",!0),E.value?(l(),i("div",Ss,Ds)):u("",!0),r(ce)])}}}),yo=Ce(qs,[["__scopeId","data-v-c87d5b4d"]]);export{yo as default};
