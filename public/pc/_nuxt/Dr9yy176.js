import{_ as oe}from"./BYDV-pPC.js";import{_ as ne}from"./CItVExi3.js";import{T as ie}from"./DrjGOYyT.js";import{f as H,a3 as D,a7 as ue,r as y,Y as de,a4 as G,v as j,g as ce,o as i,c as u,b as O,w as Y,d as P,t as l,a as t,i as f,j as r,n as g,F as N,l as R,x as ve,a5 as z,a6 as A,m as pe,p as me,e as fe,_ as ge,a9 as ye,s as _e,ar as ke,a2 as be,h as he,au as U,a1 as Ce}from"./DvlzeZYf.js";import{u as $e,g as Pe,C as Se}from"./BIoZzMix.js";import{_ as we}from"./BCw_XNK7.js";import qe from"./CbHnBtIW.js";const T=h=>(me("data-v-4285dbbe"),h=h(),fe(),h),Ie={class:"filter__box"},Fe={class:"sear-title"},xe={key:0},Me={class:"st-ext"},Oe={class:"filter"},Ne={key:0,class:"list"},Te={class:"attr-name"},Be={class:"attr-box"},Ue=["onClick"],je=T(()=>t("i",{class:"iconfont-pc icon-xiajiantou"},null,-1)),Ve={key:1,class:"list brand_fitlter"},Le={class:"attr-name"},Re={class:"attr-box"},Ee={key:0,class:"category-brand-f-letter"},De=["onClick"],Ge=["onClick"],ze={class:"pic_box"},Ae=["src"],He={class:"brand_name"},Ye=T(()=>t("i",null,null,-1)),Je=T(()=>t("i",{class:"iconfont-pc icon-xiajiantou"},null,-1)),Ke=T(()=>t("i",null,"＋",-1)),Qe={class:"attr-multiple-text"},We={key:0,class:"fc-btn-box"},Xe={class:"cat-sort-warp"},Ze={class:"cat-sort"},et={class:"flex"},tt={class:"lefter"},at=["title"],st=["title"],lt=["title"],rt=["title"],ot={key:0,class:"iconfont-pc icon-xiajiantou1"},nt={key:1,class:"iconfont-pc icon-shangjiantou1"},it={class:"priceform"},ut={class:"form-bg"},dt=T(()=>t("em",null," - ",-1)),ct={class:"righter"},vt={class:"productsNO"},pt={class:"pageInfo"},mt={class:"page_number"},ft=H({__name:"Filter",props:D({isSearchPage:{type:Boolean,default:!1},total:{type:Number,default:0},queryParams:{type:Object,default:{}},pageType:{type:String,default:"search"}},{filter:{},filterModifiers:{},filterSeleted:{},filterSeletedModifiers:{}}),emits:D(["change"],["update:filter","update:filterSeleted"]),setup(h,{emit:V}){const d=$e(),e=ue(),_=y("");y(),y();const{t:m}=de(),C=h,$=V,a=G(h,"filter"),v=G(h,"filterSeleted"),n=y({category:"",brand:""}),b=y({brand:[],category:[]}),S=y(!1),I=y(a.value.minPrice),w=y(a.value.maxPrice),L=async(s="")=>{try{const o=await Pe({...C.queryParams,page_type:C.pageType});b.value.brand=o.filter.brand,b.value.category=o.filter.category,n.value=o.filter_selected,_.value="",n.value.category&&(_.value+=n.value.category+" - "),a.value.keyword&&(_.value+=a.value.keyword+" -  "),n.value.brand&&(_.value+=n.value.brand+" -  "),_.value+=m("商品搜索")+e.pageTitle,v.value=o.filter_selected}catch{}finally{}},p=j(()=>d.total?Math.floor(Number(d.total)/25)+(C.total%25==0,1):1);ce(()=>a.value,()=>{L()},{deep:!0,immediate:!0});const J=s=>{a.value.categoryId=s,a.value.page=1,$("change")},K=j(()=>x.value?b.value.brand.filter(s=>s.first_word===x.value):b.value.brand),k=y(!1),F=y(!1),Q=j(()=>{const s=[...new Set(b.value.brand.map(o=>o.first_word))];return s.sort(),s}),q=y([]),W=s=>{if(F.value===!0){const o=q.value.indexOf(s);o>-1?q.value.splice(o,1):q.value.push(s)}else a.value.brandIds=[s],a.value.page=1,$("change")},X=s=>q.value.indexOf(s)>-1,Z=()=>{k.value=!1,F.value=!1,q.value=a.value.brandIds},ee=()=>{a.value.brandIds=q.value,a.value.page=1,k.value=!1,F.value=!1,$("change")},x=y(""),te=s=>{x.value=s},B=s=>{s===""?(a.value.sortField="",a.value.sortOrder=""):s==="sale"?(a.value.sortField="sale",a.value.sortOrder=""):s==="time"?(a.value.sortField="time",a.value.sortOrder=""):s==="price"&&(a.value.sortField="price",a.value.sortOrder=a.value.sortOrder==="asc"?"desc":"asc"),a.value.page=1,$("change")},ae=()=>{a.value.page>1&&(a.value.page--,$("change",a.value.page))},se=()=>{a.value.page<p.value&&(a.value.page++,$("change",a.value.page))},le=()=>{if(I.value>w.value||w.value===0)return pe.error(m("请输入正确的价格范围"));a.value.minPrice=I.value??0,a.value.maxPrice=w.value??0,$("change")};return(s,o)=>{const re=ie;return i(),u(N,null,[O(re,null,{default:Y(()=>[P(l(_.value),1)]),_:1}),t("div",Ie,[t("div",Fe,[t("h3",null,[n.value&&n.value.category?(i(),u("b",xe,l(n.value.category),1)):f("",!0),t("em",null,l(s.$t("商品筛选")),1)]),t("div",Me,[P(l(s.$t("共"))+" ",1),t("span",null,l(r(d).total),1),P(" "+l(s.$t("个商品")),1)])]),t("div",Oe,[b.value.category.length>0?(i(),u("div",Ne,[t("div",Te,l(s.$t("分类：")),1),t("div",Be,[t("div",{class:g(["category-link",{"category-link-more":S.value}])},[(i(!0),u(N,null,R(b.value.category,(c,M)=>(i(),u("div",{class:"item",key:M,onClick:E=>J(c.category_id)},l(c.category_name),9,Ue))),128))],2),b.value.category.length>10?(i(),u("span",{key:0,class:g(["attrMore",{attrMoreUp:S.value}]),onClick:o[0]||(o[0]=c=>S.value=!S.value)},[P(l(S.value?s.$t("收起"):s.$t("更多")),1),je],2)):f("",!0)])])):f("",!0),b.value.brand.length>0&&a.value.brandIds.length===0?(i(),u("div",Ve,[t("div",Le,l(s.$t("品牌：")),1),t("div",Re,[k.value?(i(),u("div",Ee,[t("div",{class:g(["leter",{cur:x.value===""}]),"data-word":"all",onClick:o[1]||(o[1]=c=>x.value="")},l(s.$t("所有品牌")),3),(i(!0),u(N,null,R(r(Q),(c,M)=>(i(),u("div",{class:g(["leter",{cur:x.value==c}]),key:M,onClick:E=>te(c)},l(c),11,De))),128))])):f("",!0),t("div",{class:g({"category-brand-wrap":!k.value,"category-brand-f-wrap":k.value})},[(i(!0),u(N,null,R(r(K),(c,M)=>(i(),u(N,{key:M},[k.value||!k.value&&M<8?(i(),u("div",{key:0,class:g(["item",{selected:X(c.brand_id)}]),onClick:E=>W(c.brand_id)},[t("span",ze,[t("img",{src:r(ve)(c.brand_logo)},null,8,Ae)]),t("span",He,l(c.brand_name),1),Ye],10,Ge)):f("",!0)],64))),128))],2),t("span",{class:g(["attrMore",{attrMoreUp:k.value}]),onClick:o[2]||(o[2]=c=>k.value=!k.value)},[P(l(k.value?s.$t("收起"):s.$t("更多")),1),Je],2),F.value?f("",!0):(i(),u("div",{key:1,class:"attr-multiple",onClick:o[3]||(o[3]=c=>{F.value=!0,k.value=!0})},[Ke,t("div",Qe,l(s.$t("多选")),1)]))]),k.value&&F.value?(i(),u("div",We,[t("a",{class:g(["fc-btn-ok",{"fc-disable":q.value.length===0}]),onClick:ee},l(s.$t("确定")),3),t("a",{class:"fc-btn-cancel",onClick:Z},l(s.$t("取消")),1)])):f("",!0)])):f("",!0)]),t("div",Xe,[t("div",Ze,[t("div",et,[t("div",tt,[t("span",{class:g(["sort-link",{cur_sort:a.value.sortField==""}]),title:r(m)("默认排序（根据相关性排序）"),onClick:o[4]||(o[4]=c=>B(""))},l(s.$t("默认排序")),11,at),t("span",{class:g(["sort-link",{cur_sort:a.value.sortField=="sale"}]),title:r(m)("销量（销量从高到低）"),onClick:o[5]||(o[5]=c=>B("sale"))},l(s.$t("销量")),11,st),t("span",{class:g(["sort-link",{cur_sort:a.value.sortField=="time"}]),title:r(m)("上架时间（最新发布排序）"),onClick:o[6]||(o[6]=c=>B("time"))},l(s.$t("新品")),11,lt),t("span",{class:g(["sort-link",{cur_sort:a.value.sortField=="price"}]),title:a.value.sortOrder=="desc"?r(m)("价格（价格从高到低）"):r(m)("价格（价格从低到高）"),onClick:o[7]||(o[7]=c=>B("price"))},[P(l(s.$t("价格"))+" ",1),a.value.sortOrder=="desc"?(i(),u("span",ot)):(i(),u("span",nt))],10,rt)]),t("div",it,[t("div",ut,[z(t("input",{type:"text",name:"pricemin","onUpdate:modelValue":o[8]||(o[8]=c=>I.value=c)},null,512),[[A,I.value]]),dt,z(t("input",{type:"text",name:"pricemax","onUpdate:modelValue":o[9]||(o[9]=c=>w.value=c)},null,512),[[A,w.value]]),t("a",{class:"btn-default",onClick:le,rel:"nofollow",href:"javascript:;"},l(s.$t("确定")),1)])])]),t("div",ct,[t("div",vt,[t("div",null,[P(l(s.$t("共")),1),t("em",null,l(r(d).total),1),P(l(s.$t("个商品")),1)])]),t("div",pt,[t("span",mt,l(a.value.page)+"/"+l(r(p)),1),t("span",{onClick:ae,class:g(["noPage",{disabled:a.value.page==1}])},"<",2),t("span",{onClick:se,class:g(["noPage",{disabled:a.value.page===r(p)}])},">",2)])])])])])],64)}}}),gt=ge(ft,[["__scopeId","data-v-4285dbbe"]]),yt={style:{"background-color":"#fff"}},_t={class:"container"},kt={key:0,class:"nav-selected"},bt={key:1,class:"nav-selected"},ht={key:2,class:"nav-selected"},Ft=H({__name:"search",props:{pageType:{type:String,default:"search"}},setup(h){const V=h,d=ye(),e=_e({page:1,categoryId:0,brandIds:[],sortField:"",sortOrder:"",maxPrice:0,minPrice:0,couponId:0,keyword:""});ke(()=>{e.page=d.query.page?Number(d.query.page):1,e.categoryId=d.query.cat?Number(d.query.cat):0,e.brandIds=d.query.brand?String(d.query.brand).split(",").map(Number):[],e.sortField=d.query.sort?String(d.query.sort):"",e.sortOrder=d.query.order?String(d.query.order):"",e.maxPrice=d.query.max?Number(d.query.max):0,e.minPrice=d.query.min?Number(d.query.min):0,e.keyword=d.query.keyword?String(d.query.keyword):"",e.couponId=d.query.coupon_id?Number(d.query.coupon_id):0});const _=y(),m=j(()=>{let v={};return e.page>1&&(v.page=e.page),e.categoryId>0&&(v.cat=e.categoryId),e.couponId>0&&(v.coupon_id=e.couponId),e.brandIds.length>0&&(v.brand=e.brandIds.join(",")),e.sortField!=""&&["sale","price","time"].includes(e.sortField)&&(v.sort=e.sortField),e.sortOrder!=""&&["desc","asc"].includes(e.sortOrder)&&(v.order=e.sortOrder),e.maxPrice>0&&(v.max=e.maxPrice),e.minPrice>0&&(v.min=e.minPrice),e.keyword!=""&&(v.keyword=e.keyword),v}),C=(v=1)=>{e.page=v,Ce({path:"/"+V.pageType+"/",query:m.value})},$=y(null),a=()=>{const v=$.value;v&&v.scrollIntoView()};return(v,n)=>{const b=oe,S=ne,I=gt,w=Se,L=we;return i(),u("div",yt,[O(b),t("div",_t,[r(be)()&&r(e).keyword?(i(),he(qe,{key:0,keyword:r(e).keyword},null,8,["keyword"])):f("",!0),O(S,{id:r(e).categoryId,"onUpdate:id":n[3]||(n[3]=p=>r(e).categoryId=p),isSearchPage:"",onChange:C},{default:Y(()=>[_.value?(i(),u("div",kt,[r(e).brandIds.length>0&&_.value.brand?(i(),u("div",{key:0,class:"item",onClick:n[0]||(n[0]=p=>{r(e).brandIds=[],C()})},[t("span",null,l(v.$t("品牌"))+"：",1),t("span",null,l(_.value.brand),1)])):f("",!0)])):f("",!0),_.value?(i(),u("div",bt,[r(e).minPrice>0||r(e).maxPrice>0?(i(),u("div",{key:0,class:"item",onClick:n[1]||(n[1]=p=>{r(e).maxPrice=0,r(e).minPrice=0,C()})},[t("span",null,l(v.$t("价格"))+"：",1),t("span",null,l(r(e).minPrice??0)+" "+l(r(e).maxPrice>0?" - "+r(e).maxPrice:v.$t("以上")),1)])):f("",!0)])):f("",!0),r(e).keyword?(i(),u("div",ht,[r(e).keyword?(i(),u("div",{key:0,class:"item",onClick:n[2]||(n[2]=p=>{r(e).keyword="",C()})},[t("span",null,l(v.$t("搜索"))+"：",1),t("span",null,'"'+l(r(e).keyword)+'"',1)])):f("",!0)])):f("",!0)]),_:1},8,["id"]),t("div",{ref_key:"FilterRef",ref:$},[O(I,{filter:r(e),"onUpdate:filter":n[4]||(n[4]=p=>U(e)?e.value=p:null),filterSeleted:_.value,"onUpdate:filterSeleted":n[5]||(n[5]=p=>_.value=p),queryParams:r(m),"onUpdate:queryParams":n[6]||(n[6]=p=>U(m)?m.value=p:null),pageType:h.pageType,isSearchPage:"",onChange:C},null,8,["filter","filterSeleted","queryParams","pageType"])],512),O(w,{queryParams:r(m),"onUpdate:queryParams":n[7]||(n[7]=p=>U(m)?m.value=p:null),filter:r(e),"onUpdate:filter":n[8]||(n[8]=p=>U(e)?e.value=p:null),onChange:C,onPageChange:a},null,8,["queryParams","filter"])]),O(L)])}}});export{Ft as _};
