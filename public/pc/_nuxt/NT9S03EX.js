import{b as e}from"./Bx_3tXOW.js";import{_ as a}from"./DIcT5qlW.js";import{_ as l}from"./B7gutg7-.js";import{T as r}from"./DEtxbcwL.js";import{e as t,cb as s,f as i,r as o,z as n,cc as u,s as c,Q as d,c as v,o as p,F as m,b as y,a as g,w as f,d as k,t as b,h as j,i as h,v as x,l as P,j as I,aa as w,ak as _,n as q,_ as C,G as $,g as S,H as O,m as F,ah as N,ar as U,ae as M}from"./vO8z_6wc.js";import{u as T,g as V,C as B}from"./EjWZwU6o.js";import{_ as W}from"./B6kpiin_.js";import G from"./B84Eo88l.js";import"./B3kMr2Om.js";import"./DRy-t1KR.js";import"./4BWvF7DS.js";import"./Ctuj9lAE.js";import"./BG07ctRk.js";import"./ExFuuhw5.js";import"./OZUBBuO3.js";import"./DqoL2U0I.js";import"./CdIa5lAL.js";import"./CKVP4sCQ.js";import"./6_reTNGa.js";import"./BwRzfsZt.js";import"./D_Dr4eZ1.js";import"./123WnbAt.js";import"./C_yTnQv7.js";import"./DgmxjSXK.js";import"./VsleDggW.js";import"./B0jPhJeY.js";import"./C0xcqOw0.js";/* empty css        */import"./pBde3eXe.js";import"./duVALuQ5.js";import"./YLitFIRx.js";import"./C8tVKSc2.js";import"./w_nOPjer.js";import"./BPYtos7D.js";import"./DGiXcmvN.js";import"./CiHX20FE.js";import"./y2YKyhRU.js";import"./hhFhr_YO.js";const Q={class:"filter__box"},R={class:"sear-title"},z={key:0},H={class:"st-ext"},J={class:"filter"},K={key:0,class:"list"},L={class:"attr-name"},X={class:"attr-box"},Y=["onClick"],Z={key:1,class:"list brand_fitlter"},A={class:"attr-name"},D={class:"attr-box"},E={key:0,class:"category-brand-f-letter"},ee=["onClick"],ae=["onClick"],le={class:"pic_box"},re=["src"],te={class:"brand_name"},se={class:"attr-multiple-text"},ie={key:0,class:"fc-btn-box"},oe={class:"cat-sort-warp"},ne={class:"cat-sort"},ue={class:"flex"},ce={class:"lefter"},de=["title"],ve=["title"],pe=["title"],me=["title"],ye={key:0,class:"iconfont-pc icon-xiajiantou1"},ge={key:1,class:"iconfont-pc icon-shangjiantou1"},fe={class:"priceform"},ke={class:"form-bg"},be={class:"righter"},je={class:"productsNO"},he={class:"pageInfo"},xe={class:"page_number"},Pe=C(t({__name:"Filter",props:s({isSearchPage:{type:Boolean,default:!1},total:{type:Number,default:0},queryParams:{type:Object,default:{}},pageType:{type:String,default:"search"}},{filter:{},filterModifiers:{},filterSeleted:{},filterSeletedModifiers:{}}),emits:s(["change"],["update:filter","update:filterSeleted"]),setup(e,{expose:a,emit:l}){const t=T(),s=i(),C=o("");o(),o();const{t:$}=n(),S=e,O=l,F=u(e,"filter"),N=u(e,"filterSeleted"),U=o({category:"",brand:""}),M=o({brand:[],category:[]}),B=o(!1),W=o(F.value.minPrice),G=o(F.value.maxPrice),Pe=c((()=>t.total?Math.ceil(Number(t.total)/25):1));d((()=>F.value),(()=>{(async()=>{try{const e=await V({...S.queryParams,page_type:S.pageType});M.value.brand=e.filter.brand,M.value.category=e.filter.category,U.value=e.filterSelected,C.value="",U.value.category&&(C.value+=U.value.category+" - "),F.value.keyword&&(C.value+=F.value.keyword+" -  "),U.value.brand&&(C.value+=U.value.brand+" -  "),C.value+=$("商品搜索")+s.pageTitle,N.value=e.filterSelected}catch(e){}})()}),{deep:!0,immediate:!0});const Ie=c((()=>Oe.value?M.value.brand.filter((e=>e.firstWord===Oe.value)):M.value.brand)),we=o(!1),_e=o(!1),qe=c((()=>{const e=[...new Set(M.value.brand.map((e=>e.firstWord)))];return e.sort(),e})),Ce=o([]),$e=()=>{we.value=!1,_e.value=!1,Ce.value=F.value.brandIds},Se=()=>{F.value.brandIds=Ce.value,F.value.page=1,we.value=!1,_e.value=!1,O("change")},Oe=o(""),Fe=e=>{""===e?(F.value.sortField="",F.value.sortOrder=""):"sale"===e?(F.value.sortField="sale",F.value.sortOrder=""):"time"===e?(F.value.sortField="time",F.value.sortOrder=""):"price"===e&&(F.value.sortField="price",F.value.sortOrder="asc"===F.value.sortOrder?"desc":"asc"),F.value.page=1,O("change")},Ne=()=>{F.value.page>1&&(F.value.page--,O("change",F.value.page))},Ue=()=>{F.value.page<Pe.value&&(F.value.page++,O("change",F.value.page))},Me=()=>{if(W.value>G.value||0===G.value)return q.error($("请输入正确的价格范围"));F.value.minPrice=W.value??0,F.value.maxPrice=G.value??0,O("change")};return a({clearMultipleBrandIds:()=>{Ce.value.length=0}}),(e,a)=>{const l=r;return p(),v(m,null,[y(l,null,{default:f((()=>[k(b(C.value),1)])),_:1}),g("div",Q,[g("div",R,[g("h3",null,[U.value&&U.value.category?(p(),v("b",z,b(U.value.category),1)):j("",!0),g("em",null,b(e.$t("商品筛选")),1)]),g("div",H,[k(b(e.$t("共"))+" ",1),g("span",null,b(h(t).total),1),k(" "+b(e.$t("个商品")),1)])]),g("div",J,[M.value.category.length>0?(p(),v("div",K,[g("div",L,b(e.$t("分类：")),1),g("div",X,[g("div",{class:x(["category-link",{"category-link-more":B.value}])},[(p(!0),v(m,null,P(M.value.category,((e,a)=>(p(),v("div",{class:"item",key:a,onClick:a=>{return l=e.categoryId,F.value.categoryId=l,F.value.page=1,void O("change");var l}},b(e.categoryName),9,Y)))),128))],2),M.value.category.length>10?(p(),v("span",{key:0,class:x(["attrMore",{attrMoreUp:B.value}]),onClick:a[0]||(a[0]=e=>B.value=!B.value)},[k(b(B.value?e.$t("收起"):e.$t("更多")),1),a[10]||(a[10]=g("i",{class:"iconfont-pc icon-xiajiantou"},null,-1))],2)):j("",!0)])])):j("",!0),M.value.brand.length>0&&0===F.value.brandIds.length?(p(),v("div",Z,[g("div",A,b(e.$t("品牌：")),1),g("div",D,[we.value?(p(),v("div",E,[g("div",{class:x(["leter",{cur:""===Oe.value}]),"data-word":"all",onClick:a[1]||(a[1]=e=>Oe.value="")},b(e.$t("所有品牌")),3),(p(!0),v(m,null,P(h(qe),((e,a)=>(p(),v("div",{class:x(["leter",{cur:Oe.value==e}]),key:a,onClick:a=>{return l=e,void(Oe.value=l);var l}},b(e),11,ee)))),128))])):j("",!0),g("div",{class:x({"category-brand-wrap":!we.value,"category-brand-f-wrap":we.value})},[(p(!0),v(m,null,P(h(Ie),((e,l)=>{return p(),v(m,{key:l},[we.value||!we.value&&l<8?(p(),v("div",{key:0,class:x(["item",{selected:(r=e.brandId,Ce.value.indexOf(r)>-1)}]),onClick:a=>(e=>{if(!0===_e.value){const a=Ce.value.indexOf(e);a>-1?Ce.value.splice(a,1):Ce.value.push(e)}else F.value.brandIds=[e],F.value.page=1,O("change")})(e.brandId)},[g("span",le,[g("img",{src:h(I)(e.brandLogo)},null,8,re)]),g("span",te,b(e.brandName),1),a[11]||(a[11]=g("i",null,null,-1))],10,ae)):j("",!0)],64);var r})),128))],2),g("span",{class:x(["attrMore",{attrMoreUp:we.value}]),onClick:a[2]||(a[2]=e=>we.value=!we.value)},[k(b(we.value?e.$t("收起"):e.$t("更多")),1),a[12]||(a[12]=g("i",{class:"iconfont-pc icon-xiajiantou"},null,-1))],2),_e.value?j("",!0):(p(),v("div",{key:1,class:"attr-multiple",onClick:a[3]||(a[3]=e=>{_e.value=!0,we.value=!0})},[a[13]||(a[13]=g("i",null,"＋",-1)),g("div",se,b(e.$t("多选")),1)]))]),we.value&&_e.value?(p(),v("div",ie,[g("a",{class:x(["fc-btn-ok",{"fc-disable":0===Ce.value.length}]),onClick:Se},b(e.$t("确定")),3),g("a",{class:"fc-btn-cancel",onClick:$e},b(e.$t("取消")),1)])):j("",!0)])):j("",!0)]),g("div",oe,[g("div",ne,[g("div",ue,[g("div",ce,[g("span",{class:x(["sort-link",{cur_sort:""==F.value.sortField}]),title:h($)("默认排序（根据相关性排序）"),onClick:a[4]||(a[4]=e=>Fe(""))},b(e.$t("默认排序")),11,de),g("span",{class:x(["sort-link",{cur_sort:"sale"==F.value.sortField}]),title:h($)("销量（销量从高到低）"),onClick:a[5]||(a[5]=e=>Fe("sale"))},b(e.$t("销量")),11,ve),g("span",{class:x(["sort-link",{cur_sort:"time"==F.value.sortField}]),title:h($)("上架时间（最新发布排序）"),onClick:a[6]||(a[6]=e=>Fe("time"))},b(e.$t("新品")),11,pe),g("span",{class:x(["sort-link",{cur_sort:"price"==F.value.sortField}]),title:"desc"==F.value.sortOrder?h($)("价格（价格从高到低）"):h($)("价格（价格从低到高）"),onClick:a[7]||(a[7]=e=>Fe("price"))},[k(b(e.$t("价格"))+" ",1),"desc"==F.value.sortOrder?(p(),v("span",ye)):(p(),v("span",ge))],10,me)]),g("div",fe,[g("div",ke,[w(g("input",{type:"text",name:"pricemin","onUpdate:modelValue":a[8]||(a[8]=e=>W.value=e)},null,512),[[_,W.value,void 0,{number:!0}]]),a[14]||(a[14]=g("em",null," - ",-1)),w(g("input",{type:"text",name:"pricemax","onUpdate:modelValue":a[9]||(a[9]=e=>G.value=e)},null,512),[[_,G.value,void 0,{number:!0}]]),g("a",{class:"btn-default",draggable:"false",onClick:Me,rel:"nofollow",href:"javascript:;"},b(e.$t("确定")),1)])])]),g("div",be,[g("div",je,[g("div",null,[k(b(e.$t("共")),1),g("em",null,b(h(t).total),1),k(b(e.$t("个商品")),1)])]),g("div",he,[g("span",xe,b(F.value.page)+"/"+b(h(Pe)),1),g("span",{onClick:Ne,class:x(["noPage",{disabled:1==F.value.page}])},"<",2),g("span",{onClick:Ue,class:x(["noPage",{disabled:F.value.page===h(Pe)}])},">",2)])])])])])],64)}}}),[["__scopeId","data-v-7770fa37"]]),Ie={style:{"background-color":"#fff"}},we={class:"container"},_e={key:0,class:"nav-selected"},qe={key:1,class:"nav-selected"},Ce={key:1,class:"nav-selected"},$e=C(t({__name:"search",props:{pageType:{type:String,default:"search"}},setup(r){const t=r,s=o(),i=$(),n=S({page:1,categoryId:0,brandIds:[],sortField:"",sortOrder:"",maxPrice:0,minPrice:0,couponId:0,keyword:""});O((()=>{n.page=i.query.page?Number(i.query.page):1,n.categoryId=i.query.cat?Number(i.query.cat):0,n.brandIds=i.query.brand?String(i.query.brand).split(",").map(Number):[],n.sortField=i.query.sort?String(i.query.sort):"",n.sortOrder=i.query.order?String(i.query.order):"",n.maxPrice=i.query.max?Number(i.query.max):0,n.minPrice=i.query.min?Number(i.query.min):0,n.keyword=i.query.keyword?String(i.query.keyword):"",n.couponId=i.query.couponId?Number(i.query.couponId):0}));const u=o();d((()=>u.value),(e=>{null==(null==e?void 0:e.brand)&&s.value.clearMultipleBrandIds()}));const k=c((()=>{let e={};return n.page>1&&(e.page=n.page),n.categoryId>0&&(e.cat=n.categoryId),n.couponId>0&&(e.couponId=n.couponId),n.brandIds.length>0&&(e.brand=n.brandIds.join(",")),""!=n.sortField&&["sale","price","time"].includes(n.sortField)&&(e.sort=n.sortField),""!=n.sortOrder&&["desc","asc"].includes(n.sortOrder)&&(e.order=n.sortOrder),n.maxPrice>0&&(e.max=n.maxPrice),n.minPrice>0&&(e.min=n.minPrice),""!=n.keyword&&(e.keyword=n.keyword),e})),x=(e=1)=>{n.page=e,M({path:"/"+t.pageType+"/",query:k.value})},P=o(null),I=()=>{const e=P.value;e&&e.scrollIntoView()};return(t,i)=>{const o=e,c=a,d=l,w=Pe,_=B,q=W;return p(),v("div",Ie,[y(o),y(c,{title:h(n).keyword?`${h(n).keyword} - 商品搜索`:"商品搜索"},null,8,["title"]),g("div",we,[h(N)()&&h(n).keyword?(p(),F(G,{key:0,keyword:h(n).keyword,style:{"flex-shrink":"0"}},null,8,["keyword"])):j("",!0),y(d,{id:h(n).categoryId,"onUpdate:id":i[3]||(i[3]=e=>h(n).categoryId=e),isSearchPage:"",onChange:x,style:{"flex-shrink":"0"}},{default:f((()=>[u.value?(p(),v(m,{key:0},[h(n).brandIds.length>0&&u.value.brand?(p(),v("div",_e,[g("div",{class:"item",onClick:i[0]||(i[0]=e=>{h(n).brandIds=[],x()})},[g("span",null,b(t.$t("品牌"))+"：",1),g("span",null,b(u.value.brand),1)])])):j("",!0),h(n).minPrice>0||h(n).maxPrice>0?(p(),v("div",qe,[g("div",{class:"item",onClick:i[1]||(i[1]=e=>{h(n).maxPrice=0,h(n).minPrice=0,x()})},[g("span",null,b(t.$t("价格"))+"：",1),g("span",null,b(h(n).minPrice??0)+" "+b(h(n).maxPrice>0?" - "+h(n).maxPrice:t.$t("以上")),1)])])):j("",!0)],64)):j("",!0),h(n).keyword?(p(),v("div",Ce,[h(n).keyword?(p(),v("div",{key:0,class:"item",onClick:i[2]||(i[2]=e=>{h(n).keyword="",x()})},[g("span",null,b(t.$t("搜索"))+"：",1),g("span",null,'"'+b(h(n).keyword)+'"',1)])):j("",!0)])):j("",!0)])),_:1},8,["id"]),g("div",{ref_key:"FilterRef",ref:P},[y(w,{ref_key:"filterRef",ref:s,filter:h(n),"onUpdate:filter":i[4]||(i[4]=e=>U(n)?n.value=e:null),filterSeleted:u.value,"onUpdate:filterSeleted":i[5]||(i[5]=e=>u.value=e),queryParams:h(k),"onUpdate:queryParams":i[6]||(i[6]=e=>U(k)?k.value=e:null),pageType:r.pageType,isSearchPage:"",onChange:x},null,8,["filter","filterSeleted","queryParams","pageType"])],512),y(_,{queryParams:h(k),"onUpdate:queryParams":i[7]||(i[7]=e=>U(k)?k.value=e:null),filter:h(n),"onUpdate:filter":i[8]||(i[8]=e=>U(n)?n.value=e:null),onChange:x,onPageChange:I},null,8,["queryParams","filter"])]),y(q)])}}}),[["__scopeId","data-v-5b787daa"]]);export{$e as default};
