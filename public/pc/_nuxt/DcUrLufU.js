import{_ as P}from"./uNNarvbF.js";import{_ as R}from"./BICKwAaO.js";import{a as L,E as j}from"./D5p5RYpQ.js";import{E as z}from"./lRlBa-wu.js";import{_ as H}from"./C6cR03M8.js";import{E as Z,a as O}from"./CPhr9T1V.js";import{E as W}from"./XomGKeK5.js";import{_ as Y}from"./BCw_XNK7.js";import{f as G,Y as J,r as c,a8 as K,s as C,o as b,c as Q,b as s,a,t as d,w as n,h as V,i as X,j as v,d as ee,F as oe,av as g,ad as te,a1 as re,_ as le}from"./DvlzeZYf.js";import"./DGzzo1G8.js";import{s as se,u as ie}from"./Xo_P1g0Y.js";import{M as ne}from"./DkrvK9R2.js";import{u as ae}from"./ctHFjQ9z.js";import"./DrjGOYyT.js";import"./CzQrJ5jx.js";import"./Cq9Fpw4b.js";import"./BxwJi-A4.js";import"./CvS5MqkS.js";import"./De9iyrrl.js";import"./C3hftOhu.js";import"./BB_Ol6Sd.js";import"./B9SirqjL.js";import"./eXzid_I5.js";import"./DldgdBu3.js";import"./DCTLXrZ8.js";import"./uRofAO38.js";const de={class:"full-height-div"},me={class:"register-info"},ue={class:"title"},pe={class:"label"},_e={class:"area-code-select"},fe={class:"label"};const ce={class:"label"},be={class:"label"},ve=G({__name:"BindMobilePhone",setup(ge){const w=ae(),{t:i}=J(),y=c(!1),E=K(),h=(t,e,r)=>{e?o.value.tigTips[t]={type:"valid",message:r}:o.value.tigTips[t]={type:"error",message:r}},u=t=>{o.value.tigTips[t]={type:"info",message:x[t]}},T=(t,e,r)=>{if(e){if(/^(?=.*\D).+$/.test(e))return r(new Error(i("格式错误，请输入正确的手机号码")));r()}else return r(new Error(i("手机号不能为空")))},B=(t,e,r)=>{if(e)if(/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(e))r();else return r(new Error(i("格式错误，请输入正确的邮箱地址")));else return r(new Error(i("邮箱不能为空")))},S=(t,e,r)=>{if(e){if(e.length!=6)return r(new Error(i("请输入6位验证码")));r()}else return r(new Error(i("验证码不能为空")))},k=(t,e,r)=>{if(e){if(e.length>20||e.length<6)return r(new Error(i("密码应为6-20位字符")));if(/\s/.test(e))return r(new Error(i("密码中不允许有空格")));if(/^\d+$/.test(e))return r(new Error(i("密码不能全为数字")));if(/^(?=.*[\d\W]).+$/.test(e))if(/^(?=.*[a-zA-Z0-9]).+$/.test(e))if(/^(?!([a-zA-Z0-9])\1*$).+$/.test(e))r();else return r(new Error(i("密码不能全为相同字符或数字")));else return r(new Error(i("密码不能全为符号")));else return r(new Error(i("密码不能全为字母")))}else return r(new Error(i("密码不能为空")))},x=C({mobile:i("请填写正确的手机号码，以便接收订单通知，找回密码等"),mail:i("请填写正确的邮箱地址，以便接收订单通知，找回密码等"),mobile_code:i("请输入验证码"),password:i("6-20个大小写英文字母、符号或数字的组合")}),F=C({mobile:[{validator:T,trigger:"blur",required:!0}],mail:[{validator:B,trigger:"blur",required:!0}],mobile_code:[{validator:S,trigger:"blur",required:!0}],password:[{validator:k,trigger:"blur",required:!0}]}),f=c(!1),o=c({tigTips:{},area_code:""}),M=async()=>{await E.value.validate();try{f.value=!0;const t=await ie({...o.value,open_data:w.openData});g.success(i("绑定成功"));const e=te("accessToken");e.value=t.token,w.userInfoLoaded=!1,re("/member/")}catch(t){g.error(t.message)}finally{f.value=!1}},U=t=>{g.error(t)};return(t,e)=>{const r=P,q=R,$=L,N=j,p=z,_=H,m=Z,D=W,I=O,A=Y;return b(),Q(oe,null,[s(r,{title:"绑定手机"}),s(q,{type:"register"}),a("div",de,[a("div",me,[a("div",ue,d(t.$t("绑定手机")),1),s(I,{ref_key:"formRef",ref:E,"hide-required-asterisk":!0,model:o.value,rules:v(F),"show-message":!1,class:"form-body","label-width":"auto",onValidate:h},{default:n(()=>[o.value.regist_type==="mobile"||!o.value.regist_type?(b(),V(m,{key:0,prop:"mobile"},{default:n(()=>[a("div",pe,d(t.$t("手机号")),1),s(p,{modelValue:o.value.mobile,"onUpdate:modelValue":e[1]||(e[1]=l=>o.value.mobile=l),class:"input-border-style",style:{},onFocus:e[2]||(e[2]=l=>u("mobile"))},{prefix:n(()=>[a("div",_e,[s(N,{modelValue:o.value.area_code,"onUpdate:modelValue":e[0]||(e[0]=l=>o.value.area_code=l),placeholder:t.$t("请选择区号")},{default:n(()=>[s($,{label:"(+86)"+t.$t("中国"),value:""},null,8,["label"]),s($,{label:"(+61)"+t.$t("澳洲"),value:"+61"},null,8,["label"])]),_:1},8,["modelValue","placeholder"])])]),_:1},8,["modelValue"]),s(_,{info:o.value.tigTips.mobile},null,8,["info"])]),_:1})):(b(),V(m,{key:1,prop:"mail"},{default:n(()=>[a("div",fe,d(t.$t("邮箱")),1),s(p,{modelValue:o.value.mail,"onUpdate:modelValue":e[3]||(e[3]=l=>o.value.mail=l),class:"input-border-style",onFocus:e[4]||(e[4]=l=>u("mail"))},null,8,["modelValue"]),s(_,{info:o.value.tigTips.mail},null,8,["info"])]),_:1})),X("",!0),s(m,{prop:"mobile_code"},{default:n(()=>[a("div",ce,d(t.$t("验证码")),1),s(p,{modelValue:o.value.mobile_code,"onUpdate:modelValue":e[10]||(e[10]=l=>o.value.mobile_code=l),class:"input-border-style",onFocus:e[11]||(e[11]=l=>u("mobile_code"))},{suffix:n(()=>[s(v(ne),{class:"mobile-code-text",mobile:o.value.mobile,"onUpdate:mobile":e[7]||(e[7]=l=>o.value.mobile=l),mobileCode:o.value.mobile_code,"onUpdate:mobileCode":e[8]||(e[8]=l=>o.value.mobile_code=l),mobileCodeSended:y.value,"onUpdate:mobileCodeSended":e[9]||(e[9]=l=>y.value=l),requestApi:v(se),onMobileErrorCallback:U},null,8,["mobile","mobileCode","mobileCodeSended","requestApi"])]),_:1},8,["modelValue"]),s(_,{info:o.value.tigTips.mobile_code},null,8,["info"])]),_:1}),s(m,{prop:"password"},{default:n(()=>[a("div",be,d(t.$t("设置密码")),1),s(p,{modelValue:o.value.password,"onUpdate:modelValue":e[12]||(e[12]=l=>o.value.password=l),class:"input-border-style","show-password":"",type:"password",onFocus:e[13]||(e[13]=l=>u("password"))},null,8,["modelValue"]),s(_,{info:o.value.tigTips.password},null,8,["info"])]),_:1}),s(m,{label:"",prop:"first_word"},{default:n(()=>[s(D,{loading:f.value,type:"primary",class:"submit-button",style:{width:"330px"},onClick:M},{default:n(()=>[ee(d(t.$t("确认")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])])]),s(A,{bg:"white",type:0})],64)}}}),Ze=le(ve,[["__scopeId","data-v-b72873b4"]]);export{Ze as default};
