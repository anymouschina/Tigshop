import{_ as s}from"./9TMjRzGO.js";import{_ as a}from"./BlxdsvOv.js";import{_ as t}from"./CScYj7Fy.js";import{e,G as o,r as i,z as l,y as r,n as c,ae as n,S as m,c as d,o as p,b as u,a as v,t as y,i as f,d as j,h,E as w,_ as g}from"./BLNaUqdG.js";import{_ as $}from"./zM3V5R1F.js";import{E as _}from"./C8IqyEYy.js";import"./CK-rvtuG.js";import"./ClnUiH43.js";import"./CQcoTD7x.js";import{a as k,o as b,c as C}from"./B95mWd0t.js";import{Q as x}from"./CtheyMuC.js";import{w as I,z as S}from"./DjqjJCjM.js";import{y as V}from"./BcPgypNs.js";import{s as q}from"./DSXY0Md2.js";import"./DSwxsogY.js";import"./DGSQZaL6.js";import"./D-E-9YUO.js";import"./DlIXSNl1.js";import"./DxiXPFL-.js";import"./losdC6Ud.js";import"./C8QNSlsX.js";import"./BWAJcOoD.js";import"./BwRzfsZt.js";import"./CxZS6lgh.js";import"./D_Dr4eZ1.js";import"./D5ZJ33IS.js";const z={class:"wechat-com"},B={class:"wechat container"},E={class:"message"},L={class:"message"},M={class:"payment"},O={key:0,class:"title"},P={key:1,class:"title"},U={class:"image-div"},Y={class:"left-image"},D={key:0,class:"ewm"},G={key:1,class:"ewm-empty"},J={class:"pw-box-ft"},Q={key:0},R={key:1},T={key:2},W={class:"right-image"},X={key:0,class:"image"},Z={key:1,class:"image"},A={key:2,class:"image"},F=g(e({__name:"yunpay",setup(e){const g=o(),F=i(g.query.id),H=i(g.query.type),K=i(!0);i({});const N=i(""),ss=i({}),{t:as}=l();(async()=>{try{const s=await b({id:F.value});ss.value=s.order}catch(s){c.error(s.message),n("/member/order/list/")}})();const ts=i(0);let es=null;r((()=>{(async()=>{K.value=!0;try{const s=await C({id:F.value,type:"yunpay_"+H.value});is(null==s?void 0:s.pay_info.code_url)}catch(s){c.error(s.message)}finally{K.value=!1}})(),es=q((()=>{os(),ts.value++,50===ts.value&&(clearInterval(es),c.error(as("支付已超时，您可以刷新页面重新支付")))}),2e3)}));const os=()=>{k({id:F.value}).then((s=>{1==s.pay_status&&(clearInterval(es),_.confirm(as("订单支付成功"),as("提示"),{confirmButtonText:as("查看订单"),showClose:!1,showCancelButton:!1,closeOnClickModal:!1,type:"success"}).then((()=>{n("/member/order/info?id="+F.value)})).catch((()=>{})))}))},is=async s=>{const a=s;N.value=await x.toDataURL(a,{margin:1,width:500,height:500})},ls=()=>{window.close()},rs=()=>{window.location.reload()};return m((()=>{clearInterval(es)})),(e,o)=>{const i=s,l=a,r=t,c=w,n=$;return p(),d("div",null,[u(i,{title:"YunPay"}),u(l,{showLogin:!1}),v("div",z,[v("div",B,[v("div",E,y(e.$t("订单提交成功，请尽快付款"))+"！"+y(e.$t("订单号"))+"："+y(f(ss).order_sn),1),v("div",L,[j(y(e.$t("应付金额"))+"： ",1),u(r,{modelValue:f(ss).total_amount,"onUpdate:modelValue":o[0]||(o[0]=s=>f(ss).total_amount=s),fontStyle:{color:"var(--price)",fontSize:"18px"}},null,8,["modelValue"])]),v("div",M,["wechat"==f(H)?(p(),d("div",O,y(e.$t("微信支付")),1)):h("",!0),"alipay"==f(H)?(p(),d("div",P,y(e.$t("支付宝支付")),1)):h("",!0),v("div",U,[v("div",Y,[v("div",null,[j(y(e.$t("如果二维码已过期"))+"，"+y(e.$t("请")),1),v("span",{onClick:rs,class:"font-color",style:{cursor:"pointer"}},y(e.$t("刷新")),1),j(y(e.$t("页面重新获取二维码"))+"。 ",1)]),f(ts)<=50?(p(),d("div",D,[u(c,{class:"image",src:f(N)},null,8,["src"])])):(p(),d("div",G,[j(y(e.$t("已超时"))+"，",1),v("a",{class:"font-color",onClick:rs},y(e.$t("点击刷新")),1)])),v("div",J,["wechat"==f(H)?(p(),d("div",Q,y(e.$t("请使用微信扫一扫")),1)):h("",!0),"alipay"==f(H)?(p(),d("div",R,y(e.$t("请使用支付宝扫一扫")),1)):h("",!0),"yunshanfu"==f(H)?(p(),d("div",T,y(e.$t("请使用云闪付扫一扫")),1)):h("",!0),v("div",null,y(e.$t("扫描二维码支付")),1)])]),v("div",W,["wechat"==f(H)?(p(),d("div",X,[u(c,{src:f(I)},null,8,["src"])])):h("",!0),"alipay"==f(H)?(p(),d("div",Z,[u(c,{src:f(S)},null,8,["src"])])):h("",!0),"yunshanfu"==f(H)?(p(),d("div",A,[u(c,{src:f(V)},null,8,["src"])])):h("",!0)])]),v("div",{onClick:ls,class:"button-title"},"< "+y(e.$t("选择其他支付方式")),1)])])]),u(n,{bg:"white",mt30:!1,type:1})])}}}),[["__scopeId","data-v-2e9fe41f"]]);export{F as default};
