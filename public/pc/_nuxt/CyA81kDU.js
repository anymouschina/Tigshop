import{e,cb as a,an as l,z as t,r as i,cc as s,c as u,o as r,F as o,b as p,v as c,i as d,ao as m,am as n,w as v,Y as f,a5 as h,a as b,E as y,cd as g,j as _,_ as T}from"./vO8z_6wc.js";import{E as U}from"./D0li9aqr.js";import{E as j}from"./B9ErrXst.js";import"./YLitFIRx.js";const $={class:"image"},I=T(e({__name:"UploadImage",props:a({limit:{type:Number,default:1},fileTypes:{type:Array,default:[]}},{uploadList:{default:[]},uploadListModifiers:{}}),emits:["update:uploadList"],setup(e){const a=l(),{t:T}=t(),I=i(),L=e,E=e=>{if(F.value.length>=L.limit)return g.error(T("已经达到上传数量限制")),!1;const a=e.type.replace(/.*\//,"");return L.fileTypes.includes(a)?!(e.size/1024/1024>2)||(g.error(T("只能上传2M以内的图片")),!1):(g.error(`${T("无法上传")} ${a} ${T("文件!")}${T("只能上传")} ${L.fileTypes.join(", ")} ${T("文件!")}`),!1)},x=s(e,"uploadList"),F=i([]);null!=x.value?x.value.length>0&&(x.value.forEach((e=>{e.url=_(e.picUrl)})),F.value=x.value):x.value=[];const N=i(""),V=i(!1),k=(e,a)=>{e&&x.value?x.value=x.value.filter((a=>a.picThumb!==e.picThumb)):x.value=[]},w=(e=[],a)=>{1===L.limit&&F.value.length>0&&(F.value.pop(),x.value.pop(),I.value.clearFiles(),I.value.handleStart(e[0]),I.value.submit())},z=e=>{N.value=e.url,V.value=!0},M=(e,a)=>{try{x.value.push({picThumb:e.data.picThumb,picUrl:e.data.picUrl,picId:e.data.picId,picName:e.data.picName})}catch(l){}};return(l,t)=>{const i=f,s=U,g=y,_=j;return r(),u(o,null,[p(s,{ref_key:"upload",ref:I,"file-list":F.value,"onUpdate:fileList":t[0]||(t[0]=e=>F.value=e),action:d(m).prefix+"/user/user/uploadImg",headers:d(a),"before-upload":E,"on-exceed":w,"on-preview":z,"on-remove":k,"on-success":M,limit:e.limit,multiple:e.limit>1,"list-type":"picture-card",class:c({"hide-upload-button":1==e.limit&&F.value.length>0})},n({_:2},[0===F.value.length?{name:"trigger",fn:v((()=>[p(i,null,{default:v((()=>[p(d(h))])),_:1})])),key:"0"}:void 0]),1032,["file-list","action","headers","limit","multiple","class"]),p(_,{modelValue:V.value,"onUpdate:modelValue":t[1]||(t[1]=e=>V.value=e)},{default:v((()=>[b("div",$,[p(g,{src:N.value,alt:"",fit:"cover"},null,8,["src"])])])),_:1},8,["modelValue"])],64)}}}),[["__scopeId","data-v-3969a530"]]);export{I as U};
