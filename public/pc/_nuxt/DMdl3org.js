import{at as e,e as l,cb as a,cc as s,r as n,y as t,z as u,s as c,C as i,c as v,o,a as d,h as r,F as g,l as h,d as p,t as m,v as f,ag as k,_ as y}from"./vO8z_6wc.js";const _={class:"flex align-center"},w={key:0},x={key:1},C={key:0,class:"select_popup"},b={class:"top flex justify-between"},j={class:"tabs flex"},I=["onClick"],E={key:0,class:"sec_childs"},V=["onClick"],L=y(l({__name:"SelectRegion",props:{modelValue:{default:[]},modelModifiers:{}},emits:a(["change"],["update:modelValue"]),setup(l,{emit:a}){const y=s(l,"modelValue"),L=n(!1),N=n([]),R=n(0),S=a;t((()=>{z()}));const{t:$}=u(),z=async()=>{try{let a=y.value.join();const s=await(l=a,e({url:"sys/region/getRegion",method:"get",params:{regionIds:l}}));Object.assign(N.value,s),N.value.length>1?N.value[N.value.length-1].length>0?R.value=N.value.length-1:R.value=N.value.length-2:R.value=0}catch(a){}var l},F=e=>y.value.includes(e),M=()=>{L.value=!0,z()},O=c((()=>{let e=[];return N.value.forEach(((l,a)=>{if(l.length>0){let s=!1;l.forEach((l=>{F(l.regionId)&&(e[a]=l.regionName,s=!0)})),0==s&&(e[a]=$("请选择地区"))}})),e})),P=()=>{!0===L.value&&y.value.length!=O.value.length&&(y.value=[],N.value=[],R.value=0),L.value=!1},q=n(null),A=e=>{q.value&&!q.value.contains(e.target)&&P()};return t((()=>{window.addEventListener("click",A)})),i((()=>{window.removeEventListener("click",A)})),(e,l)=>(o(),v("div",{class:"select_region_box",ref_key:"selectPop",ref:q},[d("div",_,[d("div",{class:"select_region hand-pointer flex align-center",onClick:M},[O.value.length>0?(o(),v("div",w,[(o(!0),v(g,null,h(O.value,((e,l)=>(o(),v(g,null,[p(m(e)+" ",1)],64)))),256))])):r("",!0),0==O.value.length?(o(),v("div",x,m(e.$t("请选择地区")),1)):r("",!0),l[0]||(l[0]=d("i",{class:"iconfont-pc icon-xiajiantou"},null,-1))])]),L.value?(o(),v("div",C,[d("div",b,[d("div",j,[(o(!0),v(g,null,h(O.value,((l,a)=>(o(),v("div",{class:f(["tab",{cur:R.value===a}]),onClick:e=>R.value=a},m(l||e.$t("请选择")),11,I)))),256))]),N.value.length==R.value+1?(o(),v("div",{key:0,class:"selectclose",onClick:k(P,["stop"])},"×")):r("",!0)]),(o(!0),v(g,null,h(N.value,((e,l)=>(o(),v(g,null,[R.value===l?(o(),v("div",E,[(o(!0),v(g,null,h(e,(e=>(o(),v("span",{class:f(["sec_item",{active:F(e.regionId)}]),onClick:a=>(async(e,l)=>{e>=0&&e<=y.value.length&&(y.value[e]=l,y.value.splice(e+1)),await z(),N.value.length==e+1||0==N.value[e+1].length?L.value=!1:R.value=e+1,S("change")})(l,e.regionId)},m(e.regionName),11,V)))),256))])):r("",!0)],64)))),256))])):r("",!0)],512))}}),[["__scopeId","data-v-e9d1d549"]]);export{L as S};
