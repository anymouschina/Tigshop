import{E as O}from"./lRlBa-wu.js";import{_ as Z}from"./C6cR03M8.js";import{E as j,a as D}from"./CPhr9T1V.js";import{E as L}from"./XomGKeK5.js";import{f as P,a4 as C,a7 as W,Y,r as p,a8 as G,s as V,o as c,h as $,w as n,a as b,t as v,b as l,j as a,c as H,i as M,d as J,av as S,_ as Q}from"./DvlzeZYf.js";import{_ as X}from"./BDyiSPJB.js";import{s as k,b as ee}from"./DII1Wvf5.js";import{M as oe}from"./DkrvK9R2.js";import"./D5p5RYpQ.js";import"./DGzzo1G8.js";import"./BxwJi-A4.js";import"./CvS5MqkS.js";import"./BB_Ol6Sd.js";import"./C3hftOhu.js";import"./Cq9Fpw4b.js";import"./De9iyrrl.js";import"./B9SirqjL.js";import"./uRofAO38.js";import"./DldgdBu3.js";import"./DCTLXrZ8.js";const te={class:"label"},re={class:"area-code-input"},se={key:0,class:"area-code-select"},ie={class:"label"},le=P({__name:"StepOne",props:{step:{},stepModifiers:{},mobileKey:{},mobileKeyModifiers:{}},emits:["update:step","update:mobileKey"],setup(w){const T=C(w,"step"),x=C(w,"mobileKey"),d=W(),{t:s}=Y(),g=p(!1),m=p("86"),E=G(),q=(r,e,o)=>{e?t.value.tigTips[r]={type:"valid",message:o}:t.value.tigTips[r]={type:"error",message:o}},y=r=>{t.value.tigTips[r]={type:"info",message:K[r]}},F=(r,e,o)=>{const u=d.is_open_mobile_area_code?/^(\+?[1-9]\d{1,14})$/:/^(?:\+?86)?1[3-9]\d{9}$/;if(e)if(u.test(e))o();else return o(new Error(s("格式错误，请输入正确的手机号码")));else return o(new Error(s("手机号不能为空")))},h=(r,e,o)=>{if(e)if(/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(e))o();else return o(new Error(s("格式错误，请输入正确的邮箱地址")));else return o(new Error(s("邮箱不能为空")))},A=(r,e,o)=>{if(e){if(e.length!=6)return o(new Error(s("请输入6位验证码")));o()}else return o(new Error(s("验证码不能为空")))},B=(r,e,o)=>{if(e){if(e.length>20||e.length<6)return o(new Error(s("密码应为6-20位字符")));if(/\s/.test(e))return o(new Error(s("密码中不允许有空格")));if(/^\d+$/.test(e))return o(new Error(s("密码不能全为数字")));if(/^(?=.*[\d\W]).+$/.test(e))if(/^(?=.*[a-zA-Z0-9]).+$/.test(e))if(/^(?!([a-zA-Z0-9])\1*$).+$/.test(e))o();else return o(new Error(s("密码不能全为相同字符或数字")));else return o(new Error(s("密码不能全为符号")));else return o(new Error(s("密码不能全为字母")))}else return o(new Error(s("密码不能为空")))},K=V({mobile:s("请填写手机号码"),mail:s("请填写邮箱地址"),code:s("请输入验证码"),password:s("6-20个大小写英文字母、符号或数字的组合")}),I=V({mobile:[{validator:F,trigger:"blur",required:!0}],mail:[{validator:h,trigger:"blur",required:!0}],code:[{validator:A,trigger:"blur",required:!0}],password:[{validator:B,trigger:"blur",required:!0}]}),f=p(!1),t=p({tigTips:{},mobile:"",code:""}),N=async()=>{await E.value.validate();try{f.value=!0;const r=await ee({mobile:d.is_open_mobile_area_code?m.value+t.value.mobile:t.value.mobile,code:t.value.code});x.value=r.item,T.value=2}catch(r){S.error(r.message),t.value.code="",t.value.tigTips={}}finally{f.value=!1}},R=r=>{S.error(r)};return(r,e)=>{const o=O,u=Z,_=j,U=L,z=D;return c(),$(z,{ref_key:"formRef",ref:E,"hide-required-asterisk":!0,model:t.value,rules:a(I),"show-message":!1,class:"form-body","label-width":"auto",onValidate:q},{default:n(()=>[t.value.regist_type==="mobile"||!t.value.regist_type?(c(),$(_,{key:0,prop:"mobile"},{default:n(()=>[b("div",te,v(r.$t("手机号")),1),b("div",re,[l(o,{modelValue:t.value.mobile,"onUpdate:modelValue":e[1]||(e[1]=i=>t.value.mobile=i),class:"input-border-style",onFocus:e[2]||(e[2]=i=>y("mobile"))},{prefix:n(()=>[a(d).is_open_mobile_area_code?(c(),H("div",se,[l(X,{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=i=>m.value=i)},null,8,["modelValue"])])):M("",!0)]),_:1},8,["modelValue"])]),l(u,{info:t.value.tigTips.mobile},null,8,["info"])]),_:1})):M("",!0),l(_,{prop:"code"},{default:n(()=>[b("div",ie,v(r.$t("验证码")),1),l(o,{modelValue:t.value.code,"onUpdate:modelValue":e[4]||(e[4]=i=>t.value.code=i),class:"input-border-style",onFocus:e[5]||(e[5]=i=>y("code"))},{suffix:n(()=>[l(a(oe),{class:"mobile-code-text",event:"forget_password",mobile:a(d).is_open_mobile_area_code?m.value+t.value.mobile:t.value.mobile,mobileCodeSended:g.value,"onUpdate:mobileCodeSended":e[3]||(e[3]=i=>g.value=i),requestApi:a(k),onMobileErrorCallback:R},null,8,["mobile","mobileCodeSended","requestApi"])]),_:1},8,["modelValue"]),l(u,{info:t.value.tigTips.code},null,8,["info"])]),_:1}),l(_,{label:"",prop:"first_word"},{default:n(()=>[l(U,{loading:f.value,type:"primary",class:"submit-button",style:{width:"330px"},onClick:N},{default:n(()=>[J(v(r.$t("下 一 步")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])}}}),Te=Q(le,[["__scopeId","data-v-001cb9d8"]]);export{Te as default};
