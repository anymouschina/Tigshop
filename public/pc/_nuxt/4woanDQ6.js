import{_ as e}from"./DIcT5qlW.js";import{E as t}from"./OZUBBuO3.js";import{_ as a}from"./DRy-t1KR.js";import{E as l}from"./DQonK11p.js";import{_ as s}from"./4BWvF7DS.js";import{e as o,f as i,z as c,r as d,y as n,C as u,c as r,o as m,b as v,h as p,m as f,a as h,t as k,w as y,d as g,F as b,l as V,i as x,ah as _,v as j,q as C,j as $,E as w,n as U,ai as T,ae as D,_ as E}from"./vO8z_6wc.js";import{_ as S}from"./B3kMr2Om.js";import{_ as I}from"./B6kpiin_.js";import"./CxvT33_f.js";import A from"./sxlyH3HU.js";import F from"./C9QqtWVK.js";import O from"./C6vPm8Fv.js";import{g as q,u as z,r as B,c as L,a as N}from"./ExFuuhw5.js";import{E as W}from"./CMHrSU05.js";import"./DEtxbcwL.js";import"./DqoL2U0I.js";import"./CdIa5lAL.js";import"./CKVP4sCQ.js";import"./BwRzfsZt.js";import"./D_Dr4eZ1.js";import"./Ctuj9lAE.js";import"./BG07ctRk.js";import"./6_reTNGa.js";import"./123WnbAt.js";import"./C_yTnQv7.js";import"./DgmxjSXK.js";import"./VsleDggW.js";import"./B0jPhJeY.js";import"./C0xcqOw0.js";/* empty css        */import"./y2YKyhRU.js";import"./w_nOPjer.js";import"./BPYtos7D.js";import"./_qz6p60H.js";const P={style:{"background-color":"#f2f3f5"}},R={key:0,class:"container"},Y={class:"no_goods clearfix"},Z={class:"left main"},H={class:"strong"},J={key:1,class:"container"},M={class:"cart-tit"},Q={class:"cart-head"},X={class:"product-list-cart flex"},G={class:"item col-1 center"},K={class:"item col-1",style:{"justify-content":"left"}},ee={class:"item col-3",style:{"justify-content":"left"}},te={class:"item col-2 center"},ae={class:"item col-2 center"},le={class:"item col-2 center"},se={class:"item col-2 center"},oe={class:"cart_table"},ie={class:"cart_store_title flex"},ce={class:"item col-1 center"},de={class:"item col-3 flex align-center"},ne={key:0,class:"tag"},ue={key:1,class:"tit"},re={class:"cart_list_wrap"},me={class:"product-item flex"},ve={class:"item col-1 center flex align-center justify-center"},pe={class:"item col-4 flex"},fe={class:"pic"},he=["href"],ke=["src"],ye={key:1},ge=["src"],be={key:2,class:"disabled"},Ve={key:0},xe={class:"name pt5"},_e=["href"],je={key:1},Ce={class:"info"},$e={key:2,class:"extraskudata"},we={class:"title"},Ue={class:"content"},Te={class:"content-text"},De={class:"num"},Ee={key:3,class:"promotion-box"},Se={key:0,class:"promotion"},Ie={class:"ticket-content"},Ae={key:1,class:"promotion"},Fe={class:"ticket-type"},Oe={class:"ticket-content"},qe={class:"item col-2 center"},ze={class:"price pt5 center-price"},Be={class:"item col-2 center"},Le={class:"pt5 flex justify-center"},Ne={class:"item col-2 center"},We={class:"money pt5"},Pe={class:"item col-2 center"},Re=["onClick"],Ye={key:0,class:"gift-box"},Ze={class:"gift-title"},He={class:"gift-content"},Je={class:"gift-content-item"},Me={class:"gift-item-left"},Qe={class:"gift-item-right"},Xe={class:"gift-item-name"},Ge={key:0,class:"sku-card"},Ke={class:"gift-item-num"},et={class:"pay_tools_inner flex justify-between align-center container"},tt={class:"pay_tools_l flex align-center"},at={class:"item col-1 center"},lt={class:"pay_txt_row flex"},st={class:"font-color"},ot={class:"pay_tools_r flex align-center"},it={class:"pay_tools_total_box"},ct={class:"flex align-center justify-end"},dt={class:"r_prod_view"},nt={class:"font-color"},ut={class:"r_price_total"},rt={class:"tit"},mt={class:"discounts-btn-box"},vt={class:"discounts-btn"},pt={class:"discount"},ft={class:"discount-title"},ht={class:"title-text"},kt={class:"discount-content"},yt={class:"discount-item-box"},gt={class:"item-label"},bt={class:"item-value"},Vt={key:0,class:"discount-item-box"},xt={class:"item-label"},_t={class:"item-value"},jt={class:"discount-item-box"},Ct={class:"item-label"},$t={class:"item-value discounts-value",style:{color:"var(--general)"}},wt={key:0,class:"sub-item-box"},Ut={class:"sub-item-label"},Tt={class:"sub-item-value discounts-value"},Dt={key:1,class:"discount-detail"},Et={class:"sub-item-label"},St={class:"sub-item-value discounts-value"},It={class:"discount-item-box"},At={class:"item-label"},Ft={class:"item-value"},Ot={class:"discount-desc"},qt={key:3},zt=E(o({__name:"index",setup(o){const E=i(),{t:zt}=c(),Bt=d(!0),Lt=d([]),Nt=d({}),Wt=d(!1),Pt=d();n((()=>{Yt()}));const Rt=e=>0==e.productStatus||0==e.stock||1==e.isDisabled,Yt=async()=>{try{Pt.value=W.service({lock:!1,text:zt("请求加载中"),customClass:"tig-normal-loading"});const e=await q();Lt.value=e.cartList,Nt.value=e.total,ea()}catch(e){}finally{Bt.value=!1,Pt.value.close(),Wt.value=!0}},Zt=async()=>{try{const e=[];Lt.value.forEach((t=>{t.carts.forEach((t=>{e.push({cartId:t.cartId,isChecked:t.isChecked&&!1===t.isDisabled?1:0})}))}));await N({data:e});Yt()}catch(e){}};let Ht;const Jt=e=>{Ht&&clearTimeout(Ht),Ht=setTimeout((()=>{Mt(e)}),300)},Mt=async e=>{try{await z(e.cartId,{quantity:e.quantity}),await Yt()}catch(t){console.log(t),U.error(t.message)}},Qt=()=>{let e=0;Lt.value.forEach((t=>{t.carts.forEach((t=>{1==t.isChecked&&(e+=1)}))})),0!=e?T.confirm({title:zt("确认要删除指定的商品吗"),cancelText:zt("取消"),okText:zt("确定"),maskClosable:!0,centered:!0,onOk:async()=>{try{const e=[];Lt.value.forEach((t=>{t.carts.forEach((t=>{t.isChecked&&e.push(t.cartId)}))}));await B(e);await Yt()}catch(e){}}}):U.error(zt("您还未选中任何商品"))},Xt=()=>{T.confirm({title:zt("确认要清空购物车吗？"),cancelText:zt("取消"),okText:zt("确定"),maskClosable:!0,centered:!0,onOk:async()=>{try{await L();await Yt()}catch(e){}}})},Gt=()=>{Lt.value.forEach((e=>{e.carts.forEach((e=>{e.isChecked=1==Kt.value&&!1===e.isDisabled}))})),ea(),Zt()},Kt=d(!1),ea=()=>{Lt.value.forEach((e=>{const t=e.carts.filter((e=>!e.isDisabled));e.isChecked=t.every((e=>!0===e.isChecked&&!e.isDisabled))})),Kt.value=Lt.value.every((e=>!0===e.isChecked))},ta=d(null),aa=d(!1),la=()=>{var e;const t=window.scrollY,a=window.innerHeight,l=ta.value,s=(null==(e=null==l?void 0:l.getBoundingClientRect())?void 0:e.top)+t;aa.value=!(t+a-60>s)},sa={1:"秒杀价",2:"券",3:"满减",4:"折扣",5:"满赠",6:"限时折扣"},oa=e=>{const t=[],a=e.filter((e=>2===e.type)),l=e.filter((e=>2!==e.type));return l.length>0&&t.push(l[0]),a.length>0&&t.push(a[0]),t},ia=d(!1);n((()=>{window.addEventListener("scroll",la),la()})),u((()=>{window.removeEventListener("scroll",la)}));return(o,i)=>{const c=e,d=t,n=a,u=l,q=s,z=w,L=S,N=I;return m(),r("div",P,[v(c,{title:"购物车"}),v(A,{step:1}),Bt.value||0!==Lt.value.length?p("",!0):(m(),r("div",R,[h("div",Y,[i[13]||(i[13]=h("div",{class:"left icon"},null,-1)),h("div",Z,[h("div",H,k(o.$t("您的购物车中暂时没有商品"))+"！",1),v(n,{to:"/"},{default:y((()=>[v(d,{type:"primary",size:"large",title:o.$t("马上挑选商品")},{default:y((()=>[g(k(o.$t("去逛逛")),1)])),_:1},8,["title"])])),_:1})])])])),!Bt.value&&Lt.value.length>0?(m(),r("div",J,[h("p",M,k(o.$t("你好，欢迎来到您的购物车")),1),h("div",null,[h("div",Q,[h("div",X,[h("div",G,[v(u,{modelValue:Kt.value,"onUpdate:modelValue":i[0]||(i[0]=e=>Kt.value=e),onChange:Gt},null,8,["modelValue"])]),h("div",K,k(o.$t("全选")),1),h("div",ee,k(o.$t("商品信息")),1),h("div",te,k(o.$t("单价")),1),h("div",ae,k(o.$t("数量")),1),h("div",le,k(o.$t("小计")),1),h("div",se,k(o.$t("操作")),1)])]),Lt.value?(m(!0),r(b,{key:0},V(Lt.value,((e,t)=>(m(),r("div",oe,[h("div",ie,[h("div",ce,[v(u,{modelValue:e.isChecked,"onUpdate:modelValue":t=>e.isChecked=t,onChange:t=>(e=>{e.carts.forEach((t=>{t.isChecked=1==e.isChecked})),ea(),Zt()})(e)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),h("div",de,[0==e.shopId?(m(),r("div",ne,k(o.$t("自营")),1)):x(_)()?(m(),r("div",ue,k(e.shopTitle),1)):p("",!0)])]),h("div",re,[(m(!0),r(b,null,V(e.carts,(e=>(m(),r("div",{class:j(["product-list-cart",Rt(e)?"disabled-item":""])},[h("div",me,[h("div",ve,[v(u,{modelValue:e.isChecked,"onUpdate:modelValue":t=>e.isChecked=t,onChange:i[1]||(i[1]=e=>{Zt()}),disabled:Rt(e)},null,8,["modelValue","onUpdate:modelValue","disabled"])]),h("div",pe,[h("div",fe,[0!=e.stock&&0!=e.productStatus?(m(),r("a",{key:0,target:"_blank",href:x(C)({path:"product",id:e.productId,sn:e.productSn})},[h("img",{src:("imageFormat"in o?o.imageFormat:x($))(e.picThumb),alt:""},null,8,ke)],8,he)):(m(),r("div",ye,[h("img",{src:("imageFormat"in o?o.imageFormat:x($))(e.picThumb),alt:""},null,8,ge)])),0!=e.stock&&0!=e.productStatus||1!=e.isDisabled?p("",!0):(m(),r("div",be,[0==e.stock||0==e.productStatus?(m(),r("div",Ve,k(0==e.productStatus?o.$t("已下架"):o.$t("已售罄")),1)):p("",!0)]))]),h("div",xe,[0!=e.stock&&0!=e.productStatus?(m(),r("a",{key:0,target:"_blank",href:x(C)({path:"product",id:e.productId,sn:e.productSn})},k(e.productName),9,_e)):(m(),r("p",je,k(e.productName),1)),h("div",Ce,[(m(!0),r(b,null,V(e.skuData,((e,t)=>(m(),r("span",null,k(0!==t?" , ":"")+k(e.name)+":"+k(e.value),1)))),256))]),e.extraSkuData&&e.extraSkuData.length?(m(),r("div",$e,[(m(!0),r(b,null,V(e.extraSkuData,(t=>(m(),r("div",{key:t,class:"extraskudata-item"},[h("div",we,k(t.attrName),1),i[14]||(i[14]=h("div",{class:"line-box"},[h("div",{class:"line"})],-1)),h("div",Ue,[h("span",Te,k(t.attrValue),1),v(q,{modelValue:t.attrPrice,"onUpdate:modelValue":e=>t.attrPrice=e,showText:!1},null,8,["modelValue","onUpdate:modelValue"]),h("span",De,"x"+k(e.quantity),1)])])))),128))])):p("",!0),e.activityInfo?(m(),r("div",Ee,[(m(!0),r(b,null,V(oa(e.activityInfo),(e=>(m(),r("div",{class:"promotion-box-item",key:e.promotionId},[2!=e.type?(m(),r("div",Se,[h("div",Ie,k(o.$t(sa[e.type])),1)])):p("",!0),2==e.type?(m(),r("div",Ae,[h("div",Fe,[g(k(o.$t("券")),1),i[15]||(i[15]=h("span",{class:"ticket-line"},null,-1))]),h("div",Oe,k(e.data.promotionDesc),1)])):p("",!0)])))),128))])):p("",!0)])]),h("div",qe,[h("div",ze,[v(q,{modelValue:e.price,"onUpdate:modelValue":t=>e.price=t,showText:!1},null,8,["modelValue","onUpdate:modelValue"])])]),h("div",Be,[h("div",Le,[v(F,{max:e.stock,modelValue:e.quantity,"onUpdate:modelValue":t=>e.quantity=t,onChange:t=>(e=>{Jt(e)})(e),disabled:Rt(e)},null,8,["max","modelValue","onUpdate:modelValue","onChange","disabled"])])]),h("div",Ne,[h("div",We,[v(q,{modelValue:e.subtotal,"onUpdate:modelValue":t=>e.subtotal=t,showText:!1},null,8,["modelValue","onUpdate:modelValue"])])]),h("div",Pe,[h("div",null,[h("a",{onClick:t=>{return a=e.cartId,void T.confirm({title:zt("确认要删除该商品吗"),cancelText:zt("取消"),okText:zt("确定"),maskClosable:!0,centered:!0,onOk:async()=>{try{await B([a]),Yt()}catch(e){}}});var a},style:{cursor:"pointer"}},i[16]||(i[16]=[h("i",{class:"iconfont-pc icon-shanchu"},null,-1)]),8,Re)])])]),i[17]||(i[17]=h("div",{class:"cart-line"},null,-1))],2)))),256))]),e.gift.length>0?(m(),r("div",Ye,[h("div",Ze,k(o.$t("赠品")),1),h("div",He,[(m(!0),r(b,null,V(e.gift,(e=>(m(),f(n,{key:e.giftId,target:"_blank",to:x(C)({path:"product",id:e.productId,sn:e.productSn})},{default:y((()=>[h("div",Je,[h("div",Me,[v(z,{class:"gift-img",lazy:"",src:("imageFormat"in o?o.imageFormat:x($))(e.picThumb)},null,8,["src"])]),h("div",Qe,[h("div",Xe,k(e.productName),1),e.skuData.length>0?(m(),r("div",Ge,[(m(!0),r(b,null,V(e.skuData,((e,t)=>(m(),r("div",{key:t,class:"sku-item"},k(e.value),1)))),128))])):p("",!0),h("div",Ke,"x"+k(e.num),1)])])])),_:2},1032,["to"])))),128))])])):p("",!0)])))),256)):p("",!0),h("div",{class:"checkOutBar",id:"price-total",ref_key:"checkOutBarRef",ref:ta},[h("div",{class:j({pay_tools_bar:!0,tools_bar_bottom:aa.value})},[h("div",et,[h("div",tt,[h("div",at,[v(u,{modelValue:Kt.value,"onUpdate:modelValue":i[2]||(i[2]=e=>Kt.value=e),onChange:Gt},null,8,["modelValue"])]),h("div",lt,[g(k(o.$t("全选"))+" ",1),h("div",null,[h("span",null,[g(k(o.$t("共"))+" ",1),h("span",st,k(Nt.value.totalCount),1),g(" "+k(o.$t("件")),1)])]),h("div",null,[h("a",{onClick:Qt},k(o.$t("删除勾选商品")),1)]),h("div",null,[h("a",{onClick:Xt},k(o.$t("清空购物车")),1)])])]),h("div",ot,[h("div",it,[h("div",ct,[h("p",dt,[g(k(o.$t("已选商品"))+" ",1),h("span",nt,k(Nt.value.checkedCount),1),g(" "+k(o.$t("件")),1)]),h("div",ut,[h("span",rt,k(o.$t("合计"))+"：",1),v(q,{modelValue:Nt.value.discountAfter,"onUpdate:modelValue":i[3]||(i[3]=e=>Nt.value.discountAfter=e),showText:!1},null,8,["modelValue"])])]),h("div",mt,[h("div",null,[g(k(o.$t("共优惠"))+"：",1),v(q,{modelValue:Nt.value.discounts,"onUpdate:modelValue":i[4]||(i[4]=e=>Nt.value.discounts=e),showText:!1},null,8,["modelValue"])]),v(L,{modelValue:ia.value,"onUpdate:modelValue":i[11]||(i[11]=e=>ia.value=e)},{reference:y((()=>[h("div",vt,[g(k(o.$t("优惠明细"))+" ",1),h("span",{class:j(["iconfont-pc icon-shangjiantou",{"icon-active":ia.value}])},null,2)])])),default:y((()=>[h("div",pt,[h("div",ft,[h("div",ht,k(o.$t("优惠明细")),1)]),h("div",kt,[h("div",yt,[h("div",gt,k(o.$t("商品总额")),1),h("div",bt,[v(q,{showText:!1,modelValue:Nt.value.productAmount,"onUpdate:modelValue":i[5]||(i[5]=e=>Nt.value.productAmount=e),fontStyle:{fontWeight:"bold"}},null,8,["modelValue"])])]),Nt.value.serviceFee&&Nt.value.serviceFee>0?(m(),r("div",Vt,[h("div",xt,k(o.$t("附加费用")),1),h("div",_t,[v(q,{modelValue:Nt.value.serviceFee,"onUpdate:modelValue":i[6]||(i[6]=e=>Nt.value.serviceFee=e),fontStyle:{fontWeight:"bold"},showText:!1},null,8,["modelValue"])])])):p("",!0),h("div",jt,[h("div",Ct,k(o.$t("共优惠")),1),h("div",$t,[i[18]||(i[18]=g(" - ")),v(q,{modelValue:Nt.value.discounts,"onUpdate:modelValue":i[7]||(i[7]=e=>Nt.value.discounts=e),showText:!1},null,8,["modelValue"])]),Nt.value.discountDiscountAmount>0?(m(),r("div",wt,[h("div",Ut,k(o.$t("活动优惠")),1),h("div",Tt,[i[19]||(i[19]=g(" - ")),v(q,{modelValue:Nt.value.discountDiscountAmount,"onUpdate:modelValue":i[8]||(i[8]=e=>Nt.value.discountDiscountAmount=e),showText:!1},null,8,["modelValue"])])])):p("",!0)]),Nt.value.discountCouponAmount>0?(m(),r("div",Dt,[h("div",Et,k(o.$t("优惠券")),1),h("div",St,[i[20]||(i[20]=g(" - ")),v(q,{modelValue:Nt.value.discountCouponAmount,"onUpdate:modelValue":i[9]||(i[9]=e=>Nt.value.discountCouponAmount=e),showText:!1},null,8,["modelValue"])])])):p("",!0),h("div",It,[h("div",At,k(o.$t("合计")),1),h("div",Ft,[v(q,{modelValue:Nt.value.discountAfter,"onUpdate:modelValue":i[10]||(i[10]=e=>Nt.value.discountAfter=e),fontStyle:{fontWeight:"bold"},showText:!1},null,8,["modelValue"])])]),h("div",Ot,k(o.$t("以上优惠不包含运费，实际优惠金额请以确认订单页为准")),1)])])])),_:1},8,["modelValue"])])]),h("div",{onClick:i[12]||(i[12]=e=>Nt.value.checkedCount&&(()=>{if(1===E.closeOrder)return U.error(zt("商城已关闭下单"));D("/order/check/")})()),class:j("checkout_btn hand-pointer "+(0==Nt.value.checkedCount?"disabled":""))},k(o.$t("去结算")),3)])])],2)],512)])])):p("",!0),Wt.value?(m(),f(O,{key:2,onOnBuy:Yt})):p("",!0),Bt.value?(m(),r("div",qt,i[21]||(i[21]=[h("div",null,[h("div",{style:{height:"300px",width:"100%"}})],-1)]))):p("",!0),v(N)])}}}),[["__scopeId","data-v-beaa6eb3"]]);export{zt as default};
