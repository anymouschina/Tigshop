import{_ as s}from"./DIcT5qlW.js";import{_ as a}from"./nl8XxKER.js";import{_ as t}from"./4BWvF7DS.js";import{e,G as o,r as l,z as r,y as i,n as c,ae as m,S as n,c as d,o as p,b as v,a as u,t as y,i as j,d as f,h as w,E as h,_ as g}from"./vO8z_6wc.js";import{_ as $}from"./B6kpiin_.js";import{E as k}from"./pBde3eXe.js";import"./OZUBBuO3.js";import"./duVALuQ5.js";import"./YLitFIRx.js";import{a as _,o as b,c as C}from"./D_3ms_Sp.js";import{Q as I}from"./CrMBAJkk.js";import{w as S,z as x}from"./ChzKcsu9.js";import{s as z}from"./DSXY0Md2.js";import"./DEtxbcwL.js";import"./DRy-t1KR.js";import"./Ctuj9lAE.js";import"./BG07ctRk.js";import"./y2YKyhRU.js";import"./CKVP4sCQ.js";import"./DqoL2U0I.js";import"./CdIa5lAL.js";import"./BwRzfsZt.js";import"./B0jPhJeY.js";import"./D_Dr4eZ1.js";import"./C8tVKSc2.js";const U={class:"wechat-com"},V={class:"wechat container"},q={class:"message"},A={class:"message"},B={class:"payment"},E={key:0,class:"title"},L={key:1,class:"title"},M={class:"image-div"},O={class:"left-image"},P={key:0,class:"ewm"},W={key:1,class:"ewm-empty"},D={class:"pw-box-ft"},G={key:0},J={key:1},Q={class:"right-image"},R={key:0,class:"image"},T={key:1,class:"image"},Y=g(e({__name:"yabanpay",setup(e){const g=o(),Y=l(g.query.id),Z=l(g.query.type),F=l(!0);l({});const H=l(""),K=l({}),{t:N}=r();(async()=>{try{const s=await b({id:Y.value});K.value=s.order}catch(s){c.error(s.message),m("/member/order/list/")}})();const X=l(0);let ss=null;i((()=>{(async()=>{F.value=!0;try{const s=await C({id:Y.value,type:"yabanpay_"+Z.value});ts(null==s?void 0:s.payInfo.codeUrl)}catch(s){c.error(s.message)}finally{F.value=!1}})(),ss=z((()=>{as(),X.value++,50===X.value&&(clearInterval(ss),c.error(N("支付已超时，您可以刷新页面重新支付")))}),2e3)}));const as=()=>{_({id:Y.value}).then((s=>{1==s&&(clearInterval(ss),k.confirm(N("订单支付成功"),N("提示"),{confirmButtonText:N("查看订单"),showClose:!1,showCancelButton:!1,closeOnClickModal:!1,type:"success"}).then((()=>{m("/member/order/list")})).catch((()=>{})))}))},ts=async s=>{const a=s;H.value=await I.toDataURL(a,{margin:1,width:500,height:500})},es=()=>{window.close()},os=()=>{window.location.reload()};return n((()=>{clearInterval(ss)})),(e,o)=>{const l=s,r=a,i=t,c=h,m=$;return p(),d("div",null,[v(l,{title:"YabandPay"}),v(r,{showLogin:!1}),u("div",U,[u("div",V,[u("div",q,y(e.$t("订单提交成功，请尽快付款"))+"！"+y(e.$t("订单号"))+"："+y(j(K).orderSn),1),u("div",A,[f(y(e.$t("应付金额"))+"： ",1),v(i,{modelValue:j(K).totalAmount,"onUpdate:modelValue":o[0]||(o[0]=s=>j(K).totalAmount=s),fontStyle:{color:"var(--price)",fontSize:"18px"}},null,8,["modelValue"])]),u("div",B,["wechat"==j(Z)?(p(),d("div",E,y(e.$t("微信支付")),1)):w("",!0),"alipay"==j(Z)?(p(),d("div",L,y(e.$t("支付宝支付")),1)):w("",!0),u("div",M,[u("div",O,[u("div",null,[f(y(e.$t("如果二维码已过期"))+"，"+y(e.$t("请")),1),u("span",{onClick:os,class:"font-color",style:{cursor:"pointer"}},y(e.$t("刷新")),1),f(y(e.$t("页面重新获取二维码"))+"。 ",1)]),j(X)<=50?(p(),d("div",P,[v(c,{class:"image",src:j(H)},null,8,["src"])])):(p(),d("div",W,[f(y(e.$t("已超时"))+"，",1),u("a",{class:"font-color",onClick:os},y(e.$t("点击刷新")),1)])),u("div",D,["wechat"==j(Z)?(p(),d("div",G,y(e.$t("请使用微信扫一扫")),1)):w("",!0),"alipay"==j(Z)?(p(),d("div",J,y(e.$t("请使用支付宝扫一扫")),1)):w("",!0),u("div",null,y(e.$t("扫描二维码支付")),1)])]),u("div",Q,["wechat"==j(Z)?(p(),d("div",R,[v(c,{src:j(S)},null,8,["src"])])):w("",!0),"alipay"==j(Z)?(p(),d("div",T,[v(c,{src:j(x)},null,8,["src"])])):w("",!0)])]),u("div",{onClick:es,class:"button-title"},"< "+y(e.$t("选择其他支付方式")),1)])])]),v(m,{bg:"white",mt30:!1,type:1})])}}}),[["__scopeId","data-v-1e2c7646"]]);export{Y as default};
