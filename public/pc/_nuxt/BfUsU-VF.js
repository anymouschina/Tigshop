import{_ as H}from"./uNNarvbF.js";import{_ as P}from"./BICKwAaO.js";import{E as Z}from"./lRlBa-wu.js";import{_ as O}from"./C6cR03M8.js";import{E as W,a as Y}from"./CPhr9T1V.js";import{E as G}from"./XomGKeK5.js";import{_ as J}from"./CzQrJ5jx.js";import{_ as K}from"./BCw_XNK7.js";import{f as Q,a7 as X,Y as ee,r as b,a8 as oe,s as h,o as g,c as x,b as i,a as n,t as m,w as a,h as k,j as d,i as S,d as $,$ as te,F as re,av as C,ad as se,a1 as ie,_ as le}from"./DvlzeZYf.js";import{_ as ae}from"./BDyiSPJB.js";import{s as ne,a as me}from"./Xo_P1g0Y.js";import{M as de}from"./DkrvK9R2.js";import"./D5p5RYpQ.js";import"./DGzzo1G8.js";import{u as ue}from"./ctHFjQ9z.js";import"./DrjGOYyT.js";import"./BxwJi-A4.js";import"./CvS5MqkS.js";import"./BB_Ol6Sd.js";import"./C3hftOhu.js";import"./Cq9Fpw4b.js";import"./De9iyrrl.js";import"./B9SirqjL.js";import"./eXzid_I5.js";import"./uRofAO38.js";import"./DldgdBu3.js";import"./DCTLXrZ8.js";const pe={class:"full-height-div"},_e={class:"register-info"},fe={class:"title"},ce={class:"label"},ve={class:"area-code-input"},be={key:0,class:"area-code-select"},ge={class:"label"};const we={class:"label"},ye={class:"label"},$e={class:"extra",style:{width:"330px"}},Ce=Q({__name:"Register",setup(Ee){const u=X(),T=ue(),{t:l}=ee(),E=b(!1),_=b("86"),V=oe(),B=(r,e,t)=>{e?o.value.tigTips[r]={type:"valid",message:t}:o.value.tigTips[r]={type:"error",message:t}},f=r=>{o.value.tigTips[r]={type:"info",message:M[r]}},F=(r,e,t)=>{const y=u.is_open_mobile_area_code?/^(\+?[1-9]\d{1,14})$/:/^(?:\+?86)?1[3-9]\d{9}$/;if(e)if(y.test(e))t();else return t(new Error(l("格式错误，请输入正确的手机号码")));else return t(new Error(l("手机号不能为空")))},N=(r,e,t)=>{if(e)if(/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(e))t();else return t(new Error(l("格式错误，请输入正确的邮箱地址")));else return t(new Error(l("邮箱不能为空")))},U=(r,e,t)=>{if(e){if(e.length!=6)return t(new Error(l("请输入6位验证码")));t()}else return t(new Error(l("验证码不能为空")))},q=(r,e,t)=>{if(e){if(e.length>20||e.length<6)return t(new Error(l("密码应为6-20位字符")));if(/\s/.test(e))return t(new Error(l("密码中不允许有空格")));if(/^\d+$/.test(e))return t(new Error(l("密码不能全为数字")));if(/^(?=.*[\d\W]).+$/.test(e))if(/^(?=.*[a-zA-Z0-9]).+$/.test(e))if(/^(?!([a-zA-Z0-9])\1*$).+$/.test(e))t();else return t(new Error(l("密码不能全为相同字符或数字")));else return t(new Error(l("密码不能全为符号")));else return t(new Error(l("密码不能全为字母")))}else return t(new Error(l("密码不能为空")))},M=h({mobile:l("请填写正确的手机号码，以便接收订单通知，找回密码等"),mail:l("请填写正确的邮箱地址，以便接收订单通知，找回密码等"),mobile_code:l("请输入验证码"),password:l("6-20个大小写英文字母、符号或数字的组合")}),R=h({mobile:[{validator:F,trigger:"blur",required:!0}],mail:[{validator:N,trigger:"blur",required:!0}],mobile_code:[{validator:U,trigger:"blur",required:!0}],password:[{validator:q,trigger:"blur",required:!0}]}),w=b(!1),o=b({tigTips:{},area_code:""}),A=async()=>{await V.value.validate();try{w.value=!0,o.mobile=u.is_open_mobile_area_code?_.value+o.mobile:o.mobile;const r=await me(o.value);C.success(l("注册成功"));const e=se("accessToken");e.value=r.token,T.userInfoLoaded=!1,ie("/member/")}catch(r){C.error(r.message)}finally{w.value=!1}},I=r=>{C.error(r)};return(r,e)=>{const t=H,y=P,c=Z,v=O,p=W,L=G,z=J,D=Y,j=K;return g(),x(re,null,[i(t,{title:"注册"}),i(y,{type:"register"}),n("div",pe,[n("div",_e,[n("div",fe,m(r.$t("会员注册")),1),i(D,{ref_key:"formRef",ref:V,"hide-required-asterisk":!0,model:o.value,rules:d(R),"show-message":!1,class:"form-body","label-width":"auto",onValidate:B},{default:a(()=>[o.value.regist_type==="mobile"||!o.value.regist_type?(g(),k(p,{key:0,prop:"mobile"},{default:a(()=>[n("div",ce,m(r.$t("手机号")),1),n("div",ve,[i(c,{modelValue:o.value.mobile,"onUpdate:modelValue":e[1]||(e[1]=s=>o.value.mobile=s),class:"input-border-style",onFocus:e[2]||(e[2]=s=>f("mobile"))},{prefix:a(()=>[d(u).is_open_mobile_area_code?(g(),x("div",be,[i(ae,{modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=s=>_.value=s)},null,8,["modelValue"])])):S("",!0)]),_:1},8,["modelValue"])]),i(v,{info:o.value.tigTips.mobile},null,8,["info"])]),_:1})):(g(),k(p,{key:1,prop:"mail"},{default:a(()=>[n("div",ge,m(r.$t("邮箱")),1),i(c,{modelValue:o.value.mail,"onUpdate:modelValue":e[3]||(e[3]=s=>o.value.mail=s),class:"input-border-style",onFocus:e[4]||(e[4]=s=>f("mail"))},null,8,["modelValue"]),i(v,{info:o.value.tigTips.mail},null,8,["info"])]),_:1})),S("",!0),i(p,{prop:"mobile_code"},{default:a(()=>[n("div",we,m(r.$t("验证码")),1),i(c,{modelValue:o.value.mobile_code,"onUpdate:modelValue":e[9]||(e[9]=s=>o.value.mobile_code=s),class:"input-border-style",onFocus:e[10]||(e[10]=s=>f("mobile_code"))},{suffix:a(()=>[i(d(de),{class:"mobile-code-text",mobile:d(u).is_open_mobile_area_code?_.value+o.value.mobile:o.value.mobile,mobileCode:o.value.mobile_code,"onUpdate:mobileCode":e[7]||(e[7]=s=>o.value.mobile_code=s),mobileCodeSended:E.value,"onUpdate:mobileCodeSended":e[8]||(e[8]=s=>E.value=s),requestApi:d(ne),onMobileErrorCallback:I},null,8,["mobile","mobileCode","mobileCodeSended","requestApi"])]),_:1},8,["modelValue"]),i(v,{info:o.value.tigTips.mobile_code},null,8,["info"])]),_:1}),i(p,{prop:"password"},{default:a(()=>[n("div",ye,m(r.$t("设置密码")),1),i(c,{modelValue:o.value.password,"onUpdate:modelValue":e[11]||(e[11]=s=>o.value.password=s),class:"input-border-style","show-password":"",type:"password",onFocus:e[12]||(e[12]=s=>f("password"))},null,8,["modelValue"]),i(v,{info:o.value.tigTips.password},null,8,["info"])]),_:1}),n("div",$e,[$(m(r.$t("点击注册，表示您同意"))+" ",1),i(z,{class:"font-color",target:"_blank",to:"/article/issue/info?article_sn=zcxy"},{default:a(()=>[$(" 《"+m(d(te)()?r.$t("{0}注册协议！",[d(u).shopName]):`${d(u).shopName}注册协议！`)+"》 ",1)]),_:1})]),i(p,{label:"",prop:"first_word"},{default:a(()=>[i(L,{loading:w.value,type:"primary",class:"submit-button",style:{width:"330px"},onClick:A},{default:a(()=>[$(m(r.$t("同意协议并注册")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])])]),i(j,{bg:"white",type:0})],64)}}}),Ke=le(Ce,[["__scopeId","data-v-d82141b0"]]);export{Ke as default};
