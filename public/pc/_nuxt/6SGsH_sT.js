import{_ as e}from"./9TMjRzGO.js";import{_ as l}from"./BlxdsvOv.js";import{E as o,a}from"./BucM0pco.js";import{E as s}from"./ClnUiH43.js";import{_ as r}from"./Dev7PMii.js";import{E as i,a as t}from"./Di7_rRxo.js";import{E as d}from"./CK-rvtuG.js";import{_ as m}from"./zM3V5R1F.js";import{e as u,z as p,r as n,I as b,g as c,c as v,o as f,b as _,a as w,t as g,w as j,m as y,h as E,d as V,i as $,F as h,cd as U,A as k,ae as q,_ as C}from"./BLNaUqdG.js";import"./rSOsbbvW.js";import{s as T,a as x}from"./BOgQ02OZ.js";import{M as A}from"./DNPatwbc.js";import{u as F}from"./D-E-9YUO.js";import"./DSwxsogY.js";import"./DGSQZaL6.js";import"./D_Dr4eZ1.js";import"./BWAJcOoD.js";import"./losdC6Ud.js";import"./BX08AvzU.js";import"./CxZS6lgh.js";import"./BwRzfsZt.js";import"./C8QNSlsX.js";import"./DlIXSNl1.js";import"./DxiXPFL-.js";import"./DgmxjSXK.js";import"./DSXY0Md2.js";const M={class:"full-height-div"},S={class:"register-info"},Z={class:"title"},z={class:"label"},I={class:"area-code-select"},D={class:"label"},B={class:"label"},J={class:"label"},L=C(u({__name:"BindMobilePhone",setup(u){const C=F(),{t:L}=p(),O=n(!1),P=b(),Q=(e,l,o)=>{H.value.tigTips[e]=l?{type:"valid",message:o}:{type:"error",message:o}},R=e=>{H.value.tigTips[e]={type:"info",message:W[e]}},W=c({mobile:L("请填写正确的手机号码，以便接收订单通知，找回密码等"),mail:L("请填写正确的邮箱地址，以便接收订单通知，找回密码等"),mobile_code:L("请输入验证码"),password:L("6-20个大小写英文字母、符号或数字的组合")}),Y=c({mobile:[{validator:(e,l,o)=>l?/^(?=.*\D).+$/.test(l)?o(new Error(L("格式错误，请输入正确的手机号码"))):void o():o(new Error(L("手机号不能为空"))),trigger:"blur",required:!0}],mail:[{validator:(e,l,o)=>l?/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(l)?void o():o(new Error(L("格式错误，请输入正确的邮箱地址"))):o(new Error(L("邮箱不能为空"))),trigger:"blur",required:!0}],mobile_code:[{validator:(e,l,o)=>l?6!=l.length?o(new Error(L("请输入6位验证码"))):void o():o(new Error(L("验证码不能为空"))),trigger:"blur",required:!0}],password:[{validator:(e,l,o)=>l?l.length>20||l.length<6?o(new Error(L("密码应为6-20位字符"))):/\s/.test(l)?o(new Error(L("密码中不允许有空格"))):/^\d+$/.test(l)?o(new Error(L("密码不能全为数字"))):/^(?=.*[\d\W]).+$/.test(l)?/^(?=.*[a-zA-Z0-9]).+$/.test(l)?/^(?!([a-zA-Z0-9])\1*$).+$/.test(l)?void o():o(new Error(L("密码不能全为相同字符或数字"))):o(new Error(L("密码不能全为符号"))):o(new Error(L("密码不能全为字母"))):o(new Error(L("密码不能为空"))),trigger:"blur",required:!0}]}),G=n(!1),H=n({tigTips:{},area_code:""}),K=async()=>{await P.value.validate();try{G.value=!0;const e=await x({...H.value,open_data:C.openData});U.success(L("绑定成功"));k("accessToken").value=e.token,C.userInfoLoaded=!1,q("/member/")}catch(e){U.error(e.message)}finally{G.value=!1}},N=e=>{U.error(e)};return(u,p)=>{const n=e,b=l,c=a,U=o,k=s,q=r,C=i,x=d,F=t,L=m;return f(),v(h,null,[_(n,{title:"绑定手机"}),_(b,{type:"register"}),w("div",M,[w("div",S,[w("div",Z,g(u.$t("绑定手机")),1),_(F,{ref_key:"formRef",ref:P,"hide-required-asterisk":!0,model:H.value,rules:$(Y),"show-message":!1,class:"form-body","label-width":"auto",onValidate:Q},{default:j((()=>["mobile"!==H.value.regist_type&&H.value.regist_type?(f(),y(C,{key:1,prop:"mail"},{default:j((()=>[w("div",D,g(u.$t("邮箱")),1),_(k,{modelValue:H.value.mail,"onUpdate:modelValue":p[3]||(p[3]=e=>H.value.mail=e),class:"input-border-style",onFocus:p[4]||(p[4]=e=>R("mail"))},null,8,["modelValue"]),_(q,{info:H.value.tigTips.mail},null,8,["info"])])),_:1})):(f(),y(C,{key:0,prop:"mobile"},{default:j((()=>[w("div",z,g(u.$t("手机号")),1),_(k,{modelValue:H.value.mobile,"onUpdate:modelValue":p[1]||(p[1]=e=>H.value.mobile=e),class:"input-border-style",style:{},onFocus:p[2]||(p[2]=e=>R("mobile"))},{prefix:j((()=>[w("div",I,[_(U,{modelValue:H.value.area_code,"onUpdate:modelValue":p[0]||(p[0]=e=>H.value.area_code=e),placeholder:u.$t("请选择区号")},{default:j((()=>[_(c,{label:"(+86)"+u.$t("中国"),value:""},null,8,["label"]),_(c,{label:"(+61)"+u.$t("澳洲"),value:"+61"},null,8,["label"])])),_:1},8,["modelValue","placeholder"])])])),_:1},8,["modelValue"]),_(q,{info:H.value.tigTips.mobile},null,8,["info"])])),_:1})),E("",!0),_(C,{prop:"mobile_code"},{default:j((()=>[w("div",B,g(u.$t("验证码")),1),_(k,{modelValue:H.value.mobile_code,"onUpdate:modelValue":p[10]||(p[10]=e=>H.value.mobile_code=e),class:"input-border-style",onFocus:p[11]||(p[11]=e=>R("mobile_code"))},{suffix:j((()=>[_($(A),{class:"mobile-code-text",mobile:H.value.mobile,"onUpdate:mobile":p[7]||(p[7]=e=>H.value.mobile=e),mobileCode:H.value.mobile_code,"onUpdate:mobileCode":p[8]||(p[8]=e=>H.value.mobile_code=e),mobileCodeSended:O.value,"onUpdate:mobileCodeSended":p[9]||(p[9]=e=>O.value=e),requestApi:$(T),onMobileErrorCallback:N},null,8,["mobile","mobileCode","mobileCodeSended","requestApi"])])),_:1},8,["modelValue"]),_(q,{info:H.value.tigTips.mobile_code},null,8,["info"])])),_:1}),_(C,{prop:"password"},{default:j((()=>[w("div",J,g(u.$t("设置密码")),1),_(k,{modelValue:H.value.password,"onUpdate:modelValue":p[12]||(p[12]=e=>H.value.password=e),class:"input-border-style","show-password":"",type:"password",onFocus:p[13]||(p[13]=e=>R("password"))},null,8,["modelValue"]),_(q,{info:H.value.tigTips.password},null,8,["info"])])),_:1}),_(C,{label:"",prop:"first_word"},{default:j((()=>[_(x,{loading:G.value,type:"primary",class:"submit-button",style:{width:"330px"},onClick:K},{default:j((()=>[V(g(u.$t("确认")),1)])),_:1},8,["loading"])])),_:1})])),_:1},8,["model","rules"])])]),_(L,{bg:"white",type:0})],64)}}}),[["__scopeId","data-v-f1a8910e"]]);export{L as default};
