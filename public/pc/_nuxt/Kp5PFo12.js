import{_ as e}from"./DIcT5qlW.js";import{_ as o}from"./nl8XxKER.js";import{E as l}from"./duVALuQ5.js";import{_ as a}from"./Bd89_3a4.js";import{E as s,a as r}from"./DKvZ9Rd6.js";import{E as i}from"./OZUBBuO3.js";import{_ as t}from"./DRy-t1KR.js";import{_ as d}from"./B6kpiin_.js";import{e as m,f as u,z as p,r as n,I as b,g as v,c,o as f,b as w,a as g,t as j,w as y,m as _,h as C,i as $,d as E,k as V,F as h,cd as k,A as T,ae as A,_ as x}from"./vO8z_6wc.js";import{_ as q}from"./CHbuG04u.js";import{s as M,u as U}from"./Ck8cvsow.js";import{M as F}from"./BwrAIjIS.js";import"./123WnbAt.js";import"./C_yTnQv7.js";import{u as O}from"./Ctuj9lAE.js";import"./DEtxbcwL.js";import"./CdIa5lAL.js";import"./CKVP4sCQ.js";import"./BwRzfsZt.js";import"./B0jPhJeY.js";import"./D_Dr4eZ1.js";import"./VsleDggW.js";import"./DqoL2U0I.js";import"./BG07ctRk.js";import"./y2YKyhRU.js";import"./DSXY0Md2.js";import"./DgmxjSXK.js";const S={class:"full-height-div"},z={class:"register-info"},Z={class:"title"},I={class:"label"},W={class:"area-code-input"},N={key:0,class:"area-code-select"},R={class:"label"},J={class:"label"},L={class:"label"},Q={class:"extra",style:{width:"330px"}},B=x(m({__name:"Register",setup(m){const x=u(),B=O(),{t:D}=p(),G=n(!1),H=n("86"),K=b(),P=(e,o,l)=>{le.value.tigTips[e]=o?{type:"valid",message:l}:{type:"error",message:l}},X=e=>{le.value.tigTips[e]={type:"info",message:Y[e]}},Y=v({mobile:D("请填写正确的手机号码，以便接收订单通知，找回密码等"),mail:D("请填写正确的邮箱地址，以便接收订单通知，找回密码等"),mobileCode:D("请输入验证码"),password:D("6-20个大小写英文字母、符号或数字的组合")}),ee=v({mobile:[{validator:(e,o,l)=>{const a=x.isOpenMobileAreaCode?/^(\+?[1-9]\d{1,14})$/:/^(?:\+?86)?1[3-9]\d{9}$/;return o?a.test(o)?void l():l(new Error(D("格式错误，请输入正确的手机号码"))):l(new Error(D("手机号不能为空")))},trigger:"blur",required:!0}],mail:[{validator:(e,o,l)=>o?/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(o)?void l():l(new Error(D("格式错误，请输入正确的邮箱地址"))):l(new Error(D("邮箱不能为空"))),trigger:"blur",required:!0}],mobileCode:[{validator:(e,o,l)=>o?6!=o.length?l(new Error(D("请输入6位验证码"))):void l():l(new Error(D("验证码不能为空"))),trigger:"blur",required:!0}],password:[{validator:(e,o,l)=>o?o.length>20||o.length<6?l(new Error(D("密码应为6-20位字符"))):/\s/.test(o)?l(new Error(D("密码中不允许有空格"))):/^\d+$/.test(o)?l(new Error(D("密码不能全为数字"))):/^(?=.*[\d\W]).+$/.test(o)?/^(?=.*[a-zA-Z0-9]).+$/.test(o)?/^(?!([a-zA-Z0-9])\1*$).+$/.test(o)?void l():l(new Error(D("密码不能全为相同字符或数字"))):l(new Error(D("密码不能全为符号"))):l(new Error(D("密码不能全为字母"))):l(new Error(D("密码不能为空"))),trigger:"blur",required:!0}]}),oe=n(!1),le=n({tigTips:{},areaCode:""}),ae=async()=>{await K.value.validate();try{oe.value=!0;const e=await U({...le.value,mobile:x.isOpenMobileAreaCode?H.value+le.value.mobile:le.value.mobile});k.success(D("注册成功"));T("accessToken").value=e.token,B.userInfoLoaded=!1,A("/member/")}catch(e){k.error(e.message)}finally{oe.value=!1}},se=e=>{k.error(e)};return(m,u)=>{const p=e,n=o,b=l,v=a,k=s,T=i,A=t,U=r,O=d;return f(),c(h,null,[w(p,{title:"注册"}),w(n,{type:"register"}),g("div",S,[g("div",z,[g("div",Z,j(m.$t("会员注册")),1),w(U,{ref_key:"formRef",ref:K,"hide-required-asterisk":!0,model:le.value,rules:$(ee),"show-message":!1,class:"form-body","label-width":"auto",onValidate:P},{default:y((()=>["mobile"!==le.value.registType&&le.value.registType?(f(),_(k,{key:1,prop:"mail"},{default:y((()=>[g("div",R,j(m.$t("邮箱")),1),w(b,{modelValue:le.value.mail,"onUpdate:modelValue":u[3]||(u[3]=e=>le.value.mail=e),class:"input-border-style",onFocus:u[4]||(u[4]=e=>X("mail"))},null,8,["modelValue"]),w(v,{info:le.value.tigTips.mail},null,8,["info"])])),_:1})):(f(),_(k,{key:0,prop:"mobile"},{default:y((()=>[g("div",I,j(m.$t("手机号")),1),g("div",W,[w(b,{modelValue:le.value.mobile,"onUpdate:modelValue":u[1]||(u[1]=e=>le.value.mobile=e),class:"input-border-style",onFocus:u[2]||(u[2]=e=>X("mobile"))},{prefix:y((()=>[$(x).isOpenMobileAreaCode?(f(),c("div",N,[w(q,{modelValue:H.value,"onUpdate:modelValue":u[0]||(u[0]=e=>H.value=e)},null,8,["modelValue"])])):C("",!0)])),_:1},8,["modelValue"])]),w(v,{info:le.value.tigTips.mobile},null,8,["info"])])),_:1})),C("",!0),w(k,{prop:"mobileCode"},{default:y((()=>[g("div",J,j(m.$t("验证码")),1),w(b,{modelValue:le.value.mobileCode,"onUpdate:modelValue":u[9]||(u[9]=e=>le.value.mobileCode=e),class:"input-border-style",onFocus:u[10]||(u[10]=e=>X("mobileCode"))},{suffix:y((()=>[w($(F),{class:"mobile-code-text",mobile:$(x).isOpenMobileAreaCode?H.value+le.value.mobile:le.value.mobile,mobileCode:le.value.mobileCode,"onUpdate:mobileCode":u[7]||(u[7]=e=>le.value.mobileCode=e),mobileCodeSended:G.value,"onUpdate:mobileCodeSended":u[8]||(u[8]=e=>G.value=e),requestApi:$(M),onMobileErrorCallback:se},null,8,["mobile","mobileCode","mobileCodeSended","requestApi"])])),_:1},8,["modelValue"]),w(v,{info:le.value.tigTips.mobileCode},null,8,["info"])])),_:1}),w(k,{prop:"password"},{default:y((()=>[g("div",L,j(m.$t("设置密码")),1),w(b,{modelValue:le.value.password,"onUpdate:modelValue":u[11]||(u[11]=e=>le.value.password=e),class:"input-border-style","show-password":"",type:"password",onFocus:u[12]||(u[12]=e=>X("password"))},null,8,["modelValue"]),w(v,{info:le.value.tigTips.password},null,8,["info"])])),_:1}),g("div",Q,[E(j(m.$t("点击注册，表示您同意"))+" ",1),w(A,{class:"font-color",target:"_blank",to:"/article/issue/info?articleSn=zcxy"},{default:y((()=>[E(" 《"+j($(V)()?m.$t("{0}注册协议！",[$(x).shopName]):`${$(x).shopName}注册协议！`)+"》 ",1)])),_:1})]),w(k,{label:"",prop:"firstWord"},{default:y((()=>[w(T,{loading:oe.value,type:"primary",class:"submit-button",style:{width:"330px"},onClick:ae},{default:y((()=>[E(j(m.$t("同意协议并注册")),1)])),_:1},8,["loading"])])),_:1})])),_:1},8,["model","rules"])])]),w(O,{bg:"white",type:0})],64)}}}),[["__scopeId","data-v-14431d29"]]);export{B as default};
