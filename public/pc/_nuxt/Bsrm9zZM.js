import{b as T,a as G}from"./DXZCNwre.js";import{E as J,a as O}from"./CPhr9T1V.js";import{E as P}from"./lRlBa-wu.js";import{E as X}from"./XomGKeK5.js";import{E as Y}from"./BMKQ3sGo.js";import{f as z,Y as H,r as V,v as $,a8 as K,o as w,c as L,a as h,J as M,b as l,w as o,d as f,t as v,h as k,a5 as Q,ai as W,j as _,i as F,F as Z,m as E,_ as x}from"./DvlzeZYf.js";import"./DEXPT9kT.js";import{u as ee,a as ae}from"./B61SGmBV.js";import"./BB_Ol6Sd.js";import"./BxwJi-A4.js";import"./CvS5MqkS.js";import"./B9SirqjL.js";import"./Cq9Fpw4b.js";import"./De9iyrrl.js";import"./C3hftOhu.js";import"./DCTLXrZ8.js";import"./BpsRniw3.js";const te={class:"dialog-footer"},le=z({__name:"InfoCard",props:{act:{type:String,default:""},id:{type:Number,default:0},type:{type:Number,default:1},page:{type:Number,default:1}},emits:["loadFilter"],setup(g,{emit:C}){const{t:n}=H(),N=C,i=g,a=V({account_type:1}),m=V(!0),y=$(()=>{switch(a.value.account_type){case 1:return n("银行卡");case 2:return n("支付宝");case 3:return n("微信");default:return""}}),I=async()=>{await s.value.resetFields()},R=$(()=>[{required:!0,message:n("请输入身份证号"),trigger:"blur"},{validator:(e,t,u)=>{/^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}([0-9]|X)$/.test(t)?u():u(new Error(n("请输入正确的身份证号码")))},trigger:"blur"}]),B=$(()=>[{required:!0,message:n("请输入")+y.value+n("号"),trigger:"blur"},{validator:(e,t,u)=>{!/^\d{6,}$/.test(t)&&a.value.account_type===1?u(new Error(n("请输入正确的银行卡号"))):u()},trigger:"blur"}]),s=K(),S=async()=>{await s.value.validate();try{const e=await ee({...a.value},i.act=="add"?"create_account":"update_account");await s.value.resetFields(),E.success(e.message),c.value=!1,a.value.account_type=1,N("loadFilter")}catch(e){E.error(e.message)}finally{}},U=async()=>{try{m.value=!0;const e=await ae({account_id:i.id});Object.assign(a.value,e.account_detail)}catch(e){E.error(e.message)}finally{m.value=!1}},c=V(!1),q=async()=>{c.value=!0,s.value&&await s.value.resetFields(),a.value.account_type=i.type,i.act=="edit"?await U():m.value=!1};return(e,t)=>{const u=T,b=G,d=J,p=P,D=O,j=X,A=Y;return w(),L(Z,null,[h("span",{class:"cu",onClick:q},[M(e.$slots,"default",{},void 0,!0)]),l(A,{modelValue:c.value,"onUpdate:modelValue":t[5]||(t[5]=r=>c.value=r),title:g.act=="add"?e.$t("新增卡片"):e.$t("编辑卡片"),width:"600"},{footer:o(()=>[h("div",te,[l(j,{type:"primary",onClick:S},{default:o(()=>[f(v(e.$t("保存")),1)]),_:1})])]),default:o(()=>[m.value?F("",!0):(w(),k(D,{key:0,ref_key:"formRef",ref:s,model:a.value,class:"form-body","label-suffix":"：","label-width":"auto"},{default:o(()=>[Q(l(d,{rules:[{required:!0,message:e.$t("请选择卡类型")}],label:e.$t("卡类型")},{default:o(()=>[l(b,{modelValue:a.value.account_type,"onUpdate:modelValue":t[0]||(t[0]=r=>a.value.account_type=r),onChange:I},{default:o(()=>[l(u,{value:1},{default:o(()=>[f(v(e.$t("银行卡")),1)]),_:1}),l(u,{value:2},{default:o(()=>[f(v(e.$t("支付宝")),1)]),_:1}),l(u,{value:3},{default:o(()=>[f(v(e.$t("微信")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["rules","label"]),[[W,g.page]]),l(d,{rules:[{required:!0,message:e.$t("请输入真实姓名")}],label:e.$t("真实姓名"),prop:"account_name"},{default:o(()=>[l(p,{modelValue:a.value.account_name,"onUpdate:modelValue":t[1]||(t[1]=r=>a.value.account_name=r),placeholder:e.$t("请输入真实姓名")},null,8,["modelValue","placeholder"])]),_:1},8,["rules","label"]),l(d,{rules:_(R),label:e.$t("身份证号"),prop:"identity"},{default:o(()=>[l(p,{modelValue:a.value.identity,"onUpdate:modelValue":t[2]||(t[2]=r=>a.value.identity=r),maxlength:"18",placeholder:e.$t("请输入身份证号")},null,8,["modelValue","placeholder"])]),_:1},8,["rules","label"]),l(d,{label:_(y)+e.$t("号"),rules:_(B),prop:"account_no"},{default:o(()=>[l(p,{modelValue:a.value.account_no,"onUpdate:modelValue":t[3]||(t[3]=r=>a.value.account_no=r),placeholder:e.$t("请输入")+_(y)},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),a.value.account_type===1?(w(),k(d,{key:0,label:e.$t("银行卡详情"),prop:"bank_name"},{default:o(()=>[l(p,{modelValue:a.value.bank_name,"onUpdate:modelValue":t[4]||(t[4]=r=>a.value.bank_name=r),rows:4,placeholder:e.$t("请输入银行卡详情"),type:"textarea"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):F("",!0)]),_:1},8,["model"]))]),_:1},8,["modelValue","title"])],64)}}}),$e=x(le,[["__scopeId","data-v-b1e85870"]]);export{$e as default};
