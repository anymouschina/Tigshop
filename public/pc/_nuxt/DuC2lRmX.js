import{E as e}from"./duVALuQ5.js";import{E as a}from"./OZUBBuO3.js";import{_ as t}from"./Blg26O5T.js";import{_ as l}from"./DRy-t1KR.js";import{e as s,z as o,r as i,g as r,cS as d,y as n,c as u,o as c,h as m,a as p,aa as y,F as v,l as k,v as f,t as b,b as h,w as g,d as w,i as _,q as $,E as S,j as x,m as I,n as T,ai as C,ae as V,_ as z}from"./vO8z_6wc.js";import{_ as j}from"./4BWvF7DS.js";import{E as A}from"./C0xcqOw0.js";import{v as N}from"./CxvT33_f.js";import"./C_yTnQv7.js";import{g as P,c as U,d as O,r as E,a as F,b as L}from"./DrvtNMlR.js";import{P as R}from"./DGiXcmvN.js";import{L as q}from"./DuT7nVv0.js";const H={class:"order-list"},M={key:0,class:"tag-and-input"},Q={class:"tig-tabs"},J=["onClick"],X={key:0},Z={class:"input"},B={class:"order-title"},D={class:"ul"},G={style:{width:"23%"}},K={style:{width:"28%"}},W={key:1,style:{width:"49%"}},Y={style:{width:"6%"}},ee={style:{width:"12%"}},ae={style:{width:"14%"}},te={style:{width:"12%"}},le={class:"order-table"},se={colspan:"4",class:"order-table-title"},oe={class:"font-color"},ie={key:0,style:{"margin-left":"30px"}},re={class:"font-color"},de={style:{"margin-left":"30px"}},ne={class:"order-tr"},ue={class:"column-1"},ce={class:"text-ellipsis"},me={style:{color:"#aaa"}},pe={class:"column-2-4"},ye={class:"black"},ve={class:"money"},ke={class:"column-2-4"},fe={class:"black"},be={key:0,class:"black"},he={style:{cursor:"pointer"}},ge={class:"column-2-4"},we={key:0},_e=["onClick"],$e=["onClick"],Se={key:3,class:"mb10"},xe={key:4,class:"mb10"},Ie={key:5,class:"mb10"},Te={key:6,class:"mb10"},Ce={key:7,class:"mb10"},Ve={class:"el-page"},ze={key:1,class:"no-result"},je={key:0},Ae={key:1},Ne={style:{"font-size":"12px"}},Pe=z(s({__name:"MemberOrderList",props:{modelValue:{type:Number,default:1}},emits:["change"],setup(s,{emit:z}){const{t:Pe}=o(),Ue=i([]),Oe=i(!0),Ee=i(0),Fe=r({page:1,sortField:"addTime",sortOrder:"desc",keyword:"",payStatus:-1,dateType:1}),Le=d(),Re=i("all"),qe=r([{type:"all",value:"全部订单",num:0},{type:"awaitPay",value:"待支付",num:0},{type:"awaitShipping",value:"待发货",num:0},{type:"awaitReceived",value:"待收货",num:0},{type:"awaitComment",value:"待评价",num:0}]),He=e=>{Fe.page=1,Fe.orderStatus=-1,Fe.commentStatus=-1,"awaitPay"===e?Fe.orderStatus=0:"awaitShipping"===e?Fe.orderStatus=1:"awaitReceived"===e?Fe.orderStatus=2:"awaitComment"===e&&(Fe.commentStatus=0),Re.value=e,Je()},Me=async()=>{Oe.value=!0;try{const e=await P();qe.forEach((a=>{let t=e;void 0!==t[a.type]&&(a.num=t[a.type])}))}catch(e){T.error(e.message)}finally{Oe.value=!1}};r([{value:-1,label:"交易状态"},{value:0,label:"未支付"},{value:2,label:"已支付"}]);const Qe=r([{value:0,label:"全部订单"},{value:1,label:"最近三个月订单"},{value:2,label:"最近六个月订单"},{value:3,label:"最近一年内订单"}]),Je=async()=>{Oe.value=!0;try{Ee.value=0;const e=await L({...Fe});Ue.value=e.records,Ee.value=e.total}catch(e){T.error(e.message)}finally{Oe.value=!1}};return n((()=>{Me().then((()=>{He(Le.query.type||"all"),Je()}))})),(o,i)=>{const r=e,d=a,n=t,z=l,P=S,L=j,Le=A,Xe=N;return c(),u("div",H,[s.modelValue?(c(),u("div",M,[p("div",Q,[(c(!0),u(v,null,k(qe,(e=>(c(),u("div",{class:f([Re.value==e.type?"active":"","tab"]),onClick:a=>He(e.type)},[e.num?(c(),u("span",X,b(e.num),1)):m("",!0),p("p",null,b(o.$t(e.value)),1)],10,J)))),256))]),p("div",Z,[h(r,{modelValue:Fe.keyword,"onUpdate:modelValue":i[0]||(i[0]=e=>Fe.keyword=e),placeholder:o.$t("收货人名称或订单号"),type:"text"},null,8,["modelValue","placeholder"]),h(d,{class:"ml10",onClick:i[1]||(i[1]=e=>Je())},{default:g((()=>[w(b(o.$t("搜索")),1)])),_:1})])])):m("",!0),p("div",B,[p("div",D,[s.modelValue?(c(),u(v,{key:0},[p("div",G,[h(n,{modelValue:Fe.dateType,"onUpdate:modelValue":i[2]||(i[2]=e=>Fe.dateType=e),selectList:Qe,onLoadFilter:Je},null,8,["modelValue","selectList"])]),p("div",K,b(o.$t("商品名称")),1)],64)):(c(),u("div",W,b(o.$t("商品名称")),1)),p("div",Y,b(o.$t("数量")),1),i[5]||(i[5]=p("div",{style:{width:"7%"}},null,-1)),p("div",ee,b(o.$t("金额")),1),p("div",ae,b(o.$t("交易状态")),1),p("div",te,b(o.$t("操作")),1)])]),y((c(),u("div",null,[Ee.value>0?(c(),u(v,{key:0},[(c(!0),u(v,null,k(Ue.value,((e,a)=>{var t,l,s;return c(),u("table",le,[p("thead",null,[p("tr",null,[p("th",se,[w(b(o.$t("订单号"))+"：",1),h(z,{to:"/member/order/info?id="+e.orderId,target:"_blank"},{default:g((()=>[p("span",oe,b(e.orderSn),1)])),_:2},1032,["to"]),e.shop&&e.shop.shopTitle?(c(),u("span",ie,[w(b(o.$t("下单店铺"))+"：",1),h(z,{to:_($)({path:"shop",id:e.shopId}),target:"_blank"},{default:g((()=>[p("span",re,b(e.shop.shopTitle),1)])),_:2},1032,["to"])])):m("",!0),p("span",de,b(o.$t("下单时间"))+"："+b(e.addTime),1)])])]),p("tbody",null,[p("tr",ne,[p("td",ue,[(c(!0),u(v,null,k(e.items,(e=>(c(),u("div",null,[h(z,{title:e.productName,to:_($)({path:"product",id:e.productId,sn:e.productSn}),class:"nuxt",target:"_blank"},{default:g((()=>[h(P,{src:("imageFormat"in o?o.imageFormat:_(x))(e.picThumb),loading:"lazy",style:{height:"40px",width:"40px",transition:"opacity 0.2s linear","flex-shrink":"0"}},null,8,["src"]),p("div",null,[p("div",ce,b(e.productName),1)])])),_:2},1032,["title","to"]),p("div",me,"X"+b(e.quantity),1),i[6]||(i[6]=p("div",null,null,-1))])))),256))]),p("td",pe,[p("div",null,[p("div",null,[w(b(o.$t("总额"))+": ",1),h(L,{modelValue:e.totalAmount,"onUpdate:modelValue":a=>e.totalAmount=a,showText:!1},null,8,["modelValue","onUpdate:modelValue"])]),0==e.orderStatus&&e.unpaidAmount>0?(c(),u(v,{key:0},[p("div",ye,b(o.$t("应付")),1),p("div",ve,[h(L,{modelValue:e.unpaidAmount,"onUpdate:modelValue":a=>e.unpaidAmount=a,showText:!1},null,8,["modelValue","onUpdate:modelValue"])])],64)):m("",!0),p("div",null,b(1===e.payTypeId?o.$t("在线支付"):2===e.payTypeId?o.$t("货到付款"):o.$t("线下支付")),1)])]),p("td",ke,[p("div",null,[p("div",{class:f({orange:0===e.orderStatus,black:1===e.orderStatus||2===e.orderStatus||4===e.orderStatus,gray:3===e.orderStatus,green:5===e.orderStatus})},b(e.orderStatusName),3),p("div",fe,[h(z,{to:"/member/order/info?id="+e.orderId,target:"_blank"},{default:g((()=>[w(b(o.$t("订单详情")),1)])),_:2},1032,["to"])]),2!=e.orderStatus&&5!=e.orderStatus||1!=e.shippingMethod?m("",!0):(c(),u("div",be,[h(Le,{width:600,placement:"bottom",onShow:a=>e.showPopover=!0,onHide:a=>e.showPopover=!1},{reference:g((()=>[p("span",he,[p("i",null,b(o.$t("物流跟踪")),1),i[7]||(i[7]=p("i",{style:{"font-size":"12px"},class:"iconfont-pc icon-xiajiantou1"},null,-1))])])),default:g((()=>[e.showPopover?(c(),I(q,{key:0,trackingNo:e.trackingNo,logisticsName:e.logisticsName,id:e.orderId},null,8,["trackingNo","logisticsName","id"])):m("",!0)])),_:2},1032,["onShow","onHide"])]))])]),p("td",ge,[p("div",null,[e.availableActions.toPay?(c(),u("div",we,[h(z,{to:"/order/pay/?id="+e.orderId,target:"_balnk"},{default:g((()=>[h(d,{size:"small",type:"primary"},{default:g((()=>[w(b(o.$t("付款")),1)])),_:1})])),_:2},1032,["to"])])):m("",!0),e.availableActions.cancelOrder?(c(),u("a",{key:1,onClick:a=>(async e=>{C.confirm({title:Pe("确认要取消该订单吗"),cancelText:Pe("取消"),okText:Pe("确定"),maskClosable:!0,centered:!0,onOk:async()=>{try{await U({id:e}),T.success(Pe("取消成功")),await Je(),await Me()}catch(a){T.error(a.message)}}})})(e.orderId)},b(o.$t("取消订单")),9,_e)):m("",!0),e.availableActions.delOrder?(c(),u("a",{key:2,onClick:a=>(async e=>{C.confirm({title:Pe("确认要删除该订单吗"),cancelText:Pe("取消"),okText:Pe("确定"),maskClosable:!0,centered:!0,onOk:async()=>{try{await O({id:e}),T.success(Pe("删除成功")),await Je(),await Me()}catch(a){T.error(a.message)}}})})(e.orderId)},b(o.$t("删除")),9,$e)):m("",!0),e.availableActions.confirmReceipt?(c(),u("div",Se,[h(d,{type:"primary",size:"small",onClick:a=>(async e=>{C.confirm({title:Pe("确认要收货吗"),cancelText:Pe("取消"),okText:Pe("确定"),maskClosable:!0,centered:!0,onOk:async()=>{try{await F({id:e}),Je(),Me()}catch(a){T.error(a.message)}}})})(e.orderId)},{default:g((()=>[w(b(o.$t("确认收货")),1)])),_:2},1032,["onClick"])])):m("",!0),e.availableActions.toAftersales?(c(),u("div",xe,[h(z,{to:"/member/return/info/?orderId="+e.orderId},{default:g((()=>[h(d,{size:"small"},{default:g((()=>[w(b(o.$t("申请售后")),1)])),_:1})])),_:2},1032,["to"])])):m("",!0),e.items&&(null==(t=e.items[0])?void 0:t.aftersalesItem)?(c(),u("div",Ie,[h(z,{to:"/member/return/logInfo?id="+(null==(s=null==(l=e.items[0])?void 0:l.aftersalesItem)?void 0:s.aftersaleId)},{default:g((()=>[h(d,{size:"small"},{default:g((()=>[w(b(o.$t("售后详情")),1)])),_:1})])),_:2},1032,["to"])])):m("",!0),e.availableActions.rebuy?(c(),u("div",Te,[h(d,{size:"small",onClick:a=>(async e=>{try{return await E({id:e}),T.success("正在跳转中，请稍后~"),void setTimeout((function(){V("/order/check")}),1500)}catch(a){T.error(a.message)}})(e.orderId)},{default:g((()=>[w(b(o.$t("再次购买")),1)])),_:2},1032,["onClick"])])):m("",!0),e.availableActions.toComment?(c(),u("div",Ce,[h(z,{to:"/member/comment/info/?id="+e.orderId},{default:g((()=>[h(d,{size:"small"},{default:g((()=>[w(b(o.$t("去评价")),1)])),_:1})])),_:2},1032,["to"])])):m("",!0)])])])])])})),256)),p("div",Ve,[h(_(R),{page:Fe.page,"onUpdate:page":i[3]||(i[3]=e=>Fe.page=e),size:Fe.size,"onUpdate:size":i[4]||(i[4]=e=>Fe.size=e),total:Ee.value,onCallback:Je},null,8,["page","size","total"])])],64)):(c(),u("div",ze,[Oe.value?m("",!0):(c(),u("div",je,i[8]||(i[8]=[p("span",{class:"sign sign1"},null,-1)]))),Oe.value?m("",!0):(c(),u("div",Ae,[p("ul",null,[p("li",null,b(o.$t("当前筛选下还没有任何订单哦")),1),p("li",Ne,[w(b(o.$t("现在就去"))+"： ",1),h(z,{class:"font-color",to:"/"},{default:g((()=>[w(b(o.$t("选购商品")),1)])),_:1})])])]))]))])),[[Xe,Oe.value]])])}}}),[["__scopeId","data-v-1251a4b0"]]);export{Pe as _};
