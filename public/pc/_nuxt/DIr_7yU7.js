import{_ as s}from"./9TMjRzGO.js";import{_ as a}from"./BlxdsvOv.js";import{_ as t}from"./CScYj7Fy.js";import{e as o,G as e,r as i,z as l,y as r,n as c,ae as m,S as n,c as d,o as p,b as u,a as v,t as j,d as f,i as w,E as y,_ as h}from"./BLNaUqdG.js";import{_ as g}from"./zM3V5R1F.js";import{E as _}from"./C8IqyEYy.js";import"./CK-rvtuG.js";import"./ClnUiH43.js";import"./CQcoTD7x.js";import{Q as $}from"./CtheyMuC.js";import{e as b,f as k,d as C}from"./fH7NBuZy.js";import{s as x}from"./DSXY0Md2.js";import"./DSwxsogY.js";import"./DGSQZaL6.js";import"./D-E-9YUO.js";import"./DlIXSNl1.js";import"./DxiXPFL-.js";import"./losdC6Ud.js";import"./C8QNSlsX.js";import"./BWAJcOoD.js";import"./BwRzfsZt.js";import"./CxZS6lgh.js";import"./D_Dr4eZ1.js";import"./D5ZJ33IS.js";const I={class:"wechat-com"},S={class:"wechat container"},V={class:"message"},q={class:"message"},z={class:"payment"},B={class:"title"},E={class:"image-div"},L={class:"left-image"},M={key:0,class:"ewm"},O={key:1,class:"ewm-empty"},U={class:"pw-box-ft"},D=h(o({__name:"wechat",setup(o){const h=e(),D=i(h.query.id),G=i(!0);i({});const J=i(""),P=i({});(async()=>{try{const s=await k({order_id:D.value});P.value=s.order}catch(s){c.error(s.message),m("/member/account/deposit/")}})();const{t:Q}=l(),R=i(0);let T=null;r((()=>{(async()=>{G.value=!0;try{const s=await C({id:D.value,type:"wechat"});await Z(null==s?void 0:s.pay_info.code_url)}catch(s){c.error(s.message)}finally{G.value=!1}})(),T=x((()=>{Y(),R.value++,50===R.value&&(clearInterval(T),c.error(Q("支付已超时，您可以刷新页面重新支付")))}),2e3)}));const Y=()=>{b({id:D.value}).then((s=>{1==s.pay_status&&(clearInterval(T),_.confirm(Q("充值成功"),Q("提示"),{confirmButtonText:Q("查看充值详情"),showClose:!1,showCancelButton:!1,closeOnClickModal:!1,type:"success"}).then((()=>{m("/member/account/log")})).catch((()=>{})))}))},Z=async s=>{const a=s;J.value=await $.toDataURL(a,{margin:1,width:500,height:500})},A=()=>{window.close()},F=()=>{window.location.reload()};return n((()=>{clearInterval(T)})),(o,e)=>{const i=s,l=a,r=t,c=y,m=g;return p(),d("div",null,[u(i,{title:"微信支付"}),u(l,{showLogin:!1}),v("div",I,[v("div",S,[v("div",V,j(o.$t("订单提交成功，请尽快付款")),1),v("div",q,[f(j(o.$t("应付金额"))+"： ",1),u(r,{modelValue:w(P).amount,"onUpdate:modelValue":e[0]||(e[0]=s=>w(P).amount=s),fontStyle:{color:"var(--price)",fontSize:"18px"}},null,8,["modelValue"])]),v("div",z,[v("div",B,j(o.$t("微信支付")),1),v("div",E,[v("div",L,[v("div",null,[f(j(o.$t("如果二维码已过期"))+"，",1),v("span",{onClick:F,class:"font-color",style:{cursor:"pointer"}},j(o.$t("刷新")),1),f(j(o.$t("重新获取二维码"))+"。 ",1)]),w(R)<=50?(p(),d("div",M,[u(c,{class:"image",src:w(J)},null,8,["src"])])):(p(),d("div",O,[f(j(o.$t("已超时"))+"，",1),v("a",{class:"font-color",onClick:F},j(o.$t("点击刷新")),1)])),v("div",U,[v("div",null,j(o.$t("请使用微信扫一扫")),1),v("div",null,j(o.$t("扫描二维码支付")),1)])]),e[1]||(e[1]=v("div",{class:"right-image"},[v("div",{class:"image"})],-1))]),v("div",{onClick:A,class:"button-title"},"< "+j(o.$t("选择其他支付方式")),1)])])]),u(m,{bg:"white",mt30:!1,type:1})])}}}),[["__scopeId","data-v-889ba185"]]);export{D as default};
