import{E as e}from"./CttV6g0d.js";import{_ as o}from"./CScYj7Fy.js";import{_ as l}from"./DGSQZaL6.js";import{v as s}from"./C8qdh5cF.js";import{e as a,cc as n,cb as u,r as c,g as i,Q as d,c as t,o as p,a as v,h as m,b as _,w as r,t as y,aa as b,F as f,l as g,v as k,d as h,_ as V}from"./BLNaUqdG.js";import"./BWAJcOoD.js";import"./losdC6Ud.js";import"./BwRzfsZt.js";import"./D_Dr4eZ1.js";import"./C8QNSlsX.js";import"./D-E-9YUO.js";const $={class:"from"},U={class:"check-box"},C={class:"tit"},j={key:0,class:"from_list"},I={class:"coupon-box"},L={key:0,class:"coupon_list"},M=["onClick"],x={class:"item-selected-cancel"},N={key:0,class:"priceNum"},w={key:0,class:"coupon-globle"},z={key:1,class:"zk"},B={key:0,class:"coupon-globle"},E={class:"time"},F={class:"detail"},J={key:2,class:"coupon-notice"},P={key:3,class:"coupon-notice"},Q={class:"item-selected-cancel"},Z={key:0,class:"priceNum"},q={key:0,class:"coupon-globle"},A={key:1,class:"zk"},D={key:0,class:"coupon-globle"},G={class:"time"},H={class:"detail"},K={key:2,class:"coupon-notice"},O={key:3,class:"coupon-notice"},R={key:1,class:"no-cou"},S=V(a({__name:"CouponInfo",props:{useCoupon:{type:Boolean},useCouponModifiers:{},couponList:{},couponListModifiers:{},couponLoading:{},couponLoadingModifiers:{},selectedIds:{},selectedIdsModifiers:{},selectedUserCouponIds:{},selectedUserCouponIdsModifiers:{}},emits:n(["change"],["update:useCoupon","update:couponList","update:couponLoading","update:selectedIds","update:selectedUserCouponIds"]),setup(a,{emit:n}){const V=n,S=u(a,"useCoupon"),T=u(a,"couponList"),W=u(a,"couponLoading"),X=c(0);i(["商品优惠券","优惠码兑换"]);const Y=()=>{!1===S.value?(ee.value=[],oe.value=[],V("change")):V("change",!0)},ee=u(a,"selectedIds"),oe=u(a,"selectedUserCouponIds"),le=c([]);d(T,(e=>{e&&e.enable_coupons&&(le.value=e.enable_coupons.filter((e=>e.selected)))}),{deep:!0,immediate:!0});const se=e=>{const o=Number(e.user_coupon_id);if(l=o,oe.value&&oe.value.includes(l))le.value=le.value.filter((e=>e.user_coupon_id!==o));else{if(le.value.find((o=>o.shop_id===e.shop_id)))le.value=le.value.filter((o=>o.shop_id!==e.shop_id));else{le.value.find((o=>o.id===e.id))&&(le.value=le.value.filter((o=>o.id!==e.id)))}le.value.push(e)}var l;ee.value=le.value.map((({id:e})=>Number(e))),oe.value=le.value.map((({user_coupon_id:e})=>Number(e))),V("change")};return(a,n)=>{var u,c,i,d;const V=e,ee=o,oe=l,le=s;return p(),t("div",null,[v("div",$,[v("div",U,[_(V,{modelValue:S.value,"onUpdate:modelValue":n[0]||(n[0]=e=>S.value=e),onChange:Y},{default:r((()=>[v("div",C,y(a.$t("使用优惠券")),1)])),_:1},8,["modelValue"])])]),S.value?(p(),t("div",j,[n[10]||(n[10]=v("div",{class:"arrow"},null,-1)),v("div",I,[m("",!0),b((p(),t("div",null,[0==X.value?(p(),t("div",L,[T.value&&((null==(u=T.value)?void 0:u.enable_coupons.length)>0||(null==(c=T.value)?void 0:c.disable_coupons.length)>0)?(p(),t(f,{key:0},[(null==(i=T.value)?void 0:i.enable_coupons.length)>0?(p(!0),t(f,{key:0},g(T.value.enable_coupons,((e,o)=>(p(),t("div",{class:k(["coupon_item hand-pointer",{active:e.selected}]),type:"checkbox",onClick:o=>se(e)},[n[3]||(n[3]=v("div",{class:"c-top-dong"},null,-1)),v("div",x,y(a.$t("取消勾选")),1),1==e.coupon_type?(p(),t("div",N,[_(ee,{modelValue:e.coupon_money,"onUpdate:modelValue":o=>e.coupon_money=o},null,8,["modelValue","onUpdate:modelValue"]),e.is_global?(p(),t("span",w,"["+y(a.$t("全场券"))+"]",1)):m("",!0)])):m("",!0),2==e.coupon_type?(p(),t("div",z,[h(y(e.coupon_discount)+" ",1),v("span",null,y(a.$t("折")),1),e.is_global?(p(),t("span",B,"["+y(a.$t("全场券"))+"]",1)):m("",!0)])):m("",!0),v("div",E,y(a.$t("有效期至"))+y(e.end_date),1),v("div",F,y(e.coupon_name),1),n[4]||(n[4]=v("i",{class:"icon-gou"},null,-1)),e.disable_reason?(p(),t("div",J,[n[1]||(n[1]=v("i",{class:"iconfont-pc icon-tishi"},null,-1)),h(y(e.disable_reason),1)])):m("",!0),e.selected&&1==e.coupon_type?(p(),t("div",P,[n[2]||(n[2]=v("i",{class:"iconfont-pc icon-tishi"},null,-1)),h(" "+y(a.$t("已减")),1),_(ee,{modelValue:e.coupon_money,"onUpdate:modelValue":o=>e.coupon_money=o},null,8,["modelValue","onUpdate:modelValue"])])):m("",!0)],10,M)))),256)):m("",!0),T.value&&(null==(d=T.value)?void 0:d.disable_coupons.length)>0?(p(!0),t(f,{key:1},g(T.value.disable_coupons,(e=>(p(),t("div",{class:k(["coupon_item hand-pointer disabled",{active:e.selected}]),type:"checkbox"},[n[7]||(n[7]=v("div",{class:"c-top-dong"},null,-1)),v("div",Q,y(a.$t("取消勾选")),1),1==e.coupon_type?(p(),t("div",Z,[_(ee,{modelValue:e.coupon_money,"onUpdate:modelValue":o=>e.coupon_money=o},null,8,["modelValue","onUpdate:modelValue"]),e.is_global?(p(),t("span",q,"["+y(a.$t("全场券"))+"]",1)):m("",!0)])):m("",!0),2==e.coupon_type?(p(),t("div",A,[h(y(e.coupon_discount)+" ",1),v("span",null,y(a.$t("折")),1),e.is_global?(p(),t("span",D,"["+y(a.$t("全场券"))+"]",1)):m("",!0)])):m("",!0),v("div",G,y(a.$t("有效期至"))+y(e.end_date),1),v("div",H,y(e.coupon_name),1),n[8]||(n[8]=v("i",{class:"icon-gou"},null,-1)),e.disable_reason?(p(),t("div",K,[n[5]||(n[5]=v("i",{class:"iconfont-pc icon-tishi"},null,-1)),h(y(e.disable_reason),1)])):m("",!0),e.selected&&2==e.coupon_type?(p(),t("div",O,[n[6]||(n[6]=v("i",{class:"iconfont-pc icon-tishi"},null,-1)),h(" "+y(a.$t("已减")),1),_(ee,{modelValue:e.coupon_money,"onUpdate:modelValue":o=>e.coupon_money=o},null,8,["modelValue","onUpdate:modelValue"])])):m("",!0)],2)))),256)):m("",!0)],64)):(p(),t("div",R,[h(y(a.$t("暂无可用优惠券"))+"～",1),_(oe,{target:"_blank",class:"font-color",to:"/coupon/list"},{default:r((()=>[h(y(a.$t("去领券")),1)])),_:1})]))])):m("",!0)])),[[le,W.value]]),m("",!0)])])):m("",!0)])}}}),[["__scopeId","data-v-6e42a305"]]);export{S as default};
