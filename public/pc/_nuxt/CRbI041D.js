import{_ as E}from"./uNNarvbF.js";import{_ as U}from"./BICKwAaO.js";import{_ as D}from"./CPg1UVcC.js";import{f as H,a9 as L,r as a,Y as M,H as N,m as f,a1 as I,aD as T,o as v,c as h,b as s,a as o,t,d as l,j as m,y as j,p as q,e as F,_ as z}from"./DvlzeZYf.js";import{_ as Q}from"./BCw_XNK7.js";import{E as W}from"./JPAiA_Rf.js";import"./XomGKeK5.js";import"./lRlBa-wu.js";import"./DEXPT9kT.js";import{s as Y}from"./uRofAO38.js";import{b as x}from"./CjSdxGTc.js";import{k as A,l as G,j as J}from"./B61SGmBV.js";import"./DrjGOYyT.js";import"./CzQrJ5jx.js";import"./ctHFjQ9z.js";import"./eXzid_I5.js";import"./DldgdBu3.js";import"./CvS5MqkS.js";import"./B9SirqjL.js";import"./BxwJi-A4.js";import"./BB_Ol6Sd.js";import"./C3hftOhu.js";import"./Cq9Fpw4b.js";import"./BpsRniw3.js";const K=n=>(q("data-v-9d383e25"),n=n(),F(),n),X={class:"wechat-com"},Z={class:"wechat container"},ee={class:"message"},oe={class:"message"},te={class:"payment"},ae={class:"title"},se={class:"image-div"},ne={class:"left-image"},re={key:0,class:"ewm"},ce={key:1,class:"ewm-empty"},ie={class:"pw-box-ft"},le=K(()=>o("div",{class:"right-image"},[o("div",{class:"image"})],-1)),me=H({__name:"wechat",setup(n){const C=L(),d=a(C.query.id),g=a(!0);a({});const y=a(""),p=a({});(async()=>{try{const e=await G({order_id:d.value});p.value=e.order}catch(e){f.error(e.message),I("/member/account/deposit/")}finally{}})();const $=async()=>{g.value=!0;try{const e=await J({id:d.value,type:"wechat"});await P(e==null?void 0:e.pay_info.code_url)}catch(e){f.error(e.message)}finally{g.value=!1}},{t:r}=M(),_=a(0);let c=null;N(()=>{$(),c=Y(()=>{k(),_.value++,_.value===50&&(clearInterval(c),f.error(r("支付已超时，您可以刷新页面重新支付")))},2e3)});const k=()=>{A({id:d.value}).then(e=>{e.pay_status==1&&(clearInterval(c),W.confirm(r("充值成功"),r("提示"),{confirmButtonText:r("查看充值详情"),showClose:!1,showCancelButton:!1,closeOnClickModal:!1,type:"success"}).then(()=>{I("/member/account/log")}).catch(()=>{}))})},P=async e=>{const i=e;let u={margin:1,width:500,height:500};y.value=await x.toDataURL(i,u)},b=()=>{window.close()},w=()=>{window.location.reload()};return T(()=>{clearInterval(c)}),(e,i)=>{const u=E,S=U,B=D,V=j,O=Q;return v(),h("div",null,[s(u,{title:"微信支付"}),s(S,{showLogin:!1}),o("div",X,[o("div",Z,[o("div",ee,t(e.$t("订单提交成功，请尽快付款")),1),o("div",oe,[l(t(e.$t("应付金额"))+"： ",1),s(B,{modelValue:m(p).amount,"onUpdate:modelValue":i[0]||(i[0]=R=>m(p).amount=R),fontStyle:{color:"var(--price)",fontSize:"18px"}},null,8,["modelValue"])]),o("div",te,[o("div",ae,t(e.$t("微信支付")),1),o("div",se,[o("div",ne,[o("div",null,[l(t(e.$t("如果二维码已过期"))+"，",1),o("span",{onClick:w,class:"font-color",style:{cursor:"pointer"}},t(e.$t("刷新")),1),l(t(e.$t("重新获取二维码"))+"。",1)]),m(_)<=50?(v(),h("div",re,[s(V,{class:"image",src:m(y)},null,8,["src"])])):(v(),h("div",ce,[l(t(e.$t("已超时"))+"，",1),o("a",{class:"font-color",onClick:w},t(e.$t("点击刷新")),1)])),o("div",ie,[o("div",null,t(e.$t("请使用微信扫一扫")),1),o("div",null,t(e.$t("扫描二维码支付")),1)])]),le]),o("div",{onClick:b,class:"button-title"},"< "+t(e.$t("选择其他支付方式")),1)])])]),s(O,{bg:"white",mt30:!1,type:1})])}}}),Le=z(me,[["__scopeId","data-v-9d383e25"]]);export{Le as default};
