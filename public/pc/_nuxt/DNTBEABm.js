import{E as e}from"./duVALuQ5.js";import{a,E as l}from"./DKvZ9Rd6.js";import{E as o}from"./OZUBBuO3.js";import{e as t,af as s,r as d,g as r,z as i,y as n,n as u,c as m,o as c,m as p,h as f,a as g,w as b,b as v,i as y,d as h,t as _,_ as k,s as w,F as V,p as C,v as $,a4 as x,aX as S}from"./vO8z_6wc.js";import{S as j}from"./DMdl3org.js";import{E as I}from"./B9ErrXst.js";import"./YLitFIRx.js";import{g as E,u as O}from"./EEIoH7qq.js";const B={class:"modal_region_box"},U={class:"address_from"},q={class:"from_item"},F={class:"btn_box"},L=k(t({__name:"EditRegion",props:{id:Number,act:{type:String,default:"add"},isDialog:Boolean,addressId:{type:Number,default:0},showClose:{type:Boolean,default:!0}},emits:["submitCallback","update:confirmLoading","close","change"],setup(t,{expose:k,emit:w}){const V=w,C=t,$=s().currentRoute.value.query,x=d(C.isDialog?C.act:String($.act)),S=d("add"===x.value?"create":"update");d(!1);const I=r({consignee:"",regionIds:[],address:"",mobile:"",telephone:"",email:""}),{t:L}=i(),D=d(!0);n((()=>{C.addressId>0?z():D.value=!1}));const z=async()=>{try{const e=await E(x.value,{id:C.addressId});Object.assign(I,e)}catch(e){u.error(e.message)}finally{D.value=!1}},R=r({mobile:[{validator:(e,a,l)=>a?/^(?:\+86)?1(?:3[0-9]|4[5-9]|5[0-35-9]|6[5-7]|7[0-8]|8[0-9]|9[189])\d{8}$/.test(a)?void l():l(new Error(L("格式错误，请输入正确的手机号码"))):l(new Error(L("手机号不能为空"))),trigger:"blur",required:!0}],email:[{validator:(e,a,l)=>{if(a&&!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(a))return l(new Error(L("格式错误，请输入正确的邮箱地址")));l()},trigger:"blur",required:!0}]}),Z=d(null),A=async()=>{await Z.value.validate();try{V("update:confirmLoading",!0);const e=await O(S.value,{id:C.addressId,...I});u.success(L("操作成功")),V("submitCallback",e)}catch(e){u.error(e.message)}finally{V("update:confirmLoading",!1)}},N=()=>{Z.value.validateField("regionIds")},H=()=>{V("close")};return k({onFormSubmit:()=>{A()}}),(t,s)=>{const d=e,r=l,i=a,n=o;return c(),m("div",B,[D.value?f("",!0):(c(),p(i,{key:0,"label-width":"auto","inline-message":!1,ref_key:"formRef",ref:Z,rules:R,model:I,autocomplete:"off","label-suffix":"："},{default:b((()=>[v(r,{label:t.$t("收货人"),prop:"consignee",rules:[{required:!0,message:t.$t("请您填写收货人姓名")}]},{default:b((()=>[v(d,{modelValue:I.consignee,"onUpdate:modelValue":s[0]||(s[0]=e=>I.consignee=e),maxlength:20},null,8,["modelValue"])])),_:1},8,["label","rules"]),v(r,{label:t.$t("所在地区"),prop:"regionIds",rules:[{required:!0,message:t.$t("请选择收货人所在地区")}],autoLink:""},{default:b((()=>[v(y(j),{modelValue:I.regionIds,"onUpdate:modelValue":s[1]||(s[1]=e=>I.regionIds=e),onChange:N},null,8,["modelValue"])])),_:1},8,["label","rules"]),v(r,{label:t.$t("详细地址"),prop:"address",rules:[{required:!0,message:t.$t("请您填写详细收货地址")},{min:3,message:t.$t("收货人地址过短")}]},{default:b((()=>[v(d,{modelValue:I.address,"onUpdate:modelValue":s[2]||(s[2]=e=>I.address=e),maxlength:100},null,8,["modelValue"])])),_:1},8,["label","rules"]),v(r,{label:t.$t("手机号码"),prop:"mobile"},{default:b((()=>[v(d,{modelValue:I.mobile,"onUpdate:modelValue":s[3]||(s[3]=e=>I.mobile=e),maxlength:20},null,8,["modelValue"])])),_:1},8,["label"]),v(r,{label:t.$t("固定电话"),prop:"telephone",rules:[],"wrapper-col":{span:8},extra:""},{default:b((()=>[v(d,{modelValue:I.telephone,"onUpdate:modelValue":s[4]||(s[4]=e=>I.telephone=e),maxlength:20},null,8,["modelValue"])])),_:1},8,["label"]),v(r,{required:!1,label:t.$t("邮箱地址"),prop:"email",rules:[],"wrapper-col":{span:8}},{default:b((()=>[v(d,{modelValue:I.email,"onUpdate:modelValue":s[5]||(s[5]=e=>I.email=e),maxlength:50},null,8,["modelValue"])])),_:1},8,["label"])])),_:1},8,["rules","model"])),g("div",U,[g("div",q,[s[6]||(s[6]=g("div",{class:"tit"},null,-1)),g("div",F,[v(n,{type:"primary",onClick:A},{default:b((()=>[h(_("add"===x.value?t.$t("新增"):t.$t("修改"))+_(t.$t("地址")),1)])),_:1}),C.showClose?(c(),p(n,{key:0,onClick:H},{default:b((()=>[h(_(t.$t("取消")),1)])),_:1})):f("",!0)])])])])}}}),[["__scopeId","data-v-ff443532"]]),D=k(t({__name:"DialogEditRegion",props:{path:String,class:{type:String,default:""},dialogClass:{type:String,default:""},params:{type:Object,default:{}},width:{type:String,default:"800px"},title:{type:String,default:""},isDrawer:{type:Boolean,default:!1},showClose:{type:Boolean,default:!0},showOnOk:{type:Boolean,default:!0},showFooter:{type:Boolean,default:!0},data:{type:Object,default:{}},style:{type:[String,Object],default:"display:inline-flex;"},maskClosable:{type:Boolean,default:!0},closable:{type:Boolean,default:!0},type:String},emits:["okCallback","callback"],setup(e,{expose:a,emit:l}){const o=e,t=l,s=d(!1),r=d(!1),i=d(!1),n=d(!1),u=d(o.dialogClass),y=d(o.title),h=d({});!1===o.showFooter&&(h.value.footer="");const _=w((()=>Object.assign(o.params,{isDialog:!0})));function k(){i.value=!1,s.value=!0,r.value=!0}function j(e){r.value=!1}w((()=>"gallery"==o.type?"811px":o.width));const E=d(),O=e=>{e.errcode||(r.value=!1,i.value=!1,t("okCallback",e,o.data))},B=e=>{t("callback",e,o.data)},U=()=>{E.value.onFormSubmit()},q=e=>{n.value=!e};return a({show:k,close:j}),(a,l)=>{const t=L,d=I;return c(),m(V,null,[g("div",{onClick:k,class:$("dialog-link "+o.class),style:C(o.style)},[x(a.$slots,"default",{},void 0,!0)],6),s.value?(c(),p(d,S({key:0,class:u.value,modelValue:r.value,"onUpdate:modelValue":l[1]||(l[1]=e=>r.value=e),width:e.width,title:y.value,destroyOnClose:!0,onOk:U},h.value,{"close-on-click-modal":e.maskClosable,"show-close":e.closable,centered:""}),{default:b((()=>[v(t,S({ref_key:"submitForm",ref:E,onSubmitCallback:O,onCallback:B,onShow:k,onClose:j,onOkType:q},_.value,{confirmLoading:i.value,"onUpdate:confirmLoading":l[0]||(l[0]=e=>i.value=e)}),null,16,["confirmLoading"])])),_:1},16,["class","modelValue","width","title","close-on-click-modal","show-close"])):f("",!0)],64)}}}),[["__scopeId","data-v-28c80a5b"]]);export{D as _};
