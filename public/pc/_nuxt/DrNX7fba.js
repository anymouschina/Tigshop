import{a as e,b as a}from"./DmeNR82d.js";import{E as l,a as t}from"./Di7_rRxo.js";import{E as u}from"./ClnUiH43.js";import{E as o}from"./CK-rvtuG.js";import{E as r}from"./Bil1wbyq.js";import{e as s,z as d,r as c,s as n,I as i,c as m,o as p,a as v,b as _,a4 as f,w as y,m as b,h as g,aa as $,ab as j,d as V,t as h,i as w,n as k,_ as E}from"./BLNaUqdG.js";import"./CQcoTD7x.js";import{j as U,k as F}from"./fH7NBuZy.js";import"./BwRzfsZt.js";import"./BWAJcOoD.js";import"./losdC6Ud.js";import"./C8QNSlsX.js";import"./D_Dr4eZ1.js";import"./BX08AvzU.js";import"./CxZS6lgh.js";import"./DgmxjSXK.js";import"./D5ZJ33IS.js";const q={class:"info-card"},x={class:"dialog-footer"},C=E(s({__name:"InfoCard",props:{act:{type:String,default:""},id:{type:Number,default:0},type:{type:Number,default:1},page:{type:Number,default:1}},emits:["loadFilter"],setup(s,{emit:E}){const{t:C}=d(),I=E,N=s,z=c({account_type:1}),O=c(!0),R=n((()=>{switch(z.value.account_type){case 1:return C("银行卡");case 2:return C("支付宝");case 3:return C("微信");default:return""}})),S=async()=>{await Z.value.resetFields()},X=n((()=>[{required:!0,message:C("请输入身份证号"),trigger:"blur"},{validator:(e,a,l)=>{/^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}([0-9]|X)$/.test(a)?l():l(new Error(C("请输入正确的身份证号码")))},trigger:"blur"}])),Y=n((()=>[{required:!0,message:C("请输入")+R.value+C("号"),trigger:"blur"},{validator:(e,a,l)=>{/^\d{6,}$/.test(a)||1!==z.value.account_type?l():l(new Error(C("请输入正确的银行卡号")))},trigger:"blur"}])),Z=i(),A=async()=>{await Z.value.validate();try{const e=await U({...z.value},"add"==N.act?"create_account":"update_account");await Z.value.resetFields(),k.success(e.message),B.value=!1,z.value.account_type=1,I("loadFilter")}catch(e){k.error(e.message)}},B=c(!1),D=async()=>{B.value=!0,Z.value&&await Z.value.resetFields(),z.value.account_type=N.type,"edit"==N.act?await(async()=>{try{O.value=!0;const e=await F({account_id:N.id});Object.assign(z.value,e.account_detail)}catch(e){k.error(e.message)}finally{O.value=!1}})():O.value=!1};return(d,c)=>{const n=a,i=e,k=l,E=u,U=t,F=o,C=r;return p(),m("div",q,[v("span",{class:"cu",onClick:D},[f(d.$slots,"default",{},void 0,!0)]),_(C,{modelValue:B.value,"onUpdate:modelValue":c[5]||(c[5]=e=>B.value=e),title:"add"==s.act?d.$t("新增卡片"):d.$t("编辑卡片"),width:"600"},{footer:y((()=>[v("div",x,[_(F,{type:"primary",onClick:A},{default:y((()=>[V(h(d.$t("保存")),1)])),_:1})])])),default:y((()=>[O.value?g("",!0):(p(),b(U,{key:0,ref_key:"formRef",ref:Z,model:z.value,class:"form-body","label-suffix":"：","label-width":"auto"},{default:y((()=>[$(_(k,{rules:[{required:!0,message:d.$t("请选择卡类型")}],label:d.$t("卡类型")},{default:y((()=>[_(i,{modelValue:z.value.account_type,"onUpdate:modelValue":c[0]||(c[0]=e=>z.value.account_type=e),onChange:S},{default:y((()=>[_(n,{value:1},{default:y((()=>[V(h(d.$t("银行卡")),1)])),_:1}),_(n,{value:2},{default:y((()=>[V(h(d.$t("支付宝")),1)])),_:1}),_(n,{value:3},{default:y((()=>[V(h(d.$t("微信")),1)])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["rules","label"]),[[j,s.page]]),_(k,{rules:[{required:!0,message:d.$t("请输入真实姓名")}],label:d.$t("真实姓名"),prop:"account_name"},{default:y((()=>[_(E,{modelValue:z.value.account_name,"onUpdate:modelValue":c[1]||(c[1]=e=>z.value.account_name=e),placeholder:d.$t("请输入真实姓名")},null,8,["modelValue","placeholder"])])),_:1},8,["rules","label"]),_(k,{rules:w(X),label:d.$t("身份证号"),prop:"identity"},{default:y((()=>[_(E,{modelValue:z.value.identity,"onUpdate:modelValue":c[2]||(c[2]=e=>z.value.identity=e),maxlength:"18",placeholder:d.$t("请输入身份证号")},null,8,["modelValue","placeholder"])])),_:1},8,["rules","label"]),_(k,{label:w(R)+d.$t("号"),rules:w(Y),prop:"account_no"},{default:y((()=>[_(E,{modelValue:z.value.account_no,"onUpdate:modelValue":c[3]||(c[3]=e=>z.value.account_no=e),placeholder:d.$t("请输入")+w(R)},null,8,["modelValue","placeholder"])])),_:1},8,["label","rules"]),1===z.value.account_type?(p(),b(k,{key:0,label:d.$t("银行卡详情"),prop:"bank_name"},{default:y((()=>[_(E,{modelValue:z.value.bank_name,"onUpdate:modelValue":c[4]||(c[4]=e=>z.value.bank_name=e),rows:4,placeholder:d.$t("请输入银行卡详情"),type:"textarea"},null,8,["modelValue","placeholder"])])),_:1},8,["label"])):g("",!0)])),_:1},8,["model"]))])),_:1},8,["modelValue","title"])])}}}),[["__scopeId","data-v-357d1281"]]);export{C as default};
