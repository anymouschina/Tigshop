import{_ as N}from"./uNNarvbF.js";import{_ as U}from"./BICKwAaO.js";import{_ as q}from"./CPg1UVcC.js";import{f as z,a9 as D,r as i,Y as H,H as L,m as g,a1 as b,aD as M,o as s,c as n,b as c,a as o,t,j as a,d as u,i as l,y as T,_ as j}from"./DvlzeZYf.js";import{_ as F}from"./BCw_XNK7.js";import{E as Y}from"./JPAiA_Rf.js";import"./XomGKeK5.js";import"./lRlBa-wu.js";import"./DEXPT9kT.js";import{s as Q}from"./uRofAO38.js";import{b as W}from"./CjSdxGTc.js";import{w as A,z as G}from"./CK1IVTk1.js";import{k as J,l as K,j as X}from"./B61SGmBV.js";import"./DrjGOYyT.js";import"./CzQrJ5jx.js";import"./ctHFjQ9z.js";import"./eXzid_I5.js";import"./DldgdBu3.js";import"./CvS5MqkS.js";import"./B9SirqjL.js";import"./BxwJi-A4.js";import"./BB_Ol6Sd.js";import"./C3hftOhu.js";import"./Cq9Fpw4b.js";import"./BpsRniw3.js";const Z={class:"wechat-com"},x={class:"wechat container"},ee={class:"message"},te={class:"message"},oe={class:"payment"},ae={key:0,class:"title"},se={key:1,class:"title"},ne={class:"image-div"},re={class:"left-image"},ie={key:0,class:"ewm"},ce={key:1,class:"ewm-empty"},le={class:"pw-box-ft"},me={key:0},de={key:1},_e={key:2},pe={class:"right-image"},ue={key:0,class:"image"},ye={key:1,class:"image"},fe=z({__name:"yabanpay",setup(he){const w=D(),y=i(w.query.id),r=i(w.query.type),k=i(!0);i({});const $=i(""),m=i({}),{t:d}=H();(async()=>{try{const e=await K({order_id:y.value});m.value=e.order}catch(e){g.error(e.message),b("/member/account/detail")}finally{}})();const I=async()=>{k.value=!0;try{const e=await X({id:y.value,type:"yabanpay_"+r.value});B(e==null?void 0:e.pay_info.code_url)}catch(e){g.error(e.message)}finally{k.value=!1}},f=i(0);let _=null;L(()=>{I(),_=Q(()=>{P(),f.value++,f.value===50&&(clearInterval(_),g.error(d("支付已超时，您可以刷新页面重新支付")))},2e3)});const P=()=>{J({id:y.value}).then(e=>{e.pay_status==1&&(clearInterval(_),Y.confirm(d("订单支付成功"),d("提示"),{confirmButtonText:d("查看订单"),showClose:!1,showCancelButton:!1,closeOnClickModal:!1,type:"success"}).then(()=>{b("/member/account/detail")}).catch(()=>{}))})},B=async e=>{const p=e;let h={margin:1,width:500,height:500};$.value=await W.toDataURL(p,h)},V=()=>{window.close()},C=()=>{window.location.reload()};return M(()=>{clearInterval(_)}),(e,p)=>{const h=N,O=U,R=q,v=T,S=F;return s(),n("div",null,[c(h,{title:"YaBandPay"}),c(O,{showLogin:!1}),o("div",Z,[o("div",x,[o("div",ee,t(e.$t("订单提交成功，请尽快付款"))+"！"+t(e.$t("订单号"))+"："+t(a(m).order_sn),1),o("div",te,[u(t(e.$t("应付金额"))+"： ",1),c(R,{modelValue:a(m).amount,"onUpdate:modelValue":p[0]||(p[0]=E=>a(m).amount=E),fontStyle:{color:"var(--price)",fontSize:"18px"}},null,8,["modelValue"])]),o("div",oe,[a(r)=="wechat"?(s(),n("div",ae,t(e.$t("微信支付")),1)):l("",!0),a(r)=="alipay"?(s(),n("div",se,t(e.$t("支付宝支付")),1)):l("",!0),o("div",ne,[o("div",re,[o("div",null,[u(t(e.$t("如果二维码已过期"))+"，"+t(e.$t("请")),1),o("span",{onClick:C,class:"font-color",style:{cursor:"pointer"}},t(e.$t("刷新")),1),u(t(e.$t("页面重新获取二维码"))+"。",1)]),a(f)<=50?(s(),n("div",ie,[c(v,{class:"image",src:a($)},null,8,["src"])])):(s(),n("div",ce,[u(t(e.$t("已超时"))+"，",1),o("a",{class:"font-color",onClick:C},t(e.$t("点击刷新")),1)])),o("div",le,[a(r)=="wechat"?(s(),n("div",me,t(e.$t("请使用微信扫一扫")),1)):l("",!0),a(r)=="alipay"?(s(),n("div",de,t(e.$t("请使用支付宝扫一扫")),1)):l("",!0),a(r)=="yunshanfu"?(s(),n("div",_e,t(e.$t("请使用云闪付扫一扫")),1)):l("",!0),o("div",null,t(e.$t("扫描二维码支付")),1)])]),o("div",pe,[a(r)=="wechat"?(s(),n("div",ue,[c(v,{src:a(A)},null,8,["src"])])):l("",!0),a(r)=="alipay"?(s(),n("div",ye,[c(v,{src:a(G)},null,8,["src"])])):l("",!0)])]),o("div",{onClick:V,class:"button-title"},"< "+t(e.$t("选择其他支付方式")),1)])])]),c(S,{bg:"white",mt30:!1,type:1})])}}}),Ye=j(fe,[["__scopeId","data-v-c14455c1"]]);export{Ye as default};
