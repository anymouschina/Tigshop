import{E as e}from"./ClnUiH43.js";import{E as a}from"./CK-rvtuG.js";import{_ as t}from"./CDEbyP9X.js";import{_ as l}from"./DGSQZaL6.js";import{e as s,z as o,r as i,g as r,y as d,c as n,o as u,h as c,a as m,aa as _,F as p,l as y,v,t as k,b as f,w as b,d as g,i as h,q as w,E as $,j as V,m as x,n as z,ai as C,ae as j,_ as U}from"./BLNaUqdG.js";import{_ as T}from"./CScYj7Fy.js";import{E as L}from"./DIIF5iVx.js";import{v as E}from"./C8qdh5cF.js";import"./rSOsbbvW.js";import{g as F,c as O,d as M,r as P,a as q,b as I}from"./4WcqWuuL.js";import{P as Q}from"./DE8qoeTi.js";import{L as J}from"./b_4_U_AZ.js";const N={class:"order-list"},R={key:0,class:"tag-and-input"},X={class:"tig-tabs"},Y=["onClick"],A={key:0},B={class:"input"},D={class:"order-title"},G={class:"ul"},H={style:{width:"23%"}},K={style:{width:"28%"}},S={key:1,style:{width:"49%"}},W={style:{width:"6%"}},Z={style:{width:"12%"}},ee={key:2,style:{width:"14%"}},ae={key:3,style:{width:"14%"}},te={style:{width:"12%"}},le={class:"order-table"},se={colspan:"4"},oe={class:"font-color"},ie={key:0,style:{"margin-left":"30px"}},re={class:"font-color"},de={style:{"margin-left":"30px"}},ne={class:"order-tr"},ue={class:"column-1"},ce={class:"text-ellipsis"},me={style:{color:"#aaa"}},_e={class:"column-2-4"},pe={class:"black"},ye={class:"money"},ve={class:"column-2-4"},ke={class:"black"},fe={key:0,class:"black"},be=["onMouseenter"],ge={class:"column-2-4"},he={key:0},we=["onClick"],$e=["onClick"],Ve={key:3,class:"mb10"},xe={key:4,class:"mb10"},ze={key:5,class:"mb10"},Ce={key:6,class:"mb10"},je={key:7,class:"mb10"},Ue={class:"el-page"},Te={key:1,class:"no-result"},Le={key:0},Ee={key:1},Fe={style:{"font-size":"12px"}},Oe=U(s({__name:"MemberOrderList",props:{modelValue:{type:Number,default:1}},emits:["change"],setup(s,{emit:U}){const{t:Oe}=o(),Me=i([]),Pe=i(!0),qe=i(0),Ie=r({page:1,sort_field:"add_time",sort_order:"desc",keyword:"",pay_status:-1,date_type:1}),Qe=i("all"),Je=r([{type:"all",value:"全部订单",num:0},{type:"await_pay",value:"待支付",num:0},{type:"await_shipping",value:"待发货",num:0},{type:"await_received",value:"待收货",num:0},{type:"await_comment",value:"待评价",num:0}]),Ne=async()=>{Pe.value=!0;try{const e=await F();Je.forEach((a=>{let t=e.item;void 0!==t[a.type]&&(a.num=t[a.type])}))}catch(e){z.error(e.message)}finally{Pe.value=!1}},Re=r([{value:-1,label:"交易状态"},{value:0,label:"未支付"},{value:2,label:"已支付"}]),Xe=r([{value:0,label:"全部订单"},{value:1,label:"最近三个月订单"},{value:2,label:"最近六个月订单"},{value:3,label:"最近一年内订单"}]),Ye=async()=>{Pe.value=!0;try{qe.value=0;const e=await I({...Ie});Me.value=e.filter_result,qe.value=e.total}catch(e){z.error(e.message)}finally{Pe.value=!1}};d((()=>{Ne().then((()=>{Ye()}))}));return(o,i)=>{const r=e,d=a,U=t,F=l,I=$,Ae=T,Be=L,De=E;return u(),n("div",N,[s.modelValue?(u(),n("div",R,[m("div",X,[(u(!0),n(p,null,y(Je,(e=>(u(),n("div",{class:v([Qe.value==e.type?"active":"","tab"]),onClick:a=>{return t=e.type,Ie.page=1,Ie.order_status=-1,Ie.comment_status=-1,"await_pay"===t?Ie.order_status=0:"await_shipping"===t?Ie.order_status=1:"await_received"===t?Ie.order_status=2:"await_comment"===t&&(Ie.comment_status=0),Qe.value=t,void Ye();var t}},[e.num?(u(),n("span",A,k(e.num),1)):c("",!0),m("p",null,k(o.$t(e.value)),1)],10,Y)))),256))]),m("div",B,[f(r,{modelValue:Ie.keyword,"onUpdate:modelValue":i[0]||(i[0]=e=>Ie.keyword=e),placeholder:o.$t("收货人名称或订单号"),type:"text"},null,8,["modelValue","placeholder"]),f(d,{class:"ml10",onClick:i[1]||(i[1]=e=>Ye())},{default:b((()=>[g(k(o.$t("搜索")),1)])),_:1})])])):c("",!0),m("div",D,[m("div",G,[s.modelValue?(u(),n(p,{key:0},[m("div",H,[f(U,{modelValue:Ie.date_type,"onUpdate:modelValue":i[2]||(i[2]=e=>Ie.date_type=e),selectList:Xe,onLoadFilter:Ye},null,8,["modelValue","selectList"])]),m("div",K,k(o.$t("商品名称")),1)],64)):(u(),n("div",S,k(o.$t("商品名称")),1)),m("div",W,k(o.$t("数量")),1),i[6]||(i[6]=m("div",{style:{width:"7%"}},null,-1)),m("div",Z,k(o.$t("金额")),1),s.modelValue?(u(),n("div",ee,[f(U,{modelValue:Ie.pay_status,"onUpdate:modelValue":i[3]||(i[3]=e=>Ie.pay_status=e),selectList:Re,onLoadFilter:Ye},null,8,["modelValue","selectList"])])):(u(),n("div",ae,k(o.$t("交易状态")),1)),m("div",te,k(o.$t("操作")),1)])]),_((u(),n("div",null,[qe.value>0?(u(),n(p,{key:0},[(u(!0),n(p,null,y(Me.value,((e,a)=>{var t,l,s;return u(),n("table",le,[m("thead",null,[m("tr",null,[m("th",se,[g(k(o.$t("订单号"))+"：",1),f(F,{to:"/member/order/info?id="+e.order_id,target:"_blank"},{default:b((()=>[m("span",oe,k(e.order_sn),1)])),_:2},1032,["to"]),e.shop&&e.shop.shop_title?(u(),n("span",ie,[g(k(o.$t("下单店铺"))+"：",1),f(F,{to:h(w)({path:"shop",id:e.shop_id}),target:"_blank"},{default:b((()=>[m("span",re,k(e.shop.shop_title),1)])),_:2},1032,["to"])])):c("",!0),m("span",de,k(o.$t("下单时间"))+"："+k(e.add_time),1)])])]),m("tbody",null,[m("tr",ne,[m("td",ue,[(u(!0),n(p,null,y(e.items,(e=>(u(),n("div",null,[f(F,{title:e.product_name,to:h(w)({path:"product",id:e.product_id,sn:e.product_sn}),class:"nuxt",target:"_blank"},{default:b((()=>[f(I,{src:("imageFormat"in o?o.imageFormat:h(V))(e.pic_thumb),loading:"lazy",style:{height:"40px",width:"40px",transition:"opacity 0.2s linear","flex-shrink":"0"}},null,8,["src"]),m("div",null,[m("div",ce,k(e.product_name),1)])])),_:2},1032,["title","to"]),m("div",me,"X"+k(e.quantity),1),i[7]||(i[7]=m("div",null,null,-1))])))),256))]),m("td",_e,[m("div",null,[m("div",null,[g(k(o.$t("总额"))+": ",1),f(Ae,{modelValue:e.total_amount,"onUpdate:modelValue":a=>e.total_amount=a,showText:!1},null,8,["modelValue","onUpdate:modelValue"])]),0==e.order_status&&e.unpaid_amount>0?(u(),n(p,{key:0},[m("div",pe,k(o.$t("应付")),1),m("div",ye,[f(Ae,{modelValue:e.unpaid_amount,"onUpdate:modelValue":a=>e.unpaid_amount=a,showText:!1},null,8,["modelValue","onUpdate:modelValue"])])],64)):c("",!0),m("div",null,k(1===e.pay_type_id?o.$t("在线支付"):2===e.pay_type_id?o.$t("货到付款"):o.$t("线下支付")),1)])]),m("td",ve,[m("div",null,[m("div",{class:v({orange:0===e.order_status,black:1===e.order_status||2===e.order_status||4===e.order_status,gray:3===e.order_status,green:5===e.order_status})},k(e.order_status_name),3),m("div",ke,[f(F,{to:"/member/order/info?id="+e.order_id,target:"_blank"},{default:b((()=>[g(k(o.$t("订单详情")),1)])),_:2},1032,["to"])]),2!=e.order_status&&5!=e.order_status||1!=e.shipping_method?c("",!0):(u(),n("div",fe,[f(Be,{width:600,placement:"bottom"},{reference:b((()=>[m("span",{style:{cursor:"pointer"},onMouseenter:a=>(e=>{e.show_popover=!0})(e)},[m("i",null,k(o.$t("物流跟踪")),1),i[8]||(i[8]=m("i",{style:{"font-size":"12px"},class:"iconfont-pc icon-xiajiantou1"},null,-1))],40,be)])),default:b((()=>[e.show_popover?(u(),x(J,{key:0,tracking_no:e.tracking_no,logistics_name:e.logistics_name,id:e.order_id,"onUpdate:id":a=>e.order_id=a},null,8,["tracking_no","logistics_name","id","onUpdate:id"])):c("",!0)])),_:2},1024)]))])]),m("td",ge,[m("div",null,[e.available_actions.to_pay?(u(),n("div",he,[f(F,{to:"/order/pay/?id="+e.order_id,target:"_balnk"},{default:b((()=>[f(d,{size:"small",type:"primary"},{default:b((()=>[g(k(o.$t("付款")),1)])),_:1})])),_:2},1032,["to"])])):c("",!0),e.available_actions.cancel_order?(u(),n("a",{key:1,onClick:a=>(async e=>{C.confirm({title:Oe("确认要取消该订单吗"),cancelText:Oe("取消"),okText:Oe("确定"),maskClosable:!0,centered:!0,onOk:async()=>{try{const a=await O({id:e});z.success(a.message),await Ye()}catch(a){z.error(a.message)}}})})(e.order_id)},k(o.$t("取消订单")),9,we)):c("",!0),e.available_actions.del_order?(u(),n("a",{key:2,onClick:a=>(async e=>{C.confirm({title:Oe("确认要删除该订单吗"),cancelText:Oe("取消"),okText:Oe("确定"),maskClosable:!0,centered:!0,onOk:async()=>{try{const a=await M({id:e});z.success(a.message),await Ye()}catch(a){z.error(a.message)}}})})(e.order_id)},k(o.$t("删除")),9,$e)):c("",!0),e.available_actions.confirm_receipt?(u(),n("div",Ve,[f(d,{type:"primary",size:"small",onClick:a=>(async e=>{C.confirm({title:Oe("确认要收货吗"),cancelText:Oe("取消"),okText:Oe("确定"),maskClosable:!0,centered:!0,onOk:async()=>{try{const a=await q({id:e});z.success(a.message,2),Ye(),Ne()}catch(a){z.error(a.message)}}})})(e.order_id)},{default:b((()=>[g(k(o.$t("确认收货")),1)])),_:2},1032,["onClick"])])):c("",!0),e.available_actions.to_aftersales?(u(),n("div",xe,[f(F,{to:"/member/return/info/?order_id="+e.order_id},{default:b((()=>[f(d,{size:"small"},{default:b((()=>[g(k(o.$t("申请售后")),1)])),_:1})])),_:2},1032,["to"])])):c("",!0),e.items&&(null==(t=e.items[0])?void 0:t.aftersales_item)?(u(),n("div",ze,[f(F,{to:"/member/return/logInfo?id="+(null==(s=null==(l=e.items[0])?void 0:l.aftersales_item)?void 0:s.aftersale_id)},{default:b((()=>[f(d,{size:"small"},{default:b((()=>[g(k(o.$t("售后详情")),1)])),_:1})])),_:2},1032,["to"])])):c("",!0),e.available_actions.rebuy?(u(),n("div",Ce,[f(d,{size:"small",onClick:a=>(async e=>{try{const a=await P({id:e});return z.success(a.message,1),void setTimeout((function(){j("/order/check")}),1500)}catch(a){z.error(a.message)}})(e.order_id)},{default:b((()=>[g(k(o.$t("再次购买")),1)])),_:2},1032,["onClick"])])):c("",!0),e.available_actions.to_comment?(u(),n("div",je,[f(F,{to:"/member/comment/info/?id="+e.order_id},{default:b((()=>[f(d,{size:"small"},{default:b((()=>[g(k(o.$t("去评价")),1)])),_:1})])),_:2},1032,["to"])])):c("",!0)])])])])])})),256)),m("div",Ue,[f(h(Q),{page:Ie.page,"onUpdate:page":i[4]||(i[4]=e=>Ie.page=e),size:Ie.size,"onUpdate:size":i[5]||(i[5]=e=>Ie.size=e),total:qe.value,onCallback:Ye},null,8,["page","size","total"])])],64)):(u(),n("div",Te,[Pe.value?c("",!0):(u(),n("div",Le,i[9]||(i[9]=[m("span",{class:"sign sign1"},null,-1)]))),Pe.value?c("",!0):(u(),n("div",Ee,[m("ul",null,[m("li",null,k(o.$t("当前筛选下还没有任何订单哦")),1),m("li",Fe,[g(k(o.$t("现在就去"))+"： ",1),f(F,{class:"font-color",to:"/"},{default:b((()=>[g(k(o.$t("选购商品")),1)])),_:1})])])]))]))])),[[De,Pe.value]])])}}}),[["__scopeId","data-v-193f9a65"]]);export{Oe as _};
