import{_ as H}from"./uNNarvbF.js";import{_ as L}from"./BICKwAaO.js";import{_ as M}from"./CPg1UVcC.js";import{f as N,a9 as O,r as a,Y as R,H as T,m as f,a1 as I,aD as U,o as v,c as h,b as s,a as e,t,j as n,d as p,y as q,p as F,e as j,_ as z}from"./DvlzeZYf.js";import{_ as Q}from"./BCw_XNK7.js";import{E as W}from"./JPAiA_Rf.js";import"./XomGKeK5.js";import"./lRlBa-wu.js";import"./DEXPT9kT.js";import{s as Y}from"./uRofAO38.js";import{a as A,o as G,c as J}from"./CfiMK-Hg.js";import{b as K}from"./CjSdxGTc.js";import"./DrjGOYyT.js";import"./CzQrJ5jx.js";import"./ctHFjQ9z.js";import"./eXzid_I5.js";import"./DldgdBu3.js";import"./CvS5MqkS.js";import"./B9SirqjL.js";import"./BxwJi-A4.js";import"./BB_Ol6Sd.js";import"./C3hftOhu.js";import"./Cq9Fpw4b.js";import"./BpsRniw3.js";const X=r=>(F("data-v-0bcdebc1"),r=r(),j(),r),Z={class:"wechat-com"},x={class:"wechat container"},oo={class:"message"},eo={class:"message"},to={class:"payment"},ao={class:"title"},so={class:"image-div"},no={class:"left-image"},ro={key:0,class:"ewm"},co={key:1,class:"ewm-empty"},io={class:"pw-box-ft"},lo=X(()=>e("div",{class:"right-image"},[e("div",{class:"image"})],-1)),mo=N({__name:"wechat",setup(r){const $=O(),c=a($.query.id),y=a(!0);a({});const g=a(""),i=a({});(async()=>{try{const o=await G({id:c.value});i.value=o.order}catch(o){f.error(o.message),I("/member/order/list/")}finally{}})();const b=async()=>{y.value=!0;try{const o=await J({id:c.value,type:"wechat"});k(o==null?void 0:o.pay_info.code_url)}catch(o){f.error(o.message)}finally{y.value=!1}},{t:l}=R(),_=a(0);let m=null;T(()=>{b(),m=Y(()=>{C(),_.value++,_.value===50&&(clearInterval(m),f.error(l("支付已超时，您可以刷新页面重新支付")))},2e3)});const C=()=>{A({id:c.value}).then(o=>{o.pay_status==1&&(clearInterval(m),W.confirm(l("订单支付成功"),l("提示"),{confirmButtonText:l("查看订单"),showClose:!1,showCancelButton:!1,closeOnClickModal:!1,type:"success"}).then(()=>{I("/member/order/info?id="+c.value)}).catch(()=>{}))})},k=async o=>{const d=o;let u={margin:1,width:500,height:500};g.value=await K.toDataURL(d,u)},P=()=>{window.close()},w=()=>{window.location.reload()};return U(()=>{clearInterval(m)}),(o,d)=>{const u=H,S=L,B=M,V=q,E=Q;return v(),h("div",null,[s(u,{title:"微信支付"}),s(S,{showLogin:!1}),e("div",Z,[e("div",x,[e("div",oo,t(o.$t("订单提交成功，请尽快付款"))+"！"+t(o.$t("订单号"))+"："+t(n(i).order_sn),1),e("div",eo,[p(t(o.$t("应付金额"))+"： ",1),s(B,{modelValue:n(i).total_amount,"onUpdate:modelValue":d[0]||(d[0]=D=>n(i).total_amount=D),fontStyle:{color:"var(--price)",fontSize:"18px"}},null,8,["modelValue"])]),e("div",to,[e("div",ao,t(o.$t("微信支付")),1),e("div",so,[e("div",no,[e("div",null,[p(t(o.$t("如果二维码已过期"))+"，",1),e("span",{onClick:w,class:"font-color",style:{cursor:"pointer"}},t(o.$t("刷新")),1),p(t(o.$t("重新获取二维码"))+"。",1)]),n(_)<=50?(v(),h("div",ro,[s(V,{class:"image",src:n(g)},null,8,["src"])])):(v(),h("div",co,[p(t(o.$t("已超时"))+"，",1),e("a",{class:"font-color",onClick:w},t(o.$t("点击刷新")),1)])),e("div",io,[e("div",null,t(o.$t("请使用微信扫一扫")),1),e("div",null,t(o.$t("扫描二维码支付")),1)])]),lo]),e("div",{onClick:P,class:"button-title"},"< "+t(o.$t("选择其他支付方式")),1)])])]),s(E,{bg:"white",mt30:!1,type:1})])}}}),Ro=z(mo,[["__scopeId","data-v-0bcdebc1"]]);export{Ro as default};
