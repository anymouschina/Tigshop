import{af as K,aa as W,b9 as X,f as Y,a3 as z,a7 as Z,q as tt,r as g,a4 as $,g as ot,o as s,c as d,a as e,F as q,l as x,t as a,b as u,w as i,d as p,i as _,j as r,h as y,x as et,z as k,a2 as st,a5 as at,a6 as rt,n as ct,y as nt,p as dt,e as lt,_ as it}from"./DvlzeZYf.js";import{_ as ut}from"./CzQrJ5jx.js";import{_ as pt}from"./CPg1UVcC.js";import{E as _t}from"./XomGKeK5.js";import{_ as ht}from"./D0iLGPIx.js";import{r as mt}from"./CZXUHXp1.js";import{P as ft}from"./DpiGic3x.js";import{g as L}from"./Cih86h_U.js";const Yt=c=>K({url:"search/search/get_filter",method:"get",params:c}),gt=c=>W({url:"search/search/get_product",method:"get",params:c}),vt=X("search",{state:()=>({total:0}),getters:{},actions:{}}),yt=c=>(dt("data-v-67f5d696"),c=c(),lt(),c),kt={class:"goods-list-c"},bt={class:"wrap"},Pt={class:"g-item-warp"},Ct={class:"pic"},St={class:"info"},$t={class:"name"},qt={key:0,class:"shop-info"},Bt={key:1,class:"shop-name"},Vt={class:"promotion-box"},wt={key:0,class:"activity"},zt={key:1,class:"promotion"},xt={class:"ticket-type"},Lt=yt(()=>e("span",{class:"ticket-line"},null,-1)),Mt={class:"ticket-content"},Ft={class:"item_cart_num"},Et={class:"shopping_num"},Nt=["onUpdate:modelValue"],Tt=["onClick"],Ut=["onClick"],jt={class:"shopping_act"},Dt={key:0,class:"search-empty"},Gt={class:"bd"},It={class:"pagination"},Qt=Y({__name:"CatGoodsList",props:z({queryParams:{type:Object,default:{}}},{filter:{},filterModifiers:{},queryParams:{},queryParamsModifiers:{},loadingProduct:{},loadingProductModifiers:{}}),emits:z(["change","pageChange"],["update:filter","update:queryParams","update:loadingProduct"]),setup(c,{emit:M}){const B=Z(),F=c,b=vt(),E=tt(),V=g(25),w=M,P=$(c,"filter"),N=$(c,"queryParams");g();const C=$(c,"loadingProduct"),h=g([]),m=g({}),T=async()=>{try{C.value=!0,h.value=[];const o=await gt({...F.queryParams,size:V.value});h.value=o.product_list,b.total=o.total??0,h.value.forEach(f=>{f.number=1});const l=o.product_list.map(f=>({product_id:f.product_id}));U({products:l,from:"list"})}catch{}finally{C.value=!1}},U=async o=>{try{const l=await mt({products:o.products,shop_id:o.shop_id,from:o.from});m.value=l.list}catch(l){console.error(l)}},j={1:"秒杀价",2:"券",3:"满减",4:"折扣",5:"满赠",6:"限时折扣"},D=o=>j[o];ot(()=>N.value,()=>{T()},{deep:!0,immediate:!0});const G=g(null),I=()=>{w("change",P.value.page),w("pageChange")},Q=o=>{o.number&&o.number++},R=o=>{o.number&&o.number>1&&o.number--},A=()=>{E.back()};return(o,l)=>{const f=nt,v=ut,O=pt,S=_t,H=ht;return s(),d(q,null,[e("div",{class:"goods-list__box",ref_key:"productBox",ref:G},[e("div",kt,[e("div",bt,[(s(!0),d(q,null,x(h.value,(t,J)=>(s(),d("div",{class:"item",key:J},[e("div",Pt,[e("div",Ct,[u(v,{to:r(k)({path:"product",id:t.product_id,sn:t.product_sn}),target:"_blank"},{default:i(()=>[u(f,{class:"ease",lazy:"",src:r(et)(t.pic_url)},null,8,["src"])]),_:2},1032,["to"])]),e("div",St,[u(O,{class:"",modelValue:t.product_price,"onUpdate:modelValue":n=>t.product_price=n},null,8,["modelValue","onUpdate:modelValue"]),e("div",$t,[u(v,{to:r(k)({path:"product",id:t.product_id,sn:t.product_sn}),target:"_blank"},{default:i(()=>[p(a(t.product_name),1)]),_:2},1032,["to"])]),r(st)()?(s(),d("div",qt,[t.shopSimple?(s(),y(v,{key:0,class:"shop-name",to:r(k)({path:"shop",id:t.shop_id}),target:"_blank"},{default:i(()=>[p(a(t.shopSimple.shop_title),1)]),_:2},1032,["to"])):(s(),d("div",Bt,a(r(B).default_shop_name?r(B).default_shop_name:o.$t("官方自营")),1))])):_("",!0),e("div",Vt,[m.value[t.product_id]&&m.value[t.product_id].activity_info&&m.value[t.product_id].activity_info.length>0?(s(!0),d(q,{key:0},x(m.value[t.product_id].activity_info,n=>(s(),d("div",{class:"promotion-box-item",key:n.product_id},[n.type!=2?(s(),d("div",wt,a(o.$t(D(n.type))),1)):_("",!0),n.type==2?(s(),d("div",zt,[e("div",xt,[p(a(o.$t("券"))+" ",1),Lt]),e("div",Mt,a(n.data.promotion_desc),1)])):_("",!0)]))),128)):_("",!0)]),e("div",Ft,[e("div",Et,[at(e("input",{"onUpdate:modelValue":n=>t.number=n,type:"text"},null,8,Nt),[[rt,t.number]]),e("span",null,[e("a",{class:"add",href:"javascript:;",onClick:n=>Q(t)},null,8,Tt),e("a",{class:ct(["decrease",t.number&&t.number<=1?"disabled":""]),href:"javascript:;",onClick:n=>R(t)},null,10,Ut)])]),e("div",jt,[t.product_sku&&t.product_sku.length>0?(s(),y(v,{key:0,to:r(k)({path:"product",id:t.product_id,sn:t.product_sn})},{default:i(()=>[u(S,{size:"small",type:"primary"},{default:i(()=>[p(a(o.$t(r(L)(t.product_type))),1)]),_:2},1024)]),_:2},1032,["to"])):(s(),y(H,{key:1,isQuick:t.product_type!==1,id:t.product_id,disabled:t.product_stock==0,number:t.number},{default:i(()=>[u(S,{disabled:t.product_stock==0,size:"small",type:"primary"},{default:i(()=>[p(a(o.$t(r(L)(t.product_type))),1)]),_:2},1032,["disabled"])]),_:2},1032,["isQuick","id","disabled","number"]))])])])])]))),128)),h.value.length===0&&!C.value?(s(),d("div",Dt,[e("div",Gt,[e("h4",null,a(o.$t("好狠的筛选条件啊，把相关的商品都埋没了！")),1),e("p",null,a(o.$t("建议您")),1),e("p",null,a(o.$t("1、适当减少筛选条件")),1),e("p",null,a(o.$t("2、调整价格区间")),1),e("p",null,a(o.$t("3、尝试其他关键字")),1),u(S,{class:"graybtn mt10",onClick:A},{default:i(()=>[p(a(o.$t("返回上一步")),1)]),_:1})])])):_("",!0)])])],512),e("div",It,[r(b).total>0?(s(),y(r(ft),{key:0,page:P.value.page,"onUpdate:page":l[0]||(l[0]=t=>P.value.page=t),size:V.value,total:r(b).total,onCallback:I},null,8,["page","size","total"])):_("",!0)])],64)}}}),Zt=it(Qt,[["__scopeId","data-v-67f5d696"]]);export{Zt as C,Yt as g,vt as u};
