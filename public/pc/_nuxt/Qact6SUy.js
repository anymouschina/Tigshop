import{b as e}from"./kUOzVTvd.js";import{_ as a}from"./9TMjRzGO.js";import{_ as l}from"./DHZet8FK.js";import{_ as t}from"./CScYj7Fy.js";import{_ as o}from"./DGSQZaL6.js";import{a3 as s,K as i,by as n,L as r,M as d,d5 as u,bx as c,d6 as m,N as v,e as p,O as f,P as _,r as b,s as h,bc as y,aZ as g,bq as x,a2 as j,Q as w,c as V,o as k,h as C,F as $,l as I,v as S,i as T,b as N,w as O,aa as U,m as F,as as H,ab as M,Y as A,p as L,t as B,bH as E,a1 as q,ad as J,y as P,aj as z,ae as D,n as K,a as W,d as Q,j as R,q as X,ak as Y,E as Z,_ as G}from"./BLNaUqdG.js";import{u as ee,b as ae,d as le,e as te,f as oe}from"./BWAJcOoD.js";import{U as se,C as ie}from"./BwRzfsZt.js";import{E as ne}from"./ClnUiH43.js";import{E as re}from"./CK-rvtuG.js";import{_ as de}from"./zM3V5R1F.js";import{g as ue,u as ce}from"./CyEjOijC.js";import{U as me}from"./DOF94b_8.js";import"./CdUPjuAS.js";import"./DlIXSNl1.js";import"./D-E-9YUO.js";import"./Bp2G0jMz.js";import"./DmeNR82d.js";import"./C8QNSlsX.js";import"./losdC6Ud.js";import"./D_Dr4eZ1.js";import"./BucM0pco.js";import"./rSOsbbvW.js";import"./DgmxjSXK.js";import"./BX08AvzU.js";import"./CxZS6lgh.js";import"./DIIF5iVx.js";/* empty css        */import"./C8IqyEYy.js";import"./CQcoTD7x.js";import"./D5ZJ33IS.js";import"./DSwxsogY.js";import"./DxiXPFL-.js";import"./TpWzRMhr.js";import"./Bil1wbyq.js";const ve=i({modelValue:{type:Number,default:0},id:{type:String,default:void 0},lowThreshold:{type:Number,default:2},highThreshold:{type:Number,default:4},max:{type:Number,default:5},colors:{type:d([Array,Object]),default:()=>r(["","",""])},voidColor:{type:String,default:""},disabledVoidColor:{type:String,default:""},icons:{type:d([Array,Object]),default:()=>[u,u,u]},voidIcon:{type:c,default:()=>m},disabledVoidIcon:{type:c,default:()=>u},disabled:Boolean,allowHalf:Boolean,showText:Boolean,showScore:Boolean,textColor:{type:String,default:""},texts:{type:d(Array),default:()=>r(["Extremely bad","Disappointed","Fair","Satisfied","Surprise"])},scoreTemplate:{type:String,default:"{value}"},size:n,clearable:Boolean,...ee(["ariaLabel"])}),pe={[ie]:e=>s(e),[se]:e=>s(e)},fe=p({name:"ElRate"});const _e=J(v(p({...fe,props:ve,emits:pe,setup(e,{expose:a,emit:l}){const t=e;function o(e,a){const l=e=>g(e),t=Object.keys(a).map((e=>+e)).filter((t=>{const o=a[t];return!!l(o)&&o.excluded?e<t:e<=t})).sort(((e,a)=>e-a)),o=a[t[0]];return l(o)&&o.value||o}const s=f(te,void 0),i=f(oe,void 0),n=ae(),r=_("rate"),{inputId:d,isLabeledByFormItem:u}=le(t,{formItemContext:i}),c=b(t.modelValue),m=b(-1),v=b(!0),p=h((()=>[r.b(),r.m(n.value)])),J=h((()=>t.disabled||(null==s?void 0:s.disabled))),P=h((()=>r.cssVarBlock({"void-color":t.voidColor,"disabled-void-color":t.disabledVoidColor,"fill-color":W.value}))),z=h((()=>{let e="";return t.showScore?e=t.scoreTemplate.replace(/\{\s*value\s*\}/,J.value?`${t.modelValue}`:`${c.value}`):t.showText&&(e=t.texts[Math.ceil(c.value)-1]),e})),D=h((()=>100*t.modelValue-100*Math.floor(t.modelValue))),K=h((()=>y(t.colors)?{[t.lowThreshold]:t.colors[0],[t.highThreshold]:{value:t.colors[1],excluded:!0},[t.max]:t.colors[2]}:t.colors)),W=h((()=>{const e=o(c.value,K.value);return g(e)?"":e})),Q=h((()=>{let e="";return J.value?e=`${D.value}%`:t.allowHalf&&(e="50%"),{color:W.value,width:e}})),R=h((()=>{let e=y(t.icons)?[...t.icons]:{...t.icons};return e=x(e),y(e)?{[t.lowThreshold]:e[0],[t.highThreshold]:{value:e[1],excluded:!0},[t.max]:e[2]}:e})),X=h((()=>o(t.modelValue,R.value))),Y=h((()=>J.value?j(t.disabledVoidIcon)?t.disabledVoidIcon:x(t.disabledVoidIcon):j(t.voidIcon)?t.voidIcon:x(t.voidIcon))),Z=h((()=>o(c.value,R.value)));function G(e){const a=J.value&&D.value>0&&e-1<t.modelValue&&e>t.modelValue,l=t.allowHalf&&v.value&&e-.5<=c.value&&e>c.value;return a||l}function ee(e){t.clearable&&e===t.modelValue&&(e=0),l(se,e),t.modelValue!==e&&l(ie,e)}function ne(e){if(J.value)return;let a=c.value;const o=e.code;return o===q.up||o===q.right?(t.allowHalf?a+=.5:a+=1,e.stopPropagation(),e.preventDefault()):o!==q.left&&o!==q.down||(t.allowHalf?a-=.5:a-=1,e.stopPropagation(),e.preventDefault()),a=a<0?0:a,a=a>t.max?t.max:a,l(se,a),l(ie,a),a}function re(e,a){if(!J.value){if(t.allowHalf&&a){let l=a.target;E(l,r.e("item"))&&(l=l.querySelector(`.${r.e("icon")}`)),(0===l.clientWidth||E(l,r.e("decimal")))&&(l=l.parentNode),v.value=2*a.offsetX<=l.clientWidth,c.value=v.value?e-.5:e}else c.value=e;m.value=e}}function de(){J.value||(t.allowHalf&&(v.value=t.modelValue!==Math.floor(t.modelValue)),c.value=t.modelValue,m.value=-1)}return w((()=>t.modelValue),(e=>{c.value=e,v.value=t.modelValue!==Math.floor(t.modelValue)})),t.modelValue||l(se,0),a({setCurrentValue:re,resetCurrentValue:de}),(e,a)=>{var l;return k(),V("div",{id:T(d),class:S([T(p),T(r).is("disabled",T(J))]),role:"slider","aria-label":T(u)?void 0:e.ariaLabel||"rating","aria-labelledby":T(u)?null==(l=T(i))?void 0:l.labelId:void 0,"aria-valuenow":c.value,"aria-valuetext":T(z)||void 0,"aria-valuemin":"0","aria-valuemax":e.max,tabindex:"0",style:L(T(P)),onKeydown:ne},[(k(!0),V($,null,I(e.max,((e,a)=>(k(),V("span",{key:a,class:S(T(r).e("item")),onMousemove:a=>re(e,a),onMouseleave:de,onClick:a=>{return l=e,void(J.value||(t.allowHalf&&v.value?ee(c.value):ee(l)));var l}},[N(T(A),{class:S([T(r).e("icon"),{hover:m.value===e},T(r).is("active",e<=c.value)])},{default:O((()=>[G(e)?C("v-if",!0):(k(),V($,{key:0},[U((k(),F(H(T(Z)),null,null,512)),[[M,e<=c.value]]),U((k(),F(H(T(Y)),null,null,512)),[[M,!(e<=c.value)]])],64)),G(e)?(k(),V($,{key:1},[(k(),F(H(T(Y)),{class:S([T(r).em("decimal","box")])},null,8,["class"])),N(T(A),{style:L(T(Q)),class:S([T(r).e("icon"),T(r).e("decimal")])},{default:O((()=>[(k(),F(H(T(X))))])),_:1},8,["style","class"])],64)):C("v-if",!0)])),_:2},1032,["class"])],42,["onMousemove","onClick"])))),128)),e.showText||e.showScore?(k(),V("span",{key:0,class:S(T(r).e("text")),style:L({color:e.textColor})},B(T(z)),7)):C("v-if",!0)],46,["id","aria-label","aria-labelledby","aria-valuenow","aria-valuetext","aria-valuemax"])}}}),[["__file","rate.vue"]])),be={class:"container flex"},he={class:"menu"},ye={class:"info-row"},ge={class:"collection"},xe={class:"nav"},je={class:"collection-list-tag"},we={key:0,class:"white-card"},Ve={class:"product-left"},ke=["src"],Ce={style:{"line-height":"2"}},$e={class:"product-right"},Ie={class:"lab-text"},Se={key:0},Te={class:"tips"},Ne={class:"lab-text"},Oe={key:0,class:"label-list"},Ue=["onClick"],Fe=["onClick"],He={key:1,class:"label-edit-input"},Me=["onClick"],Ae={key:1,class:"label-list"},Le={class:"label-item-txt"},Be={class:"lab-text"},Ee=["placeholder","onUpdate:modelValue","disabled"],qe={key:1},Je={class:"tips"},Pe={class:"lab-text"},ze={key:1},De=G(p({__name:"Info",setup(s){b(999),b(0);const i=b(["1分","2分","3分","4分","5分"]),n=b(!0),r=b(["送货快","质量很好","服务周到","正品","很划算","包装仔细","价格实惠","还可以","相当好"]),d=b([]);P((()=>{u()}));const u=async()=>{try{d.value=[];const e=await ue({id:c.currentRoute.value.query.id});e.item.items.map((e=>{e.all_comment_tag=JSON.parse(JSON.stringify(r.value)),Object.assign(e,{comment_rank:0,content:"",show_pics:[],comment_tag:[],isAdd:!1,rank_verification:!0,content_verification:!0,isCommentInfo:!!e.comment_info},e.comment_info)})),Object.assign(d.value,e.item.items);d.value.every((e=>1===e.is_showed))&&D("/member/comment/list?order_type=2")}catch(e){K.error(e.message)}finally{n.value=!1}},c=z(),m=b(""),v=(e,a)=>{let l=d.value[e].comment_tag;l.includes(a)?d.value[e].comment_tag=l.filter((e=>e!==a)):l.push(a)};return(s,n)=>{const r=e,c=a,p=l,f=t,_=o,b=_e,h=ne,y=Z,g=re,x=de;return k(),V($,null,[N(r),N(c,{title:"评价晒单"}),W("div",be,[W("div",he,[N(p)]),W("div",ye,[W("div",ge,[W("div",xe,[W("div",je,B(s.$t("订单评价")),1),W("div",null,[Q(B(s.$t("评价立送")),1),n[1]||(n[1]=W("span",{class:"font-color"},"5",-1)),Q(B(s.$t("积分"))+"，"+B(s.$t("晒单额外赠送")),1),n[2]||(n[2]=W("span",{class:"font-color"},"5",-1)),Q(B(s.$t("积分")),1)])]),(k(!0),V($,null,I(d.value,((e,a)=>(k(),V("div",null,[e.is_showed?C("",!0):(k(),V("div",we,[W("div",Ve,[N(_,{title:e.product_name,to:("urlFormat"in s?s.urlFormat:T(X))({path:"product",id:e.product_id,sn:e.product_sn}),class:"nuxt",target:"_blank"},{default:O((()=>[W("div",null,[W("img",{alt:"",src:("imageFormat"in s?s.imageFormat:T(R))(e.pic_thumb)},null,8,ke)]),W("div",null,[W("div",Ce,[W("a",null,B(e.product_name),1)]),W("div",null,[N(f,{modelValue:e.price,"onUpdate:modelValue":a=>e.price=a,showText:!1},null,8,["modelValue","onUpdate:modelValue"])])])])),_:2},1032,["title","to"])]),W("div",$e,[W("div",null,[W("span",Ie,B(s.$t("商品评分"))+"：",1),W("span",null,[N(b,{disabled:e.isCommentInfo,modelValue:e.comment_rank,"onUpdate:modelValue":a=>e.comment_rank=a,size:"large",texts:i.value,"show-text":""},null,8,["disabled","modelValue","onUpdate:modelValue","texts"])])]),e.rank_verification?C("",!0):(k(),V("div",Se,[n[3]||(n[3]=W("span",{class:"lab-text"},null,-1)),W("p",Te,B(s.$t("请先评价商品")),1)])),W("div",null,[W("div",Ne,B(s.$t("评价标签"))+"：",1),e.isCommentInfo?(k(),V("div",Ae,[(k(!0),V($,null,I(e.comment_tag,(e=>(k(),V("div",Le,[W("span",null,B(e),1)])))),256))])):(k(),V("div",Oe,[(k(!0),V($,null,I(e.all_comment_tag,(l=>(k(),V("div",{style:L({border:e.comment_tag.includes(l)?" 2px solid var(--general)":" 1px solid #ccc"}),class:"label-item",onClick:e=>v(a,l)},[W("span",null,B(s.$t(l)),1)],12,Ue)))),256)),e.isAdd?(k(),V("div",He,[W("div",null,[N(h,{modelValue:m.value,"onUpdate:modelValue":n[0]||(n[0]=e=>m.value=e),autofocus:""},null,8,["modelValue"])]),W("p",{onClick:e=>(e=>{if(""!==m.value){const a=JSON.parse(JSON.stringify(d.value[e].all_comment_tag));a.push(m.value),d.value[e].all_comment_tag=a,v(e,m.value)}m.value="",d.value[e].isAdd=!1})(a)},B(s.$t("确定")),9,Me)])):(k(),V("div",{key:0,class:"label-edit",onClick:e=>(e=>{d.value[e].isAdd=!d.value[e].isAdd})(a)},[n[4]||(n[4]=W("div",null,null,-1)),W("p",null,B(s.$t("自定义")),1)],8,Fe))]))]),W("div",null,[W("div",Be,B(s.$t("购物心得"))+"：",1),U(W("textarea",{cols:"50",name:"content",placeholder:s.$t("商品是否给力？快分享你的购买心得吧~"),rows:"5",style:{border:"1px solid #d9d9d9",padding:"4px"},"onUpdate:modelValue":a=>e.content=a,disabled:e.isCommentInfo},null,8,Ee),[[Y,e.content]])]),e.content_verification?C("",!0):(k(),V("div",qe,[n[5]||(n[5]=W("span",{class:"lab-text"},null,-1)),W("p",Je,B(s.$t("请填写购买心得")),1)])),W("div",null,[W("div",Pe,B(s.$t("晒单"))+"：",1),e.is_showed?(k(),V("div",ze,[(k(!0),V($,null,I(e.show_pics,(e=>(k(),F(y,{src:("imageFormat"in s?s.imageFormat:T(R))(e.pic_thumb),loading:"lazy",style:{height:"80px",width:"80px",transition:"opacity 0.2s linear","margin-right":"10px"}},null,8,["src"])))),256))])):(k(),F(me,{key:0,uploadList:e.show_pics,"onUpdate:uploadList":a=>e.show_pics=a,limit:9,fileTypes:["jpeg","png"]},null,8,["uploadList","onUpdate:uploadList"]))]),W("div",null,[N(g,{type:"primary",onClick:a=>(async e=>{if(e.comment_rank<1)e.rank_verification=!1;else if(""!=e.content)try{const a={product_id:e.product_id,order_id:e.order_id,order_item_id:e.item_id,shop_id:e.shop_id,comment_rank:e.comment_rank,comment_tag:e.comment_tag,content:e.content,show_pics:e.show_pics},l=await ce(a);e.rank_verification=!0,e.content_verification=!0,K.success(l.message),u()}catch(a){K.error(a.message)}else e.content_verification=!1})(e)},{default:O((()=>[Q(B(s.$t("提交评论")),1)])),_:2},1032,["onClick"])])])]))])))),256))])])]),N(x)],64)}}}),[["__scopeId","data-v-05542c40"]]);export{De as default};
