import{aq as e,e as l,cc as a,cb as s,r as n,y as i,z as t,s as c,C as u,c as o,o as v,a as r,h as g,F as d,l as _,d as h,t as p,v as m,ag as f,_ as k}from"./BLNaUqdG.js";const y={class:"flex align-center"},w={key:0},x={key:1},C={key:0,class:"select_popup"},b={class:"top flex justify-between"},j={class:"tabs flex"},E=["onClick"],V={key:0,class:"sec_childs"},L=["onClick"],S=k(l({__name:"SelectRegion",props:{modelValue:{default:[]},modelModifiers:{}},emits:a(["change"],["update:modelValue"]),setup(l,{emit:a}){const k=s(l,"modelValue"),S=n(!1),$=n([]),q=n(0),z=a;i((()=>{M()}));const{t:F}=t(),I=n(!1),M=async()=>{try{let a=k.value.join();const s=await(l=a,e({url:"sys/region/get_region",method:"get",params:{region_ids:l}}));s.region_list&&0==s.region_list[s.region_list.length-1].length&&(S.value=!1,I.value=!0),Object.assign($.value,s.region_list),q.value=$.value.length>1?$.value.length-1:0}catch(a){}var l},O=e=>k.value.includes(e),P=()=>{S.value=!0,M()},R=c((()=>{let e=[];return $.value.forEach(((l,a)=>{if(l.length>0){let s=!1;l.forEach((l=>{O(l.region_id)&&(e[a]=l.region_name,s=!0)})),0==s&&(e[a]=F("请选择地区"))}})),e})),A=()=>{!0===S.value&&k.value.length!=R.value.length&&(k.value=[],$.value=[],q.value=0),S.value=!1},B=n(null),D=e=>{B.value&&!B.value.contains(e.target)&&A()};return i((()=>{window.addEventListener("click",D)})),u((()=>{window.removeEventListener("click",D)})),(e,l)=>(v(),o("div",{class:"select_region_box",ref_key:"selectPop",ref:B},[r("div",y,[r("div",{class:"select_region hand-pointer flex align-center",onClick:P},[R.value.length>0?(v(),o("div",w,[(v(!0),o(d,null,_(R.value,((e,l)=>(v(),o(d,null,[h(p(e)+" ",1)],64)))),256))])):g("",!0),0==R.value.length?(v(),o("div",x,p(e.$t("请选择地区")),1)):g("",!0),l[0]||(l[0]=r("i",{class:"iconfont-pc icon-xiajiantou"},null,-1))])]),S.value?(v(),o("div",C,[r("div",b,[r("div",j,[(v(!0),o(d,null,_(R.value,((l,a)=>(v(),o("div",{class:m(["tab",{cur:q.value===a}]),onClick:e=>q.value=a},p(l||e.$t("请选择")),11,E)))),256))]),$.value.length==q.value+1?(v(),o("div",{key:0,class:"selectclose",onClick:f(A,["stop"])},"×")):g("",!0)]),(v(!0),o(d,null,_($.value,((e,l)=>(v(),o(d,null,[q.value===l?(v(),o("div",V,[(v(!0),o(d,null,_(e,(e=>(v(),o("span",{class:m(["sec_item",{active:O(e.region_id)}]),onClick:a=>(async(e,l)=>{e>=0&&e<=k.value.length&&(k.value[e]=l,k.value.splice(e+1)),await M(),$.value.length==e+1?(S.value=!1,I.value=!0):q.value=e+1,z("change")})(l,e.region_id)},p(e.region_name),11,L)))),256))])):g("",!0)],64)))),256))])):g("",!0)],512))}}),[["__scopeId","data-v-9e831aac"]]);export{S};
