import{_ as e}from"./DIcT5qlW.js";import{_ as l}from"./nl8XxKER.js";import{E as o,a}from"./123WnbAt.js";import{E as s}from"./duVALuQ5.js";import{_ as r}from"./Bd89_3a4.js";import{E as i,a as t}from"./DKvZ9Rd6.js";import{E as d}from"./OZUBBuO3.js";import{_ as m}from"./B6kpiin_.js";import{e as u,z as p,r as n,I as b,g as v,c as f,o as c,b as w,a as g,t as j,w as y,m as _,h as C,d as E,i as $,F as h,cd as V,A as T,ae as k,_ as U}from"./vO8z_6wc.js";import"./C_yTnQv7.js";import{s as q,a as x}from"./Ck8cvsow.js";import{M as A}from"./BwrAIjIS.js";import{u as F}from"./Ctuj9lAE.js";import"./DEtxbcwL.js";import"./DRy-t1KR.js";import"./D_Dr4eZ1.js";import"./CdIa5lAL.js";import"./CKVP4sCQ.js";import"./VsleDggW.js";import"./B0jPhJeY.js";import"./BwRzfsZt.js";import"./DqoL2U0I.js";import"./BG07ctRk.js";import"./y2YKyhRU.js";import"./DgmxjSXK.js";import"./DSXY0Md2.js";const M={class:"full-height-div"},S={class:"register-info"},Z={class:"title"},z={class:"label"},D={class:"area-code-select"},I={class:"label"},W={class:"label"},B={class:"label"},J=U(u({__name:"BindMobilePhone",setup(u){const U=F(),{t:J}=p(),L=n(!1),O=b(),P=(e,l,o)=>{K.value.tigTips[e]=l?{type:"valid",message:o}:{type:"error",message:o}},Q=e=>{K.value.tigTips[e]={type:"info",message:R[e]}},R=v({mobile:J("请填写正确的手机号码，以便接收订单通知，找回密码等"),mail:J("请填写正确的邮箱地址，以便接收订单通知，找回密码等"),mobileCode:J("请输入验证码"),password:J("6-20个大小写英文字母、符号或数字的组合")}),G=v({mobile:[{validator:(e,l,o)=>l?/^(?=.*\D).+$/.test(l)?o(new Error(J("格式错误，请输入正确的手机号码"))):void o():o(new Error(J("手机号不能为空"))),trigger:"blur",required:!0}],mail:[{validator:(e,l,o)=>l?/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(l)?void o():o(new Error(J("格式错误，请输入正确的邮箱地址"))):o(new Error(J("邮箱不能为空"))),trigger:"blur",required:!0}],mobileCode:[{validator:(e,l,o)=>l?6!=l.length?o(new Error(J("请输入6位验证码"))):void o():o(new Error(J("验证码不能为空"))),trigger:"blur",required:!0}],password:[{validator:(e,l,o)=>l?l.length>20||l.length<6?o(new Error(J("密码应为6-20位字符"))):/\s/.test(l)?o(new Error(J("密码中不允许有空格"))):/^\d+$/.test(l)?o(new Error(J("密码不能全为数字"))):/^(?=.*[\d\W]).+$/.test(l)?/^(?=.*[a-zA-Z0-9]).+$/.test(l)?/^(?!([a-zA-Z0-9])\1*$).+$/.test(l)?void o():o(new Error(J("密码不能全为相同字符或数字"))):o(new Error(J("密码不能全为符号"))):o(new Error(J("密码不能全为字母"))):o(new Error(J("密码不能为空"))),trigger:"blur",required:!0}]}),H=n(!1),K=n({tigTips:{},areaCode:""}),N=async()=>{await O.value.validate();try{H.value=!0;const e=await x({...K.value,openData:U.openData});V.success(J("绑定成功"));T("accessToken").value=e.token,U.userInfoLoaded=!1,k("/member/")}catch(e){V.error(e.message)}finally{H.value=!1}},X=e=>{V.error(e)};return(u,p)=>{const n=e,b=l,v=a,V=o,T=s,k=r,U=i,x=d,F=t,J=m;return c(),f(h,null,[w(n,{title:"绑定手机"}),w(b,{type:"register"}),g("div",M,[g("div",S,[g("div",Z,j(u.$t("绑定手机")),1),w(F,{ref_key:"formRef",ref:O,"hide-required-asterisk":!0,model:K.value,rules:$(G),"show-message":!1,class:"form-body","label-width":"auto",onValidate:P},{default:y((()=>["mobile"!==K.value.registType&&K.value.registType?(c(),_(U,{key:1,prop:"mail"},{default:y((()=>[g("div",I,j(u.$t("邮箱")),1),w(T,{modelValue:K.value.mail,"onUpdate:modelValue":p[3]||(p[3]=e=>K.value.mail=e),class:"input-border-style",onFocus:p[4]||(p[4]=e=>Q("mail"))},null,8,["modelValue"]),w(k,{info:K.value.tigTips.mail},null,8,["info"])])),_:1})):(c(),_(U,{key:0,prop:"mobile"},{default:y((()=>[g("div",z,j(u.$t("手机号")),1),w(T,{modelValue:K.value.mobile,"onUpdate:modelValue":p[1]||(p[1]=e=>K.value.mobile=e),class:"input-border-style",style:{},onFocus:p[2]||(p[2]=e=>Q("mobile"))},{prefix:y((()=>[g("div",D,[w(V,{modelValue:K.value.areaCode,"onUpdate:modelValue":p[0]||(p[0]=e=>K.value.areaCode=e),placeholder:u.$t("请选择区号")},{default:y((()=>[w(v,{label:"(+86)"+u.$t("中国"),value:""},null,8,["label"]),w(v,{label:"(+61)"+u.$t("澳洲"),value:"+61"},null,8,["label"])])),_:1},8,["modelValue","placeholder"])])])),_:1},8,["modelValue"]),w(k,{info:K.value.tigTips.mobile},null,8,["info"])])),_:1})),C("",!0),w(U,{prop:"mobileCode"},{default:y((()=>[g("div",W,j(u.$t("验证码")),1),w(T,{modelValue:K.value.mobileCode,"onUpdate:modelValue":p[10]||(p[10]=e=>K.value.mobileCode=e),class:"input-border-style",onFocus:p[11]||(p[11]=e=>Q("mobileCode"))},{suffix:y((()=>[w($(A),{class:"mobile-code-text",mobile:K.value.mobile,"onUpdate:mobile":p[7]||(p[7]=e=>K.value.mobile=e),mobileCode:K.value.mobileCode,"onUpdate:mobileCode":p[8]||(p[8]=e=>K.value.mobileCode=e),mobileCodeSended:L.value,"onUpdate:mobileCodeSended":p[9]||(p[9]=e=>L.value=e),requestApi:$(q),onMobileErrorCallback:X},null,8,["mobile","mobileCode","mobileCodeSended","requestApi"])])),_:1},8,["modelValue"]),w(k,{info:K.value.tigTips.mobileCode},null,8,["info"])])),_:1}),w(U,{prop:"password"},{default:y((()=>[g("div",B,j(u.$t("设置密码")),1),w(T,{modelValue:K.value.password,"onUpdate:modelValue":p[12]||(p[12]=e=>K.value.password=e),class:"input-border-style","show-password":"",type:"password",onFocus:p[13]||(p[13]=e=>Q("password"))},null,8,["modelValue"]),w(k,{info:K.value.tigTips.password},null,8,["info"])])),_:1}),w(U,{label:"",prop:"firstWord"},{default:y((()=>[w(x,{loading:H.value,type:"primary",class:"submit-button",style:{width:"330px"},onClick:N},{default:y((()=>[E(j(u.$t("确认")),1)])),_:1},8,["loading"])])),_:1})])),_:1},8,["model","rules"])])]),w(J,{bg:"white",type:0})],64)}}}),[["__scopeId","data-v-6b8a572d"]]);export{J as default};
