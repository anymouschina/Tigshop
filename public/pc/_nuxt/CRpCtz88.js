import{at as a,aq as t,ap as s,r as e,e as o,cc as l,f as r,aj as d,cb as i,Q as c,c as u,o as p,F as n,a as m,h as _,l as v,b as y,i as f,q as h,w as g,E as k,j as b,d as j,t as P,ah as $,m as C,aa as q,ak as x,v as z,_ as U}from"./BLNaUqdG.js";import{_ as V}from"./DGSQZaL6.js";import{_ as w}from"./CScYj7Fy.js";import{E}from"./CK-rvtuG.js";import{B as M}from"./BynQilW0.js";import{t as Q}from"./CTzMDe2j.js";import{P as B}from"./DE8qoeTi.js";import{g as F}from"./DxPtKouI.js";const G=t=>a({url:"search/search/get_filter",method:"get",params:t}),I=s("search",(()=>({total:e(0)}))),J={class:"goods-list-c"},L={class:"wrap"},O={class:"g-item-warp"},T={class:"pic"},Y={class:"info"},A={class:"name"},D={key:0,class:"shop-info"},H={key:1,class:"shop-name"},K={class:"promotion-box"},N={key:0,class:"activity"},R={key:1,class:"promotion"},S={class:"ticket-type"},W={class:"ticket-content"},X={class:"item_cart_num"},Z={class:"shopping_num"},aa=["onUpdate:modelValue"],ta=["onClick"],sa=["onClick"],ea={class:"shopping_act"},oa={key:0,class:"search-empty"},la={class:"bd"},ra={class:"pagination"},da=U(o({__name:"CatGoodsList",props:l({queryParams:{type:Object,default:{}}},{filter:{},filterModifiers:{},queryParams:{},queryParamsModifiers:{},loadingProduct:{},loadingProductModifiers:{}}),emits:l(["change","pageChange"],["update:filter","update:queryParams","update:loadingProduct"]),setup(a,{emit:s}){const o=r(),l=a,U=I(),G=d(),da=e(25),ia=s,ca=i(a,"filter"),ua=i(a,"queryParams");e();const pa=i(a,"loadingProduct"),na=e([]),ma=e({}),_a=async()=>{try{pa.value=!0,na.value=[];const s=await(a={...l.queryParams,size:da.value},t({url:"search/search/get_product",method:"get",params:a}));na.value=s.product_list,U.total=s.total??0,na.value.forEach((a=>{a.number=1}));const e=s.product_list.map((a=>({product_id:a.product_id})));va({products:e,from:"list"})}catch(s){}finally{pa.value=!1}var a},va=async a=>{try{const t=await Q({products:a.products,shop_id:a.shop_id,from:a.from});ma.value=t.list}catch(t){console.error(t)}},ya={1:"秒杀价",2:"券",3:"满减",4:"折扣",5:"满赠",6:"限时折扣"};c((()=>ua.value),(()=>{_a()}),{deep:!0,immediate:!0});const fa=e(null),ha=()=>{ia("change",ca.value.page),ia("pageChange")},ga=()=>{G.back()};return(a,t)=>{const s=k,e=V,l=w,r=E,d=M;return p(),u(n,null,[m("div",{class:"goods-list__box",ref_key:"productBox",ref:fa},[m("div",J,[m("div",L,[(p(!0),u(n,null,v(na.value,((i,c)=>(p(),u("div",{class:"item",key:c},[m("div",O,[m("div",T,[y(e,{to:f(h)({path:"product",id:i.product_id,sn:i.product_sn}),target:"_blank"},{default:g((()=>[y(s,{class:"ease",lazy:"",src:f(b)(i.pic_url)},null,8,["src"])])),_:2},1032,["to"])]),m("div",Y,[y(l,{class:"",modelValue:i.product_price,"onUpdate:modelValue":a=>i.product_price=a},null,8,["modelValue","onUpdate:modelValue"]),m("div",A,[y(e,{to:f(h)({path:"product",id:i.product_id,sn:i.product_sn}),target:"_blank"},{default:g((()=>[j(P(i.product_name),1)])),_:2},1032,["to"])]),f($)()?(p(),u("div",D,[i.shop?(p(),C(e,{key:0,class:"shop-name",to:f(h)({path:"shop",id:i.shop_id}),target:"_blank"},{default:g((()=>[j(P(i.shop.shop_title),1)])),_:2},1032,["to"])):(p(),u("div",H,P(f(o).default_shop_name?f(o).default_shop_name:a.$t("官方自营")),1))])):_("",!0),m("div",K,[ma.value[i.product_id]&&ma.value[i.product_id].activity_info&&ma.value[i.product_id].activity_info.length>0?(p(!0),u(n,{key:0},v(ma.value[i.product_id].activity_info,(s=>{return p(),u("div",{class:"promotion-box-item",key:s.product_id},[2!=s.type?(p(),u("div",N,P(a.$t((e=s.type,ya[e]))),1)):_("",!0),2==s.type?(p(),u("div",R,[m("div",S,[j(P(a.$t("券"))+" ",1),t[1]||(t[1]=m("span",{class:"ticket-line"},null,-1))]),m("div",W,P(s.data.promotion_desc),1)])):_("",!0)]);var e})),128)):_("",!0)]),m("div",X,[m("div",Z,[q(m("input",{"onUpdate:modelValue":a=>i.number=a,type:"text"},null,8,aa),[[x,i.number]]),m("span",null,[m("a",{class:"add",href:"javascript:;",onClick:a=>(a=>{a.number&&a.number++})(i)},null,8,ta),m("a",{class:z(["decrease",i.number&&i.number<=1?"disabled":""]),href:"javascript:;",onClick:a=>(a=>{a.number&&a.number>1&&a.number--})(i)},null,10,sa)])]),m("div",ea,[i.product_sku&&i.product_sku.length>0?(p(),C(e,{key:0,to:f(h)({path:"product",id:i.product_id,sn:i.product_sn})},{default:g((()=>[y(r,{size:"small",type:"primary"},{default:g((()=>[j(P(a.$t(f(F)(i.product_type))),1)])),_:2},1024)])),_:2},1032,["to"])):(p(),C(d,{key:1,isQuick:1!==i.product_type,id:i.product_id,disabled:0==i.product_stock,number:i.number},{default:g((()=>[y(r,{disabled:0==i.product_stock,size:"small",type:"primary"},{default:g((()=>[j(P(a.$t(f(F)(i.product_type))),1)])),_:2},1032,["disabled"])])),_:2},1032,["isQuick","id","disabled","number"]))])])])])])))),128)),0!==na.value.length||pa.value?_("",!0):(p(),u("div",oa,[m("div",la,[m("h4",null,P(a.$t("好狠的筛选条件啊，把相关的商品都埋没了！")),1),m("p",null,P(a.$t("建议您")),1),m("p",null,P(a.$t("1、适当减少筛选条件")),1),m("p",null,P(a.$t("2、调整价格区间")),1),m("p",null,P(a.$t("3、尝试其他关键字")),1),y(r,{class:"graybtn mt10",onClick:ga},{default:g((()=>[j(P(a.$t("返回上一步")),1)])),_:1})])]))])])],512),m("div",ra,[f(U).total>0?(p(),C(f(B),{key:0,page:ca.value.page,"onUpdate:page":t[0]||(t[0]=a=>ca.value.page=a),size:da.value,total:f(U).total,onCallback:ha},null,8,["page","size","total"])):_("",!0)])],64)}}}),[["__scopeId","data-v-ee91c420"]]);export{da as C,G as g,I as u};
