import{_ as Ve}from"./BYDV-pPC.js";import{_ as Ce}from"./uNNarvbF.js";import{_ as ke}from"./DA1gAKyu.js";import{_ as xe}from"./CPg1UVcC.js";import{_ as Ie}from"./CzQrJ5jx.js";import{A as Se,L as te,bp as de,d4 as j,B as ue,d5 as $e,a_ as Te,T as me,f as re,M as pe,D as Ee,r as C,v as y,g as Ne,o as s,c,F as x,l as F,n as S,j as n,ab as J,t as _,i as T,K as Ae,bS as ae,S as _e,bf as le,bi as ve,bb as z,bA as fe,b as g,w as q,a5 as ne,h as $,N as K,ai as he,E as be,P as De,H as Fe,a1 as Me,m as se,q as He,a,d as R,x as ye,z as Be,a6 as Le,p as Oe,e as Pe,y as Ue,_ as je}from"./DvlzeZYf.js";import{c as ze,a as Ke,d as Re,e as Je,f as We}from"./BxwJi-A4.js";import{C as qe,U as W}from"./BB_Ol6Sd.js";import{E as Ge}from"./lRlBa-wu.js";import{E as Xe}from"./XomGKeK5.js";import{_ as Qe}from"./BCw_XNK7.js";import{g as Ye,u as Ze}from"./DI-T9in3.js";import{U as eo}from"./BDZmXE2g.js";import"./CljOOE4N.js";import"./ctHFjQ9z.js";import"./6IjmK16v.js";import"./DXZCNwre.js";import"./B9SirqjL.js";import"./CvS5MqkS.js";import"./Cq9Fpw4b.js";import"./D5p5RYpQ.js";import"./DGzzo1G8.js";import"./DldgdBu3.js";import"./DCTLXrZ8.js";import"./De9iyrrl.js";import"./C3hftOhu.js";import"./CFi7q_x0.js";/* empty css        */import"./JPAiA_Rf.js";import"./DEXPT9kT.js";import"./BpsRniw3.js";import"./DrjGOYyT.js";import"./eXzid_I5.js";import"./DHvqcBjr.js";import"./BMKQ3sGo.js";const oo=Se({modelValue:{type:Number,default:0},id:{type:String,default:void 0},lowThreshold:{type:Number,default:2},highThreshold:{type:Number,default:4},max:{type:Number,default:5},colors:{type:te([Array,Object]),default:()=>de(["","",""])},voidColor:{type:String,default:""},disabledVoidColor:{type:String,default:""},icons:{type:te([Array,Object]),default:()=>[j,j,j]},voidIcon:{type:ue,default:()=>$e},disabledVoidIcon:{type:ue,default:()=>j},disabled:Boolean,allowHalf:Boolean,showText:Boolean,showScore:Boolean,textColor:{type:String,default:""},texts:{type:te(Array),default:()=>de(["Extremely bad","Disappointed","Fair","Satisfied","Surprise"])},scoreTemplate:{type:String,default:"{value}"},size:Te,clearable:Boolean,...ze(["ariaLabel"])}),to={[qe]:w=>me(w),[W]:w=>me(w)},ao=re({name:"ElRate"}),lo=re({...ao,props:oo,emits:to,setup(w,{expose:G,emit:I}){const o=w;function f(t,r){const d=b=>_e(b),V=Object.keys(r).map(b=>+b).filter(b=>{const U=r[b];return(d(U)?U.excluded:!1)?t<b:t<=b}).sort((b,U)=>b-U),D=r[V[0]];return d(D)&&D.value||D}const E=pe(Je,void 0),H=pe(We,void 0),k=Ke(),v=Ee("rate"),{inputId:X,isLabeledByFormItem:N}=Re(o,{formItemContext:H}),u=C(o.modelValue),e=C(-1),m=C(!0),p=y(()=>[v.b(),v.m(k.value)]),h=y(()=>o.disabled||(E==null?void 0:E.disabled)),Q=y(()=>v.cssVarBlock({"void-color":o.voidColor,"disabled-void-color":o.disabledVoidColor,"fill-color":O.value})),B=y(()=>{let t="";return o.showScore?t=o.scoreTemplate.replace(/\{\s*value\s*\}/,h.value?`${o.modelValue}`:`${u.value}`):o.showText&&(t=o.texts[Math.ceil(u.value)-1]),t}),L=y(()=>o.modelValue*100-Math.floor(o.modelValue)*100),Y=y(()=>ae(o.colors)?{[o.lowThreshold]:o.colors[0],[o.highThreshold]:{value:o.colors[1],excluded:!0},[o.max]:o.colors[2]}:o.colors),O=y(()=>{const t=f(u.value,Y.value);return _e(t)?"":t}),Z=y(()=>{let t="";return h.value?t=`${L.value}%`:o.allowHalf&&(t="50%"),{color:O.value,width:t}}),P=y(()=>{let t=ae(o.icons)?[...o.icons]:{...o.icons};return t=le(t),ae(t)?{[o.lowThreshold]:t[0],[o.highThreshold]:{value:t[1],excluded:!0},[o.max]:t[2]}:t}),ee=y(()=>f(o.modelValue,P.value)),l=y(()=>h.value?ve(o.disabledVoidIcon)?o.disabledVoidIcon:le(o.disabledVoidIcon):ve(o.voidIcon)?o.voidIcon:le(o.voidIcon)),A=y(()=>f(u.value,P.value));function i(t){const r=h.value&&L.value>0&&t-1<o.modelValue&&t>o.modelValue,d=o.allowHalf&&m.value&&t-.5<=u.value&&t>u.value;return r||d}function oe(t){o.clearable&&t===o.modelValue&&(t=0),I(W,t),o.modelValue!==t&&I("change",t)}function ge(t){h.value||(o.allowHalf&&m.value?oe(u.value):oe(t))}function we(t){if(h.value)return;let r=u.value;const d=t.code;return d===z.up||d===z.right?(o.allowHalf?r+=.5:r+=1,t.stopPropagation(),t.preventDefault()):(d===z.left||d===z.down)&&(o.allowHalf?r-=.5:r-=1,t.stopPropagation(),t.preventDefault()),r=r<0?0:r,r=r>o.max?o.max:r,I(W,r),I("change",r),r}function ie(t,r){if(!h.value){if(o.allowHalf&&r){let d=r.target;fe(d,v.e("item"))&&(d=d.querySelector(`.${v.e("icon")}`)),(d.clientWidth===0||fe(d,v.e("decimal")))&&(d=d.parentNode),m.value=r.offsetX*2<=d.clientWidth,u.value=m.value?t-.5:t}else u.value=t;e.value=t}}function ce(){h.value||(o.allowHalf&&(m.value=o.modelValue!==Math.floor(o.modelValue)),u.value=o.modelValue,e.value=-1)}return Ne(()=>o.modelValue,t=>{u.value=t,m.value=o.modelValue!==Math.floor(o.modelValue)}),o.modelValue||I(W,0),G({setCurrentValue:ie,resetCurrentValue:ce}),(t,r)=>{var d;return s(),c("div",{id:n(X),class:S([n(p),n(v).is("disabled",n(h))]),role:"slider","aria-label":n(N)?void 0:t.ariaLabel||"rating","aria-labelledby":n(N)?(d=n(H))==null?void 0:d.labelId:void 0,"aria-valuenow":u.value,"aria-valuetext":n(B)||void 0,"aria-valuemin":"0","aria-valuemax":t.max,tabindex:"0",style:J(n(Q)),onKeydown:we},[(s(!0),c(x,null,F(t.max,(V,D)=>(s(),c("span",{key:D,class:S(n(v).e("item")),onMousemove:b=>ie(V,b),onMouseleave:ce,onClick:b=>ge(V)},[g(n(be),{class:S([n(v).e("icon"),{hover:e.value===V},n(v).is("active",V<=u.value)])},{default:q(()=>[i(V)?T("v-if",!0):(s(),c(x,{key:0},[ne((s(),$(K(n(A)),null,null,512)),[[he,V<=u.value]]),ne((s(),$(K(n(l)),null,null,512)),[[he,!(V<=u.value)]])],64)),i(V)?(s(),c(x,{key:1},[(s(),$(K(n(l)),{class:S([n(v).em("decimal","box")])},null,8,["class"])),g(n(be),{style:J(n(Z)),class:S([n(v).e("icon"),n(v).e("decimal")])},{default:q(()=>[(s(),$(K(n(ee))))]),_:1},8,["style","class"])],64)):T("v-if",!0)]),_:2},1032,["class"])],42,["onMousemove","onClick"]))),128)),t.showText||t.showScore?(s(),c("span",{key:0,class:S(n(v).e("text")),style:J({color:t.textColor})},_(n(B)),7)):T("v-if",!0)],46,["id","aria-label","aria-labelledby","aria-valuenow","aria-valuetext","aria-valuemax"])}}});var so=Ae(lo,[["__file","rate.vue"]]);const no=De(so),M=w=>(Oe("data-v-0073d99b"),w=w(),Pe(),w),ro={class:"container flex"},io={class:"menu"},co={class:"info-row"},uo={class:"collection"},mo={class:"nav"},po={class:"collection-list-tag"},_o=M(()=>a("span",{class:"font-color"},"5",-1)),vo=M(()=>a("span",{class:"font-color"},"5",-1)),fo={key:0,class:"white-card"},ho={class:"product-left"},bo=["src"],yo={style:{"line-height":"2"}},go={class:"product-right"},wo={class:"lab-text"},Vo={key:0},Co=M(()=>a("span",{class:"lab-text"},null,-1)),ko={class:"tips"},xo={class:"lab-text"},Io={key:0,class:"label-list"},So=["onClick"],$o=["onClick"],To=M(()=>a("div",null,null,-1)),Eo={key:1,class:"label-edit-input"},No=["onClick"],Ao={key:1,class:"label-list"},Do={class:"label-item-txt"},Fo={class:"lab-text"},Mo=["placeholder","onUpdate:modelValue","disabled"],Ho={key:1},Bo=M(()=>a("span",{class:"lab-text"},null,-1)),Lo={class:"tips"},Oo={class:"lab-text"},Po={key:1},Uo=re({__name:"Info",setup(w){C(999),C(0);const G=C(["1分","2分","3分","4分","5分"]),I=C(!0),o=C(["送货快","质量很好","服务周到","正品","很划算","包装仔细","价格实惠","还可以","相当好"]),f=C([]);Fe(()=>{E()});const E=async()=>{try{f.value=[];const e=await Ye({id:H.currentRoute.value.query.id});e.item.items.map(p=>{p.all_comment_tag=JSON.parse(JSON.stringify(o.value)),Object.assign(p,{comment_rank:0,content:"",show_pics:[],comment_tag:[],isAdd:!1,rank_verification:!0,content_verification:!0,isCommentInfo:!!p.comment_info},p.comment_info)}),Object.assign(f.value,e.item.items),f.value.every(p=>p.is_showed===1)&&Me("/member/comment/list?order_type=2")}catch(e){se.error(e.message)}finally{I.value=!1}},H=He(),k=C(""),v=e=>{f.value[e].isAdd=!f.value[e].isAdd},X=e=>{if(k.value!==""){const m=JSON.parse(JSON.stringify(f.value[e].all_comment_tag));m.push(k.value),f.value[e].all_comment_tag=m,N(e,k.value)}k.value="",f.value[e].isAdd=!1},N=(e,m)=>{let p=f.value[e].comment_tag;p.includes(m)?f.value[e].comment_tag=p.filter(h=>h!==m):p.push(m)},u=async(e,m)=>{if(e.comment_rank<1){e.rank_verification=!1;return}if(e.content==""){e.content_verification=!1;return}try{const p={product_id:e.product_id,order_id:e.order_id,order_item_id:e.item_id,shop_id:e.shop_id,comment_rank:e.comment_rank,comment_tag:e.comment_tag,content:e.content,show_pics:e.show_pics},h=await Ze(p);e.rank_verification=!0,e.content_verification=!0,se.success(h.message),E()}catch(p){se.error(p.message)}finally{}};return(e,m)=>{const p=Ve,h=Ce,Q=ke,B=xe,L=Ie,Y=no,O=Ge,Z=Ue,P=Xe,ee=Qe;return s(),c(x,null,[g(p),g(h,{title:"评价晒单"}),a("div",ro,[a("div",io,[g(Q)]),a("div",co,[a("div",uo,[a("div",mo,[a("div",po,_(e.$t("订单评价")),1),a("div",null,[R(_(e.$t("评价立送")),1),_o,R(_(e.$t("积分"))+"，"+_(e.$t("晒单额外赠送")),1),vo,R(_(e.$t("积分")),1)])]),(s(!0),c(x,null,F(f.value,(l,A)=>(s(),c("div",null,[l.is_showed?T("",!0):(s(),c("div",fo,[a("div",ho,[g(L,{title:l.product_name,to:("urlFormat"in e?e.urlFormat:n(Be))({path:"product",id:l.product_id,sn:l.product_sn}),class:"nuxt",target:"_blank"},{default:q(()=>[a("div",null,[a("img",{alt:"",src:("imageFormat"in e?e.imageFormat:n(ye))(l.pic_thumb)},null,8,bo)]),a("div",null,[a("div",yo,[a("a",null,_(l.product_name),1)]),a("div",null,[g(B,{modelValue:l.price,"onUpdate:modelValue":i=>l.price=i,showText:!1},null,8,["modelValue","onUpdate:modelValue"])])])]),_:2},1032,["title","to"])]),a("div",go,[a("div",null,[a("span",wo,_(e.$t("商品评分"))+"：",1),a("span",null,[g(Y,{disabled:l.isCommentInfo,modelValue:l.comment_rank,"onUpdate:modelValue":i=>l.comment_rank=i,size:"large",texts:G.value,"show-text":""},null,8,["disabled","modelValue","onUpdate:modelValue","texts"])])]),l.rank_verification?T("",!0):(s(),c("div",Vo,[Co,a("p",ko,_(e.$t("请先评价商品")),1)])),a("div",null,[a("div",xo,_(e.$t("评价标签"))+"：",1),l.isCommentInfo?(s(),c("div",Ao,[(s(!0),c(x,null,F(l.comment_tag,i=>(s(),c("div",Do,[a("span",null,_(i),1)]))),256))])):(s(),c("div",Io,[(s(!0),c(x,null,F(l.all_comment_tag,i=>(s(),c("div",{style:J({border:l.comment_tag.includes(i)?" 2px solid var(--general)":" 1px solid #ccc"}),class:"label-item",onClick:oe=>N(A,i)},[a("span",null,_(e.$t(i)),1)],12,So))),256)),l.isAdd?(s(),c("div",Eo,[a("div",null,[g(O,{modelValue:k.value,"onUpdate:modelValue":m[0]||(m[0]=i=>k.value=i),autofocus:""},null,8,["modelValue"])]),a("p",{onClick:i=>X(A)},_(e.$t("确定")),9,No)])):(s(),c("div",{key:0,class:"label-edit",onClick:i=>v(A)},[To,a("p",null,_(e.$t("自定义")),1)],8,$o))]))]),a("div",null,[a("div",Fo,_(e.$t("购物心得"))+"：",1),ne(a("textarea",{cols:"50",name:"content",placeholder:e.$t("商品是否给力？快分享你的购买心得吧~"),rows:"5",style:{border:"1px solid #d9d9d9",padding:"4px"},"onUpdate:modelValue":i=>l.content=i,disabled:l.isCommentInfo},null,8,Mo),[[Le,l.content]])]),l.content_verification?T("",!0):(s(),c("div",Ho,[Bo,a("p",Lo,_(e.$t("请填写购买心得")),1)])),a("div",null,[a("div",Oo,_(e.$t("晒单"))+"：",1),l.is_showed?(s(),c("div",Po,[(s(!0),c(x,null,F(l.show_pics,i=>(s(),$(Z,{src:("imageFormat"in e?e.imageFormat:n(ye))(i.pic_thumb),loading:"lazy",style:{height:"80px",width:"80px",transition:"opacity 0.2s linear","margin-right":"10px"}},null,8,["src"]))),256))])):(s(),$(eo,{key:0,uploadList:l.show_pics,"onUpdate:uploadList":i=>l.show_pics=i,limit:9,fileTypes:["jpeg","png"]},null,8,["uploadList","onUpdate:uploadList"]))]),a("div",null,[g(P,{type:"primary",onClick:i=>u(l)},{default:q(()=>[R(_(e.$t("提交评论")),1)]),_:2},1032,["onClick"])])])]))]))),256))])])]),g(ee)],64)}}}),kt=je(Uo,[["__scopeId","data-v-0073d99b"]]);export{kt as default};
