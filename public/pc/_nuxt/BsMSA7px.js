import{E as q}from"./yqEFMWm8.js";import{_ as x}from"./CPg1UVcC.js";import{_ as A}from"./CzQrJ5jx.js";import{v as G}from"./C_PfpWcu.js";import{f as H,a3 as J,a4 as f,r as S,s as K,g as O,o as t,c as n,a as l,b as v,w as M,t as s,i as a,a5 as Q,F as V,l as w,d as r,n as B,p as R,e as W,_ as X}from"./DvlzeZYf.js";import"./BxwJi-A4.js";import"./CvS5MqkS.js";import"./BB_Ol6Sd.js";import"./Cq9Fpw4b.js";import"./B9SirqjL.js";import"./ctHFjQ9z.js";const _=d=>(R("data-v-093a4715"),d=d(),W(),d),Y={class:"from"},Z={class:"check-box"},ee={class:"tit"},oe={key:0,class:"from_list"},se=_(()=>l("div",{class:"arrow"},null,-1)),te={class:"coupon-box"},ne={key:0,class:"coupon_list"},le=["onClick"],ae=_(()=>l("div",{class:"c-top-dong"},null,-1)),ie={class:"item-selected-cancel"},de={key:0,class:"priceNum"},ce={key:0,class:"coupon-globle"},ue={key:1,class:"zk"},_e={key:0,class:"coupon-globle"},pe={class:"time"},re={class:"detail"},me=_(()=>l("i",{class:"icon-gou"},null,-1)),ve={key:2,class:"coupon-notice"},he=_(()=>l("i",{class:"iconfont-pc icon-tishi"},null,-1)),fe={key:3,class:"coupon-notice"},ye=_(()=>l("i",{class:"iconfont-pc icon-tishi"},null,-1)),ge=_(()=>l("div",{class:"c-top-dong"},null,-1)),be={class:"item-selected-cancel"},ke={key:0,class:"priceNum"},Ce={key:0,class:"coupon-globle"},Ve={key:1,class:"zk"},Ie={key:0,class:"coupon-globle"},Ue={class:"time"},$e={class:"detail"},Le=_(()=>l("i",{class:"icon-gou"},null,-1)),Ne={key:2,class:"coupon-notice"},Se=_(()=>l("i",{class:"iconfont-pc icon-tishi"},null,-1)),Me={key:3,class:"coupon-notice"},we=_(()=>l("i",{class:"iconfont-pc icon-tishi"},null,-1)),Be={key:1,class:"no-cou"},ze=H({__name:"CouponInfo",props:{useCoupon:{type:Boolean},useCouponModifiers:{},couponList:{},couponListModifiers:{},couponLoading:{},couponLoadingModifiers:{},selectedIds:{},selectedIdsModifiers:{},selectedUserCouponIds:{},selectedUserCouponIdsModifiers:{}},emits:J(["change"],["update:useCoupon","update:couponList","update:couponLoading","update:selectedIds","update:selectedUserCouponIds"]),setup(d,{emit:z}){const C=z,y=f(d,"useCoupon"),c=f(d,"couponList"),D=f(d,"couponLoading"),E=S(0);K(["商品优惠券","优惠码兑换"]);const F=()=>{y.value===!1?(I.value=[],g.value=[],C("change")):C("change",!0)},I=f(d,"selectedIds"),g=f(d,"selectedUserCouponIds"),i=S([]);O(c,o=>{o&&o.enable_coupons&&(i.value=o.enable_coupons.filter(m=>m.selected))},{deep:!0,immediate:!0});const P=o=>g.value?g.value.includes(o):!1,T=o=>{const m=Number(o.user_coupon_id);P(m)?i.value=i.value.filter(p=>p.user_coupon_id!==m):(i.value.find(u=>u.shop_id===o.shop_id)?i.value=i.value.filter(u=>u.shop_id!==o.shop_id):i.value.find(h=>h.id===o.id)&&(i.value=i.value.filter(h=>h.id!==o.id)),i.value.push(o)),I.value=i.value.map(({id:p})=>Number(p)),g.value=i.value.map(({user_coupon_id:p})=>Number(p)),C("change")};return(o,m)=>{var U,$,L,N;const p=q,u=x,h=A,j=G;return t(),n("div",null,[l("div",Y,[l("div",Z,[v(p,{modelValue:y.value,"onUpdate:modelValue":m[0]||(m[0]=e=>y.value=e),onChange:F},{default:M(()=>[l("div",ee,s(o.$t("使用优惠券")),1)]),_:1},8,["modelValue"])])]),y.value?(t(),n("div",oe,[se,l("div",te,[a("",!0),Q((t(),n("div",null,[E.value==0?(t(),n("div",ne,[c.value&&(((U=c.value)==null?void 0:U.enable_coupons.length)>0||(($=c.value)==null?void 0:$.disable_coupons.length)>0)?(t(),n(V,{key:0},[((L=c.value)==null?void 0:L.enable_coupons.length)>0?(t(!0),n(V,{key:0},w(c.value.enable_coupons,(e,b)=>(t(),n("div",{class:B(["coupon_item hand-pointer",{active:e.selected}]),type:"checkbox",onClick:k=>T(e)},[ae,l("div",ie,s(o.$t("取消勾选")),1),e.coupon_type==1?(t(),n("div",de,[v(u,{modelValue:e.coupon_money,"onUpdate:modelValue":k=>e.coupon_money=k},null,8,["modelValue","onUpdate:modelValue"]),e.is_global?(t(),n("span",ce,"["+s(o.$t("全场券"))+"]",1)):a("",!0)])):a("",!0),e.coupon_type==2?(t(),n("div",ue,[r(s(e.coupon_discount)+" ",1),l("span",null,s(o.$t("折")),1),e.is_global?(t(),n("span",_e,"["+s(o.$t("全场券"))+"]",1)):a("",!0)])):a("",!0),l("div",pe,s(o.$t("有效期至"))+s(e.end_date),1),l("div",re,s(e.coupon_name),1),me,e.disable_reason?(t(),n("div",ve,[he,r(s(e.disable_reason),1)])):a("",!0),e.selected&&e.coupon_type==1?(t(),n("div",fe,[ye,r(" "+s(o.$t("已减")),1),v(u,{modelValue:e.coupon_money,"onUpdate:modelValue":k=>e.coupon_money=k},null,8,["modelValue","onUpdate:modelValue"])])):a("",!0)],10,le))),256)):a("",!0),c.value&&((N=c.value)==null?void 0:N.disable_coupons.length)>0?(t(!0),n(V,{key:1},w(c.value.disable_coupons,e=>(t(),n("div",{class:B(["coupon_item hand-pointer disabled",{active:e.selected}]),type:"checkbox"},[ge,l("div",be,s(o.$t("取消勾选")),1),e.coupon_type==1?(t(),n("div",ke,[v(u,{modelValue:e.coupon_money,"onUpdate:modelValue":b=>e.coupon_money=b},null,8,["modelValue","onUpdate:modelValue"]),e.is_global?(t(),n("span",Ce,"["+s(o.$t("全场券"))+"]",1)):a("",!0)])):a("",!0),e.coupon_type==2?(t(),n("div",Ve,[r(s(e.coupon_discount)+" ",1),l("span",null,s(o.$t("折")),1),e.is_global?(t(),n("span",Ie,"["+s(o.$t("全场券"))+"]",1)):a("",!0)])):a("",!0),l("div",Ue,s(o.$t("有效期至"))+s(e.end_date),1),l("div",$e,s(e.coupon_name),1),Le,e.disable_reason?(t(),n("div",Ne,[Se,r(s(e.disable_reason),1)])):a("",!0),e.selected&&e.coupon_type==2?(t(),n("div",Me,[we,r(" "+s(o.$t("已减")),1),v(u,{modelValue:e.coupon_money,"onUpdate:modelValue":b=>e.coupon_money=b},null,8,["modelValue","onUpdate:modelValue"])])):a("",!0)],2))),256)):a("",!0)],64)):(t(),n("div",Be,[r(s(o.$t("暂无可用优惠券"))+"～",1),v(h,{target:"_blank",class:"font-color",to:"/coupon/list"},{default:M(()=>[r(s(o.$t("去领券")),1)]),_:1})]))])):a("",!0)])),[[j,D.value]]),a("",!0)])])):a("",!0)])}}}),Je=X(ze,[["__scopeId","data-v-093a4715"]]);export{Je as default};
