import{E as W}from"./lRlBa-wu.js";import{E as Z}from"./XomGKeK5.js";import{_ as x}from"./CqRtc8Nz.js";import{_ as ee}from"./CzQrJ5jx.js";import{f as te,Y as se,r as $,s as V,H as oe,o as l,c as n,a as s,F as k,l as L,n as D,t as a,i as c,b as r,w as u,d as _,a5 as ae,j as T,x as le,z as ne,h as re,m as p,a0 as O,a1 as ie,y as de,p as ue,e as ce,_ as _e}from"./DvlzeZYf.js";import{_ as pe}from"./CPg1UVcC.js";import{E as me}from"./CFi7q_x0.js";import{v as ve}from"./C_PfpWcu.js";import"./DGzzo1G8.js";import{a as ye,c as he,d as fe,r as ge,b as ke,g as be}from"./YoGlnDdk.js";import{P as we}from"./DpiGic3x.js";import{L as $e}from"./CrKE52E_.js";const C=h=>(ue("data-v-4d2af987"),h=h(),ce(),h),Ve={class:"order-list"},Ce={key:0,class:"tag-and-input"},ze={class:"tig-tabs"},Le=["onClick"],Te={key:0},Oe={class:"input"},Ue={class:"order-title"},Fe={class:"ul"},Ee={style:{width:"23%"}},Ie={style:{width:"28%"}},Ne={key:1,style:{width:"49%"}},Be={style:{width:"6%"}},Se=C(()=>s("div",{style:{width:"7%"}},null,-1)),Me={style:{width:"12%"}},Pe={key:2,style:{width:"14%"}},De={key:3,style:{width:"14%"}},Re={style:{width:"12%"}},je={class:"order-table"},qe={colspan:"4"},He={class:"font-color"},Xe={style:{"margin-left":"30px"}},Ye={class:"order-tr"},Ae={class:"column-1"},Ge={class:"text-ellipsis"},Je={style:{color:"#aaa"}},Ke=C(()=>s("div",null,null,-1)),Qe={class:"column-2-4"},We={class:"black"},Ze={class:"money"},xe={class:"column-2-4"},et={class:"black"},tt={key:0,class:"black"},st=["onMouseenter"],ot=C(()=>s("i",{style:{"font-size":"12px"},class:"iconfont-pc icon-xiajiantou1"},null,-1)),at={class:"column-2-4"},lt={key:0},nt=["onClick"],rt=["onClick"],it={key:3,class:"mb10"},dt={key:4,class:"mb10"},ut={key:5,class:"mb10"},ct={key:6,class:"mb10"},_t={key:7,class:"mb10"},pt={class:"el-page"},mt={key:1,class:"no-result"},vt={key:0},yt=C(()=>s("span",{class:"sign sign1"},null,-1)),ht=[yt],ft={key:1},gt={style:{"font-size":"12px"}},kt=te({__name:"MemberOrderList",props:{modelValue:{type:Number,default:1}},emits:["change"],setup(h,{emit:bt}){const{t:m}=se(),z=$([]),f=$(!0),b=$(0),i=V({page:1,sort_field:"add_time",sort_order:"desc",keyword:"",pay_status:-1,date_type:1}),U=$("all"),F=V([{type:"all",value:"全部订单",num:0},{type:"await_pay",value:"待支付",num:0},{type:"await_shipping",value:"待发货",num:0},{type:"await_received",value:"待收货",num:0},{type:"await_comment",value:"待评价",num:0}]),R=t=>{i.page=1,i.order_status=-1,i.comment_status=-1,t==="await_pay"?i.order_status=0:t==="await_shipping"?i.order_status=1:t==="await_received"?i.order_status=2:t==="await_comment"&&(i.comment_status=0),U.value=t,v()},E=async()=>{f.value=!0;try{const t=await ye();F.forEach(o=>{let w=t.item;w[o.type]!==void 0&&(o.num=w[o.type])})}catch(t){p.error(t.message)}finally{f.value=!1}},j=V([{value:-1,label:"交易状态"},{value:0,label:"未支付"},{value:2,label:"已支付"}]),q=V([{value:0,label:"全部订单"},{value:1,label:"最近三个月订单"},{value:2,label:"最近六个月订单"},{value:3,label:"最近一年内订单"}]),H=async t=>{O.confirm({title:m("确认要取消该订单吗"),cancelText:m("取消"),okText:m("确定"),maskClosable:!0,centered:!0,onOk:async()=>{try{const o=await he({id:t});p.success(o.message),await v()}catch(o){p.error(o.message)}finally{}}})},X=async t=>{O.confirm({title:m("确认要删除该订单吗"),cancelText:m("取消"),okText:m("确定"),maskClosable:!0,centered:!0,onOk:async()=>{try{const o=await fe({id:t});p.success(o.message),await v()}catch(o){p.error(o.message)}finally{}}})},Y=async t=>{try{const o=await ge({id:t});p.success(o.message,1),setTimeout(function(){ie("/order/check")},1500);return}catch(o){p.error(o.message)}finally{}},A=async t=>{O.confirm({title:m("确认要收货吗"),cancelText:m("取消"),okText:m("确定"),maskClosable:!0,centered:!0,onOk:async()=>{try{const o=await ke({id:t});p.success(o.message,2),v(),E()}catch(o){p.error(o.message)}finally{}}})},v=async()=>{f.value=!0;try{b.value=0;const t=await be({...i});z.value=t.filter_result,console.log(z.value),b.value=t.total}catch(t){p.error(t.message)}finally{f.value=!1}};oe(()=>{E().then(()=>{v()})});const G=(t,o)=>{t.show_popover=!0};return(t,o)=>{const w=W,g=Z,I=x,y=ee,J=de,N=pe,K=me,Q=ve;return l(),n("div",Ve,[h.modelValue?(l(),n("div",Ce,[s("div",ze,[(l(!0),n(k,null,L(F,e=>(l(),n("div",{class:D([U.value==e.type?"active":"","tab"]),onClick:B=>R(e.type)},[e.num?(l(),n("span",Te,a(e.num),1)):c("",!0),s("p",null,a(t.$t(e.value)),1)],10,Le))),256))]),s("div",Oe,[r(w,{modelValue:i.keyword,"onUpdate:modelValue":o[0]||(o[0]=e=>i.keyword=e),placeholder:t.$t("收货人名称或订单号"),type:"text"},null,8,["modelValue","placeholder"]),r(g,{class:"ml10",onClick:o[1]||(o[1]=e=>v())},{default:u(()=>[_(a(t.$t("搜索")),1)]),_:1})])])):c("",!0),s("div",Ue,[s("div",Fe,[h.modelValue?(l(),n(k,{key:0},[s("div",Ee,[r(I,{modelValue:i.date_type,"onUpdate:modelValue":o[2]||(o[2]=e=>i.date_type=e),selectList:q,onLoadFilter:v},null,8,["modelValue","selectList"])]),s("div",Ie,a(t.$t("商品名称")),1)],64)):(l(),n("div",Ne,a(t.$t("商品名称")),1)),s("div",Be,a(t.$t("数量")),1),Se,s("div",Me,a(t.$t("金额")),1),h.modelValue?(l(),n("div",Pe,[r(I,{modelValue:i.pay_status,"onUpdate:modelValue":o[3]||(o[3]=e=>i.pay_status=e),selectList:j,onLoadFilter:v},null,8,["modelValue","selectList"])])):(l(),n("div",De,a(t.$t("交易状态")),1)),s("div",Re,a(t.$t("操作")),1)])]),ae((l(),n("div",null,[b.value>0?(l(),n(k,{key:0},[(l(!0),n(k,null,L(z.value,(e,B)=>{var S,M,P;return l(),n("table",je,[s("thead",null,[s("tr",null,[s("th",qe,[_(a(t.$t("订单号"))+"：",1),r(y,{to:"/member/order/info?id="+e.order_id,target:"_blank"},{default:u(()=>[s("span",He,a(e.order_sn),1)]),_:2},1032,["to"]),s("span",Xe,a(t.$t("下单时间"))+"："+a(e.add_time),1)])])]),s("tbody",null,[s("tr",Ye,[s("td",Ae,[(l(!0),n(k,null,L(e.items,d=>(l(),n("div",null,[r(y,{title:d.product_name,to:T(ne)({path:"product",id:d.product_id,sn:d.product_sn}),class:"nuxt",target:"_blank"},{default:u(()=>[r(J,{src:("imageFormat"in t?t.imageFormat:T(le))(d.product_pic_thumb),loading:"lazy",style:{height:"40px",width:"40px",transition:"opacity 0.2s linear","flex-shrink":"0"}},null,8,["src"]),s("div",null,[s("div",Ge,a(d.product_name),1)])]),_:2},1032,["title","to"]),s("div",Je,"X"+a(d.quantity),1),Ke]))),256))]),s("td",Qe,[s("div",null,[s("div",null,[_(a(t.$t("总额"))+": ",1),r(N,{modelValue:e.total_amount,"onUpdate:modelValue":d=>e.total_amount=d,showText:!1},null,8,["modelValue","onUpdate:modelValue"])]),e.order_status==0&&e.unpaid_amount>0?(l(),n(k,{key:0},[s("div",We,a(t.$t("应付")),1),s("div",Ze,[r(N,{modelValue:e.unpaid_amount,"onUpdate:modelValue":d=>e.unpaid_amount=d,showText:!1},null,8,["modelValue","onUpdate:modelValue"])])],64)):c("",!0),s("div",null,a(e.pay_type_id===1?t.$t("在线支付"):e.pay_type_id===2?t.$t("货到付款"):t.$t("线下支付")),1)])]),s("td",xe,[s("div",null,[s("div",{class:D({orange:e.order_status===0,black:e.order_status===1||e.order_status===2||e.order_status===4,gray:e.order_status===3,green:e.order_status===5})},a(e.order_status_name),3),s("div",et,[r(y,{to:"/member/order/info?id="+e.order_id,target:"_blank"},{default:u(()=>[_(a(t.$t("订单详情")),1)]),_:2},1032,["to"])]),(e.order_status==2||e.order_status==5)&&e.shipping_method==1?(l(),n("div",tt,[r(K,{width:600,placement:"bottom"},{reference:u(()=>[s("span",{style:{cursor:"pointer"},onMouseenter:d=>G(e,B)},[s("i",null,a(t.$t("物流跟踪")),1),ot],40,st)]),default:u(()=>[e.show_popover?(l(),re($e,{key:0,tracking_no:e.tracking_no,logistics_name:e.logistics_name,id:e.order_id,"onUpdate:id":d=>e.order_id=d},null,8,["tracking_no","logistics_name","id","onUpdate:id"])):c("",!0)]),_:2},1024)])):c("",!0)])]),s("td",at,[s("div",null,[e.available_actions.to_pay?(l(),n("div",lt,[r(y,{to:"/order/pay/?id="+e.order_id,target:"_balnk"},{default:u(()=>[r(g,{size:"small",type:"primary"},{default:u(()=>[_(a(t.$t("付款")),1)]),_:1})]),_:2},1032,["to"])])):c("",!0),e.available_actions.cancel_order?(l(),n("a",{key:1,onClick:d=>H(e.order_id)},a(t.$t("取消订单")),9,nt)):c("",!0),e.available_actions.del_order?(l(),n("a",{key:2,onClick:d=>X(e.order_id)},a(t.$t("删除")),9,rt)):c("",!0),e.available_actions.confirm_receipt?(l(),n("div",it,[r(g,{type:"primary",size:"small",onClick:d=>A(e.order_id)},{default:u(()=>[_(a(t.$t("确认收货")),1)]),_:2},1032,["onClick"])])):c("",!0),e.available_actions.to_aftersales?(l(),n("div",dt,[r(y,{to:"/member/return/info/?order_id="+e.order_id},{default:u(()=>[r(g,{size:"small"},{default:u(()=>[_(a(t.$t("申请售后")),1)]),_:1})]),_:2},1032,["to"])])):c("",!0),(S=e.items[0])!=null&&S.aftersales_item?(l(),n("div",ut,[r(y,{to:"/member/return/logInfo?id="+((P=(M=e.items[0])==null?void 0:M.aftersales_item)==null?void 0:P.aftersale_id)},{default:u(()=>[r(g,{size:"small"},{default:u(()=>[_(a(t.$t("售后详情")),1)]),_:1})]),_:2},1032,["to"])])):c("",!0),e.available_actions.rebuy?(l(),n("div",ct,[r(g,{size:"small",onClick:d=>Y(e.order_id)},{default:u(()=>[_(a(t.$t("再次购买")),1)]),_:2},1032,["onClick"])])):c("",!0),e.available_actions.to_comment?(l(),n("div",_t,[r(y,{to:"/member/comment/info/?id="+e.order_id},{default:u(()=>[r(g,{size:"small"},{default:u(()=>[_(a(t.$t("去评价")),1)]),_:1})]),_:2},1032,["to"])])):c("",!0)])])])])])}),256)),s("div",pt,[r(T(we),{page:i.page,"onUpdate:page":o[4]||(o[4]=e=>i.page=e),size:i.size,"onUpdate:size":o[5]||(o[5]=e=>i.size=e),total:b.value,onCallback:v},null,8,["page","size","total"])])],64)):(l(),n("div",mt,[f.value?c("",!0):(l(),n("div",vt,ht)),f.value?c("",!0):(l(),n("div",ft,[s("ul",null,[s("li",null,a(t.$t("当前筛选下还没有任何订单哦")),1),s("li",gt,[_(a(t.$t("现在就去"))+"： ",1),r(y,{class:"font-color",to:"/"},{default:u(()=>[_(a(t.$t("选购商品")),1)]),_:1})])])]))]))])),[[Q,f.value]])])}}}),Nt=_e(kt,[["__scopeId","data-v-4d2af987"]]);export{Nt as _};
