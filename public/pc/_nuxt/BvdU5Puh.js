import{b as e}from"./Bx_3tXOW.js";import{_ as a}from"./DIcT5qlW.js";import{_ as l}from"./CFmHvMYA.js";import{_ as o}from"./4BWvF7DS.js";import{_ as t}from"./DRy-t1KR.js";import{a3 as s,K as i,by as n,L as r,M as d,d7 as u,bx as c,d8 as m,N as v,e as p,O as f,P as b,r as h,s as y,bd as g,a_ as x,bq as V,a2 as j,Q as w,c as k,o as I,h as C,F as T,l as $,v as S,i as _,b as N,w as O,aa as U,m as F,av as P,ab as H,Y as M,p as A,t as L,bH as R,a1 as B,ad as E,z as J,y as q,aj as z,ae as D,n as K,a as W,d as Q,j as X,q as Y,ak as Z,E as G,_ as ee}from"./vO8z_6wc.js";import{u as ae,b as le,d as oe,e as te,f as se}from"./CdIa5lAL.js";import{U as ie,C as ne}from"./BwRzfsZt.js";import{E as re}from"./duVALuQ5.js";import{E as de}from"./OZUBBuO3.js";import{_ as ue}from"./B6kpiin_.js";import{g as ce,u as me}from"./B6vdHKXe.js";import{U as ve}from"./CyA81kDU.js";import"./B3kMr2Om.js";import"./BG07ctRk.js";import"./Ctuj9lAE.js";import"./ExFuuhw5.js";import"./6_reTNGa.js";import"./DqoL2U0I.js";import"./CKVP4sCQ.js";import"./D_Dr4eZ1.js";import"./123WnbAt.js";import"./C_yTnQv7.js";import"./DgmxjSXK.js";import"./VsleDggW.js";import"./B0jPhJeY.js";import"./C0xcqOw0.js";/* empty css        */import"./pBde3eXe.js";import"./YLitFIRx.js";import"./C8tVKSc2.js";import"./DEtxbcwL.js";import"./y2YKyhRU.js";import"./D0li9aqr.js";import"./B9ErrXst.js";const pe=i({modelValue:{type:Number,default:0},id:{type:String,default:void 0},lowThreshold:{type:Number,default:2},highThreshold:{type:Number,default:4},max:{type:Number,default:5},colors:{type:d([Array,Object]),default:()=>r(["","",""])},voidColor:{type:String,default:""},disabledVoidColor:{type:String,default:""},icons:{type:d([Array,Object]),default:()=>[u,u,u]},voidIcon:{type:c,default:()=>m},disabledVoidIcon:{type:c,default:()=>u},disabled:Boolean,allowHalf:Boolean,showText:Boolean,showScore:Boolean,textColor:{type:String,default:""},texts:{type:d(Array),default:()=>r(["Extremely bad","Disappointed","Fair","Satisfied","Surprise"])},scoreTemplate:{type:String,default:"{value}"},size:n,clearable:Boolean,...ae(["ariaLabel"])}),fe={[ne]:e=>s(e),[ie]:e=>s(e)},be=p({name:"ElRate"});const he=E(v(p({...be,props:pe,emits:fe,setup(e,{expose:a,emit:l}){const o=e;function t(e,a){const l=e=>x(e),o=Object.keys(a).map((e=>+e)).filter((o=>{const t=a[o];return!!l(t)&&t.excluded?e<o:e<=o})).sort(((e,a)=>e-a)),t=a[o[0]];return l(t)&&t.value||t}const s=f(te,void 0),i=f(se,void 0),n=le(),r=b("rate"),{inputId:d,isLabeledByFormItem:u}=oe(o,{formItemContext:i}),c=h(o.modelValue),m=h(-1),v=h(!0),p=y((()=>[r.b(),r.m(n.value)])),E=y((()=>o.disabled||(null==s?void 0:s.disabled))),J=y((()=>r.cssVarBlock({"void-color":o.voidColor,"disabled-void-color":o.disabledVoidColor,"fill-color":K.value}))),q=y((()=>{let e="";return o.showScore?e=o.scoreTemplate.replace(/\{\s*value\s*\}/,E.value?`${o.modelValue}`:`${c.value}`):o.showText&&(e=o.texts[Math.ceil(c.value)-1]),e})),z=y((()=>100*o.modelValue-100*Math.floor(o.modelValue))),D=y((()=>g(o.colors)?{[o.lowThreshold]:o.colors[0],[o.highThreshold]:{value:o.colors[1],excluded:!0},[o.max]:o.colors[2]}:o.colors)),K=y((()=>{const e=t(c.value,D.value);return x(e)?"":e})),W=y((()=>{let e="";return E.value?e=`${z.value}%`:o.allowHalf&&(e="50%"),{color:K.value,width:e}})),Q=y((()=>{let e=g(o.icons)?[...o.icons]:{...o.icons};return e=V(e),g(e)?{[o.lowThreshold]:e[0],[o.highThreshold]:{value:e[1],excluded:!0},[o.max]:e[2]}:e})),X=y((()=>t(o.modelValue,Q.value))),Y=y((()=>E.value?j(o.disabledVoidIcon)?o.disabledVoidIcon:V(o.disabledVoidIcon):j(o.voidIcon)?o.voidIcon:V(o.voidIcon))),Z=y((()=>t(c.value,Q.value)));function G(e){const a=E.value&&z.value>0&&e-1<o.modelValue&&e>o.modelValue,l=o.allowHalf&&v.value&&e-.5<=c.value&&e>c.value;return a||l}function ee(e){o.clearable&&e===o.modelValue&&(e=0),l(ie,e),o.modelValue!==e&&l(ne,e)}function ae(e){if(E.value)return;let a=c.value;const t=e.code;return t===B.up||t===B.right?(o.allowHalf?a+=.5:a+=1,e.stopPropagation(),e.preventDefault()):t!==B.left&&t!==B.down||(o.allowHalf?a-=.5:a-=1,e.stopPropagation(),e.preventDefault()),a=a<0?0:a,a=a>o.max?o.max:a,l(ie,a),l(ne,a),a}function re(e,a){if(!E.value){if(o.allowHalf&&a){let l=a.target;R(l,r.e("item"))&&(l=l.querySelector(`.${r.e("icon")}`)),(0===l.clientWidth||R(l,r.e("decimal")))&&(l=l.parentNode),v.value=2*a.offsetX<=l.clientWidth,c.value=v.value?e-.5:e}else c.value=e;m.value=e}}function de(){E.value||(o.allowHalf&&(v.value=o.modelValue!==Math.floor(o.modelValue)),c.value=o.modelValue,m.value=-1)}return w((()=>o.modelValue),(e=>{c.value=e,v.value=o.modelValue!==Math.floor(o.modelValue)})),o.modelValue||l(ie,0),a({setCurrentValue:re,resetCurrentValue:de}),(e,a)=>{var l;return I(),k("div",{id:_(d),class:S([_(p),_(r).is("disabled",_(E))]),role:"slider","aria-label":_(u)?void 0:e.ariaLabel||"rating","aria-labelledby":_(u)?null==(l=_(i))?void 0:l.labelId:void 0,"aria-valuenow":c.value,"aria-valuetext":_(q)||void 0,"aria-valuemin":"0","aria-valuemax":e.max,tabindex:"0",style:A(_(J)),onKeydown:ae},[(I(!0),k(T,null,$(e.max,((e,a)=>(I(),k("span",{key:a,class:S(_(r).e("item")),onMousemove:a=>re(e,a),onMouseleave:de,onClick:a=>{return l=e,void(E.value||(o.allowHalf&&v.value?ee(c.value):ee(l)));var l}},[N(_(M),{class:S([_(r).e("icon"),{hover:m.value===e},_(r).is("active",e<=c.value)])},{default:O((()=>[G(e)?C("v-if",!0):(I(),k(T,{key:0},[U((I(),F(P(_(Z)),null,null,512)),[[H,e<=c.value]]),U((I(),F(P(_(Y)),null,null,512)),[[H,!(e<=c.value)]])],64)),G(e)?(I(),k(T,{key:1},[(I(),F(P(_(Y)),{class:S([_(r).em("decimal","box")])},null,8,["class"])),N(_(M),{style:A(_(W)),class:S([_(r).e("icon"),_(r).e("decimal")])},{default:O((()=>[(I(),F(P(_(X))))])),_:1},8,["style","class"])],64)):C("v-if",!0)])),_:2},1032,["class"])],42,["onMousemove","onClick"])))),128)),e.showText||e.showScore?(I(),k("span",{key:0,class:S(_(r).e("text")),style:A({color:e.textColor})},L(_(q)),7)):C("v-if",!0)],46,["id","aria-label","aria-labelledby","aria-valuenow","aria-valuetext","aria-valuemax"])}}}),[["__file","rate.vue"]])),ye={class:"container flex"},ge={class:"menu"},xe={class:"info-row"},Ve={class:"collection"},je={class:"nav"},we={class:"collection-list-tag"},ke={key:0,class:"white-card"},Ie={class:"product-left"},Ce=["src"],Te={style:{"line-height":"2"}},$e={class:"product-right"},Se={class:"lab-text"},_e={key:0},Ne={class:"tips"},Oe={class:"lab-text"},Ue={key:0,class:"label-list"},Fe=["onClick"],Pe=["onClick"],He={key:1,class:"label-edit-input"},Me=["onClick"],Ae={key:1,class:"label-list"},Le={class:"label-item-txt"},Re={class:"lab-text"},Be=["placeholder","onUpdate:modelValue","disabled"],Ee={key:1},Je={class:"tips"},qe={class:"lab-text"},ze={key:1},De=ee(p({__name:"Info",setup(s){const{t:i}=J();h(999),h(0);const n=h(["1分","2分","3分","4分","5分"]),r=h(!0),d=h(["送货快","质量很好","服务周到","正品","很划算","包装仔细","价格实惠","还可以","相当好"]),u=h([]);q((()=>{c()}));const c=async()=>{try{u.value=[];const e=await ce({id:m.currentRoute.value.query.id});e.items.map((e=>{e.allCommentTag=JSON.parse(JSON.stringify(d.value)),Object.assign(e,{commentRank:0,content:"",showPics:[],commentTag:[],isAdd:!1,rankVerification:!0,contentVerification:!0,isCommentInfo:!!e.commentInfo},e.commentInfo)})),Object.assign(u.value,e.items);u.value.every((e=>1===e.isShowed))&&D("/member/comment/list?orderType=2")}catch(e){K.error(e.message)}finally{r.value=!1}},m=z(),v=h(""),p=(e,a)=>{let l=u.value[e].commentTag;l.includes(a)?u.value[e].commentTag=l.filter((e=>e!==a)):l.push(a)};return(s,r)=>{const d=e,m=a,f=l,b=o,h=t,y=he,g=re,x=G,V=de,j=ue;return I(),k(T,null,[N(d),N(m,{title:"评价晒单"}),W("div",ye,[W("div",ge,[N(f)]),W("div",xe,[W("div",Ve,[W("div",je,[W("div",we,L(s.$t("订单评价")),1),W("div",null,[Q(L(s.$t("评价立送")),1),r[1]||(r[1]=W("span",{class:"font-color"},"5",-1)),Q(L(s.$t("积分"))+"，"+L(s.$t("晒单额外赠送")),1),r[2]||(r[2]=W("span",{class:"font-color"},"5",-1)),Q(L(s.$t("积分")),1)])]),(I(!0),k(T,null,$(u.value,((e,a)=>(I(),k("div",null,[e.isShowed?C("",!0):(I(),k("div",ke,[W("div",Ie,[N(h,{title:e.productName,to:("urlFormat"in s?s.urlFormat:_(Y))({path:"product",id:e.productId,sn:e.productSn}),class:"nuxt",target:"_blank"},{default:O((()=>[W("div",null,[W("img",{alt:"",src:("imageFormat"in s?s.imageFormat:_(X))(e.picThumb)},null,8,Ce)]),W("div",null,[W("div",Te,[W("a",null,L(e.productName),1)]),W("div",null,[N(b,{modelValue:e.price,"onUpdate:modelValue":a=>e.price=a,showText:!1},null,8,["modelValue","onUpdate:modelValue"])])])])),_:2},1032,["title","to"])]),W("div",$e,[W("div",null,[W("span",Se,L(s.$t("商品评分"))+"：",1),W("span",null,[N(y,{disabled:e.isCommentInfo,modelValue:e.commentRank,"onUpdate:modelValue":a=>e.commentRank=a,size:"large",texts:n.value,"show-text":""},null,8,["disabled","modelValue","onUpdate:modelValue","texts"])])]),e.rankVerification?C("",!0):(I(),k("div",_e,[r[3]||(r[3]=W("span",{class:"lab-text"},null,-1)),W("p",Ne,L(s.$t("请先评价商品")),1)])),W("div",null,[W("div",Oe,L(s.$t("评价标签"))+"：",1),e.isCommentInfo?(I(),k("div",Ae,[(I(!0),k(T,null,$(e.commentTag,(e=>(I(),k("div",Le,[W("span",null,L(e),1)])))),256))])):(I(),k("div",Ue,[(I(!0),k(T,null,$(e.allCommentTag,(l=>(I(),k("div",{style:A({border:e.commentTag.includes(l)?" 2px solid var(--general)":" 1px solid #ccc"}),class:"label-item",onClick:e=>p(a,l)},[W("span",null,L(s.$t(l)),1)],12,Fe)))),256)),e.isAdd?(I(),k("div",He,[W("div",null,[N(g,{modelValue:v.value,"onUpdate:modelValue":r[0]||(r[0]=e=>v.value=e),autofocus:""},null,8,["modelValue"])]),W("p",{onClick:e=>(e=>{if(""!==v.value){const a=JSON.parse(JSON.stringify(u.value[e].allCommentTag));a.push(v.value),u.value[e].allCommentTag=a,p(e,v.value)}v.value="",u.value[e].isAdd=!1})(a)},L(s.$t("确定")),9,Me)])):(I(),k("div",{key:0,class:"label-edit",onClick:e=>(e=>{u.value[e].isAdd=!u.value[e].isAdd})(a)},[r[4]||(r[4]=W("div",null,null,-1)),W("p",null,L(s.$t("自定义")),1)],8,Pe))]))]),W("div",null,[W("div",Re,L(s.$t("购物心得"))+"：",1),U(W("textarea",{cols:"50",name:"content",placeholder:s.$t("商品是否给力？快分享你的购买心得吧~"),rows:"5",style:{border:"1px solid #d9d9d9",padding:"4px"},"onUpdate:modelValue":a=>e.content=a,disabled:e.isCommentInfo},null,8,Be),[[Z,e.content]])]),e.contentVerification?C("",!0):(I(),k("div",Ee,[r[5]||(r[5]=W("span",{class:"lab-text"},null,-1)),W("p",Je,L(s.$t("请填写购买心得")),1)])),W("div",null,[W("div",qe,L(s.$t("晒单"))+"：",1),e.isShowed?(I(),k("div",ze,[(I(!0),k(T,null,$(e.showPics,(e=>(I(),F(x,{src:("imageFormat"in s?s.imageFormat:_(X))(e.picThumb),loading:"lazy",style:{height:"80px",width:"80px",transition:"opacity 0.2s linear","margin-right":"10px"}},null,8,["src"])))),256))])):(I(),F(ve,{key:0,uploadList:e.showPics,"onUpdate:uploadList":a=>e.showPics=a,limit:9,fileTypes:["jpeg","png"]},null,8,["uploadList","onUpdate:uploadList"]))]),W("div",null,[N(V,{type:"primary",onClick:a=>(async e=>{if(e.commentRank<1)e.rankVerification=!1;else if(""!=e.content)try{const a={productId:e.productId,orderId:e.orderId,orderItemId:e.itemId,shopId:e.shopId,commentRank:e.commentRank,commentTag:e.commentTag,content:e.content,showPics:e.showPics};await me(a),e.rankVerification=!0,e.contentVerification=!0,K.success(i("评价成功")),c()}catch(a){K.error(a.message)}else e.contentVerification=!1})(e)},{default:O((()=>[Q(L(s.$t("提交评论")),1)])),_:2},1032,["onClick"])])])]))])))),256))])])]),N(j)],64)}}}),[["__scopeId","data-v-51263322"]]);export{De as default};
