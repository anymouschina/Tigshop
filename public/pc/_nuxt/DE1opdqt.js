import{E as e}from"./duVALuQ5.js";import{_ as o}from"./Bd89_3a4.js";import{E as r,a}from"./DKvZ9Rd6.js";import{E as s}from"./OZUBBuO3.js";import{e as l,cb as i,cc as t,f as d,z as u,r as m,I as p,g as n,m as c,o as v,w as b,h as f,b as g,a as w,t as j,c as y,i as E,d as _,cd as $,_ as V}from"./vO8z_6wc.js";import{_ as h}from"./CHbuG04u.js";import{s as C,e as T}from"./BEIcWXyR.js";import{M as A}from"./BwrAIjIS.js";import"./123WnbAt.js";import"./C_yTnQv7.js";import"./CdIa5lAL.js";import"./CKVP4sCQ.js";import"./BwRzfsZt.js";import"./B0jPhJeY.js";import"./D_Dr4eZ1.js";import"./VsleDggW.js";import"./DqoL2U0I.js";import"./DSXY0Md2.js";import"./DgmxjSXK.js";const q={class:"label"},M={class:"area-code-input"},k={key:0,class:"area-code-select"},x={class:"label"},O=V(l({__name:"StepOne",props:{step:{},stepModifiers:{}},emits:i(["success"],["update:step"]),setup(l,{emit:i}){const V=t(l,"step"),O=i,U=d(),{t:S}=u(),Z=m(!1),z=m("86"),F=p(),I=(e,o,r)=>{B.value.tigTips[e]=o?{type:"valid",message:r}:{type:"error",message:r}},W=e=>{B.value.tigTips[e]={type:"info",message:P[e]}},P=n({mobile:S("请填写手机号码"),mail:S("请填写邮箱地址"),code:S("请输入验证码"),password:S("6-20个大小写英文字母、符号或数字的组合")}),Q=n({mobile:[{validator:(e,o,r)=>{const a=U.isOpenMobileAreaCode?/^(\+?[1-9]\d{1,14})$/:/^(?:\+?86)?1[3-9]\d{9}$/;return o?a.test(o)?void r():r(new Error(S("格式错误，请输入正确的手机号码"))):r(new Error(S("手机号不能为空")))},trigger:"blur",required:!0}],mail:[{validator:(e,o,r)=>o?/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(o)?void r():r(new Error(S("格式错误，请输入正确的邮箱地址"))):r(new Error(S("邮箱不能为空"))),trigger:"blur",required:!0}],code:[{validator:(e,o,r)=>o?6!=o.length?r(new Error(S("请输入6位验证码"))):void r():r(new Error(S("验证码不能为空"))),trigger:"blur",required:!0}],password:[{validator:(e,o,r)=>o?o.length>20||o.length<6?r(new Error(S("密码应为6-20位字符"))):/\s/.test(o)?r(new Error(S("密码中不允许有空格"))):/^\d+$/.test(o)?r(new Error(S("密码不能全为数字"))):/^(?=.*[\d\W]).+$/.test(o)?/^(?=.*[a-zA-Z0-9]).+$/.test(o)?/^(?!([a-zA-Z0-9])\1*$).+$/.test(o)?void r():r(new Error(S("密码不能全为相同字符或数字"))):r(new Error(S("密码不能全为符号"))):r(new Error(S("密码不能全为字母"))):r(new Error(S("密码不能为空"))),trigger:"blur",required:!0}]}),R=m(!1),B=m({tigTips:{},mobile:"",code:""}),D=async()=>{await F.value.validate();try{R.value=!0;const e=await T({mobile:U.isOpenMobileAreaCode?z.value+B.value.mobile:B.value.mobile,code:B.value.code});O("success",e),V.value=2}catch(e){$.error(e.message),B.value.code="",B.value.tigTips={}}finally{R.value=!1}},G=e=>{$.error(e)};return(l,i)=>{const t=e,d=o,u=r,m=s,p=a;return v(),c(p,{ref_key:"formRef",ref:F,"hide-required-asterisk":!0,model:B.value,rules:E(Q),"show-message":!1,class:"form-body","label-width":"auto",onValidate:I},{default:b((()=>["mobile"!==B.value.registType&&B.value.registType?f("",!0):(v(),c(u,{key:0,prop:"mobile"},{default:b((()=>[w("div",q,j(l.$t("手机号")),1),w("div",M,[g(t,{modelValue:B.value.mobile,"onUpdate:modelValue":i[1]||(i[1]=e=>B.value.mobile=e),class:"input-border-style",onFocus:i[2]||(i[2]=e=>W("mobile"))},{prefix:b((()=>[E(U).isOpenMobileAreaCode?(v(),y("div",k,[g(h,{modelValue:z.value,"onUpdate:modelValue":i[0]||(i[0]=e=>z.value=e)},null,8,["modelValue"])])):f("",!0)])),_:1},8,["modelValue"])]),g(d,{info:B.value.tigTips.mobile},null,8,["info"])])),_:1})),g(u,{prop:"code"},{default:b((()=>[w("div",x,j(l.$t("验证码")),1),g(t,{modelValue:B.value.code,"onUpdate:modelValue":i[4]||(i[4]=e=>B.value.code=e),class:"input-border-style",onFocus:i[5]||(i[5]=e=>W("code"))},{suffix:b((()=>[g(E(A),{class:"mobile-code-text",event:"forgetPassword",mobile:E(U).isOpenMobileAreaCode?z.value+B.value.mobile:B.value.mobile,mobileCodeSended:Z.value,"onUpdate:mobileCodeSended":i[3]||(i[3]=e=>Z.value=e),requestApi:E(C),onMobileErrorCallback:G},null,8,["mobile","mobileCodeSended","requestApi"])])),_:1},8,["modelValue"]),g(d,{info:B.value.tigTips.code},null,8,["info"])])),_:1}),g(u,{label:"",prop:"firstWord"},{default:b((()=>[g(m,{loading:R.value,type:"primary",class:"submit-button",style:{width:"330px"},onClick:D},{default:b((()=>[_(j(l.$t("下 一 步")),1)])),_:1},8,["loading"])])),_:1})])),_:1},8,["model","rules"])}}}),[["__scopeId","data-v-9f1c0b79"]]);export{O as default};
