import{a as ve,e as ee,f as H}from"./BxwJi-A4.js";import{cu as $e,A as te,ba as me,L as J,bS as pe,bi as Q,bI as he,r as L,v,f as V,D as le,g as j,G as be,s as ge,bj as ye,o as X,c as Se,J as $,n as O,j as c,K as _e,bh as Fe,M as z,H as we,aD as We,bP as je,bs as ze,b as R,F as Re,ay as Ie,aY as qe,cv as Te,bz as se,cw as U,w as Y,h as ke,N as De,ab as ie,d as Ge,t as ne,i as ue,a as de,cx as Ke,cy as Ue,P as Ye,Q as He}from"./DvlzeZYf.js";import{c as Z}from"./De9iyrrl.js";import{d as Je,t as Qe}from"./Cq9Fpw4b.js";import{u as Xe}from"./CvS5MqkS.js";var Ze=4;function ce(i){return $e(i,Ze)}const et=te({size:{type:String,values:me},disabled:Boolean}),tt=te({...et,model:Object,rules:{type:J(Object)},labelPosition:{type:String,values:["left","right","top"],default:"right"},requireAsteriskPosition:{type:String,values:["left","right"],default:"left"},labelWidth:{type:[String,Number],default:""},labelSuffix:{type:String,default:""},inline:Boolean,inlineMessage:Boolean,statusIcon:Boolean,showMessage:{type:Boolean,default:!0},validateOnRuleChange:{type:Boolean,default:!0},hideRequiredAsterisk:Boolean,scrollToError:Boolean,scrollIntoViewOptions:{type:[Object,Boolean]}}),lt={validate:(i,p,e)=>(pe(i)||Q(i))&&he(p)&&Q(e)};function rt(){const i=L([]),p=v(()=>{if(!i.value.length)return"0";const d=Math.max(...i.value);return d?`${d}px`:""});function e(d){const n=i.value.indexOf(d);return n===-1&&p.value,n}function u(d,n){if(d&&n){const f=e(n);i.value.splice(f,1,d)}else d&&i.value.push(d)}function t(d){const n=e(d);n>-1&&i.value.splice(n,1)}return{autoLabelWidth:p,registerLabelWidth:u,deregisterLabelWidth:t}}const A=(i,p)=>{const e=Z(p);return e.length>0?i.filter(u=>u.prop&&e.includes(u.prop)):i},ot="ElForm",at=V({name:ot}),st=V({...at,props:tt,emits:lt,setup(i,{expose:p,emit:e}){const u=i,t=[],d=ve(),n=le("form"),f=v(()=>{const{labelPosition:r,inline:a}=u;return[n.b(),n.m(d.value||"default"),{[n.m(`label-${r}`)]:r,[n.m("inline")]:a}]}),P=r=>t.find(a=>a.prop===r),g=r=>{t.push(r)},s=r=>{r.prop&&t.splice(t.indexOf(r),1)},b=(r=[])=>{u.model&&A(t,r).forEach(a=>a.resetField())},y=(r=[])=>{A(t,r).forEach(a=>a.clearValidate())},C=v(()=>!!u.model),x=r=>{if(t.length===0)return[];const a=A(t,r);return a.length?a:[]},F=async r=>E(void 0,r),W=async(r=[])=>{if(!C.value)return!1;const a=x(r);if(a.length===0)return!0;let S={};for(const _ of a)try{await _.validate("")}catch(I){S={...S,...I}}return Object.keys(S).length===0?!0:Promise.reject(S)},E=async(r=[],a)=>{const S=!Fe(a);try{const _=await W(r);return _===!0&&await(a==null?void 0:a(_)),_}catch(_){if(_ instanceof Error)throw _;const I=_;return u.scrollToError&&M(Object.keys(I)[0]),await(a==null?void 0:a(!1,I)),S&&Promise.reject(I)}},M=r=>{var a;const S=A(t,r)[0];S&&((a=S.$el)==null||a.scrollIntoView(u.scrollIntoViewOptions))};return j(()=>u.rules,()=>{u.validateOnRuleChange&&F().catch(r=>Je())},{deep:!0}),be(ee,ge({...ye(u),emit:e,resetFields:b,clearValidate:y,validateField:E,getField:P,addField:g,removeField:s,...rt()})),p({validate:F,validateField:E,resetFields:b,clearValidate:y,scrollToField:M,fields:t}),(r,a)=>(X(),Se("form",{class:O(c(f))},[$(r.$slots,"default")],2))}});var it=_e(st,[["__file","form.vue"]]);const nt=["","error","validating","success"],ut=te({label:String,labelWidth:{type:[String,Number],default:""},labelPosition:{type:String,values:["left","right","top",""],default:""},prop:{type:J([String,Array])},required:{type:Boolean,default:void 0},rules:{type:J([Object,Array])},error:String,validateStatus:{type:String,values:nt},for:String,inlineMessage:{type:[String,Boolean],default:""},showMessage:{type:Boolean,default:!0},size:{type:String,values:me}}),fe="ElLabelWrap";var dt=V({name:fe,props:{isAutoWidth:Boolean,updateAll:Boolean},setup(i,{slots:p}){const e=z(ee,void 0),u=z(H);u||Qe(fe,"usage: <el-form-item><label-wrap /></el-form-item>");const t=le("form"),d=L(),n=L(0),f=()=>{var s;if((s=d.value)!=null&&s.firstElementChild){const b=window.getComputedStyle(d.value.firstElementChild).width;return Math.ceil(Number.parseFloat(b))}else return 0},P=(s="update")=>{Ie(()=>{p.default&&i.isAutoWidth&&(s==="update"?n.value=f():s==="remove"&&(e==null||e.deregisterLabelWidth(n.value)))})},g=()=>P("update");return we(()=>{g()}),We(()=>{P("remove")}),je(()=>g()),j(n,(s,b)=>{i.updateAll&&(e==null||e.registerLabelWidth(s,b))}),ze(v(()=>{var s,b;return(b=(s=d.value)==null?void 0:s.firstElementChild)!=null?b:null}),g),()=>{var s,b;if(!p)return null;const{isAutoWidth:y}=i;if(y){const C=e==null?void 0:e.autoLabelWidth,x=u==null?void 0:u.hasLabel,F={};if(x&&C&&C!=="auto"){const W=Math.max(0,Number.parseInt(C,10)-n.value),M=(u.labelPosition||e.labelPosition)==="left"?"marginRight":"marginLeft";W&&(F[M]=`${W}px`)}return R("div",{ref:d,class:[t.be("item","label-wrap")],style:F},[(s=p.default)==null?void 0:s.call(p)])}else return R(Re,{ref:d},[(b=p.default)==null?void 0:b.call(p)])}}});const ct=V({name:"ElFormItem"}),ft=V({...ct,props:ut,setup(i,{expose:p}){const e=i,u=qe(),t=z(ee,void 0),d=z(H,void 0),n=ve(void 0,{formItem:!1}),f=le("form-item"),P=Xe().value,g=L([]),s=L(""),b=Te(s,100),y=L(""),C=L();let x,F=!1;const W=v(()=>e.labelPosition||(t==null?void 0:t.labelPosition)),E=v(()=>{if(W.value==="top")return{};const l=se(e.labelWidth||(t==null?void 0:t.labelWidth)||"");return l?{width:l}:{}}),M=v(()=>{if(W.value==="top"||t!=null&&t.inline)return{};if(!e.label&&!e.labelWidth&&Ce)return{};const l=se(e.labelWidth||(t==null?void 0:t.labelWidth)||"");return!e.label&&!u.label?{marginLeft:l}:{}}),r=v(()=>[f.b(),f.m(n.value),f.is("error",s.value==="error"),f.is("validating",s.value==="validating"),f.is("success",s.value==="success"),f.is("required",xe.value||e.required),f.is("no-asterisk",t==null?void 0:t.hideRequiredAsterisk),(t==null?void 0:t.requireAsteriskPosition)==="right"?"asterisk-right":"asterisk-left",{[f.m("feedback")]:t==null?void 0:t.statusIcon,[f.m(`label-${W.value}`)]:W.value}]),a=v(()=>he(e.inlineMessage)?e.inlineMessage:(t==null?void 0:t.inlineMessage)||!1),S=v(()=>[f.e("error"),{[f.em("error","inline")]:a.value}]),_=v(()=>e.prop?Q(e.prop)?e.prop:e.prop.join("."):""),I=v(()=>!!(e.label||u.label)),q=v(()=>e.for||(g.value.length===1?g.value[0]:void 0)),T=v(()=>!q.value&&I.value),Ce=!!d,k=v(()=>{const l=t==null?void 0:t.model;if(!(!l||!e.prop))return U(l,e.prop).value}),D=v(()=>{const{required:l}=e,o=[];e.rules&&o.push(...Z(e.rules));const h=t==null?void 0:t.rules;if(h&&e.prop){const m=U(h,e.prop).value;m&&o.push(...Z(m))}if(l!==void 0){const m=o.map((w,N)=>[w,N]).filter(([w])=>Object.keys(w).includes("required"));if(m.length>0)for(const[w,N]of m)w.required!==l&&(o[N]={...w,required:l});else o.push({required:l})}return o}),Ee=v(()=>D.value.length>0),Le=l=>D.value.filter(h=>!h.trigger||!l?!0:pe(h.trigger)?h.trigger.includes(l):h.trigger===l).map(({trigger:h,...m})=>m),xe=v(()=>D.value.some(l=>l.required)),Me=v(()=>{var l;return b.value==="error"&&e.showMessage&&((l=t==null?void 0:t.showMessage)!=null?l:!0)}),re=v(()=>`${e.label||""}${(t==null?void 0:t.labelSuffix)||""}`),B=l=>{s.value=l},Be=l=>{var o,h;const{errors:m,fields:w}=l;(!m||!w)&&console.error(l),B("error"),y.value=m?(h=(o=m==null?void 0:m[0])==null?void 0:o.message)!=null?h:`${e.prop} is required`:"",t==null||t.emit("validate",e.prop,!1,y.value)},Ne=()=>{B("success"),t==null||t.emit("validate",e.prop,!0,"")},Oe=async l=>{const o=_.value;return new Ue({[o]:l}).validate({[o]:k.value},{firstFields:!0}).then(()=>(Ne(),!0)).catch(m=>(Be(m),Promise.reject(m)))},oe=async(l,o)=>{if(F||!e.prop)return!1;const h=Fe(o);if(!Ee.value)return o==null||o(!1),!1;const m=Le(l);return m.length===0?(o==null||o(!0),!0):(B("validating"),Oe(m).then(()=>(o==null||o(!0),!0)).catch(w=>{const{fields:N}=w;return o==null||o(!1,N),h?!1:Promise.reject(N)}))},G=()=>{B(""),y.value="",F=!1},ae=async()=>{const l=t==null?void 0:t.model;if(!l||!e.prop)return;const o=U(l,e.prop);F=!0,o.value=ce(x),await Ie(),G(),F=!1},Ve=l=>{g.value.includes(l)||g.value.push(l)},Ae=l=>{g.value=g.value.filter(o=>o!==l)};j(()=>e.error,l=>{y.value=l||"",B(l?"error":"")},{immediate:!0}),j(()=>e.validateStatus,l=>B(l||""));const K=ge({...ye(e),$el:C,size:n,validateState:s,labelId:P,inputIds:g,isGroup:T,hasLabel:I,fieldValue:k,addInputId:Ve,removeInputId:Ae,resetField:ae,clearValidate:G,validate:oe});return be(H,K),we(()=>{e.prop&&(t==null||t.addField(K),x=ce(k.value))}),We(()=>{t==null||t.removeField(K)}),p({size:n,validateMessage:y,validateState:s,validate:oe,clearValidate:G,resetField:ae}),(l,o)=>{var h;return X(),Se("div",{ref_key:"formItemRef",ref:C,class:O(c(r)),role:c(T)?"group":void 0,"aria-labelledby":c(T)?c(P):void 0},[R(c(dt),{"is-auto-width":c(E).width==="auto","update-all":((h=c(t))==null?void 0:h.labelWidth)==="auto"},{default:Y(()=>[c(I)?(X(),ke(De(c(q)?"label":"div"),{key:0,id:c(P),for:c(q),class:O(c(f).e("label")),style:ie(c(E))},{default:Y(()=>[$(l.$slots,"label",{label:c(re)},()=>[Ge(ne(c(re)),1)])]),_:3},8,["id","for","class","style"])):ue("v-if",!0)]),_:3},8,["is-auto-width","update-all"]),de("div",{class:O(c(f).e("content")),style:ie(c(M))},[$(l.$slots,"default"),R(Ke,{name:`${c(f).namespace.value}-zoom-in-top`},{default:Y(()=>[c(Me)?$(l.$slots,"error",{key:0,error:y.value},()=>[de("div",{class:O(c(S))},ne(y.value),3)]):ue("v-if",!0)]),_:3},8,["name"])],6)],10,["role","aria-labelledby"])}}});var Pe=_e(ft,[["__file","form-item.vue"]]);const gt=Ye(it,{FormItem:Pe}),yt=He(Pe);export{yt as E,gt as a};
